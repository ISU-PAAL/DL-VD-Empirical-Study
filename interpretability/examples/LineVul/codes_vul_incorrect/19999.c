// commit message qemu@95a5befc2f (target=1, prob=0.34088236, correct=False): Use qemu_tolower() and qemu_toupper(), not tolower() and toupper()
/*0  */ static int read_naa_id(const uint8_t *p, uint64_t *p_wwn)  // (3) 0.05708
/*2  */ {                                                          // (27) 0.002114
/*4  */     int i;                                                 // (24) 0.01268
/*8  */     if ((p[1] & 0xF) == 3) {                               // (8) 0.03805
/*10 */         /* NAA designator type */                          // (16) 0.0296
/*12 */         if (p[3] != 8) {                                   // (10) 0.03594
/*14 */             return -EINVAL;                                // (11) 0.03594
/*16 */         }                                                  // (20) 0.01691
/*18 */         *p_wwn = ldq_be_p(p + 4);                          // (5) 0.05074
/*20 */         return 0;                                          // (18) 0.02114
/*22 */     }                                                      // (25) 0.008457
/*26 */     if ((p[1] & 0xF) == 8) {                               // (9) 0.03805
/*28 */         /* SCSI name string designator type */             // (14) 0.03383
/*30 */         if (p[3] < 20 || memcmp(&p[4], "naa.", 4)) {       // (1) 0.06342
/*32 */             return -EINVAL;                                // (12) 0.03594
/*34 */         }                                                  // (21) 0.01691
/*36 */         if (p[3] > 20 && p[24] != ',') {                   // (4) 0.05285
/*38 */             return -EINVAL;                                // (13) 0.03594
/*40 */         }                                                  // (22) 0.01691
/*42 */         *p_wwn = 0;                                        // (15) 0.03171
/*44 */         for (i = 8; i < 24; i++) {                         // (7) 0.04228
/*46 */             char c = toupper(p[i]);                        // (6) 0.0444
/*48 */             c -= (c >= '0' && c <= '9' ? '0' : 'A' - 10);  // (0) 0.07611
/*50 */             *p_wwn = (*p_wwn << 4) | c;                    // (2) 0.0592
/*52 */         }                                                  // (23) 0.01691
/*54 */         return 0;                                          // (17) 0.02114
/*56 */     }                                                      // (26) 0.008457
/*60 */     return -EINVAL;                                        // (19) 0.01903
/*62 */ }                                                          // (28) 0.002114
