{"code":"!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,\"a\",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p=\"\",n(n.s=82)}([function(t,e,n){\"use strict\";n.d(e,\"c\",(function(){return w})),n.d(e,\"g\",(function(){return M})),n.d(e,\"f\",(function(){return E})),n.d(e,\"h\",(function(){return T})),n.d(e,\"i\",(function(){return C})),n.d(e,\"d\",(function(){return k})),n.d(e,\"e\",(function(){return u.g})),n.d(e,\"b\",(function(){return D})),n.d(e,\"a\",(function(){return F}));var i=n(26),r=n(14);function o(t,e){const{element:{content:n},parts:i}=t,r=document.createTreeWalker(n,133,null,!1);let o=s(i),a=i[o],c=-1,l=0;const d=[];let u=null;for(;r.nextNode();){c++;const t=r.currentNode;for(t.previousSibling===u&&(u=null),e.has(t)&&(d.push(t),null===u&&(u=t)),null!==u&&l++;void 0!==a&&a.index===c;)a.index=null!==u?-1:a.index-l,o=s(i,o),a=i[o]}d.forEach(t=>t.parentNode.removeChild(t))}const a=t=>{let e=11===t.nodeType?0:1;const n=document.createTreeWalker(t,133,null,!1);for(;n.nextNode();)e++;return e},s=(t,e=-1)=>{for(let n=e+1;n<t.length;n++){const e=t[n];if(Object(r.d)(e))return n}return-1};var c=n(37),l=n(36),d=n(43),u=n(9);\n/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nconst h=(t,e)=>`${t}--${e}`;let p=!0;void 0===window.ShadyCSS?p=!1:void 0===window.ShadyCSS.prepareTemplateDom&&(console.warn(\"Incompatible ShadyCSS version detected. Please update to at least @webcomponents/webcomponentsjs@2.0.2 and @webcomponents/shadycss@1.3.1.\"),p=!1);const f=t=>e=>{const n=h(e.type,t);let i=l.a.get(n);void 0===i&&(i={stringsArray:new WeakMap,keyString:new Map},l.a.set(n,i));let o=i.stringsArray.get(e.strings);if(void 0!==o)return o;const a=e.strings.join(r.f);if(o=i.keyString.get(a),void 0===o){const n=e.getTemplateElement();p&&window.ShadyCSS.prepareTemplateDom(n,t),o=new r.a(e,n),i.keyString.set(a,o)}return i.stringsArray.set(e.strings,o),o},m=[\"html\",\"svg\"],g=new Set,v=(t,e,n)=>{g.add(t);const i=n?n.element:document.createElement(\"template\"),r=e.querySelectorAll(\"style\"),{length:c}=r;if(0===c)return void window.ShadyCSS.prepareTemplateStyles(i,t);const d=document.createElement(\"style\");for(let t=0;t<c;t++){const e=r[t];e.parentNode.removeChild(e),d.textContent+=e.textContent}(t=>{m.forEach(e=>{const n=l.a.get(h(e,t));void 0!==n&&n.keyString.forEach(t=>{const{element:{content:e}}=t,n=new Set;Array.from(e.querySelectorAll(\"style\")).forEach(t=>{n.add(t)}),o(t,n)})})})(t);const u=i.content;n?function(t,e,n=null){const{element:{content:i},parts:r}=t;if(null==n)return void i.appendChild(e);const o=document.createTreeWalker(i,133,null,!1);let c=s(r),l=0,d=-1;for(;o.nextNode();){d++;for(o.currentNode===n&&(l=a(e),n.parentNode.insertBefore(e,n));-1!==c&&r[c].index===d;){if(l>0){for(;-1!==c;)r[c].index+=l,c=s(r,c);return}c=s(r,c)}}}(n,d,u.firstChild):u.insertBefore(d,u.firstChild),window.ShadyCSS.prepareTemplateStyles(i,t);const p=u.querySelector(\"style\");if(window.ShadyCSS.nativeShadow&&null!==p)e.insertBefore(p.cloneNode(!0),e.firstChild);else if(n){u.insertBefore(d,u.firstChild);const t=new Set;t.add(d),o(n,t)}};window.JSCompiler_renameProperty=(t,e)=>t;const y={toAttribute(t,e){switch(e){case Boolean:return t?\"\":null;case Object:case Array:return null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){switch(e){case Boolean:return null!==t;case Number:return null===t?null:Number(t);case Object:case Array:return JSON.parse(t)}return t}},b=(t,e)=>e!==t&&(e==e||t==t),_={attribute:!0,type:String,converter:y,reflect:!1,hasChanged:b};class x extends HTMLElement{constructor(){super(),this.initialize()}static get observedAttributes(){this.finalize();const t=[];return this._classProperties.forEach((e,n)=>{const i=this._attributeNameForProperty(n,e);void 0!==i&&(this._attributeToPropertyMap.set(i,n),t.push(i))}),t}static _ensureClassProperties(){if(!this.hasOwnProperty(JSCompiler_renameProperty(\"_classProperties\",this))){this._classProperties=new Map;const t=Object.getPrototypeOf(this)._classProperties;void 0!==t&&t.forEach((t,e)=>this._classProperties.set(e,t))}}static createProperty(t,e=_){if(this._ensureClassProperties(),this._classProperties.set(t,e),e.noAccessor||this.prototype.hasOwnProperty(t))return;const n=\"symbol\"==typeof t?Symbol():\"__\"+t,i=this.getPropertyDescriptor(t,n,e);void 0!==i&&Object.defineProperty(this.prototype,t,i)}static getPropertyDescriptor(t,e,n){return{get(){return this[e]},set(i){const r=this[t];this[e]=i,this.requestUpdateInternal(t,r,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this._classProperties&&this._classProperties.get(t)||_}static finalize(){const t=Object.getPrototypeOf(this);if(t.hasOwnProperty(\"finalized\")||t.finalize(),this.finalized=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty(\"properties\",this))){const t=this.properties,e=[...Object.getOwnPropertyNames(t),...\"function\"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t):[]];for(const n of e)this.createProperty(n,t[n])}}static _attributeNameForProperty(t,e){const n=e.attribute;return!1===n?void 0:\"string\"==typeof n?n:\"string\"==typeof t?t.toLowerCase():void 0}static _valueHasChanged(t,e,n=b){return n(t,e)}static _propertyValueFromAttribute(t,e){const n=e.type,i=e.converter||y,r=\"function\"==typeof i?i:i.fromAttribute;return r?r(t,n):t}static _propertyValueToAttribute(t,e){if(void 0===e.reflect)return;const n=e.type,i=e.converter;return(i&&i.toAttribute||y.toAttribute)(t,n)}initialize(){this._updateState=0,this._updatePromise=new Promise(t=>this._enableUpdatingResolver=t),this._changedProperties=new Map,this._saveInstanceProperties(),this.requestUpdateInternal()}_saveInstanceProperties(){this.constructor._classProperties.forEach((t,e)=>{if(this.hasOwnProperty(e)){const t=this[e];delete this[e],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(e,t)}})}_applyInstanceProperties(){this._instanceProperties.forEach((t,e)=>this[e]=t),this._instanceProperties=void 0}connectedCallback(){this.enableUpdating()}enableUpdating(){void 0!==this._enableUpdatingResolver&&(this._enableUpdatingResolver(),this._enableUpdatingResolver=void 0)}disconnectedCallback(){}attributeChangedCallback(t,e,n){e!==n&&this._attributeToProperty(t,n)}_propertyToAttribute(t,e,n=_){const i=this.constructor,r=i._attributeNameForProperty(t,n);if(void 0!==r){const t=i._propertyValueToAttribute(e,n);if(void 0===t)return;this._updateState=8|this._updateState,null==t?this.removeAttribute(r):this.setAttribute(r,t),this._updateState=-9&this._updateState}}_attributeToProperty(t,e){if(8&this._updateState)return;const n=this.constructor,i=n._attributeToPropertyMap.get(t);if(void 0!==i){const t=n.getPropertyOptions(i);this._updateState=16|this._updateState,this[i]=n._propertyValueFromAttribute(e,t),this._updateState=-17&this._updateState}}requestUpdateInternal(t,e,n){let i=!0;if(void 0!==t){const r=this.constructor;n=n||r.getPropertyOptions(t),r._valueHasChanged(this[t],e,n.hasChanged)?(this._changedProperties.has(t)||this._changedProperties.set(t,e),!0!==n.reflect||16&this._updateState||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(t,n))):i=!1}!this._hasRequestedUpdate&&i&&(this._updatePromise=this._enqueueUpdate())}requestUpdate(t,e){return this.requestUpdateInternal(t,e),this.updateComplete}async _enqueueUpdate(){this._updateState=4|this._updateState;try{await this._updatePromise}catch(t){}const t=this.performUpdate();return null!=t&&await t,!this._hasRequestedUpdate}get _hasRequestedUpdate(){return 4&this._updateState}get hasUpdated(){return 1&this._updateState}performUpdate(){if(!this._hasRequestedUpdate)return;this._instanceProperties&&this._applyInstanceProperties();let t=!1;const e=this._changedProperties;try{t=this.shouldUpdate(e),t?this.update(e):this._markUpdated()}catch(e){throw t=!1,this._markUpdated(),e}t&&(1&this._updateState||(this._updateState=1|this._updateState,this.firstUpdated(e)),this.updated(e))}_markUpdated(){this._changedProperties=new Map,this._updateState=-5&this._updateState}get updateComplete(){return this._getUpdateComplete()}_getUpdateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._updatePromise}shouldUpdate(t){return!0}update(t){void 0!==this._reflectingProperties&&this._reflectingProperties.size>0&&(this._reflectingProperties.forEach((t,e)=>this._propertyToAttribute(e,this[e],t)),this._reflectingProperties=void 0),this._markUpdated()}updated(t){}firstUpdated(t){}}x.finalized=!0;\n/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nconst w=t=>e=>\"function\"==typeof e?((t,e)=>(window.customElements.define(t,e),e))(t,e):((t,e)=>{const{kind:n,elements:i}=e;return{kind:n,elements:i,finisher(e){window.customElements.define(t,e)}}})(t,e),S=(t,e)=>\"method\"===e.kind&&e.descriptor&&!(\"value\"in e.descriptor)?Object.assign(Object.assign({},e),{finisher(n){n.createProperty(e.key,t)}}):{kind:\"field\",key:Symbol(),placement:\"own\",descriptor:{},initializer(){\"function\"==typeof e.initializer&&(this[e.key]=e.initializer.call(this))},finisher(n){n.createProperty(e.key,t)}};function M(t){return(e,n)=>void 0!==n?((t,e,n)=>{e.constructor.createProperty(n,t)})(t,e,n):S(t,e)}function E(t){return M({attribute:!1,hasChanged:null==t?void 0:t.hasChanged})}function T(t,e){return(n,i)=>{const r={get(){return this.renderRoot.querySelector(t)},enumerable:!0,configurable:!0};if(e){const e=void 0!==i?i:n.key,o=\"symbol\"==typeof e?Symbol():\"__\"+e;r.get=function(){return void 0===this[o]&&(this[o]=this.renderRoot.querySelector(t)),this[o]}}return void 0!==i?A(r,n,i):O(r,n)}}function C(t){return(e,n)=>{const i={async get(){return await this.updateComplete,this.renderRoot.querySelector(t)},enumerable:!0,configurable:!0};return void 0!==n?A(i,e,n):O(i,e)}}const A=(t,e,n)=>{Object.defineProperty(e,n,t)},O=(t,e)=>({kind:\"method\",placement:\"prototype\",key:e.key,descriptor:t});function k(t){return(e,n)=>void 0!==n?((t,e,n)=>{Object.assign(e[n],t)})(t,e,n):((t,e)=>Object.assign(Object.assign({},e),{finisher(n){Object.assign(n.prototype[e.key],t)}}))(t,e)}const L=Element.prototype;L.msMatchesSelector||L.webkitMatchesSelector;\n/**\n@license\nCopyright (c) 2019 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\nconst I=window.ShadowRoot&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow)&&\"adoptedStyleSheets\"in Document.prototype&&\"replace\"in CSSStyleSheet.prototype,R=Symbol();class P{constructor(t,e){if(e!==R)throw new Error(\"CSSResult is not constructable. Use `unsafeCSS` or `css` instead.\");this.cssText=t}get styleSheet(){return void 0===this._styleSheet&&(I?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}const D=(t,...e)=>{const n=e.reduce((e,n,i)=>e+(t=>{if(t instanceof P)return t.cssText;if(\"number\"==typeof t)return t;throw new Error(`Value passed to 'css' function must be a 'css' function result: ${t}. Use 'unsafeCSS' to pass non-literal values, but\\n            take care to ensure page security.`)})(n)+t[i+1],t[0]);return new P(n,R)};\n/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n(window.litElementVersions||(window.litElementVersions=[])).push(\"2.5.1\");const N={};class F extends x{static getStyles(){return this.styles}static _getUniqueStyles(){if(this.hasOwnProperty(JSCompiler_renameProperty(\"_styles\",this)))return;const t=this.getStyles();if(Array.isArray(t)){const e=(t,n)=>t.reduceRight((t,n)=>Array.isArray(n)?e(n,t):(t.add(n),t),n),n=e(t,new Set),i=[];n.forEach(t=>i.unshift(t)),this._styles=i}else this._styles=void 0===t?[]:[t];this._styles=this._styles.map(t=>{if(t instanceof CSSStyleSheet&&!I){const e=Array.prototype.slice.call(t.cssRules).reduce((t,e)=>t+e.cssText,\"\");return new P(String(e),R)}return t})}initialize(){super.initialize(),this.constructor._getUniqueStyles(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}createRenderRoot(){return this.attachShadow(this.constructor.shadowRootOptions)}adoptStyles(){const t=this.constructor._styles;0!==t.length&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow?I?this.renderRoot.adoptedStyleSheets=t.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(t.map(t=>t.cssText),this.localName))}connectedCallback(){super.connectedCallback(),this.hasUpdated&&void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this)}update(t){const e=this.render();super.update(t),e!==N&&this.constructor.render(e,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach(t=>{const e=document.createElement(\"style\");e.textContent=t.cssText,this.renderRoot.appendChild(e)}))}render(){return N}}F.finalized=!0,F.render=(t,e,n)=>{if(!n||\"object\"!=typeof n||!n.scopeName)throw new Error(\"The `scopeName` option is required.\");const r=n.scopeName,o=c.a.has(e),a=p&&11===e.nodeType&&!!e.host,s=a&&!g.has(r),l=s?document.createDocumentFragment():e;if(Object(c.b)(t,l,Object.assign({templateFactory:f(r)},n)),s){const t=c.a.get(l);c.a.delete(l);const n=t.value instanceof d.a?t.value.template:void 0;v(r,l,n),Object(i.b)(e,e.firstChild),e.appendChild(l),c.a.set(e,t)}!o&&a&&window.ShadyCSS.styleElement(e.host)},F.shadowRootOptions={mode:\"open\"}},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"__extends\",(function(){return r})),n.d(e,\"__assign\",(function(){return o})),n.d(e,\"__rest\",(function(){return a})),n.d(e,\"__decorate\",(function(){return s})),n.d(e,\"__param\",(function(){return c})),n.d(e,\"__metadata\",(function(){return l})),n.d(e,\"__awaiter\",(function(){return d})),n.d(e,\"__generator\",(function(){return u})),n.d(e,\"__createBinding\",(function(){return h})),n.d(e,\"__exportStar\",(function(){return p})),n.d(e,\"__values\",(function(){return f})),n.d(e,\"__read\",(function(){return m})),n.d(e,\"__spread\",(function(){return g})),n.d(e,\"__spreadArrays\",(function(){return v})),n.d(e,\"__await\",(function(){return y})),n.d(e,\"__asyncGenerator\",(function(){return b})),n.d(e,\"__asyncDelegator\",(function(){return _})),n.d(e,\"__asyncValues\",(function(){return x})),n.d(e,\"__makeTemplateObject\",(function(){return w})),n.d(e,\"__importStar\",(function(){return S})),n.d(e,\"__importDefault\",(function(){return M})),n.d(e,\"__classPrivateFieldGet\",(function(){return E})),n.d(e,\"__classPrivateFieldSet\",(function(){return T}));\n/*! *****************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\nvar i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function r(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function a(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}function s(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}function c(t,e){return function(n,i){e(n,i,t)}}function l(t,e){if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function d(t,e,n,i){return new(n||(n=Promise))((function(r,o){function a(t){try{c(i.next(t))}catch(t){o(t)}}function s(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((i=i.apply(t,e||[])).next())}))}function u(t,e){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},\"function\"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError(\"Generator is already executing.\");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function h(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}function p(t,e){for(var n in t)\"default\"===n||e.hasOwnProperty(n)||(e[n]=t[n])}function f(t){var e=\"function\"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&\"number\"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")}function m(t,e){var n=\"function\"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a}function g(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(m(arguments[e]));return t}function v(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,r++)i[r]=o[a];return i}function y(t){return this instanceof y?(this.v=t,this):new y(t)}function b(t,e,n){if(!Symbol.asyncIterator)throw new TypeError(\"Symbol.asyncIterator is not defined.\");var i,r=n.apply(t,e||[]),o=[];return i={},a(\"next\"),a(\"throw\"),a(\"return\"),i[Symbol.asyncIterator]=function(){return this},i;function a(t){r[t]&&(i[t]=function(e){return new Promise((function(n,i){o.push([t,e,n,i])>1||s(t,e)}))})}function s(t,e){try{(n=r[t](e)).value instanceof y?Promise.resolve(n.value.v).then(c,l):d(o[0][2],n)}catch(t){d(o[0][3],t)}var n}function c(t){s(\"next\",t)}function l(t){s(\"throw\",t)}function d(t,e){t(e),o.shift(),o.length&&s(o[0][0],o[0][1])}}function _(t){var e,n;return e={},i(\"next\"),i(\"throw\",(function(t){throw t})),i(\"return\"),e[Symbol.iterator]=function(){return this},e;function i(i,r){e[i]=t[i]?function(e){return(n=!n)?{value:y(t[i](e)),done:\"return\"===i}:r?r(e):e}:r}}function x(t){if(!Symbol.asyncIterator)throw new TypeError(\"Symbol.asyncIterator is not defined.\");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=f(t),e={},i(\"next\"),i(\"throw\"),i(\"return\"),e[Symbol.asyncIterator]=function(){return this},e);function i(n){e[n]=t[n]&&function(e){return new Promise((function(i,r){(function(t,e,n,i){Promise.resolve(i).then((function(e){t({value:e,done:n})}),e)})(i,r,(e=t[n](e)).done,e.value)}))}}}function w(t,e){return Object.defineProperty?Object.defineProperty(t,\"raw\",{value:e}):t.raw=e,t}function S(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function M(t){return t&&t.__esModule?t:{default:t}}function E(t,e){if(!e.has(t))throw new TypeError(\"attempted to get private field on non-instance\");return e.get(t)}function T(t,e,n){if(!e.has(t))throw new TypeError(\"attempted to set private field on non-instance\");return e.set(t,n),n}},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"customElement\",(function(){return i})),n.d(e,\"property\",(function(){return o})),n.d(e,\"state\",(function(){return a})),n.d(e,\"eventOptions\",(function(){return c})),n.d(e,\"query\",(function(){return l})),n.d(e,\"queryAll\",(function(){return d})),n.d(e,\"queryAsync\",(function(){return u})),n.d(e,\"queryAssignedElements\",(function(){return f})),n.d(e,\"queryAssignedNodes\",(function(){return m}));\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst i=t=>e=>\"function\"==typeof e?((t,e)=>(window.customElements.define(t,e),e))(t,e):((t,e)=>{const{kind:n,elements:i}=e;return{kind:n,elements:i,finisher(e){window.customElements.define(t,e)}}})(t,e)\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */,r=(t,e)=>\"method\"===e.kind&&e.descriptor&&!(\"value\"in e.descriptor)?{...e,finisher(n){n.createProperty(e.key,t)}}:{kind:\"field\",key:Symbol(),placement:\"own\",descriptor:{},originalKey:e.key,initializer(){\"function\"==typeof e.initializer&&(this[e.key]=e.initializer.call(this))},finisher(n){n.createProperty(e.key,t)}};function o(t){return(e,n)=>void 0!==n?((t,e,n)=>{e.constructor.createProperty(n,t)})(t,e,n):r(t,e)\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */}function a(t){return o({...t,state:!0})}\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const s=({finisher:t,descriptor:e})=>(n,i)=>{var r;if(void 0===i){const i=null!==(r=n.originalKey)&&void 0!==r?r:n.key,o=null!=e?{kind:\"method\",placement:\"prototype\",key:i,descriptor:e(n.key)}:{...n,key:i};return null!=t&&(o.finisher=function(e){t(e,i)}),o}{const r=n.constructor;void 0!==e&&Object.defineProperty(n,i,e(i)),null==t||t(r,i)}}\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */;function c(t){return s({finisher:(e,n)=>{Object.assign(e.prototype[n],t)}})}\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */function l(t,e){return s({descriptor:n=>{const i={get(){var e,n;return null!==(n=null===(e=this.renderRoot)||void 0===e?void 0:e.querySelector(t))&&void 0!==n?n:null},enumerable:!0,configurable:!0};if(e){const e=\"symbol\"==typeof n?Symbol():\"__\"+n;i.get=function(){var n,i;return void 0===this[e]&&(this[e]=null!==(i=null===(n=this.renderRoot)||void 0===n?void 0:n.querySelector(t))&&void 0!==i?i:null),this[e]}}return i}})}\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */function d(t){return s({descriptor:e=>({get(){var e,n;return null!==(n=null===(e=this.renderRoot)||void 0===e?void 0:e.querySelectorAll(t))&&void 0!==n?n:[]},enumerable:!0,configurable:!0})})}\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */function u(t){return s({descriptor:e=>({async get(){var e;return await this.updateComplete,null===(e=this.renderRoot)||void 0===e?void 0:e.querySelector(t)},enumerable:!0,configurable:!0})})}\n/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */var h;const p=null!=(null===(h=window.HTMLSlotElement)||void 0===h?void 0:h.prototype.assignedElements)?(t,e)=>t.assignedElements(e):(t,e)=>t.assignedNodes(e).filter(t=>t.nodeType===Node.ELEMENT_NODE);function f(t){const{slot:e,selector:n}=null!=t?t:{};return s({descriptor:i=>({get(){var i;const r=\"slot\"+(e?`[name=${e}]`:\":not([name])\"),o=null===(i=this.renderRoot)||void 0===i?void 0:i.querySelector(r),a=null!=o?p(o,t):[];return n?a.filter(t=>t.matches(n)):a},enumerable:!0,configurable:!0})})}\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */function m(t,e,n){let i,r=t;return\"object\"==typeof t?(r=t.slot,i=t):i={flatten:e},n?f({slot:r,flatten:e,selector:n}):s({descriptor:t=>({get(){var t,e;const n=\"slot\"+(r?`[name=${r}]`:\":not([name])\"),o=null===(t=this.renderRoot)||void 0===t?void 0:t.querySelector(n);return null!==(e=null==o?void 0:o.assignedNodes(i))&&void 0!==e?e:[]},enumerable:!0,configurable:!0})})}},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"CSSResult\",(function(){return a})),n.d(e,\"adoptStyles\",(function(){return l})),n.d(e,\"css\",(function(){return c})),n.d(e,\"getCompatibleStyle\",(function(){return d})),n.d(e,\"supportsAdoptingStyleSheets\",(function(){return i})),n.d(e,\"unsafeCSS\",(function(){return s})),n.d(e,\"ReactiveElement\",(function(){return y})),n.d(e,\"defaultConverter\",(function(){return m})),n.d(e,\"notEqual\",(function(){return g})),n.d(e,\"_$LH\",(function(){return x.a})),n.d(e,\"html\",(function(){return x.b})),n.d(e,\"noChange\",(function(){return x.c})),n.d(e,\"nothing\",(function(){return x.d})),n.d(e,\"render\",(function(){return x.e})),n.d(e,\"svg\",(function(){return x.f})),n.d(e,\"LitElement\",(function(){return S})),n.d(e,\"UpdatingElement\",(function(){return w})),n.d(e,\"_$LE\",(function(){return E}));\n/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst i=window.ShadowRoot&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow)&&\"adoptedStyleSheets\"in Document.prototype&&\"replace\"in CSSStyleSheet.prototype,r=Symbol(),o=new WeakMap;class a{constructor(t,e,n){if(this._$cssResult$=!0,n!==r)throw Error(\"CSSResult is not constructable. Use `unsafeCSS` or `css` instead.\");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const e=this.t;if(i&&void 0===t){const n=void 0!==e&&1===e.length;n&&(t=o.get(e)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),n&&o.set(e,t))}return t}toString(){return this.cssText}}const s=t=>new a(\"string\"==typeof t?t:t+\"\",void 0,r),c=(t,...e)=>{const n=1===t.length?t[0]:e.reduce((e,n,i)=>e+(t=>{if(!0===t._$cssResult$)return t.cssText;if(\"number\"==typeof t)return t;throw Error(\"Value passed to 'css' function must be a 'css' function result: \"+t+\". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.\")})(n)+t[i+1],t[0]);return new a(n,t,r)},l=(t,e)=>{i?t.adoptedStyleSheets=e.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet):e.forEach(e=>{const n=document.createElement(\"style\"),i=window.litNonce;void 0!==i&&n.setAttribute(\"nonce\",i),n.textContent=e.cssText,t.appendChild(n)})},d=i?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e=\"\";for(const n of t.cssRules)e+=n.cssText;return s(e)})(t):t\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */;var u;const h=window.trustedTypes,p=h?h.emptyScript:\"\",f=window.reactiveElementPolyfillSupport,m={toAttribute(t,e){switch(e){case Boolean:t=t?p:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){let n=t;switch(e){case Boolean:n=null!==t;break;case Number:n=null===t?null:Number(t);break;case Object:case Array:try{n=JSON.parse(t)}catch(t){n=null}}return n}},g=(t,e)=>e!==t&&(e==e||t==t),v={attribute:!0,type:String,converter:m,reflect:!1,hasChanged:g};class y extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(t){var e;null!==(e=this.h)&&void 0!==e||(this.h=[]),this.h.push(t)}static get observedAttributes(){this.finalize();const t=[];return this.elementProperties.forEach((e,n)=>{const i=this._$Ep(n,e);void 0!==i&&(this._$Ev.set(i,n),t.push(i))}),t}static createProperty(t,e=v){if(e.state&&(e.attribute=!1),this.finalize(),this.elementProperties.set(t,e),!e.noAccessor&&!this.prototype.hasOwnProperty(t)){const n=\"symbol\"==typeof t?Symbol():\"__\"+t,i=this.getPropertyDescriptor(t,n,e);void 0!==i&&Object.defineProperty(this.prototype,t,i)}}static getPropertyDescriptor(t,e,n){return{get(){return this[e]},set(i){const r=this[t];this[e]=i,this.requestUpdate(t,r,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)||v}static finalize(){if(this.hasOwnProperty(\"finalized\"))return!1;this.finalized=!0;const t=Object.getPrototypeOf(this);if(t.finalize(),this.elementProperties=new Map(t.elementProperties),this._$Ev=new Map,this.hasOwnProperty(\"properties\")){const t=this.properties,e=[...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)];for(const n of e)this.createProperty(n,t[n])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(t){const e=[];if(Array.isArray(t)){const n=new Set(t.flat(1/0).reverse());for(const t of n)e.unshift(d(t))}else void 0!==t&&e.push(d(t));return e}static _$Ep(t,e){const n=e.attribute;return!1===n?void 0:\"string\"==typeof n?n:\"string\"==typeof t?t.toLowerCase():void 0}u(){var t;this._$E_=new Promise(t=>this.enableUpdating=t),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(t=this.constructor.h)||void 0===t||t.forEach(t=>t(this))}addController(t){var e,n;(null!==(e=this._$ES)&&void 0!==e?e:this._$ES=[]).push(t),void 0!==this.renderRoot&&this.isConnected&&(null===(n=t.hostConnected)||void 0===n||n.call(t))}removeController(t){var e;null===(e=this._$ES)||void 0===e||e.splice(this._$ES.indexOf(t)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach((t,e)=>{this.hasOwnProperty(e)&&(this._$Ei.set(e,this[e]),delete this[e])})}createRenderRoot(){var t;const e=null!==(t=this.shadowRoot)&&void 0!==t?t:this.attachShadow(this.constructor.shadowRootOptions);return l(e,this.constructor.elementStyles),e}connectedCallback(){var t;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(t=this._$ES)||void 0===t||t.forEach(t=>{var e;return null===(e=t.hostConnected)||void 0===e?void 0:e.call(t)})}enableUpdating(t){}disconnectedCallback(){var t;null===(t=this._$ES)||void 0===t||t.forEach(t=>{var e;return null===(e=t.hostDisconnected)||void 0===e?void 0:e.call(t)})}attributeChangedCallback(t,e,n){this._$AK(t,n)}_$EO(t,e,n=v){var i,r;const o=this.constructor._$Ep(t,n);if(void 0!==o&&!0===n.reflect){const a=(null!==(r=null===(i=n.converter)||void 0===i?void 0:i.toAttribute)&&void 0!==r?r:m.toAttribute)(e,n.type);this._$El=t,null==a?this.removeAttribute(o):this.setAttribute(o,a),this._$El=null}}_$AK(t,e){var n,i;const r=this.constructor,o=r._$Ev.get(t);if(void 0!==o&&this._$El!==o){const t=r.getPropertyOptions(o),a=t.converter,s=null!==(i=null!==(n=null==a?void 0:a.fromAttribute)&&void 0!==n?n:\"function\"==typeof a?a:null)&&void 0!==i?i:m.fromAttribute;this._$El=o,this[o]=s(e,t.type),this._$El=null}}requestUpdate(t,e,n){let i=!0;void 0!==t&&(((n=n||this.constructor.getPropertyOptions(t)).hasChanged||g)(this[t],e)?(this._$AL.has(t)||this._$AL.set(t,e),!0===n.reflect&&this._$El!==t&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(t,n))):i=!1),!this.isUpdatePending&&i&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var t;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach((t,e)=>this[e]=t),this._$Ei=void 0);let e=!1;const n=this._$AL;try{e=this.shouldUpdate(n),e?(this.willUpdate(n),null===(t=this._$ES)||void 0===t||t.forEach(t=>{var e;return null===(e=t.hostUpdate)||void 0===e?void 0:e.call(t)}),this.update(n)):this._$Ek()}catch(t){throw e=!1,this._$Ek(),t}e&&this._$AE(n)}willUpdate(t){}_$AE(t){var e;null===(e=this._$ES)||void 0===e||e.forEach(t=>{var e;return null===(e=t.hostUpdated)||void 0===e?void 0:e.call(t)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(t){return!0}update(t){void 0!==this._$EC&&(this._$EC.forEach((t,e)=>this._$EO(e,this[e],t)),this._$EC=void 0),this._$Ek()}updated(t){}firstUpdated(t){}}y.finalized=!0,y.elementProperties=new Map,y.elementStyles=[],y.shadowRootOptions={mode:\"open\"},null==f||f({ReactiveElement:y}),(null!==(u=globalThis.reactiveElementVersions)&&void 0!==u?u:globalThis.reactiveElementVersions=[]).push(\"1.3.4\");var b,_,x=n(22);\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const w=y;class S extends y{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t,e;const n=super.createRenderRoot();return null!==(t=(e=this.renderOptions).renderBefore)&&void 0!==t||(e.renderBefore=n.firstChild),n}update(t){const e=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=Object(x.e)(e,this.renderRoot,this.renderOptions)}connectedCallback(){var t;super.connectedCallback(),null===(t=this._$Do)||void 0===t||t.setConnected(!0)}disconnectedCallback(){var t;super.disconnectedCallback(),null===(t=this._$Do)||void 0===t||t.setConnected(!1)}render(){return x.c}}S.finalized=!0,S._$litElement$=!0,null===(b=globalThis.litElementHydrateSupport)||void 0===b||b.call(globalThis,{LitElement:S});const M=globalThis.litElementPolyfillSupport;null==M||M({LitElement:S});const E={_$AK:(t,e,n)=>{t._$AK(e,n)},_$AL:t=>t._$AL};(null!==(_=globalThis.litElementVersions)&&void 0!==_?_:globalThis.litElementVersions=[]).push(\"3.2.2\")},function(t,e,n){\"use strict\";n.r(e),function(t,i){n.d(e,\"$mobx\",(function(){return w})),n.d(e,\"FlowCancellationError\",(function(){return Te})),n.d(e,\"IDerivationState\",(function(){return Q})),n.d(e,\"ObservableMap\",(function(){return xn})),n.d(e,\"ObservableSet\",(function(){return Mn})),n.d(e,\"Reaction\",(function(){return Xt})),n.d(e,\"_allowStateChanges\",(function(){return Mt})),n.d(e,\"_allowStateChangesInsideComputed\",(function(){return Ct})),n.d(e,\"_allowStateReadsEnd\",(function(){return mt})),n.d(e,\"_allowStateReadsStart\",(function(){return ft})),n.d(e,\"_endAction\",(function(){return St})),n.d(e,\"_getAdministration\",(function(){return Pn})),n.d(e,\"_getGlobalState\",(function(){return Bt})),n.d(e,\"_interceptReads\",(function(){return ke})),n.d(e,\"_isComputingDerivation\",(function(){return st})),n.d(e,\"_resetGlobalState\",(function(){return zt})),n.d(e,\"_startAction\",(function(){return wt})),n.d(e,\"action\",(function(){return oe})),n.d(e,\"autorun\",(function(){return le})),n.d(e,\"comparer\",(function(){return T})),n.d(e,\"computed\",(function(){return it})),n.d(e,\"configure\",(function(){return ge})),n.d(e,\"createAtom\",(function(){return E})),n.d(e,\"decorate\",(function(){return ve})),n.d(e,\"entries\",(function(){return ze})),n.d(e,\"extendObservable\",(function(){return ye})),n.d(e,\"flow\",(function(){return Ae})),n.d(e,\"get\",(function(){return Ge})),n.d(e,\"getAtom\",(function(){return Rn})),n.d(e,\"getDebugName\",(function(){return Dn})),n.d(e,\"getDependencyTree\",(function(){return xe})),n.d(e,\"getObserverTree\",(function(){return Se})),n.d(e,\"has\",(function(){return $e})),n.d(e,\"intercept\",(function(){return Le})),n.d(e,\"isAction\",(function(){return se})),n.d(e,\"isArrayLike\",(function(){return m})),n.d(e,\"isBoxedObservable\",(function(){return Ot})),n.d(e,\"isComputed\",(function(){return Re})),n.d(e,\"isComputedProp\",(function(){return Pe})),n.d(e,\"isFlowCancellationError\",(function(){return Ce})),n.d(e,\"isObservable\",(function(){return Ne})),n.d(e,\"isObservableArray\",(function(){return yn})),n.d(e,\"isObservableMap\",(function(){return wn})),n.d(e,\"isObservableObject\",(function(){return In})),n.d(e,\"isObservableProp\",(function(){return Fe})),n.d(e,\"isObservableSet\",(function(){return En})),n.d(e,\"keys\",(function(){return je})),n.d(e,\"observable\",(function(){return Z})),n.d(e,\"observe\",(function(){return Ve})),n.d(e,\"onBecomeObserved\",(function(){return pe})),n.d(e,\"onBecomeUnobserved\",(function(){return fe})),n.d(e,\"onReactionError\",(function(){return Yt})),n.d(e,\"reaction\",(function(){return he})),n.d(e,\"remove\",(function(){return He})),n.d(e,\"runInAction\",(function(){return ae})),n.d(e,\"set\",(function(){return Ue})),n.d(e,\"spy\",(function(){return ee})),n.d(e,\"toJS\",(function(){return Xe})),n.d(e,\"trace\",(function(){return Ye})),n.d(e,\"transaction\",(function(){return Ze})),n.d(e,\"untracked\",(function(){return ut})),n.d(e,\"values\",(function(){return Be})),n.d(e,\"when\",(function(){return Je}));var r=[];Object.freeze(r);var o={};function a(){return++jt.mobxGuid}function s(t){throw c(!1,t),\"X\"}function c(t,e){if(!t)throw new Error(\"[mobx] \"+(e||\"An invariant failed, however the error is obfuscated because this is a production build.\"))}Object.freeze(o);function l(t){var e=!1;return function(){if(!e)return e=!0,t.apply(this,arguments)}}var d=function(){};function u(t){return null!==t&&\"object\"==typeof t}function h(t){if(null===t||\"object\"!=typeof t)return!1;var e=Object.getPrototypeOf(t);return e===Object.prototype||null===e}function p(t,e,n){Object.defineProperty(t,e,{enumerable:!1,writable:!0,configurable:!0,value:n})}function f(t,e){var n=\"isMobX\"+t;return e.prototype[n]=!0,function(t){return u(t)&&!0===t[n]}}function m(t){return Array.isArray(t)||yn(t)}function g(t){return t instanceof Map}function v(t){return t instanceof Set}function y(t){var e=new Set;for(var n in t)e.add(n);return Object.getOwnPropertySymbols(t).forEach((function(n){Object.getOwnPropertyDescriptor(t,n).enumerable&&e.add(n)})),Array.from(e)}function b(t){return t&&t.toString?t.toString():new String(t).toString()}function _(t){return null===t?null:\"object\"==typeof t?\"\"+t:t}var x=\"undefined\"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames,w=Symbol(\"mobx administration\"),S=function(){function t(t){void 0===t&&(t=\"Atom@\"+a()),this.name=t,this.isPendingUnobservation=!1,this.isBeingObserved=!1,this.observers=new Set,this.diffValue=0,this.lastAccessedBy=0,this.lowestObserverState=Q.NOT_TRACKING}return t.prototype.onBecomeObserved=function(){this.onBecomeObservedListeners&&this.onBecomeObservedListeners.forEach((function(t){return t()}))},t.prototype.onBecomeUnobserved=function(){this.onBecomeUnobservedListeners&&this.onBecomeUnobservedListeners.forEach((function(t){return t()}))},t.prototype.reportObserved=function(){return Wt(this)},t.prototype.reportChanged=function(){Gt(),function(t){if(t.lowestObserverState===Q.STALE)return;t.lowestObserverState=Q.STALE,t.observers.forEach((function(e){e.dependenciesState===Q.UP_TO_DATE&&(e.isTracing!==tt.NONE&&qt(e,t),e.onBecomeStale()),e.dependenciesState=Q.STALE}))}(this),Vt()},t.prototype.toString=function(){return this.name},t}(),M=f(\"Atom\",S);function E(t,e,n){void 0===e&&(e=d),void 0===n&&(n=d);var i=new S(t);return e!==d&&pe(i,e),n!==d&&fe(i,n),i}var T={identity:function(t,e){return t===e},structural:function(t,e){return Fn(t,e)},default:function(t,e){return Object.is(t,e)},shallow:function(t,e){return Fn(t,e,1)}},C=function(t,e){return(C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};\n/*! *****************************************************************************\nCopyright (c) Microsoft Corporation. All rights reserved.\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\nthis file except in compliance with the License. You may obtain a copy of the\nLicense at http://www.apache.org/licenses/LICENSE-2.0\n\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\nMERCHANTABLITY OR NON-INFRINGEMENT.\n\nSee the Apache Version 2.0 License for specific language governing permissions\nand limitations under the License.\n***************************************************************************** */var A=function(){return(A=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function O(t){var e=\"function\"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function k(t,e){var n=\"function\"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a}function L(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(k(arguments[e]));return t}var I=Symbol(\"mobx did run lazy initializers\"),R=Symbol(\"mobx pending decorators\"),P={},D={};function N(t,e){var n=e?P:D;return n[t]||(n[t]={configurable:!0,enumerable:e,get:function(){return F(this),this[t]},set:function(e){F(this),this[t]=e}})}function F(t){var e,n;if(!0!==t[I]){var i=t[R];if(i){p(t,I,!0);var r=L(Object.getOwnPropertySymbols(i),Object.keys(i));try{for(var o=O(r),a=o.next();!a.done;a=o.next()){var s=i[a.value];s.propertyCreator(t,s.prop,s.descriptor,s.decoratorTarget,s.decoratorArguments)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}}}}function j(t,e){return function(){var n,i=function(i,r,o,a){if(!0===a)return e(i,r,o,i,n),null;if(!Object.prototype.hasOwnProperty.call(i,R)){var s=i[R];p(i,R,A({},s))}return i[R][r]={prop:r,propertyCreator:e,descriptor:o,decoratorTarget:i,decoratorArguments:n},N(r,t)};return B(arguments)?(n=r,i.apply(null,arguments)):(n=Array.prototype.slice.call(arguments),i)}}function B(t){return(2===t.length||3===t.length)&&(\"string\"==typeof t[1]||\"symbol\"==typeof t[1])||4===t.length&&!0===t[3]}function z(t,e,n){return Ne(t)?t:Array.isArray(t)?Z.array(t,{name:n}):h(t)?Z.object(t,void 0,{name:n}):g(t)?Z.map(t,{name:n}):v(t)?Z.set(t,{name:n}):t}function U(t){return t}function H(e){c(e);var n=j(!0,(function(t,n,i,r,o){var a=i?i.initializer?i.initializer.call(t):i.value:void 0;Cn(t).addObservableProp(n,a,e)})),i=(void 0!==t&&t.env,n);return i.enhancer=e,i}var $={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};function G(t){return null==t?$:\"string\"==typeof t?{name:t,deep:!0,proxy:!0}:t}Object.freeze($);var V=H(z),W=H((function(t,e,n){return null==t||In(t)||yn(t)||wn(t)||En(t)?t:Array.isArray(t)?Z.array(t,{name:n,deep:!1}):h(t)?Z.object(t,void 0,{name:n,deep:!1}):g(t)?Z.map(t,{name:n,deep:!1}):v(t)?Z.set(t,{name:n,deep:!1}):s(!1)})),q=H(U),X=H((function(t,e,n){return Fn(t,e)?e:t}));function Y(t){return t.defaultDecorator?t.defaultDecorator.enhancer:!1===t.deep?U:z}var K={box:function(t,e){arguments.length>2&&J(\"box\");var n=G(e);return new At(t,Y(n),n.name,!0,n.equals)},array:function(t,e){arguments.length>2&&J(\"array\");var n=G(e);return pn(t,Y(n),n.name)},map:function(t,e){arguments.length>2&&J(\"map\");var n=G(e);return new xn(t,Y(n),n.name)},set:function(t,e){arguments.length>2&&J(\"set\");var n=G(e);return new Mn(t,Y(n),n.name)},object:function(t,e,n){\"string\"==typeof arguments[1]&&J(\"object\");var i=G(n);if(!1===i.proxy)return ye({},t,e,i);var r=be(i),o=ye({},void 0,void 0,i),a=on(o);return _e(a,t,e,r),a},ref:q,shallow:W,deep:V,struct:X},Z=function(t,e,n){if(\"string\"==typeof arguments[1]||\"symbol\"==typeof arguments[1])return V.apply(null,arguments);if(Ne(t))return t;var i=h(t)?Z.object(t,e,n):Array.isArray(t)?Z.array(t,e):g(t)?Z.map(t,e):v(t)?Z.set(t,e):t;if(i!==t)return i;s(!1)};function J(t){s(\"Expected one or two arguments to observable.\"+t+\". Did you accidentally try to use observable.\"+t+\" as decorator?\")}Object.keys(K).forEach((function(t){return Z[t]=K[t]}));var Q,tt,et=j(!1,(function(t,e,n,i,r){var o=n.get,a=n.set,s=r[0]||{};Cn(t).addComputedProp(t,e,A({get:o,set:a,context:t},s))})),nt=et({equals:T.structural}),it=function(t,e,n){if(\"string\"==typeof e)return et.apply(null,arguments);if(null!==t&&\"object\"==typeof t&&1===arguments.length)return et.apply(null,arguments);var i=\"object\"==typeof e?e:{};return i.get=t,i.set=\"function\"==typeof e?e:i.set,i.name=i.name||t.name||\"\",new kt(i)};it.struct=nt,function(t){t[t.NOT_TRACKING=-1]=\"NOT_TRACKING\",t[t.UP_TO_DATE=0]=\"UP_TO_DATE\",t[t.POSSIBLY_STALE=1]=\"POSSIBLY_STALE\",t[t.STALE=2]=\"STALE\"}(Q||(Q={})),function(t){t[t.NONE=0]=\"NONE\",t[t.LOG=1]=\"LOG\",t[t.BREAK=2]=\"BREAK\"}(tt||(tt={}));var rt=function(t){this.cause=t};function ot(t){return t instanceof rt}function at(t){switch(t.dependenciesState){case Q.UP_TO_DATE:return!1;case Q.NOT_TRACKING:case Q.STALE:return!0;case Q.POSSIBLY_STALE:for(var e=ft(!0),n=ht(),i=t.observing,r=i.length,o=0;o<r;o++){var a=i[o];if(Lt(a)){if(jt.disableErrorBoundaries)a.get();else try{a.get()}catch(t){return pt(n),mt(e),!0}if(t.dependenciesState===Q.STALE)return pt(n),mt(e),!0}}return gt(t),pt(n),mt(e),!1}}function st(){return null!==jt.trackingDerivation}function ct(t){var e=t.observers.size>0;jt.computationDepth>0&&e&&s(!1),jt.allowStateChanges||!e&&\"strict\"!==jt.enforceActions||s(!1)}function lt(t,e,n){var i=ft(!0);gt(t),t.newObserving=new Array(t.observing.length+100),t.unboundDepsCount=0,t.runId=++jt.runId;var r,o=jt.trackingDerivation;if(jt.trackingDerivation=t,!0===jt.disableErrorBoundaries)r=e.call(n);else try{r=e.call(n)}catch(t){r=new rt(t)}return jt.trackingDerivation=o,function(t){for(var e=t.observing,n=t.observing=t.newObserving,i=Q.UP_TO_DATE,r=0,o=t.unboundDepsCount,a=0;a<o;a++){0===(s=n[a]).diffValue&&(s.diffValue=1,r!==a&&(n[r]=s),r++),s.dependenciesState>i&&(i=s.dependenciesState)}n.length=r,t.newObserving=null,o=e.length;for(;o--;){0===(s=e[o]).diffValue&&Ht(s,t),s.diffValue=0}for(;r--;){var s;1===(s=n[r]).diffValue&&(s.diffValue=0,Ut(s,t))}i!==Q.UP_TO_DATE&&(t.dependenciesState=i,t.onBecomeStale())}(t),mt(i),r}function dt(t){var e=t.observing;t.observing=[];for(var n=e.length;n--;)Ht(e[n],t);t.dependenciesState=Q.NOT_TRACKING}function ut(t){var e=ht();try{return t()}finally{pt(e)}}function ht(){var t=jt.trackingDerivation;return jt.trackingDerivation=null,t}function pt(t){jt.trackingDerivation=t}function ft(t){var e=jt.allowStateReads;return jt.allowStateReads=t,e}function mt(t){jt.allowStateReads=t}function gt(t){if(t.dependenciesState!==Q.UP_TO_DATE){t.dependenciesState=Q.UP_TO_DATE;for(var e=t.observing,n=e.length;n--;)e[n].lowestObserverState=Q.UP_TO_DATE}}var vt=0,yt=1,bt=Object.getOwnPropertyDescriptor((function(){}),\"name\");bt&&bt.configurable;function _t(t,e,n){var i=function(){return xt(t,e,n||this,arguments)};return i.isMobxAction=!0,i}function xt(t,e,n,i){var r=wt(t,n,i);try{return e.apply(n,i)}catch(t){throw r.error=t,t}finally{St(r)}}function wt(t,e,n){var i=0,r=ht();Gt();var o={prevDerivation:r,prevAllowStateChanges:Et(!0),prevAllowStateReads:ft(!0),notifySpy:!1,startTime:i,actionId:yt++,parentActionId:vt};return vt=o.actionId,o}function St(t){vt!==t.actionId&&s(\"invalid action stack. did you forget to finish an action?\"),vt=t.parentActionId,void 0!==t.error&&(jt.suppressReactionErrors=!0),Tt(t.prevAllowStateChanges),mt(t.prevAllowStateReads),Vt(),pt(t.prevDerivation),t.notifySpy,jt.suppressReactionErrors=!1}function Mt(t,e){var n,i=Et(t);try{n=e()}finally{Tt(i)}return n}function Et(t){var e=jt.allowStateChanges;return jt.allowStateChanges=t,e}function Tt(t){jt.allowStateChanges=t}function Ct(t){var e,n=jt.computationDepth;jt.computationDepth=0;try{e=t()}finally{jt.computationDepth=n}return e}var At=function(t){function e(e,n,i,r,o){void 0===i&&(i=\"ObservableValue@\"+a()),void 0===r&&(r=!0),void 0===o&&(o=T.default);var s=t.call(this,i)||this;return s.enhancer=n,s.name=i,s.equals=o,s.hasUnreportedChange=!1,s.value=n(e,void 0,i),s}return function(t,e){function n(){this.constructor=t}C(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.dehanceValue=function(t){return void 0!==this.dehancer?this.dehancer(t):t},e.prototype.set=function(t){this.value;if((t=this.prepareNewValue(t))!==jt.UNCHANGED){0,this.setNewValue(t)}},e.prototype.prepareNewValue=function(t){if(ct(this),an(this)){var e=cn(this,{object:this,type:\"update\",newValue:t});if(!e)return jt.UNCHANGED;t=e.newValue}return t=this.enhancer(t,this.value,this.name),this.equals(this.value,t)?jt.UNCHANGED:t},e.prototype.setNewValue=function(t){var e=this.value;this.value=t,this.reportChanged(),ln(this)&&un(this,{type:\"update\",object:this,newValue:t,oldValue:e})},e.prototype.get=function(){return this.reportObserved(),this.dehanceValue(this.value)},e.prototype.intercept=function(t){return sn(this,t)},e.prototype.observe=function(t,e){return e&&t({object:this,type:\"update\",newValue:this.value,oldValue:void 0}),dn(this,t)},e.prototype.toJSON=function(){return this.get()},e.prototype.toString=function(){return this.name+\"[\"+this.value+\"]\"},e.prototype.valueOf=function(){return _(this.get())},e.prototype[Symbol.toPrimitive]=function(){return this.valueOf()},e}(S),Ot=f(\"ObservableValue\",At),kt=function(){function t(t){this.dependenciesState=Q.NOT_TRACKING,this.observing=[],this.newObserving=null,this.isBeingObserved=!1,this.isPendingUnobservation=!1,this.observers=new Set,this.diffValue=0,this.runId=0,this.lastAccessedBy=0,this.lowestObserverState=Q.UP_TO_DATE,this.unboundDepsCount=0,this.__mapid=\"#\"+a(),this.value=new rt(null),this.isComputing=!1,this.isRunningSetter=!1,this.isTracing=tt.NONE,c(t.get,\"missing option for computed: get\"),this.derivation=t.get,this.name=t.name||\"ComputedValue@\"+a(),t.set&&(this.setter=_t(this.name+\"-setter\",t.set)),this.equals=t.equals||(t.compareStructural||t.struct?T.structural:T.default),this.scope=t.context,this.requiresReaction=!!t.requiresReaction,this.keepAlive=!!t.keepAlive}return t.prototype.onBecomeStale=function(){!function(t){if(t.lowestObserverState!==Q.UP_TO_DATE)return;t.lowestObserverState=Q.POSSIBLY_STALE,t.observers.forEach((function(e){e.dependenciesState===Q.UP_TO_DATE&&(e.dependenciesState=Q.POSSIBLY_STALE,e.isTracing!==tt.NONE&&qt(e,t),e.onBecomeStale())}))}(this)},t.prototype.onBecomeObserved=function(){this.onBecomeObservedListeners&&this.onBecomeObservedListeners.forEach((function(t){return t()}))},t.prototype.onBecomeUnobserved=function(){this.onBecomeUnobservedListeners&&this.onBecomeUnobservedListeners.forEach((function(t){return t()}))},t.prototype.get=function(){this.isComputing&&s(\"Cycle detected in computation \"+this.name+\": \"+this.derivation),0!==jt.inBatch||0!==this.observers.size||this.keepAlive?(Wt(this),at(this)&&this.trackAndCompute()&&function(t){if(t.lowestObserverState===Q.STALE)return;t.lowestObserverState=Q.STALE,t.observers.forEach((function(e){e.dependenciesState===Q.POSSIBLY_STALE?e.dependenciesState=Q.STALE:e.dependenciesState===Q.UP_TO_DATE&&(t.lowestObserverState=Q.UP_TO_DATE)}))}(this)):at(this)&&(this.warnAboutUntrackedRead(),Gt(),this.value=this.computeValue(!1),Vt());var t=this.value;if(ot(t))throw t.cause;return t},t.prototype.peek=function(){var t=this.computeValue(!1);if(ot(t))throw t.cause;return t},t.prototype.set=function(t){if(this.setter){c(!this.isRunningSetter,\"The setter of computed value '\"+this.name+\"' is trying to update itself. Did you intend to update an _observable_ value, instead of the computed property?\"),this.isRunningSetter=!0;try{this.setter.call(this.scope,t)}finally{this.isRunningSetter=!1}}else c(!1,!1)},t.prototype.trackAndCompute=function(){var t=this.value,e=this.dependenciesState===Q.NOT_TRACKING,n=this.computeValue(!0),i=e||ot(t)||ot(n)||!this.equals(t,n);return i&&(this.value=n),i},t.prototype.computeValue=function(t){var e;if(this.isComputing=!0,jt.computationDepth++,t)e=lt(this,this.derivation,this.scope);else if(!0===jt.disableErrorBoundaries)e=this.derivation.call(this.scope);else try{e=this.derivation.call(this.scope)}catch(t){e=new rt(t)}return jt.computationDepth--,this.isComputing=!1,e},t.prototype.suspend=function(){this.keepAlive||(dt(this),this.value=void 0)},t.prototype.observe=function(t,e){var n=this,i=!0,r=void 0;return le((function(){var o=n.get();if(!i||e){var a=ht();t({type:\"update\",object:n,newValue:o,oldValue:r}),pt(a)}i=!1,r=o}))},t.prototype.warnAboutUntrackedRead=function(){},t.prototype.toJSON=function(){return this.get()},t.prototype.toString=function(){return this.name+\"[\"+this.derivation.toString()+\"]\"},t.prototype.valueOf=function(){return _(this.get())},t.prototype[Symbol.toPrimitive]=function(){return this.valueOf()},t}(),Lt=f(\"ComputedValue\",kt),It=[\"mobxGuid\",\"spyListeners\",\"enforceActions\",\"computedRequiresReaction\",\"reactionRequiresObservable\",\"observableRequiresReaction\",\"allowStateReads\",\"disableErrorBoundaries\",\"runId\",\"UNCHANGED\"],Rt=function(){this.version=5,this.UNCHANGED={},this.trackingDerivation=null,this.computationDepth=0,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!0,this.allowStateReads=!0,this.enforceActions=!1,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.computedConfigurable=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1},Pt={};function Dt(){return\"undefined\"!=typeof window?window:void 0!==i?i:\"undefined\"!=typeof self?self:Pt}var Nt=!0,Ft=!1,jt=function(){var t=Dt();return t.__mobxInstanceCount>0&&!t.__mobxGlobals&&(Nt=!1),t.__mobxGlobals&&t.__mobxGlobals.version!==(new Rt).version&&(Nt=!1),Nt?t.__mobxGlobals?(t.__mobxInstanceCount+=1,t.__mobxGlobals.UNCHANGED||(t.__mobxGlobals.UNCHANGED={}),t.__mobxGlobals):(t.__mobxInstanceCount=1,t.__mobxGlobals=new Rt):(setTimeout((function(){Ft||s(\"There are multiple, different versions of MobX active. Make sure MobX is loaded only once or use `configure({ isolateGlobalState: true })`\")}),1),new Rt)}();function Bt(){return jt}function zt(){var t=new Rt;for(var e in t)-1===It.indexOf(e)&&(jt[e]=t[e]);jt.allowStateChanges=!jt.enforceActions}function Ut(t,e){t.observers.add(e),t.lowestObserverState>e.dependenciesState&&(t.lowestObserverState=e.dependenciesState)}function Ht(t,e){t.observers.delete(e),0===t.observers.size&&$t(t)}function $t(t){!1===t.isPendingUnobservation&&(t.isPendingUnobservation=!0,jt.pendingUnobservations.push(t))}function Gt(){jt.inBatch++}function Vt(){if(0==--jt.inBatch){Zt();for(var t=jt.pendingUnobservations,e=0;e<t.length;e++){var n=t[e];n.isPendingUnobservation=!1,0===n.observers.size&&(n.isBeingObserved&&(n.isBeingObserved=!1,n.onBecomeUnobserved()),n instanceof kt&&n.suspend())}jt.pendingUnobservations=[]}}function Wt(t){var e=jt.trackingDerivation;return null!==e?(e.runId!==t.lastAccessedBy&&(t.lastAccessedBy=e.runId,e.newObserving[e.unboundDepsCount++]=t,t.isBeingObserved||(t.isBeingObserved=!0,t.onBecomeObserved())),!0):(0===t.observers.size&&jt.inBatch>0&&$t(t),!1)}function qt(t,e){if(console.log(\"[mobx.trace] '\"+t.name+\"' is invalidated due to a change in: '\"+e.name+\"'\"),t.isTracing===tt.BREAK){var n=[];!function t(e,n,i){if(n.length>=1e3)return void n.push(\"(and many more)\");n.push(\"\"+new Array(i).join(\"\\t\")+e.name),e.dependencies&&e.dependencies.forEach((function(e){return t(e,n,i+1)}))}(xe(t),n,1),new Function(\"debugger;\\n/*\\nTracing '\"+t.name+\"'\\n\\nYou are entering this break point because derivation '\"+t.name+\"' is being traced and '\"+e.name+\"' is now forcing it to update.\\nJust follow the stacktrace you should now see in the devtools to see precisely what piece of your code is causing this update\\nThe stackframe you are looking for is at least ~6-8 stack-frames up.\\n\\n\"+(t instanceof kt?t.derivation.toString().replace(/[*]\\//g,\"/\"):\"\")+\"\\n\\nThe dependencies for this derivation are:\\n\\n\"+n.join(\"\\n\")+\"\\n*/\\n    \")()}}var Xt=function(){function t(t,e,n,i){void 0===t&&(t=\"Reaction@\"+a()),void 0===i&&(i=!1),this.name=t,this.onInvalidate=e,this.errorHandler=n,this.requiresObservable=i,this.observing=[],this.newObserving=[],this.dependenciesState=Q.NOT_TRACKING,this.diffValue=0,this.runId=0,this.unboundDepsCount=0,this.__mapid=\"#\"+a(),this.isDisposed=!1,this._isScheduled=!1,this._isTrackPending=!1,this._isRunning=!1,this.isTracing=tt.NONE}return t.prototype.onBecomeStale=function(){this.schedule()},t.prototype.schedule=function(){this._isScheduled||(this._isScheduled=!0,jt.pendingReactions.push(this),Zt())},t.prototype.isScheduled=function(){return this._isScheduled},t.prototype.runReaction=function(){if(!this.isDisposed){if(Gt(),this._isScheduled=!1,at(this)){this._isTrackPending=!0;try{this.onInvalidate(),this._isTrackPending}catch(t){this.reportExceptionInDerivation(t)}}Vt()}},t.prototype.track=function(t){if(!this.isDisposed){Gt();0,this._isRunning=!0;var e=lt(this,t,void 0);this._isRunning=!1,this._isTrackPending=!1,this.isDisposed&&dt(this),ot(e)&&this.reportExceptionInDerivation(e.cause),Vt()}},t.prototype.reportExceptionInDerivation=function(t){var e=this;if(this.errorHandler)this.errorHandler(t,this);else{if(jt.disableErrorBoundaries)throw t;var n=\"[mobx] Encountered an uncaught exception that was thrown by a reaction or observer component, in: '\"+this+\"'\";jt.suppressReactionErrors?console.warn(\"[mobx] (error in reaction '\"+this.name+\"' suppressed, fix error of causing action below)\"):console.error(n,t),jt.globalReactionErrorHandlers.forEach((function(n){return n(t,e)}))}},t.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._isRunning||(Gt(),dt(this),Vt()))},t.prototype.getDisposer=function(){var t=this.dispose.bind(this);return t[w]=this,t},t.prototype.toString=function(){return\"Reaction[\"+this.name+\"]\"},t.prototype.trace=function(t){void 0===t&&(t=!1),Ye(this,t)},t}();function Yt(t){return jt.globalReactionErrorHandlers.push(t),function(){var e=jt.globalReactionErrorHandlers.indexOf(t);e>=0&&jt.globalReactionErrorHandlers.splice(e,1)}}var Kt=function(t){return t()};function Zt(){jt.inBatch>0||jt.isRunningReactions||Kt(Jt)}function Jt(){jt.isRunningReactions=!0;for(var t=jt.pendingReactions,e=0;t.length>0;){100==++e&&(console.error(\"Reaction doesn't converge to a stable state after 100 iterations. Probably there is a cycle in the reactive function: \"+t[0]),t.splice(0));for(var n=t.splice(0),i=0,r=n.length;i<r;i++)n[i].runReaction()}jt.isRunningReactions=!1}var Qt=f(\"Reaction\",Xt);function te(t){var e=Kt;Kt=function(n){return t((function(){return e(n)}))}}function ee(t){return console.warn(\"[mobx.spy] Is a no-op in production builds\"),function(){}}function ne(){s(!1)}function ie(t){return function(e,n,i){if(i){if(i.value)return{value:_t(t,i.value),enumerable:!1,configurable:!0,writable:!0};var r=i.initializer;return{enumerable:!1,configurable:!0,writable:!0,initializer:function(){return _t(t,r.call(this))}}}return re(t).apply(this,arguments)}}function re(t){return function(e,n,i){Object.defineProperty(e,n,{configurable:!0,enumerable:!1,get:function(){},set:function(e){p(this,n,oe(t,e))}})}}var oe=function(t,e,n,i){return 1===arguments.length&&\"function\"==typeof t?_t(t.name||\"<unnamed action>\",t):2===arguments.length&&\"function\"==typeof e?_t(t,e):1===arguments.length&&\"string\"==typeof t?ie(t):!0!==i?ie(e).apply(null,arguments):void p(t,e,_t(t.name||e,n.value,this))};function ae(t,e){return xt(\"string\"==typeof t?t:t.name||\"<unnamed action>\",\"function\"==typeof t?t:e,this,void 0)}function se(t){return\"function\"==typeof t&&!0===t.isMobxAction}function ce(t,e,n){p(t,e,_t(e,n.bind(t)))}function le(t,e){void 0===e&&(e=o);var n,i=e&&e.name||t.name||\"Autorun@\"+a();if(!e.scheduler&&!e.delay)n=new Xt(i,(function(){this.track(c)}),e.onError,e.requiresObservable);else{var r=ue(e),s=!1;n=new Xt(i,(function(){s||(s=!0,r((function(){s=!1,n.isDisposed||n.track(c)})))}),e.onError,e.requiresObservable)}function c(){t(n)}return n.schedule(),n.getDisposer()}oe.bound=function(t,e,n,i){return!0===i?(ce(t,e,n.value),null):n?{configurable:!0,enumerable:!1,get:function(){return ce(this,e,n.value||n.initializer.call(this)),this[e]},set:ne}:{enumerable:!1,configurable:!0,set:function(t){ce(this,e,t)},get:function(){}}};var de=function(t){return t()};function ue(t){return t.scheduler?t.scheduler:t.delay?function(e){return setTimeout(e,t.delay)}:de}function he(t,e,n){void 0===n&&(n=o);var i,r,s,c=n.name||\"Reaction@\"+a(),l=oe(c,n.onError?(i=n.onError,r=e,function(){try{return r.apply(this,arguments)}catch(t){i.call(this,t)}}):e),d=!n.scheduler&&!n.delay,u=ue(n),h=!0,p=!1,f=n.compareStructural?T.structural:n.equals||T.default,m=new Xt(c,(function(){h||d?g():p||(p=!0,u(g))}),n.onError,n.requiresObservable);function g(){if(p=!1,!m.isDisposed){var e=!1;m.track((function(){var n=t(m);e=h||!f(s,n),s=n})),h&&n.fireImmediately&&l(s,m),h||!0!==e||l(s,m),h&&(h=!1)}}return m.schedule(),m.getDisposer()}function pe(t,e,n){return me(\"onBecomeObserved\",t,e,n)}function fe(t,e,n){return me(\"onBecomeUnobserved\",t,e,n)}function me(t,e,n,i){var r=\"function\"==typeof i?Rn(e,n):Rn(e),o=\"function\"==typeof i?i:n,a=t+\"Listeners\";return r[a]?r[a].add(o):r[a]=new Set([o]),\"function\"!=typeof r[t]?s(!1):function(){var t=r[a];t&&(t.delete(o),0===t.size&&delete r[a])}}function ge(t){var e=t.enforceActions,n=t.computedRequiresReaction,i=t.computedConfigurable,r=t.disableErrorBoundaries,o=t.reactionScheduler,a=t.reactionRequiresObservable,c=t.observableRequiresReaction;if(!0===t.isolateGlobalState&&((jt.pendingReactions.length||jt.inBatch||jt.isRunningReactions)&&s(\"isolateGlobalState should be called before MobX is running any reactions\"),Ft=!0,Nt&&(0==--Dt().__mobxInstanceCount&&(Dt().__mobxGlobals=void 0),jt=new Rt)),void 0!==e){var l=void 0;switch(e){case!0:case\"observed\":l=!0;break;case!1:case\"never\":l=!1;break;case\"strict\":case\"always\":l=\"strict\";break;default:s(\"Invalid value for 'enforceActions': '\"+e+\"', expected 'never', 'always' or 'observed'\")}jt.enforceActions=l,jt.allowStateChanges=!0!==l&&\"strict\"!==l}void 0!==n&&(jt.computedRequiresReaction=!!n),void 0!==a&&(jt.reactionRequiresObservable=!!a),void 0!==c&&(jt.observableRequiresReaction=!!c,jt.allowStateReads=!jt.observableRequiresReaction),void 0!==i&&(jt.computedConfigurable=!!i),void 0!==r&&(!0===r&&console.warn(\"WARNING: Debug feature only. MobX will NOT recover from errors when `disableErrorBoundaries` is enabled.\"),jt.disableErrorBoundaries=!!r),o&&te(o)}function ve(t,e){var n=\"function\"==typeof t?t.prototype:t,i=function(t){var i=e[t];Array.isArray(i)||(i=[i]);var r=Object.getOwnPropertyDescriptor(n,t),o=i.reduce((function(e,i){return i(n,t,e)}),r);o&&Object.defineProperty(n,t,o)};for(var r in e)i(r);return t}function ye(t,e,n,i){var r=be(i=G(i));return F(t),Cn(t,i.name,r.enhancer),e&&_e(t,e,n,r),t}function be(t){return t.defaultDecorator||(!1===t.deep?q:V)}function _e(t,e,n,i){var r,o;Gt();try{var a=x(e);try{for(var s=O(a),c=s.next();!c.done;c=s.next()){var l=c.value,d=Object.getOwnPropertyDescriptor(e,l);0;var u=(n&&l in n?n[l]:d.get?et:i)(t,l,d,!0);u&&Object.defineProperty(t,l,u)}}catch(t){r={error:t}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}}finally{Vt()}}function xe(t,e){return we(Rn(t,e))}function we(t){var e,n,i={name:t.name};return t.observing&&t.observing.length>0&&(i.dependencies=(e=t.observing,n=[],e.forEach((function(t){-1===n.indexOf(t)&&n.push(t)})),n).map(we)),i}function Se(t,e){return Me(Rn(t,e))}function Me(t){var e={name:t.name};return function(t){return t.observers&&t.observers.size>0}(t)&&(e.observers=Array.from(function(t){return t.observers}(t)).map(Me)),e}var Ee=0;function Te(){this.message=\"FLOW_CANCELLED\"}function Ce(t){return t instanceof Te}function Ae(t){1!==arguments.length&&s(\"Flow expects 1 argument and cannot be used as decorator\");var e=t.name||\"<unnamed flow>\";return function(){var n,i=this,r=arguments,o=++Ee,a=oe(e+\" - runid: \"+o+\" - init\",t).apply(i,r),s=void 0,c=new Promise((function(t,i){var r=0;function c(t){var n;s=void 0;try{n=oe(e+\" - runid: \"+o+\" - yield \"+r++,a.next).call(a,t)}catch(t){return i(t)}d(n)}function l(t){var n;s=void 0;try{n=oe(e+\" - runid: \"+o+\" - yield \"+r++,a.throw).call(a,t)}catch(t){return i(t)}d(n)}function d(e){if(!e||\"function\"!=typeof e.then)return e.done?t(e.value):(s=Promise.resolve(e.value)).then(c,l);e.then(d,i)}n=i,c(void 0)}));return c.cancel=oe(e+\" - runid: \"+o+\" - cancel\",(function(){try{s&&Oe(s);var t=a.return(void 0),e=Promise.resolve(t.value);e.then(d,d),Oe(e),n(new Te)}catch(t){n(t)}})),c}}function Oe(t){\"function\"==typeof t.cancel&&t.cancel()}function ke(t,e,n){var i;if(wn(t)||yn(t)||Ot(t))i=Pn(t);else{if(!In(t))return s(!1);if(\"string\"!=typeof e)return s(!1);i=Pn(t,e)}return void 0!==i.dehancer?s(!1):(i.dehancer=\"function\"==typeof e?e:n,function(){i.dehancer=void 0})}function Le(t,e,n){return\"function\"==typeof n?function(t,e,n){return Pn(t,e).intercept(n)}(t,e,n):function(t,e){return Pn(t).intercept(e)}(t,e)}function Ie(t,e){if(null==t)return!1;if(void 0!==e){if(!1===In(t))return!1;if(!t[w].values.has(e))return!1;var n=Rn(t,e);return Lt(n)}return Lt(t)}function Re(t){return arguments.length>1?s(!1):Ie(t)}function Pe(t,e){return\"string\"!=typeof e?s(!1):Ie(t,e)}function De(t,e){return null!=t&&(void 0!==e?!!In(t)&&t[w].values.has(e):In(t)||!!t[w]||M(t)||Qt(t)||Lt(t))}function Ne(t){return 1!==arguments.length&&s(!1),De(t)}function Fe(t,e){return\"string\"!=typeof e?s(!1):De(t,e)}function je(t){return In(t)?t[w].getKeys():wn(t)||En(t)?Array.from(t.keys()):yn(t)?t.map((function(t,e){return e})):s(!1)}function Be(t){return In(t)?je(t).map((function(e){return t[e]})):wn(t)?je(t).map((function(e){return t.get(e)})):En(t)?Array.from(t.values()):yn(t)?t.slice():s(!1)}function ze(t){return In(t)?je(t).map((function(e){return[e,t[e]]})):wn(t)?je(t).map((function(e){return[e,t.get(e)]})):En(t)?Array.from(t.entries()):yn(t)?t.map((function(t,e){return[e,t]})):s(!1)}function Ue(t,e,n){if(2!==arguments.length||En(t))if(In(t)){var i=t[w],r=i.values.get(e);r?i.write(e,n):i.addObservableProp(e,n,i.defaultEnhancer)}else if(wn(t))t.set(e,n);else if(En(t))t.add(e);else{if(!yn(t))return s(!1);\"number\"!=typeof e&&(e=parseInt(e,10)),c(e>=0,\"Not a valid index: '\"+e+\"'\"),Gt(),e>=t.length&&(t.length=e+1),t[e]=n,Vt()}else{Gt();var o=e;try{for(var a in o)Ue(t,a,o[a])}finally{Vt()}}}function He(t,e){if(In(t))t[w].remove(e);else if(wn(t))t.delete(e);else if(En(t))t.delete(e);else{if(!yn(t))return s(!1);\"number\"!=typeof e&&(e=parseInt(e,10)),c(e>=0,\"Not a valid index: '\"+e+\"'\"),t.splice(e,1)}}function $e(t,e){return In(t)?Pn(t).has(e):wn(t)||En(t)?t.has(e):yn(t)?e>=0&&e<t.length:s(!1)}function Ge(t,e){if($e(t,e))return In(t)?t[e]:wn(t)?t.get(e):yn(t)?t[e]:s(!1)}function Ve(t,e,n,i){return\"function\"==typeof n?function(t,e,n,i){return Pn(t,e).observe(n,i)}(t,e,n,i):function(t,e,n){return Pn(t).observe(e,n)}(t,e,n)}Te.prototype=Object.create(Error.prototype);var We={detectCycles:!0,exportMapsAsObjects:!0,recurseEverything:!1};function qe(t,e,n,i){return i.detectCycles&&t.set(e,n),n}function Xe(t,e){var n;return\"boolean\"==typeof e&&(e={detectCycles:e}),e||(e=We),e.detectCycles=void 0===e.detectCycles?!0===e.recurseEverything:!0===e.detectCycles,e.detectCycles&&(n=new Map),function t(e,n,i){if(!n.recurseEverything&&!Ne(e))return e;if(\"object\"!=typeof e)return e;if(null===e)return null;if(e instanceof Date)return e;if(Ot(e))return t(e.get(),n,i);if(Ne(e)&&je(e),!0===n.detectCycles&&null!==e&&i.has(e))return i.get(e);if(yn(e)||Array.isArray(e)){var r=qe(i,e,[],n),o=e.map((function(e){return t(e,n,i)}));r.length=o.length;for(var a=0,s=o.length;a<s;a++)r[a]=o[a];return r}if(En(e)||Object.getPrototypeOf(e)===Set.prototype){if(!1===n.exportMapsAsObjects){var c=qe(i,e,new Set,n);return e.forEach((function(e){c.add(t(e,n,i))})),c}var l=qe(i,e,[],n);return e.forEach((function(e){l.push(t(e,n,i))})),l}if(wn(e)||Object.getPrototypeOf(e)===Map.prototype){if(!1===n.exportMapsAsObjects){var d=qe(i,e,new Map,n);return e.forEach((function(e,r){d.set(r,t(e,n,i))})),d}var u=qe(i,e,{},n);return e.forEach((function(e,r){u[r]=t(e,n,i)})),u}var h=qe(i,e,{},n);return y(e).forEach((function(r){h[r]=t(e[r],n,i)})),h}(t,e,n)}function Ye(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=!1;\"boolean\"==typeof t[t.length-1]&&(n=t.pop());var i=Ke(t);if(!i)return s(!1);i.isTracing===tt.NONE&&console.log(\"[mobx.trace] '\"+i.name+\"' tracing enabled\"),i.isTracing=n?tt.BREAK:tt.LOG}function Ke(t){switch(t.length){case 0:return jt.trackingDerivation;case 1:return Rn(t[0]);case 2:return Rn(t[0],t[1])}}function Ze(t,e){void 0===e&&(e=void 0),Gt();try{return t.apply(e)}finally{Vt()}}function Je(t,e,n){return 1===arguments.length||e&&\"object\"==typeof e?tn(t,e):Qe(t,e,n||{})}function Qe(t,e,n){var i;\"number\"==typeof n.timeout&&(i=setTimeout((function(){if(!o[w].isDisposed){o();var t=new Error(\"WHEN_TIMEOUT\");if(!n.onError)throw t;n.onError(t)}}),n.timeout)),n.name=n.name||\"When@\"+a();var r=_t(n.name+\"-effect\",e),o=le((function(e){t()&&(e.dispose(),i&&clearTimeout(i),r())}),n);return o}function tn(t,e){var n;var i=new Promise((function(i,r){var o=Qe(t,i,A(A({},e),{onError:r}));n=function(){o(),r(\"WHEN_CANCELLED\")}}));return i.cancel=n,i}function en(t){return t[w]}function nn(t){return\"string\"==typeof t||\"number\"==typeof t||\"symbol\"==typeof t}var rn={has:function(t,e){if(e===w||\"constructor\"===e||e===I)return!0;var n=en(t);return nn(e)?n.has(e):e in t},get:function(t,e){if(e===w||\"constructor\"===e||e===I)return t[e];var n=en(t),i=n.values.get(e);if(i instanceof S){var r=i.get();return void 0===r&&n.has(e),r}return nn(e)&&n.has(e),t[e]},set:function(t,e,n){return!!nn(e)&&(Ue(t,e,n),!0)},deleteProperty:function(t,e){return!!nn(e)&&(en(t).remove(e),!0)},ownKeys:function(t){return en(t).keysAtom.reportObserved(),Reflect.ownKeys(t)},preventExtensions:function(t){return s(\"Dynamic observable objects cannot be frozen\"),!1}};function on(t){var e=new Proxy(t,rn);return t[w].proxy=e,e}function an(t){return void 0!==t.interceptors&&t.interceptors.length>0}function sn(t,e){var n=t.interceptors||(t.interceptors=[]);return n.push(e),l((function(){var t=n.indexOf(e);-1!==t&&n.splice(t,1)}))}function cn(t,e){var n=ht();try{for(var i=L(t.interceptors||[]),r=0,o=i.length;r<o&&(c(!(e=i[r](e))||e.type,\"Intercept handlers should return nothing or a change object\"),e);r++);return e}finally{pt(n)}}function ln(t){return void 0!==t.changeListeners&&t.changeListeners.length>0}function dn(t,e){var n=t.changeListeners||(t.changeListeners=[]);return n.push(e),l((function(){var t=n.indexOf(e);-1!==t&&n.splice(t,1)}))}function un(t,e){var n=ht(),i=t.changeListeners;if(i){for(var r=0,o=(i=i.slice()).length;r<o;r++)i[r](e);pt(n)}}var hn={get:function(t,e){return e===w?t[w]:\"length\"===e?t[w].getArrayLength():\"number\"==typeof e?mn.get.call(t,e):\"string\"!=typeof e||isNaN(e)?mn.hasOwnProperty(e)?mn[e]:t[e]:mn.get.call(t,parseInt(e))},set:function(t,e,n){return\"length\"===e&&t[w].setArrayLength(n),\"number\"==typeof e&&mn.set.call(t,e,n),\"symbol\"==typeof e||isNaN(e)?t[e]=n:mn.set.call(t,parseInt(e),n),!0},preventExtensions:function(t){return s(\"Observable arrays cannot be frozen\"),!1}};function pn(t,e,n,i){void 0===n&&(n=\"ObservableArray@\"+a()),void 0===i&&(i=!1);var r,o,s,c=new fn(n,e,i);r=c.values,o=w,s=c,Object.defineProperty(r,o,{enumerable:!1,writable:!1,configurable:!0,value:s});var l=new Proxy(c.values,hn);if(c.proxy=l,t&&t.length){var d=Et(!0);c.spliceWithArray(0,0,t),Tt(d)}return l}var fn=function(){function t(t,e,n){this.owned=n,this.values=[],this.proxy=void 0,this.lastKnownLength=0,this.atom=new S(t||\"ObservableArray@\"+a()),this.enhancer=function(n,i){return e(n,i,t+\"[..]\")}}return t.prototype.dehanceValue=function(t){return void 0!==this.dehancer?this.dehancer(t):t},t.prototype.dehanceValues=function(t){return void 0!==this.dehancer&&t.length>0?t.map(this.dehancer):t},t.prototype.intercept=function(t){return sn(this,t)},t.prototype.observe=function(t,e){return void 0===e&&(e=!1),e&&t({object:this.proxy,type:\"splice\",index:0,added:this.values.slice(),addedCount:this.values.length,removed:[],removedCount:0}),dn(this,t)},t.prototype.getArrayLength=function(){return this.atom.reportObserved(),this.values.length},t.prototype.setArrayLength=function(t){if(\"number\"!=typeof t||t<0)throw new Error(\"[mobx.array] Out of range: \"+t);var e=this.values.length;if(t!==e)if(t>e){for(var n=new Array(t-e),i=0;i<t-e;i++)n[i]=void 0;this.spliceWithArray(e,0,n)}else this.spliceWithArray(t,e-t)},t.prototype.updateArrayLength=function(t,e){if(t!==this.lastKnownLength)throw new Error(\"[mobx] Modification exception: the internal structure of an observable array was changed.\");this.lastKnownLength+=e},t.prototype.spliceWithArray=function(t,e,n){var i=this;ct(this.atom);var o=this.values.length;if(void 0===t?t=0:t>o?t=o:t<0&&(t=Math.max(0,o+t)),e=1===arguments.length?o-t:null==e?0:Math.max(0,Math.min(e,o-t)),void 0===n&&(n=r),an(this)){var a=cn(this,{object:this.proxy,type:\"splice\",index:t,removedCount:e,added:n});if(!a)return r;e=a.removedCount,n=a.added}n=0===n.length?n:n.map((function(t){return i.enhancer(t,void 0)}));var s=this.spliceItemsIntoValues(t,e,n);return 0===e&&0===n.length||this.notifyArraySplice(t,n,s),this.dehanceValues(s)},t.prototype.spliceItemsIntoValues=function(t,e,n){var i;if(n.length<1e4)return(i=this.values).splice.apply(i,L([t,e],n));var r=this.values.slice(t,t+e);return this.values=this.values.slice(0,t).concat(n,this.values.slice(t+e)),r},t.prototype.notifyArrayChildUpdate=function(t,e,n){var i=!this.owned&&!1,r=ln(this),o=r||i?{object:this.proxy,type:\"update\",index:t,newValue:e,oldValue:n}:null;this.atom.reportChanged(),r&&un(this,o)},t.prototype.notifyArraySplice=function(t,e,n){var i=!this.owned&&!1,r=ln(this),o=r||i?{object:this.proxy,type:\"splice\",index:t,removed:n,added:e,removedCount:n.length,addedCount:e.length}:null;this.atom.reportChanged(),r&&un(this,o)},t}(),mn={intercept:function(t){return this[w].intercept(t)},observe:function(t,e){return void 0===e&&(e=!1),this[w].observe(t,e)},clear:function(){return this.splice(0)},replace:function(t){var e=this[w];return e.spliceWithArray(0,e.values.length,t)},toJS:function(){return this.slice()},toJSON:function(){return this.toJS()},splice:function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r=this[w];switch(arguments.length){case 0:return[];case 1:return r.spliceWithArray(t);case 2:return r.spliceWithArray(t,e)}return r.spliceWithArray(t,e,n)},spliceWithArray:function(t,e,n){return this[w].spliceWithArray(t,e,n)},push:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this[w];return n.spliceWithArray(n.values.length,0,t),n.values.length},pop:function(){return this.splice(Math.max(this[w].values.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this[w];return n.spliceWithArray(0,0,t),n.values.length},reverse:function(){var t=this.slice();return t.reverse.apply(t,arguments)},sort:function(t){var e=this.slice();return e.sort.apply(e,arguments)},remove:function(t){var e=this[w],n=e.dehanceValues(e.values).indexOf(t);return n>-1&&(this.splice(n,1),!0)},get:function(t){var e=this[w];if(e){if(t<e.values.length)return e.atom.reportObserved(),e.dehanceValue(e.values[t]);console.warn(\"[mobx.array] Attempt to read an array index (\"+t+\") that is out of bounds (\"+e.values.length+\"). Please check length first. Out of bound indices will not be tracked by MobX\")}},set:function(t,e){var n=this[w],i=n.values;if(t<i.length){ct(n.atom);var r=i[t];if(an(n)){var o=cn(n,{type:\"update\",object:n.proxy,index:t,newValue:e});if(!o)return;e=o.newValue}(e=n.enhancer(e,r))!==r&&(i[t]=e,n.notifyArrayChildUpdate(t,e,r))}else{if(t!==i.length)throw new Error(\"[mobx.array] Index out of bounds, \"+t+\" is larger than \"+i.length);n.spliceWithArray(t,0,[e])}}};[\"concat\",\"flat\",\"includes\",\"indexOf\",\"join\",\"lastIndexOf\",\"slice\",\"toString\",\"toLocaleString\"].forEach((function(t){\"function\"==typeof Array.prototype[t]&&(mn[t]=function(){var e=this[w];e.atom.reportObserved();var n=e.dehanceValues(e.values);return n[t].apply(n,arguments)})})),[\"every\",\"filter\",\"find\",\"findIndex\",\"flatMap\",\"forEach\",\"map\",\"some\"].forEach((function(t){\"function\"==typeof Array.prototype[t]&&(mn[t]=function(e,n){var i=this,r=this[w];return r.atom.reportObserved(),r.values[t]((function(t,o){return t=r.dehanceValue(t),e.call(n,t,o,i)}),n)})})),[\"reduce\",\"reduceRight\"].forEach((function(t){mn[t]=function(e,n){var i=this,r=this[w];return r.atom.reportObserved(),r.values[t]((function(t,n,o){return n=r.dehanceValue(n),e(t,n,o,i)}),n)}}));var gn,vn=f(\"ObservableArrayAdministration\",fn);function yn(t){return u(t)&&vn(t[w])}var bn,_n={},xn=function(){function t(t,e,n){if(void 0===e&&(e=z),void 0===n&&(n=\"ObservableMap@\"+a()),this.enhancer=e,this.name=n,this[gn]=_n,this._keysAtom=E(this.name+\".keys()\"),this[Symbol.toStringTag]=\"Map\",\"function\"!=typeof Map)throw new Error(\"mobx.map requires Map polyfill for the current browser. Check babel-polyfill or core-js/es6/map.js\");this._data=new Map,this._hasMap=new Map,this.merge(t)}return t.prototype._has=function(t){return this._data.has(t)},t.prototype.has=function(t){var e=this;if(!jt.trackingDerivation)return this._has(t);var n=this._hasMap.get(t);if(!n){var i=n=new At(this._has(t),U,this.name+\".\"+b(t)+\"?\",!1);this._hasMap.set(t,i),fe(i,(function(){return e._hasMap.delete(t)}))}return n.get()},t.prototype.set=function(t,e){var n=this._has(t);if(an(this)){var i=cn(this,{type:n?\"update\":\"add\",object:this,newValue:e,name:t});if(!i)return this;e=i.newValue}return n?this._updateValue(t,e):this._addValue(t,e),this},t.prototype.delete=function(t){var e=this;if((ct(this._keysAtom),an(this))&&!(i=cn(this,{type:\"delete\",object:this,name:t})))return!1;if(this._has(t)){var n=ln(this),i=n?{type:\"delete\",object:this,oldValue:this._data.get(t).value,name:t}:null;return Ze((function(){e._keysAtom.reportChanged(),e._updateHasMapEntry(t,!1),e._data.get(t).setNewValue(void 0),e._data.delete(t)})),n&&un(this,i),!0}return!1},t.prototype._updateHasMapEntry=function(t,e){var n=this._hasMap.get(t);n&&n.setNewValue(e)},t.prototype._updateValue=function(t,e){var n=this._data.get(t);if((e=n.prepareNewValue(e))!==jt.UNCHANGED){var i=ln(this),r=i?{type:\"update\",object:this,oldValue:n.value,name:t,newValue:e}:null;0,n.setNewValue(e),i&&un(this,r)}},t.prototype._addValue=function(t,e){var n=this;ct(this._keysAtom),Ze((function(){var i=new At(e,n.enhancer,n.name+\".\"+b(t),!1);n._data.set(t,i),e=i.value,n._updateHasMapEntry(t,!0),n._keysAtom.reportChanged()}));var i=ln(this),r=i?{type:\"add\",object:this,name:t,newValue:e}:null;i&&un(this,r)},t.prototype.get=function(t){return this.has(t)?this.dehanceValue(this._data.get(t).get()):this.dehanceValue(void 0)},t.prototype.dehanceValue=function(t){return void 0!==this.dehancer?this.dehancer(t):t},t.prototype.keys=function(){return this._keysAtom.reportObserved(),this._data.keys()},t.prototype.values=function(){var t=this,e=this.keys();return zn({next:function(){var n=e.next(),i=n.done,r=n.value;return{done:i,value:i?void 0:t.get(r)}}})},t.prototype.entries=function(){var t=this,e=this.keys();return zn({next:function(){var n=e.next(),i=n.done,r=n.value;return{done:i,value:i?void 0:[r,t.get(r)]}}})},t.prototype[(gn=w,Symbol.iterator)]=function(){return this.entries()},t.prototype.forEach=function(t,e){var n,i;try{for(var r=O(this),o=r.next();!o.done;o=r.next()){var a=k(o.value,2),s=a[0],c=a[1];t.call(e,c,s,this)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}},t.prototype.merge=function(t){var e=this;return wn(t)&&(t=t.toJS()),Ze((function(){h(t)?y(t).forEach((function(n){return e.set(n,t[n])})):Array.isArray(t)?t.forEach((function(t){var n=k(t,2),i=n[0],r=n[1];return e.set(i,r)})):g(t)?(t.constructor!==Map&&s(\"Cannot initialize from classes that inherit from Map: \"+t.constructor.name),t.forEach((function(t,n){return e.set(n,t)}))):null!=t&&s(\"Cannot initialize map from \"+t)})),this},t.prototype.clear=function(){var t=this;Ze((function(){ut((function(){var e,n;try{for(var i=O(t.keys()),r=i.next();!r.done;r=i.next()){var o=r.value;t.delete(o)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}}))}))},t.prototype.replace=function(t){var e=this;return Ze((function(){var n,i,r,o,a=function(t){if(g(t)||wn(t))return t;if(Array.isArray(t))return new Map(t);if(h(t)){var e=new Map;for(var n in t)e.set(n,t[n]);return e}return s(\"Cannot convert to map from '\"+t+\"'\")}(t),c=new Map,l=!1;try{for(var d=O(e._data.keys()),u=d.next();!u.done;u=d.next()){var p=u.value;if(!a.has(p))if(e.delete(p))l=!0;else{var f=e._data.get(p);c.set(p,f)}}}catch(t){n={error:t}}finally{try{u&&!u.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}try{for(var m=O(a.entries()),v=m.next();!v.done;v=m.next()){var y=k(v.value,2),b=(p=y[0],f=y[1],e._data.has(p));if(e.set(p,f),e._data.has(p)){var _=e._data.get(p);c.set(p,_),b||(l=!0)}}}catch(t){r={error:t}}finally{try{v&&!v.done&&(o=m.return)&&o.call(m)}finally{if(r)throw r.error}}if(!l)if(e._data.size!==c.size)e._keysAtom.reportChanged();else for(var x=e._data.keys(),w=c.keys(),S=x.next(),M=w.next();!S.done;){if(S.value!==M.value){e._keysAtom.reportChanged();break}S=x.next(),M=w.next()}e._data=c})),this},Object.defineProperty(t.prototype,\"size\",{get:function(){return this._keysAtom.reportObserved(),this._data.size},enumerable:!0,configurable:!0}),t.prototype.toPOJO=function(){var t,e,n={};try{for(var i=O(this),r=i.next();!r.done;r=i.next()){var o=k(r.value,2),a=o[0],s=o[1];n[\"symbol\"==typeof a?a:b(a)]=s}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return n},t.prototype.toJS=function(){return new Map(this)},t.prototype.toJSON=function(){return this.toPOJO()},t.prototype.toString=function(){var t=this;return this.name+\"[{ \"+Array.from(this.keys()).map((function(e){return b(e)+\": \"+t.get(e)})).join(\", \")+\" }]\"},t.prototype.observe=function(t,e){return dn(this,t)},t.prototype.intercept=function(t){return sn(this,t)},t}(),wn=f(\"ObservableMap\",xn),Sn={},Mn=function(){function t(t,e,n){if(void 0===e&&(e=z),void 0===n&&(n=\"ObservableSet@\"+a()),this.name=n,this[bn]=Sn,this._data=new Set,this._atom=E(this.name),this[Symbol.toStringTag]=\"Set\",\"function\"!=typeof Set)throw new Error(\"mobx.set requires Set polyfill for the current browser. Check babel-polyfill or core-js/es6/set.js\");this.enhancer=function(t,i){return e(t,i,n)},t&&this.replace(t)}return t.prototype.dehanceValue=function(t){return void 0!==this.dehancer?this.dehancer(t):t},t.prototype.clear=function(){var t=this;Ze((function(){ut((function(){var e,n;try{for(var i=O(t._data.values()),r=i.next();!r.done;r=i.next()){var o=r.value;t.delete(o)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}}))}))},t.prototype.forEach=function(t,e){var n,i;try{for(var r=O(this),o=r.next();!o.done;o=r.next()){var a=o.value;t.call(e,a,a,this)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}},Object.defineProperty(t.prototype,\"size\",{get:function(){return this._atom.reportObserved(),this._data.size},enumerable:!0,configurable:!0}),t.prototype.add=function(t){var e=this;if((ct(this._atom),an(this))&&!(i=cn(this,{type:\"add\",object:this,newValue:t})))return this;if(!this.has(t)){Ze((function(){e._data.add(e.enhancer(t,void 0)),e._atom.reportChanged()}));var n=ln(this),i=n?{type:\"add\",object:this,newValue:t}:null;0,n&&un(this,i)}return this},t.prototype.delete=function(t){var e=this;if(an(this)&&!(i=cn(this,{type:\"delete\",object:this,oldValue:t})))return!1;if(this.has(t)){var n=ln(this),i=n?{type:\"delete\",object:this,oldValue:t}:null;return Ze((function(){e._atom.reportChanged(),e._data.delete(t)})),n&&un(this,i),!0}return!1},t.prototype.has=function(t){return this._atom.reportObserved(),this._data.has(this.dehanceValue(t))},t.prototype.entries=function(){var t=0,e=Array.from(this.keys()),n=Array.from(this.values());return zn({next:function(){var i=t;return t+=1,i<n.length?{value:[e[i],n[i]],done:!1}:{done:!0}}})},t.prototype.keys=function(){return this.values()},t.prototype.values=function(){this._atom.reportObserved();var t=this,e=0,n=Array.from(this._data.values());return zn({next:function(){return e<n.length?{value:t.dehanceValue(n[e++]),done:!1}:{done:!0}}})},t.prototype.replace=function(t){var e=this;return En(t)&&(t=t.toJS()),Ze((function(){Array.isArray(t)||v(t)?(e.clear(),t.forEach((function(t){return e.add(t)}))):null!=t&&s(\"Cannot initialize set from \"+t)})),this},t.prototype.observe=function(t,e){return dn(this,t)},t.prototype.intercept=function(t){return sn(this,t)},t.prototype.toJS=function(){return new Set(this)},t.prototype.toString=function(){return this.name+\"[ \"+Array.from(this).join(\", \")+\" ]\"},t.prototype[(bn=w,Symbol.iterator)]=function(){return this.values()},t}(),En=f(\"ObservableSet\",Mn),Tn=function(){function t(t,e,n,i){void 0===e&&(e=new Map),this.target=t,this.values=e,this.name=n,this.defaultEnhancer=i,this.keysAtom=new S(n+\".keys\")}return t.prototype.read=function(t){return this.values.get(t).get()},t.prototype.write=function(t,e){var n=this.target,i=this.values.get(t);if(i instanceof kt)i.set(e);else{if(an(this)){if(!(o=cn(this,{type:\"update\",object:this.proxy||n,name:t,newValue:e})))return;e=o.newValue}if((e=i.prepareNewValue(e))!==jt.UNCHANGED){var r=ln(this),o=r?{type:\"update\",object:this.proxy||n,oldValue:i.value,name:t,newValue:e}:null;0,i.setNewValue(e),r&&un(this,o)}}},t.prototype.has=function(t){var e=this.pendingKeys||(this.pendingKeys=new Map),n=e.get(t);if(n)return n.get();var i=!!this.values.get(t);return n=new At(i,U,this.name+\".\"+b(t)+\"?\",!1),e.set(t,n),n.get()},t.prototype.addObservableProp=function(t,e,n){void 0===n&&(n=this.defaultEnhancer);var i=this.target;if(an(this)){var r=cn(this,{object:this.proxy||i,name:t,type:\"add\",newValue:e});if(!r)return;e=r.newValue}var o=new At(e,n,this.name+\".\"+b(t),!1);this.values.set(t,o),e=o.value,Object.defineProperty(i,t,function(t){return An[t]||(An[t]={configurable:!0,enumerable:!0,get:function(){return this[w].read(t)},set:function(e){this[w].write(t,e)}})}(t)),this.notifyPropertyAddition(t,e)},t.prototype.addComputedProp=function(t,e,n){var i,r,o,a=this.target;n.name=n.name||this.name+\".\"+b(e),this.values.set(e,new kt(n)),(t===a||(i=t,r=e,!(o=Object.getOwnPropertyDescriptor(i,r))||!1!==o.configurable&&!1!==o.writable))&&Object.defineProperty(t,e,function(t){return On[t]||(On[t]={configurable:jt.computedConfigurable,enumerable:!1,get:function(){return kn(this).read(t)},set:function(e){kn(this).write(t,e)}})}(e))},t.prototype.remove=function(t){if(this.values.has(t)){var e=this.target;if(an(this))if(!(a=cn(this,{object:this.proxy||e,name:t,type:\"remove\"})))return;try{Gt();var n=ln(this),i=this.values.get(t),r=i&&i.get();if(i&&i.set(void 0),this.keysAtom.reportChanged(),this.values.delete(t),this.pendingKeys){var o=this.pendingKeys.get(t);o&&o.set(!1)}delete this.target[t];var a=n?{type:\"remove\",object:this.proxy||e,oldValue:r,name:t}:null;0,n&&un(this,a)}finally{Vt()}}},t.prototype.illegalAccess=function(t,e){console.warn(\"Property '\"+e+\"' of '\"+t+\"' was accessed through the prototype chain. Use 'decorate' instead to declare the prop or access it statically through it's owner\")},t.prototype.observe=function(t,e){return dn(this,t)},t.prototype.intercept=function(t){return sn(this,t)},t.prototype.notifyPropertyAddition=function(t,e){var n=ln(this),i=n?{type:\"add\",object:this.proxy||this.target,name:t,newValue:e}:null;if(n&&un(this,i),this.pendingKeys){var r=this.pendingKeys.get(t);r&&r.set(!0)}this.keysAtom.reportChanged()},t.prototype.getKeys=function(){var t,e;this.keysAtom.reportObserved();var n=[];try{for(var i=O(this.values),r=i.next();!r.done;r=i.next()){var o=k(r.value,2),a=o[0];o[1]instanceof At&&n.push(a)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return n},t}();function Cn(t,e,n){if(void 0===e&&(e=\"\"),void 0===n&&(n=z),Object.prototype.hasOwnProperty.call(t,w))return t[w];h(t)||(e=(t.constructor.name||\"ObservableObject\")+\"@\"+a()),e||(e=\"ObservableObject@\"+a());var i=new Tn(t,new Map,b(e),n);return p(t,w,i),i}var An=Object.create(null),On=Object.create(null);function kn(t){var e=t[w];return e||(F(t),t[w])}var Ln=f(\"ObservableObjectAdministration\",Tn);function In(t){return!!u(t)&&(F(t),Ln(t[w]))}function Rn(t,e){if(\"object\"==typeof t&&null!==t){if(yn(t))return void 0!==e&&s(!1),t[w].atom;if(En(t))return t[w];if(wn(t)){var n=t;return void 0===e?n._keysAtom:((i=n._data.get(e)||n._hasMap.get(e))||s(!1),i)}var i;if(F(t),e&&!t[w]&&t[e],In(t))return e?((i=t[w].values.get(e))||s(!1),i):s(!1);if(M(t)||Lt(t)||Qt(t))return t}else if(\"function\"==typeof t&&Qt(t[w]))return t[w];return s(!1)}function Pn(t,e){return t||s(\"Expecting some object\"),void 0!==e?Pn(Rn(t,e)):M(t)||Lt(t)||Qt(t)||wn(t)||En(t)?t:(F(t),t[w]?t[w]:void s(!1))}function Dn(t,e){return(void 0!==e?Rn(t,e):In(t)||wn(t)||En(t)?Pn(t):Rn(t)).name}var Nn=Object.prototype.toString;function Fn(t,e,n){return void 0===n&&(n=-1),function t(e,n,i,r,o){if(e===n)return 0!==e||1/e==1/n;if(null==e||null==n)return!1;if(e!=e)return n!=n;var a=typeof e;if(\"function\"!==a&&\"object\"!==a&&\"object\"!=typeof n)return!1;var s=Nn.call(e);if(s!==Nn.call(n))return!1;switch(s){case\"[object RegExp]\":case\"[object String]\":return\"\"+e==\"\"+n;case\"[object Number]\":return+e!=+e?+n!=+n:0==+e?1/+e==1/n:+e==+n;case\"[object Date]\":case\"[object Boolean]\":return+e==+n;case\"[object Symbol]\":return\"undefined\"!=typeof Symbol&&Symbol.valueOf.call(e)===Symbol.valueOf.call(n);case\"[object Map]\":case\"[object Set]\":i>=0&&i++}e=jn(e),n=jn(n);var c=\"[object Array]\"===s;if(!c){if(\"object\"!=typeof e||\"object\"!=typeof n)return!1;var l=e.constructor,d=n.constructor;if(l!==d&&!(\"function\"==typeof l&&l instanceof l&&\"function\"==typeof d&&d instanceof d)&&\"constructor\"in e&&\"constructor\"in n)return!1}if(0===i)return!1;i<0&&(i=-1);o=o||[];var u=(r=r||[]).length;for(;u--;)if(r[u]===e)return o[u]===n;if(r.push(e),o.push(n),c){if((u=e.length)!==n.length)return!1;for(;u--;)if(!t(e[u],n[u],i-1,r,o))return!1}else{var h=Object.keys(e),p=void 0;if(u=h.length,Object.keys(n).length!==u)return!1;for(;u--;)if(p=h[u],!Bn(n,p)||!t(e[p],n[p],i-1,r,o))return!1}return r.pop(),o.pop(),!0}(t,e,n)}function jn(t){return yn(t)?t.slice():g(t)||wn(t)||v(t)||En(t)?Array.from(t.entries()):t}function Bn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function zn(t){return t[Symbol.iterator]=Un,t}function Un(){return this}if(\"undefined\"==typeof Proxy||\"undefined\"==typeof Symbol)throw new Error(\"[mobx] MobX 5+ requires Proxy and Symbol objects. If your environment doesn't support Symbol or Proxy objects, please downgrade to MobX 4. For React Native Android, consider upgrading JSCore.\");\"object\"==typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:ee,extras:{getDebugName:Dn},$mobx:w})}.call(this,n(68),n(69))},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.formatBoolean=e.formatForDisplay=e.SCROLL_SYNC_CSS_CLASS=e.datasetDisplayName=e.NONE_DS_DICT_KEY=e.NONE_DS_DISPLAY_NAME=e.canonicalizeLayout=e.defaultValueByField=e.formatEdgeLabel=e.formatSpanLabel=e.listFieldTypes=void 0,n(21),n(3);const i=n(8);function r(t){let e=`[${t.start}, ${t.end})`;return t.align&&(e=`${t.align} ${e}`),t.label&&(e=`${e}: ${t.label}`),e.replace(/\\ /g,\"\")}function o(t){const e=t=>`[${t[0]}, ${t[1]})`;return`${e(t.span1)}${t.span2?\"  \"+e(t.span2):\"\"}: ${t.label}`.replace(/\\ /g,\"\")}function a(t){return t?\"\":\" \"}e.listFieldTypes=[\"Tokens\",\"SequenceTags\",\"SpanLabels\",\"EdgeLabels\",\"SparseMultilabel\"],e.formatSpanLabel=r,e.formatEdgeLabel=o,e.defaultValueByField=function(t,n){const r=n[t];return void 0!==r.default?r.default:(0,i.isLitSubtype)(r,\"Scalar\")?0:(0,i.isLitSubtype)(r,e.listFieldTypes)?[]:((0,i.isLitSubtype)(r,\"ImageBytes\")||(0,i.isLitSubtype)(r,[\"TextSegment\",\"CategoryLabel\"])||console.log(\"Warning: default value requested for unrecognized input field type\",t,r),\"\")},e.canonicalizeLayout=function(t){var e,n;if(!t.hasOwnProperty(\"components\"))return t;const i={upper:{},lower:{},layoutSettings:null!==(e=(t=t).layoutSettings)&&void 0!==e?e:{},description:null!==(n=t.description)&&void 0!==n?n:\"\"};i.upper.Main=t.components.Main;for(const e of Object.keys(t.components))\"Main\"!==e&&(i.lower[e]=t.components[e]);return i},e.NONE_DS_DISPLAY_NAME=\"none\",e.NONE_DS_DICT_KEY=\"_union_empty\",e.datasetDisplayName=function(t){return t===e.NONE_DS_DICT_KEY?e.NONE_DS_DISPLAY_NAME:t},e.SCROLL_SYNC_CSS_CLASS=\"scroll-sync\",e.formatForDisplay=function(t,e,n){if(null==t)return\"\";if(null!=e&&(0,i.isLitSubtype)(e,\"SpanLabels\")){return t.map(r).join(\", \")}if(null!=e&&(0,i.isLitSubtype)(e,\"EdgeLabels\")){return t.map(o).join(\", \")}const s=t=>Number.isInteger(t)?t.toString():t.toFixed(4).toString();if(Array.isArray(t)){return\"\"+t.map(t=>\"number\"==typeof t?s(t):n?(0,i.chunkWords)(t):\"\"+t).join(\", \")}return\"boolean\"==typeof t?a(t):\"number\"==typeof t?s(t):n?(0,i.chunkWords)(t):\"\"+t},e.formatBoolean=a},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"ACESFilmicToneMapping\",(function(){return nt})),n.d(e,\"AddEquation\",(function(){return E})),n.d(e,\"AddOperation\",(function(){return Z})),n.d(e,\"AdditiveAnimationBlendMode\",(function(){return We})),n.d(e,\"AdditiveBlending\",(function(){return x})),n.d(e,\"AlphaFormat\",(function(){return Nt})),n.d(e,\"AlwaysDepth\",(function(){return H})),n.d(e,\"AlwaysStencilFunc\",(function(){return Mn})),n.d(e,\"AmbientLight\",(function(){return au})),n.d(e,\"AmbientLightProbe\",(function(){return Au})),n.d(e,\"AnimationClip\",(function(){return pd})),n.d(e,\"AnimationLoader\",(function(){return xd})),n.d(e,\"AnimationMixer\",(function(){return oh})),n.d(e,\"AnimationObjectGroup\",(function(){return ih})),n.d(e,\"AnimationUtils\",(function(){return td})),n.d(e,\"ArcCurve\",(function(){return Od})),n.d(e,\"ArrayCamera\",(function(){return As})),n.d(e,\"ArrowHelper\",(function(){return Xh})),n.d(e,\"Audio\",(function(){return Bu})),n.d(e,\"AudioAnalyser\",(function(){return Vu})),n.d(e,\"AudioContext\",(function(){return Eu})),n.d(e,\"AudioListener\",(function(){return ju})),n.d(e,\"AudioLoader\",(function(){return Tu})),n.d(e,\"AxesHelper\",(function(){return Yh})),n.d(e,\"AxisHelper\",(function(){return Jp})),n.d(e,\"BackSide\",(function(){return m})),n.d(e,\"BasicDepthPacking\",(function(){return on})),n.d(e,\"BasicShadowMap\",(function(){return d})),n.d(e,\"BinaryTextureLoader\",(function(){return rf})),n.d(e,\"Bone\",(function(){return hc})),n.d(e,\"BooleanKeyframeTrack\",(function(){return ad})),n.d(e,\"BoundingBoxHelper\",(function(){return Qp})),n.d(e,\"Box2\",(function(){return mh})),n.d(e,\"Box3\",(function(){return ti})),n.d(e,\"Box3Helper\",(function(){return $h})),n.d(e,\"BoxBufferGeometry\",(function(){return po})),n.d(e,\"BoxGeometry\",(function(){return po})),n.d(e,\"BoxHelper\",(function(){return Hh})),n.d(e,\"BufferAttribute\",(function(){return Er})),n.d(e,\"BufferGeometry\",(function(){return Wr})),n.d(e,\"BufferGeometryLoader\",(function(){return fu})),n.d(e,\"ByteType\",(function(){return Et})),n.d(e,\"Cache\",(function(){return md})),n.d(e,\"Camera\",(function(){return yo})),n.d(e,\"CameraHelper\",(function(){return Bh})),n.d(e,\"CanvasRenderer\",(function(){return sf})),n.d(e,\"CanvasTexture\",(function(){return Uc})),n.d(e,\"CatmullRomCurve3\",(function(){return Dd})),n.d(e,\"CineonToneMapping\",(function(){return et})),n.d(e,\"CircleBufferGeometry\",(function(){return $c})),n.d(e,\"CircleGeometry\",(function(){return $c})),n.d(e,\"ClampToEdgeWrapping\",(function(){return ht})),n.d(e,\"Clock\",(function(){return Iu})),n.d(e,\"ClosedSplineCurve3\",(function(){return Yp})),n.d(e,\"Color\",(function(){return yr})),n.d(e,\"ColorKeyframeTrack\",(function(){return sd})),n.d(e,\"CompressedTexture\",(function(){return zc})),n.d(e,\"CompressedTextureLoader\",(function(){return wd})),n.d(e,\"ConeBufferGeometry\",(function(){return Vc})),n.d(e,\"ConeGeometry\",(function(){return Vc})),n.d(e,\"CubeCamera\",(function(){return _o})),n.d(e,\"CubeReflectionMapping\",(function(){return ot})),n.d(e,\"CubeRefractionMapping\",(function(){return at})),n.d(e,\"CubeTexture\",(function(){return xo})),n.d(e,\"CubeTextureLoader\",(function(){return Md})),n.d(e,\"CubeUVReflectionMapping\",(function(){return lt})),n.d(e,\"CubeUVRefractionMapping\",(function(){return dt})),n.d(e,\"CubicBezierCurve\",(function(){return Bd})),n.d(e,\"CubicBezierCurve3\",(function(){return zd})),n.d(e,\"CubicInterpolant\",(function(){return nd})),n.d(e,\"CullFaceBack\",(function(){return s})),n.d(e,\"CullFaceFront\",(function(){return c})),n.d(e,\"CullFaceFrontBack\",(function(){return l})),n.d(e,\"CullFaceNone\",(function(){return a})),n.d(e,\"Curve\",(function(){return Cd})),n.d(e,\"CurvePath\",(function(){return qd})),n.d(e,\"CustomBlending\",(function(){return M})),n.d(e,\"CustomToneMapping\",(function(){return it})),n.d(e,\"CylinderBufferGeometry\",(function(){return Gc})),n.d(e,\"CylinderGeometry\",(function(){return Gc})),n.d(e,\"Cylindrical\",(function(){return ph})),n.d(e,\"DataTexture\",(function(){return So})),n.d(e,\"DataTexture2DArray\",(function(){return qo})),n.d(e,\"DataTexture3D\",(function(){return Xo})),n.d(e,\"DataTextureLoader\",(function(){return Ed})),n.d(e,\"DataUtils\",(function(){return Jh})),n.d(e,\"DecrementStencilOp\",(function(){return pn})),n.d(e,\"DecrementWrapStencilOp\",(function(){return mn})),n.d(e,\"DefaultLoadingManager\",(function(){return vd})),n.d(e,\"DepthFormat\",(function(){return Ht})),n.d(e,\"DepthStencilFormat\",(function(){return $t})),n.d(e,\"DepthTexture\",(function(){return Hc})),n.d(e,\"DirectionalLight\",(function(){return ou})),n.d(e,\"DirectionalLightHelper\",(function(){return Nh})),n.d(e,\"DiscreteInterpolant\",(function(){return rd})),n.d(e,\"DodecahedronBufferGeometry\",(function(){return qc})),n.d(e,\"DodecahedronGeometry\",(function(){return qc})),n.d(e,\"DoubleSide\",(function(){return g})),n.d(e,\"DstAlphaFactor\",(function(){return N})),n.d(e,\"DstColorFactor\",(function(){return j})),n.d(e,\"DynamicBufferAttribute\",(function(){return Bp})),n.d(e,\"DynamicCopyUsage\",(function(){return In})),n.d(e,\"DynamicDrawUsage\",(function(){return Tn})),n.d(e,\"DynamicReadUsage\",(function(){return On})),n.d(e,\"EdgesGeometry\",(function(){return Jc})),n.d(e,\"EdgesHelper\",(function(){return tf})),n.d(e,\"EllipseCurve\",(function(){return Ad})),n.d(e,\"EqualDepth\",(function(){return V})),n.d(e,\"EqualStencilFunc\",(function(){return bn})),n.d(e,\"EquirectangularReflectionMapping\",(function(){return st})),n.d(e,\"EquirectangularRefractionMapping\",(function(){return ct})),n.d(e,\"Euler\",(function(){return Ri})),n.d(e,\"EventDispatcher\",(function(){return Nn})),n.d(e,\"ExtrudeBufferGeometry\",(function(){return Cl})),n.d(e,\"ExtrudeGeometry\",(function(){return Cl})),n.d(e,\"Face3\",(function(){return br})),n.d(e,\"Face4\",(function(){return Mp})),n.d(e,\"FaceColors\",(function(){return Ap})),n.d(e,\"FileLoader\",(function(){return _d})),n.d(e,\"FlatShading\",(function(){return v})),n.d(e,\"Float16BufferAttribute\",(function(){return Rr})),n.d(e,\"Float32Attribute\",(function(){return qp})),n.d(e,\"Float32BufferAttribute\",(function(){return Pr})),n.d(e,\"Float64Attribute\",(function(){return Xp})),n.d(e,\"Float64BufferAttribute\",(function(){return Dr})),n.d(e,\"FloatType\",(function(){return kt})),n.d(e,\"Fog\",(function(){return Ns})),n.d(e,\"FogExp2\",(function(){return Ds})),n.d(e,\"Font\",(function(){return xu})),n.d(e,\"FontLoader\",(function(){return Su})),n.d(e,\"FrontSide\",(function(){return f})),n.d(e,\"Frustum\",(function(){return To})),n.d(e,\"GLBufferAttribute\",(function(){return ch})),n.d(e,\"GLSL1\",(function(){return Pn})),n.d(e,\"GLSL3\",(function(){return Dn})),n.d(e,\"GammaEncoding\",(function(){return Je})),n.d(e,\"GeometryUtils\",(function(){return af})),n.d(e,\"GreaterDepth\",(function(){return q})),n.d(e,\"GreaterEqualDepth\",(function(){return W})),n.d(e,\"GreaterEqualStencilFunc\",(function(){return Sn})),n.d(e,\"GreaterStencilFunc\",(function(){return xn})),n.d(e,\"GridHelper\",(function(){return Lh})),n.d(e,\"Group\",(function(){return Os})),n.d(e,\"HalfFloatType\",(function(){return Lt})),n.d(e,\"HemisphereLight\",(function(){return Zd})),n.d(e,\"HemisphereLightHelper\",(function(){return kh})),n.d(e,\"HemisphereLightProbe\",(function(){return Cu})),n.d(e,\"IcosahedronBufferGeometry\",(function(){return Ol})),n.d(e,\"IcosahedronGeometry\",(function(){return Ol})),n.d(e,\"ImageBitmapLoader\",(function(){return bu})),n.d(e,\"ImageLoader\",(function(){return Sd})),n.d(e,\"ImageUtils\",(function(){return $n})),n.d(e,\"ImmediateRenderObject\",(function(){return bh})),n.d(e,\"IncrementStencilOp\",(function(){return hn})),n.d(e,\"IncrementWrapStencilOp\",(function(){return fn})),n.d(e,\"InstancedBufferAttribute\",(function(){return pu})),n.d(e,\"InstancedBufferGeometry\",(function(){return hu})),n.d(e,\"InstancedInterleavedBuffer\",(function(){return sh})),n.d(e,\"InstancedMesh\",(function(){return _c})),n.d(e,\"Int16Attribute\",(function(){return $p})),n.d(e,\"Int16BufferAttribute\",(function(){return Or})),n.d(e,\"Int32Attribute\",(function(){return Vp})),n.d(e,\"Int32BufferAttribute\",(function(){return Lr})),n.d(e,\"Int8Attribute\",(function(){return zp})),n.d(e,\"Int8BufferAttribute\",(function(){return Tr})),n.d(e,\"IntType\",(function(){return At})),n.d(e,\"InterleavedBuffer\",(function(){return js})),n.d(e,\"InterleavedBufferAttribute\",(function(){return zs})),n.d(e,\"Interpolant\",(function(){return ed})),n.d(e,\"InterpolateDiscrete\",(function(){return Be})),n.d(e,\"InterpolateLinear\",(function(){return ze})),n.d(e,\"InterpolateSmooth\",(function(){return Ue})),n.d(e,\"InvertStencilOp\",(function(){return gn})),n.d(e,\"JSONLoader\",(function(){return cf})),n.d(e,\"KeepStencilOp\",(function(){return dn})),n.d(e,\"KeyframeTrack\",(function(){return od})),n.d(e,\"LOD\",(function(){return oc})),n.d(e,\"LatheBufferGeometry\",(function(){return kl})),n.d(e,\"LatheGeometry\",(function(){return kl})),n.d(e,\"Layers\",(function(){return Ni})),n.d(e,\"LensFlare\",(function(){return df})),n.d(e,\"LessDepth\",(function(){return $})),n.d(e,\"LessEqualDepth\",(function(){return G})),n.d(e,\"LessEqualStencilFunc\",(function(){return _n})),n.d(e,\"LessStencilFunc\",(function(){return yn})),n.d(e,\"Light\",(function(){return Kd})),n.d(e,\"LightProbe\",(function(){return lu})),n.d(e,\"Line\",(function(){return Cc})),n.d(e,\"Line3\",(function(){return yh})),n.d(e,\"LineBasicMaterial\",(function(){return xc})),n.d(e,\"LineCurve\",(function(){return Ud})),n.d(e,\"LineCurve3\",(function(){return Hd})),n.d(e,\"LineDashedMaterial\",(function(){return Jl})),n.d(e,\"LineLoop\",(function(){return Lc})),n.d(e,\"LinePieces\",(function(){return Tp})),n.d(e,\"LineSegments\",(function(){return kc})),n.d(e,\"LineStrip\",(function(){return Ep})),n.d(e,\"LinearEncoding\",(function(){return Ke})),n.d(e,\"LinearFilter\",(function(){return bt})),n.d(e,\"LinearInterpolant\",(function(){return id})),n.d(e,\"LinearMipMapLinearFilter\",(function(){return St})),n.d(e,\"LinearMipMapNearestFilter\",(function(){return xt})),n.d(e,\"LinearMipmapLinearFilter\",(function(){return wt})),n.d(e,\"LinearMipmapNearestFilter\",(function(){return _t})),n.d(e,\"LinearToneMapping\",(function(){return Q})),n.d(e,\"Loader\",(function(){return yd})),n.d(e,\"LoaderUtils\",(function(){return uu})),n.d(e,\"LoadingManager\",(function(){return gd})),n.d(e,\"LogLuvEncoding\",(function(){return tn})),n.d(e,\"LoopOnce\",(function(){return Ne})),n.d(e,\"LoopPingPong\",(function(){return je})),n.d(e,\"LoopRepeat\",(function(){return Fe})),n.d(e,\"LuminanceAlphaFormat\",(function(){return zt})),n.d(e,\"LuminanceFormat\",(function(){return Bt})),n.d(e,\"MOUSE\",(function(){return r})),n.d(e,\"Material\",(function(){return xr})),n.d(e,\"MaterialLoader\",(function(){return du})),n.d(e,\"Math\",(function(){return Bn})),n.d(e,\"MathUtils\",(function(){return Bn})),n.d(e,\"Matrix3\",(function(){return Un})),n.d(e,\"Matrix4\",(function(){return Ei})),n.d(e,\"MaxEquation\",(function(){return O})),n.d(e,\"Mesh\",(function(){return uo})),n.d(e,\"MeshBasicMaterial\",(function(){return wr})),n.d(e,\"MeshDepthMaterial\",(function(){return ws})),n.d(e,\"MeshDistanceMaterial\",(function(){return Ss})),n.d(e,\"MeshFaceMaterial\",(function(){return kp})),n.d(e,\"MeshLambertMaterial\",(function(){return Kl})),n.d(e,\"MeshMatcapMaterial\",(function(){return Zl})),n.d(e,\"MeshNormalMaterial\",(function(){return Yl})),n.d(e,\"MeshPhongMaterial\",(function(){return ql})),n.d(e,\"MeshPhysicalMaterial\",(function(){return Wl})),n.d(e,\"MeshStandardMaterial\",(function(){return Vl})),n.d(e,\"MeshToonMaterial\",(function(){return Xl})),n.d(e,\"MinEquation\",(function(){return A})),n.d(e,\"MirroredRepeatWrapping\",(function(){return pt})),n.d(e,\"MixOperation\",(function(){return K})),n.d(e,\"MultiMaterial\",(function(){return Lp})),n.d(e,\"MultiplyBlending\",(function(){return S})),n.d(e,\"MultiplyOperation\",(function(){return Y})),n.d(e,\"NearestFilter\",(function(){return ft})),n.d(e,\"NearestMipMapLinearFilter\",(function(){return yt})),n.d(e,\"NearestMipMapNearestFilter\",(function(){return gt})),n.d(e,\"NearestMipmapLinearFilter\",(function(){return vt})),n.d(e,\"NearestMipmapNearestFilter\",(function(){return mt})),n.d(e,\"NeverDepth\",(function(){return U})),n.d(e,\"NeverStencilFunc\",(function(){return vn})),n.d(e,\"NoBlending\",(function(){return b})),n.d(e,\"NoColors\",(function(){return Cp})),n.d(e,\"NoToneMapping\",(function(){return J})),n.d(e,\"NormalAnimationBlendMode\",(function(){return Ve})),n.d(e,\"NormalBlending\",(function(){return _})),n.d(e,\"NotEqualDepth\",(function(){return X})),n.d(e,\"NotEqualStencilFunc\",(function(){return wn})),n.d(e,\"NumberKeyframeTrack\",(function(){return cd})),n.d(e,\"Object3D\",(function(){return Ki})),n.d(e,\"ObjectLoader\",(function(){return mu})),n.d(e,\"ObjectSpaceNormalMap\",(function(){return cn})),n.d(e,\"OctahedronBufferGeometry\",(function(){return Ll})),n.d(e,\"OctahedronGeometry\",(function(){return Ll})),n.d(e,\"OneFactor\",(function(){return L})),n.d(e,\"OneMinusDstAlphaFactor\",(function(){return F})),n.d(e,\"OneMinusDstColorFactor\",(function(){return B})),n.d(e,\"OneMinusSrcAlphaFactor\",(function(){return D})),n.d(e,\"OneMinusSrcColorFactor\",(function(){return R})),n.d(e,\"OrthographicCamera\",(function(){return iu})),n.d(e,\"PCFShadowMap\",(function(){return u})),n.d(e,\"PCFSoftShadowMap\",(function(){return h})),n.d(e,\"PMREMGenerator\",(function(){return mp})),n.d(e,\"ParametricBufferGeometry\",(function(){return Il})),n.d(e,\"ParametricGeometry\",(function(){return Il})),n.d(e,\"Particle\",(function(){return Rp})),n.d(e,\"ParticleBasicMaterial\",(function(){return Np})),n.d(e,\"ParticleSystem\",(function(){return Pp})),n.d(e,\"ParticleSystemMaterial\",(function(){return Fp})),n.d(e,\"Path\",(function(){return Xd})),n.d(e,\"PerspectiveCamera\",(function(){return bo})),n.d(e,\"Plane\",(function(){return tr})),n.d(e,\"PlaneBufferGeometry\",(function(){return Oo})),n.d(e,\"PlaneGeometry\",(function(){return Oo})),n.d(e,\"PlaneHelper\",(function(){return Gh})),n.d(e,\"PointCloud\",(function(){return Ip})),n.d(e,\"PointCloudMaterial\",(function(){return Dp})),n.d(e,\"PointLight\",(function(){return nu})),n.d(e,\"PointLightHelper\",(function(){return Th})),n.d(e,\"Points\",(function(){return Fc})),n.d(e,\"PointsMaterial\",(function(){return Ic})),n.d(e,\"PolarGridHelper\",(function(){return Ih})),n.d(e,\"PolyhedronBufferGeometry\",(function(){return Wc})),n.d(e,\"PolyhedronGeometry\",(function(){return Wc})),n.d(e,\"PositionalAudio\",(function(){return Gu})),n.d(e,\"PropertyBinding\",(function(){return nh})),n.d(e,\"PropertyMixer\",(function(){return Wu})),n.d(e,\"QuadraticBezierCurve\",(function(){return $d})),n.d(e,\"QuadraticBezierCurve3\",(function(){return Gd})),n.d(e,\"Quaternion\",(function(){return Kn})),n.d(e,\"QuaternionKeyframeTrack\",(function(){return dd})),n.d(e,\"QuaternionLinearInterpolant\",(function(){return ld})),n.d(e,\"REVISION\",(function(){return i})),n.d(e,\"RGBADepthPacking\",(function(){return an})),n.d(e,\"RGBAFormat\",(function(){return jt})),n.d(e,\"RGBAIntegerFormat\",(function(){return Yt})),n.d(e,\"RGBA_ASTC_10x10_Format\",(function(){return ye})),n.d(e,\"RGBA_ASTC_10x5_Format\",(function(){return me})),n.d(e,\"RGBA_ASTC_10x6_Format\",(function(){return ge})),n.d(e,\"RGBA_ASTC_10x8_Format\",(function(){return ve})),n.d(e,\"RGBA_ASTC_12x10_Format\",(function(){return be})),n.d(e,\"RGBA_ASTC_12x12_Format\",(function(){return _e})),n.d(e,\"RGBA_ASTC_4x4_Format\",(function(){return se})),n.d(e,\"RGBA_ASTC_5x4_Format\",(function(){return ce})),n.d(e,\"RGBA_ASTC_5x5_Format\",(function(){return le})),n.d(e,\"RGBA_ASTC_6x5_Format\",(function(){return de})),n.d(e,\"RGBA_ASTC_6x6_Format\",(function(){return ue})),n.d(e,\"RGBA_ASTC_8x5_Format\",(function(){return he})),n.d(e,\"RGBA_ASTC_8x6_Format\",(function(){return pe})),n.d(e,\"RGBA_ASTC_8x8_Format\",(function(){return fe})),n.d(e,\"RGBA_BPTC_Format\",(function(){return xe})),n.d(e,\"RGBA_ETC2_EAC_Format\",(function(){return ae})),n.d(e,\"RGBA_PVRTC_2BPPV1_Format\",(function(){return ie})),n.d(e,\"RGBA_PVRTC_4BPPV1_Format\",(function(){return ne})),n.d(e,\"RGBA_S3TC_DXT1_Format\",(function(){return Zt})),n.d(e,\"RGBA_S3TC_DXT3_Format\",(function(){return Jt})),n.d(e,\"RGBA_S3TC_DXT5_Format\",(function(){return Qt})),n.d(e,\"RGBDEncoding\",(function(){return rn})),n.d(e,\"RGBEEncoding\",(function(){return Qe})),n.d(e,\"RGBEFormat\",(function(){return Ut})),n.d(e,\"RGBFormat\",(function(){return Ft})),n.d(e,\"RGBIntegerFormat\",(function(){return Xt})),n.d(e,\"RGBM16Encoding\",(function(){return nn})),n.d(e,\"RGBM7Encoding\",(function(){return en})),n.d(e,\"RGB_ETC1_Format\",(function(){return re})),n.d(e,\"RGB_ETC2_Format\",(function(){return oe})),n.d(e,\"RGB_PVRTC_2BPPV1_Format\",(function(){return ee})),n.d(e,\"RGB_PVRTC_4BPPV1_Format\",(function(){return te})),n.d(e,\"RGB_S3TC_DXT1_Format\",(function(){return Kt})),n.d(e,\"RGFormat\",(function(){return Wt})),n.d(e,\"RGIntegerFormat\",(function(){return qt})),n.d(e,\"RawShaderMaterial\",(function(){return Gl})),n.d(e,\"Ray\",(function(){return Mi})),n.d(e,\"Raycaster\",(function(){return lh})),n.d(e,\"RectAreaLight\",(function(){return su})),n.d(e,\"RedFormat\",(function(){return Gt})),n.d(e,\"RedIntegerFormat\",(function(){return Vt})),n.d(e,\"ReinhardToneMapping\",(function(){return tt})),n.d(e,\"RepeatWrapping\",(function(){return ut})),n.d(e,\"ReplaceStencilOp\",(function(){return un})),n.d(e,\"ReverseSubtractEquation\",(function(){return C})),n.d(e,\"RingBufferGeometry\",(function(){return Rl})),n.d(e,\"RingGeometry\",(function(){return Rl})),n.d(e,\"SRGB8_ALPHA8_ASTC_10x10_Format\",(function(){return Re})),n.d(e,\"SRGB8_ALPHA8_ASTC_10x5_Format\",(function(){return ke})),n.d(e,\"SRGB8_ALPHA8_ASTC_10x6_Format\",(function(){return Le})),n.d(e,\"SRGB8_ALPHA8_ASTC_10x8_Format\",(function(){return Ie})),n.d(e,\"SRGB8_ALPHA8_ASTC_12x10_Format\",(function(){return Pe})),n.d(e,\"SRGB8_ALPHA8_ASTC_12x12_Format\",(function(){return De})),n.d(e,\"SRGB8_ALPHA8_ASTC_4x4_Format\",(function(){return we})),n.d(e,\"SRGB8_ALPHA8_ASTC_5x4_Format\",(function(){return Se})),n.d(e,\"SRGB8_ALPHA8_ASTC_5x5_Format\",(function(){return Me})),n.d(e,\"SRGB8_ALPHA8_ASTC_6x5_Format\",(function(){return Ee})),n.d(e,\"SRGB8_ALPHA8_ASTC_6x6_Format\",(function(){return Te})),n.d(e,\"SRGB8_ALPHA8_ASTC_8x5_Format\",(function(){return Ce})),n.d(e,\"SRGB8_ALPHA8_ASTC_8x6_Format\",(function(){return Ae})),n.d(e,\"SRGB8_ALPHA8_ASTC_8x8_Format\",(function(){return Oe})),n.d(e,\"Scene\",(function(){return Fs})),n.d(e,\"SceneUtils\",(function(){return lf})),n.d(e,\"ShaderChunk\",(function(){return ko})),n.d(e,\"ShaderLib\",(function(){return Io})),n.d(e,\"ShaderMaterial\",(function(){return vo})),n.d(e,\"ShadowMaterial\",(function(){return $l})),n.d(e,\"Shape\",(function(){return Yd})),n.d(e,\"ShapeBufferGeometry\",(function(){return Pl})),n.d(e,\"ShapeGeometry\",(function(){return Pl})),n.d(e,\"ShapePath\",(function(){return _u})),n.d(e,\"ShapeUtils\",(function(){return Ml})),n.d(e,\"ShortType\",(function(){return Tt})),n.d(e,\"Skeleton\",(function(){return mc})),n.d(e,\"SkeletonHelper\",(function(){return Eh})),n.d(e,\"SkinnedMesh\",(function(){return uc})),n.d(e,\"SmoothShading\",(function(){return y})),n.d(e,\"Sphere\",(function(){return gi})),n.d(e,\"SphereBufferGeometry\",(function(){return Dl})),n.d(e,\"SphereGeometry\",(function(){return Dl})),n.d(e,\"Spherical\",(function(){return hh})),n.d(e,\"SphericalHarmonics3\",(function(){return cu})),n.d(e,\"Spline\",(function(){return Zp})),n.d(e,\"SplineCurve\",(function(){return Vd})),n.d(e,\"SplineCurve3\",(function(){return Kp})),n.d(e,\"SpotLight\",(function(){return tu})),n.d(e,\"SpotLightHelper\",(function(){return xh})),n.d(e,\"Sprite\",(function(){return ec})),n.d(e,\"SpriteMaterial\",(function(){return Us})),n.d(e,\"SrcAlphaFactor\",(function(){return P})),n.d(e,\"SrcAlphaSaturateFactor\",(function(){return z})),n.d(e,\"SrcColorFactor\",(function(){return I})),n.d(e,\"StaticCopyUsage\",(function(){return Ln})),n.d(e,\"StaticDrawUsage\",(function(){return En})),n.d(e,\"StaticReadUsage\",(function(){return An})),n.d(e,\"StereoCamera\",(function(){return Lu})),n.d(e,\"StreamCopyUsage\",(function(){return Rn})),n.d(e,\"StreamDrawUsage\",(function(){return Cn})),n.d(e,\"StreamReadUsage\",(function(){return kn})),n.d(e,\"StringKeyframeTrack\",(function(){return ud})),n.d(e,\"SubtractEquation\",(function(){return T})),n.d(e,\"SubtractiveBlending\",(function(){return w})),n.d(e,\"TOUCH\",(function(){return o})),n.d(e,\"TangentSpaceNormalMap\",(function(){return sn})),n.d(e,\"TetrahedronBufferGeometry\",(function(){return Nl})),n.d(e,\"TetrahedronGeometry\",(function(){return Nl})),n.d(e,\"TextBufferGeometry\",(function(){return Fl})),n.d(e,\"TextGeometry\",(function(){return Fl})),n.d(e,\"Texture\",(function(){return Vn})),n.d(e,\"TextureLoader\",(function(){return Td})),n.d(e,\"TorusBufferGeometry\",(function(){return jl})),n.d(e,\"TorusGeometry\",(function(){return jl})),n.d(e,\"TorusKnotBufferGeometry\",(function(){return Bl})),n.d(e,\"TorusKnotGeometry\",(function(){return Bl})),n.d(e,\"Triangle\",(function(){return ur})),n.d(e,\"TriangleFanDrawMode\",(function(){return Ye})),n.d(e,\"TriangleStripDrawMode\",(function(){return Xe})),n.d(e,\"TrianglesDrawMode\",(function(){return qe})),n.d(e,\"TubeBufferGeometry\",(function(){return zl})),n.d(e,\"TubeGeometry\",(function(){return zl})),n.d(e,\"UVMapping\",(function(){return rt})),n.d(e,\"Uint16Attribute\",(function(){return Gp})),n.d(e,\"Uint16BufferAttribute\",(function(){return kr})),n.d(e,\"Uint32Attribute\",(function(){return Wp})),n.d(e,\"Uint32BufferAttribute\",(function(){return Ir})),n.d(e,\"Uint8Attribute\",(function(){return Up})),n.d(e,\"Uint8BufferAttribute\",(function(){return Cr})),n.d(e,\"Uint8ClampedAttribute\",(function(){return Hp})),n.d(e,\"Uint8ClampedBufferAttribute\",(function(){return Ar})),n.d(e,\"Uniform\",(function(){return ah})),n.d(e,\"UniformsLib\",(function(){return Lo})),n.d(e,\"UniformsUtils\",(function(){return go})),n.d(e,\"UnsignedByteType\",(function(){return Mt})),n.d(e,\"UnsignedInt248Type\",(function(){return Dt})),n.d(e,\"UnsignedIntType\",(function(){return Ot})),n.d(e,\"UnsignedShort4444Type\",(function(){return It})),n.d(e,\"UnsignedShort5551Type\",(function(){return Rt})),n.d(e,\"UnsignedShort565Type\",(function(){return Pt})),n.d(e,\"UnsignedShortType\",(function(){return Ct})),n.d(e,\"VSMShadowMap\",(function(){return p})),n.d(e,\"Vector2\",(function(){return zn})),n.d(e,\"Vector3\",(function(){return Zn})),n.d(e,\"Vector4\",(function(){return qn})),n.d(e,\"VectorKeyframeTrack\",(function(){return hd})),n.d(e,\"Vertex\",(function(){return jp})),n.d(e,\"VertexColors\",(function(){return Op})),n.d(e,\"VideoTexture\",(function(){return Bc})),n.d(e,\"WebGL1Renderer\",(function(){return Ps})),n.d(e,\"WebGLCubeRenderTarget\",(function(){return wo})),n.d(e,\"WebGLMultisampleRenderTarget\",(function(){return Yn})),n.d(e,\"WebGLRenderTarget\",(function(){return Xn})),n.d(e,\"WebGLRenderTargetCube\",(function(){return of})),n.d(e,\"WebGLRenderer\",(function(){return Rs})),n.d(e,\"WebGLUtils\",(function(){return Cs})),n.d(e,\"WireframeGeometry\",(function(){return Ul})),n.d(e,\"WireframeHelper\",(function(){return ef})),n.d(e,\"WrapAroundEnding\",(function(){return Ge})),n.d(e,\"XHRLoader\",(function(){return nf})),n.d(e,\"ZeroCurvatureEnding\",(function(){return He})),n.d(e,\"ZeroFactor\",(function(){return k})),n.d(e,\"ZeroSlopeEnding\",(function(){return $e})),n.d(e,\"ZeroStencilOp\",(function(){return ln})),n.d(e,\"sRGBEncoding\",(function(){return Ze}));const i=\"125\",r={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},o={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},a=0,s=1,c=2,l=3,d=0,u=1,h=2,p=3,f=0,m=1,g=2,v=1,y=2,b=0,_=1,x=2,w=3,S=4,M=5,E=100,T=101,C=102,A=103,O=104,k=200,L=201,I=202,R=203,P=204,D=205,N=206,F=207,j=208,B=209,z=210,U=0,H=1,$=2,G=3,V=4,W=5,q=6,X=7,Y=0,K=1,Z=2,J=0,Q=1,tt=2,et=3,nt=4,it=5,rt=300,ot=301,at=302,st=303,ct=304,lt=306,dt=307,ut=1e3,ht=1001,pt=1002,ft=1003,mt=1004,gt=1004,vt=1005,yt=1005,bt=1006,_t=1007,xt=1007,wt=1008,St=1008,Mt=1009,Et=1010,Tt=1011,Ct=1012,At=1013,Ot=1014,kt=1015,Lt=1016,It=1017,Rt=1018,Pt=1019,Dt=1020,Nt=1021,Ft=1022,jt=1023,Bt=1024,zt=1025,Ut=jt,Ht=1026,$t=1027,Gt=1028,Vt=1029,Wt=1030,qt=1031,Xt=1032,Yt=1033,Kt=33776,Zt=33777,Jt=33778,Qt=33779,te=35840,ee=35841,ne=35842,ie=35843,re=36196,oe=37492,ae=37496,se=37808,ce=37809,le=37810,de=37811,ue=37812,he=37813,pe=37814,fe=37815,me=37816,ge=37817,ve=37818,ye=37819,be=37820,_e=37821,xe=36492,we=37840,Se=37841,Me=37842,Ee=37843,Te=37844,Ce=37845,Ae=37846,Oe=37847,ke=37848,Le=37849,Ie=37850,Re=37851,Pe=37852,De=37853,Ne=2200,Fe=2201,je=2202,Be=2300,ze=2301,Ue=2302,He=2400,$e=2401,Ge=2402,Ve=2500,We=2501,qe=0,Xe=1,Ye=2,Ke=3e3,Ze=3001,Je=3007,Qe=3002,tn=3003,en=3004,nn=3005,rn=3006,on=3200,an=3201,sn=0,cn=1,ln=0,dn=7680,un=7681,hn=7682,pn=7683,fn=34055,mn=34056,gn=5386,vn=512,yn=513,bn=514,_n=515,xn=516,wn=517,Sn=518,Mn=519,En=35044,Tn=35048,Cn=35040,An=35045,On=35049,kn=35041,Ln=35046,In=35050,Rn=35042,Pn=\"100\",Dn=\"300 es\";function Nn(){}Object.assign(Nn.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0===this._listeners)return;const n=this._listeners[t];if(void 0!==n){const t=n.indexOf(e);-1!==t&&n.splice(t,1)}},dispatchEvent:function(t){if(void 0===this._listeners)return;const e=this._listeners[t.type];if(void 0!==e){t.target=this;const n=e.slice(0);for(let e=0,i=n.length;e<i;e++)n[e].call(this,t)}}});const Fn=[];for(let t=0;t<256;t++)Fn[t]=(t<16?\"0\":\"\")+t.toString(16);let jn=1234567;const Bn={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Fn[255&t]+Fn[t>>8&255]+Fn[t>>16&255]+Fn[t>>24&255]+\"-\"+Fn[255&e]+Fn[e>>8&255]+\"-\"+Fn[e>>16&15|64]+Fn[e>>24&255]+\"-\"+Fn[63&n|128]+Fn[n>>8&255]+\"-\"+Fn[n>>16&255]+Fn[n>>24&255]+Fn[255&i]+Fn[i>>8&255]+Fn[i>>16&255]+Fn[i>>24&255]).toUpperCase()},clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},damp:function(t,e,n,i){return Bn.lerp(t,e,1-Math.exp(-n*i))},pingpong:function(t,e=1){return e-Math.abs(Bn.euclideanModulo(t,2*e)-e)},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){return void 0!==t&&(jn=t%2147483647),jn=16807*jn%2147483647,(jn-1)/2147483646},degToRad:function(t){return t*Bn.DEG2RAD},radToDeg:function(t){return t*Bn.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,i,r){const o=Math.cos,a=Math.sin,s=o(n/2),c=a(n/2),l=o((e+i)/2),d=a((e+i)/2),u=o((e-i)/2),h=a((e-i)/2),p=o((i-e)/2),f=a((i-e)/2);switch(r){case\"XYX\":t.set(s*d,c*u,c*h,s*l);break;case\"YZY\":t.set(c*h,s*d,c*u,s*l);break;case\"ZXZ\":t.set(c*u,c*h,s*d,s*l);break;case\"XZX\":t.set(s*d,c*f,c*p,s*l);break;case\"YXY\":t.set(c*p,s*d,c*f,s*l);break;case\"ZYZ\":t.set(c*f,c*p,s*d,s*l);break;default:console.warn(\"THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: \"+r)}}};class zn{constructor(t=0,e=0){Object.defineProperty(this,\"isVector2\",{value:!0}),this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error(\"index is out of range: \"+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error(\"index is out of range: \"+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t,e){return void 0!==e?(console.warn(\"THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead.\"),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t,e){return void 0!==e?(console.warn(\"THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.\"),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6],this.y=i[1]*e+i[4]*n+i[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn(\"THREE.Vector2: offset has been removed from .fromBufferAttribute().\"),this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),i=Math.sin(e),r=this.x-t.x,o=this.y-t.y;return this.x=r*n-o*i+t.x,this.y=r*i+o*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}class Un{constructor(){Object.defineProperty(this,\"isMatrix3\",{value:!0}),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error(\"THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.\")}set(t,e,n,i,r,o,a,s,c){const l=this.elements;return l[0]=t,l[1]=i,l[2]=a,l[3]=e,l[4]=r,l[5]=s,l[6]=n,l[7]=o,l[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}clone(){return(new this.constructor).fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,i=e.elements,r=this.elements,o=n[0],a=n[3],s=n[6],c=n[1],l=n[4],d=n[7],u=n[2],h=n[5],p=n[8],f=i[0],m=i[3],g=i[6],v=i[1],y=i[4],b=i[7],_=i[2],x=i[5],w=i[8];return r[0]=o*f+a*v+s*_,r[3]=o*m+a*y+s*x,r[6]=o*g+a*b+s*w,r[1]=c*f+l*v+d*_,r[4]=c*m+l*y+d*x,r[7]=c*g+l*b+d*w,r[2]=u*f+h*v+p*_,r[5]=u*m+h*y+p*x,r[8]=u*g+h*b+p*w,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],a=t[5],s=t[6],c=t[7],l=t[8];return e*o*l-e*a*c-n*r*l+n*a*s+i*r*c-i*o*s}invert(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],a=t[5],s=t[6],c=t[7],l=t[8],d=l*o-a*c,u=a*s-l*r,h=c*r-o*s,p=e*d+n*u+i*h;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const f=1/p;return t[0]=d*f,t[1]=(i*c-l*n)*f,t[2]=(a*n-i*o)*f,t[3]=u*f,t[4]=(l*e-i*s)*f,t[5]=(i*r-a*e)*f,t[6]=h*f,t[7]=(n*s-c*e)*f,t[8]=(o*e-n*r)*f,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).copy(this).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,i,r,o,a){const s=Math.cos(r),c=Math.sin(r);return this.set(n*s,n*c,-n*(s*o+c*a)+o+t,-i*c,i*s,-i*(-c*o+s*a)+a+e,0,0,1),this}scale(t,e){const n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this}rotate(t){const e=Math.cos(t),n=Math.sin(t),i=this.elements,r=i[0],o=i[3],a=i[6],s=i[1],c=i[4],l=i[7];return i[0]=e*r+n*s,i[3]=e*o+n*c,i[6]=e*a+n*l,i[1]=-n*r+e*s,i[4]=-n*o+e*c,i[7]=-n*a+e*l,this}translate(t,e){const n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this}equals(t){const e=this.elements,n=t.elements;for(let t=0;t<9;t++)if(e[t]!==n[t])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}}let Hn;const $n={getDataURL:function(t){if(/^data:/i.test(t.src))return t.src;if(\"undefined\"==typeof HTMLCanvasElement)return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{void 0===Hn&&(Hn=document.createElementNS(\"http://www.w3.org/1999/xhtml\",\"canvas\")),Hn.width=t.width,Hn.height=t.height;const n=Hn.getContext(\"2d\");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=Hn}return e.width>2048||e.height>2048?e.toDataURL(\"image/jpeg\",.6):e.toDataURL(\"image/png\")}};let Gn=0;function Vn(t=Vn.DEFAULT_IMAGE,e=Vn.DEFAULT_MAPPING,n=ht,i=ht,r=bt,o=wt,a=jt,s=Mt,c=1,l=Ke){Object.defineProperty(this,\"id\",{value:Gn++}),this.uuid=Bn.generateUUID(),this.name=\"\",this.image=t,this.mipmaps=[],this.mapping=e,this.wrapS=n,this.wrapT=i,this.magFilter=r,this.minFilter=o,this.anisotropy=c,this.format=a,this.internalFormat=null,this.type=s,this.offset=new zn(0,0),this.repeat=new zn(1,1),this.center=new zn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Un,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=l,this.version=0,this.onUpdate=null}function Wn(t){return\"undefined\"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||\"undefined\"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||\"undefined\"!=typeof ImageBitmap&&t instanceof ImageBitmap?$n.getDataURL(t):t.data?{data:Array.prototype.slice.call(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn(\"THREE.Texture: Unable to serialize Texture.\"),{})}Vn.DEFAULT_IMAGE=void 0,Vn.DEFAULT_MAPPING=rt,Vn.prototype=Object.assign(Object.create(Nn.prototype),{constructor:Vn,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){const e=void 0===t||\"string\"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const n={metadata:{version:4.5,type:\"Texture\",generator:\"Texture.toJSON\"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const i=this.image;if(void 0===i.uuid&&(i.uuid=Bn.generateUUID()),!e&&void 0===t.images[i.uuid]){let e;if(Array.isArray(i)){e=[];for(let t=0,n=i.length;t<n;t++)i[t].isDataTexture?e.push(Wn(i[t].image)):e.push(Wn(i[t]))}else e=Wn(i);t.images[i.uuid]={uuid:i.uuid,url:e}}n.image=i.uuid}return e||(t.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:\"dispose\"})},transformUv:function(t){if(this.mapping!==rt)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case ut:t.x=t.x-Math.floor(t.x);break;case ht:t.x=t.x<0?0:1;break;case pt:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case ut:t.y=t.y-Math.floor(t.y);break;case ht:t.y=t.y<0?0:1;break;case pt:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(Vn.prototype,\"needsUpdate\",{set:function(t){!0===t&&this.version++}});class qn{constructor(t=0,e=0,n=0,i=1){Object.defineProperty(this,\"isVector4\",{value:!0}),this.x=t,this.y=e,this.z=n,this.w=i}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error(\"index is out of range: \"+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error(\"index is out of range: \"+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t,e){return void 0!==e?(console.warn(\"THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.\"),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t,e){return void 0!==e?(console.warn(\"THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.\"),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,n=this.y,i=this.z,r=this.w,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*i+o[12]*r,this.y=o[1]*e+o[5]*n+o[9]*i+o[13]*r,this.z=o[2]*e+o[6]*n+o[10]*i+o[14]*r,this.w=o[3]*e+o[7]*n+o[11]*i+o[15]*r,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,i,r;const o=t.elements,a=o[0],s=o[4],c=o[8],l=o[1],d=o[5],u=o[9],h=o[2],p=o[6],f=o[10];if(Math.abs(s-l)<.01&&Math.abs(c-h)<.01&&Math.abs(u-p)<.01){if(Math.abs(s+l)<.1&&Math.abs(c+h)<.1&&Math.abs(u+p)<.1&&Math.abs(a+d+f-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;const t=(a+1)/2,o=(d+1)/2,m=(f+1)/2,g=(s+l)/4,v=(c+h)/4,y=(u+p)/4;return t>o&&t>m?t<.01?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(t),i=g/n,r=v/n):o>m?o<.01?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(o),n=g/i,r=y/i):m<.01?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(m),n=v/r,i=y/r),this.set(n,i,r,e),this}let m=Math.sqrt((p-u)*(p-u)+(c-h)*(c-h)+(l-s)*(l-s));return Math.abs(m)<.001&&(m=1),this.x=(p-u)/m,this.y=(c-h)/m,this.z=(l-s)/m,this.w=Math.acos((a+d+f-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn(\"THREE.Vector4: offset has been removed from .fromBufferAttribute().\"),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}class Xn extends Nn{constructor(t,e,n){super(),Object.defineProperty(this,\"isWebGLRenderTarget\",{value:!0}),this.width=t,this.height=e,this.scissor=new qn(0,0,t,e),this.scissorTest=!1,this.viewport=new qn(0,0,t,e),n=n||{},this.texture=new Vn(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=t,this.texture.image.height=e,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:bt,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}setSize(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.texture.image.width=t,this.texture.image.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this}dispose(){this.dispatchEvent({type:\"dispose\"})}}class Yn extends Xn{constructor(t,e,n){super(t,e,n),Object.defineProperty(this,\"isWebGLMultisampleRenderTarget\",{value:!0}),this.samples=4}copy(t){return super.copy.call(this,t),this.samples=t.samples,this}}class Kn{constructor(t=0,e=0,n=0,i=1){Object.defineProperty(this,\"isQuaternion\",{value:!0}),this._x=t,this._y=e,this._z=n,this._w=i}static slerp(t,e,n,i){return n.copy(t).slerp(e,i)}static slerpFlat(t,e,n,i,r,o,a){let s=n[i+0],c=n[i+1],l=n[i+2],d=n[i+3];const u=r[o+0],h=r[o+1],p=r[o+2],f=r[o+3];if(d!==f||s!==u||c!==h||l!==p){let t=1-a;const e=s*u+c*h+l*p+d*f,n=e>=0?1:-1,i=1-e*e;if(i>Number.EPSILON){const r=Math.sqrt(i),o=Math.atan2(r,e*n);t=Math.sin(t*o)/r,a=Math.sin(a*o)/r}const r=a*n;if(s=s*t+u*r,c=c*t+h*r,l=l*t+p*r,d=d*t+f*r,t===1-a){const t=1/Math.sqrt(s*s+c*c+l*l+d*d);s*=t,c*=t,l*=t,d*=t}}t[e]=s,t[e+1]=c,t[e+2]=l,t[e+3]=d}static multiplyQuaternionsFlat(t,e,n,i,r,o){const a=n[i],s=n[i+1],c=n[i+2],l=n[i+3],d=r[o],u=r[o+1],h=r[o+2],p=r[o+3];return t[e]=a*p+l*d+s*h-c*u,t[e+1]=s*p+l*u+c*d-a*h,t[e+2]=c*p+l*h+a*u-s*d,t[e+3]=l*p-a*d-s*u-c*h,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){if(!t||!t.isEuler)throw new Error(\"THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.\");const n=t._x,i=t._y,r=t._z,o=t._order,a=Math.cos,s=Math.sin,c=a(n/2),l=a(i/2),d=a(r/2),u=s(n/2),h=s(i/2),p=s(r/2);switch(o){case\"XYZ\":this._x=u*l*d+c*h*p,this._y=c*h*d-u*l*p,this._z=c*l*p+u*h*d,this._w=c*l*d-u*h*p;break;case\"YXZ\":this._x=u*l*d+c*h*p,this._y=c*h*d-u*l*p,this._z=c*l*p-u*h*d,this._w=c*l*d+u*h*p;break;case\"ZXY\":this._x=u*l*d-c*h*p,this._y=c*h*d+u*l*p,this._z=c*l*p+u*h*d,this._w=c*l*d-u*h*p;break;case\"ZYX\":this._x=u*l*d-c*h*p,this._y=c*h*d+u*l*p,this._z=c*l*p-u*h*d,this._w=c*l*d+u*h*p;break;case\"YZX\":this._x=u*l*d+c*h*p,this._y=c*h*d+u*l*p,this._z=c*l*p-u*h*d,this._w=c*l*d-u*h*p;break;case\"XZY\":this._x=u*l*d-c*h*p,this._y=c*h*d-u*l*p,this._z=c*l*p+u*h*d,this._w=c*l*d+u*h*p;break;default:console.warn(\"THREE.Quaternion: .setFromEuler() encountered an unknown order: \"+o)}return!1!==e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,i=Math.sin(n);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],i=e[4],r=e[8],o=e[1],a=e[5],s=e[9],c=e[2],l=e[6],d=e[10],u=n+a+d;if(u>0){const t=.5/Math.sqrt(u+1);this._w=.25/t,this._x=(l-s)*t,this._y=(r-c)*t,this._z=(o-i)*t}else if(n>a&&n>d){const t=2*Math.sqrt(1+n-a-d);this._w=(l-s)/t,this._x=.25*t,this._y=(i+o)/t,this._z=(r+c)/t}else if(a>d){const t=2*Math.sqrt(1+a-n-d);this._w=(r-c)/t,this._x=(i+o)/t,this._y=.25*t,this._z=(s+l)/t}else{const t=2*Math.sqrt(1+d-n-a);this._w=(o-i)/t,this._x=(r+c)/t,this._y=(s+l)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(Bn.clamp(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(0===n)return this;const i=Math.min(1,e/n);return this.slerp(t,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,e){return void 0!==e?(console.warn(\"THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.\"),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,i=t._y,r=t._z,o=t._w,a=e._x,s=e._y,c=e._z,l=e._w;return this._x=n*l+o*a+i*c-r*s,this._y=i*l+o*s+r*a-n*c,this._z=r*l+o*c+n*s-i*a,this._w=o*l-n*a-i*s-r*c,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const n=this._x,i=this._y,r=this._z,o=this._w;let a=o*t._w+n*t._x+i*t._y+r*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=i,this._z=r,this;const s=1-a*a;if(s<=Number.EPSILON){const t=1-e;return this._w=t*o+e*this._w,this._x=t*n+e*this._x,this._y=t*i+e*this._y,this._z=t*r+e*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(s),l=Math.atan2(c,a),d=Math.sin((1-e)*l)/c,u=Math.sin(e*l)/c;return this._w=o*d+this._w*u,this._x=n*d+this._x*u,this._y=i*d+this._y*u,this._z=r*d+this._z*u,this._onChangeCallback(),this}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}class Zn{constructor(t=0,e=0,n=0){Object.defineProperty(this,\"isVector3\",{value:!0}),this.x=t,this.y=e,this.z=n}set(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error(\"index is out of range: \"+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error(\"index is out of range: \"+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,e){return void 0!==e?(console.warn(\"THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.\"),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t,e){return void 0!==e?(console.warn(\"THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.\"),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t,e){return void 0!==e?(console.warn(\"THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.\"),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return t&&t.isEuler||console.error(\"THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.\"),this.applyQuaternion(Qn.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(Qn.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6]*i,this.y=r[1]*e+r[4]*n+r[7]*i,this.z=r[2]*e+r[5]*n+r[8]*i,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,i=this.z,r=t.elements,o=1/(r[3]*e+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*e+r[4]*n+r[8]*i+r[12])*o,this.y=(r[1]*e+r[5]*n+r[9]*i+r[13])*o,this.z=(r[2]*e+r[6]*n+r[10]*i+r[14])*o,this}applyQuaternion(t){const e=this.x,n=this.y,i=this.z,r=t.x,o=t.y,a=t.z,s=t.w,c=s*e+o*i-a*n,l=s*n+a*e-r*i,d=s*i+r*n-o*e,u=-r*e-o*n-a*i;return this.x=c*s+u*-r+l*-a-d*-o,this.y=l*s+u*-o+d*-r-c*-a,this.z=d*s+u*-a+c*-o-l*-r,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[4]*n+r[8]*i,this.y=r[1]*e+r[5]*n+r[9]*i,this.z=r[2]*e+r[6]*n+r[10]*i,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t,e){return void 0!==e?(console.warn(\"THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.\"),this.crossVectors(t,e)):this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,i=t.y,r=t.z,o=e.x,a=e.y,s=e.z;return this.x=i*s-r*a,this.y=r*o-n*s,this.z=n*a-i*o,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return Jn.copy(this).projectOnVector(t),this.sub(Jn)}reflect(t){return this.sub(Jn.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(Bn.clamp(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return e*e+n*n+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const i=Math.sin(e)*t;return this.x=i*Math.sin(n),this.y=Math.cos(e)*t,this.z=i*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=i,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn(\"THREE.Vector3: offset has been removed from .fromBufferAttribute().\"),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}const Jn=new Zn,Qn=new Kn;class ti{constructor(t,e){Object.defineProperty(this,\"isBox3\",{value:!0}),this.min=void 0!==t?t:new Zn(1/0,1/0,1/0),this.max=void 0!==e?e:new Zn(-1/0,-1/0,-1/0)}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,n=1/0,i=1/0,r=-1/0,o=-1/0,a=-1/0;for(let s=0,c=t.length;s<c;s+=3){const c=t[s],l=t[s+1],d=t[s+2];c<e&&(e=c),l<n&&(n=l),d<i&&(i=d),c>r&&(r=c),l>o&&(o=l),d>a&&(a=d)}return this.min.set(e,n,i),this.max.set(r,o,a),this}setFromBufferAttribute(t){let e=1/0,n=1/0,i=1/0,r=-1/0,o=-1/0,a=-1/0;for(let s=0,c=t.count;s<c;s++){const c=t.getX(s),l=t.getY(s),d=t.getZ(s);c<e&&(e=c),l<n&&(n=l),d<i&&(i=d),c>r&&(r=c),l>o&&(o=l),d>a&&(a=d)}return this.min.set(e,n,i),this.max.set(r,o,a),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=ii.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t){return this.makeEmpty(),this.expandByObject(t)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return void 0===t&&(console.warn(\"THREE.Box3: .getCenter() target is now required\"),t=new Zn),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return void 0===t&&(console.warn(\"THREE.Box3: .getSize() target is now required\"),t=new Zn),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t){t.updateWorldMatrix(!1,!1);const e=t.geometry;void 0!==e&&(null===e.boundingBox&&e.computeBoundingBox(),ri.copy(e.boundingBox),ri.applyMatrix4(t.matrixWorld),this.union(ri));const n=t.children;for(let t=0,e=n.length;t<e;t++)this.expandByObject(n[t]);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return void 0===e&&(console.warn(\"THREE.Box3: .getParameter() target is now required\"),e=new Zn),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,ii),ii.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(ui),hi.subVectors(this.max,ui),oi.subVectors(t.a,ui),ai.subVectors(t.b,ui),si.subVectors(t.c,ui),ci.subVectors(ai,oi),li.subVectors(si,ai),di.subVectors(oi,si);let e=[0,-ci.z,ci.y,0,-li.z,li.y,0,-di.z,di.y,ci.z,0,-ci.x,li.z,0,-li.x,di.z,0,-di.x,-ci.y,ci.x,0,-li.y,li.x,0,-di.y,di.x,0];return!!ei(e,oi,ai,si,hi)&&(e=[1,0,0,0,1,0,0,0,1],!!ei(e,oi,ai,si,hi)&&(pi.crossVectors(ci,li),e=[pi.x,pi.y,pi.z],ei(e,oi,ai,si,hi)))}clampPoint(t,e){return void 0===e&&(console.warn(\"THREE.Box3: .clampPoint() target is now required\"),e=new Zn),e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return ii.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return void 0===t&&console.error(\"THREE.Box3: .getBoundingSphere() target is now required\"),this.getCenter(t.center),t.radius=.5*this.getSize(ii).length(),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(ni[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),ni[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),ni[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),ni[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),ni[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),ni[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),ni[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),ni[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(ni)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}function ei(t,e,n,i,r){for(let o=0,a=t.length-3;o<=a;o+=3){fi.fromArray(t,o);const a=r.x*Math.abs(fi.x)+r.y*Math.abs(fi.y)+r.z*Math.abs(fi.z),s=e.dot(fi),c=n.dot(fi),l=i.dot(fi);if(Math.max(-Math.max(s,c,l),Math.min(s,c,l))>a)return!1}return!0}const ni=[new Zn,new Zn,new Zn,new Zn,new Zn,new Zn,new Zn,new Zn],ii=new Zn,ri=new ti,oi=new Zn,ai=new Zn,si=new Zn,ci=new Zn,li=new Zn,di=new Zn,ui=new Zn,hi=new Zn,pi=new Zn,fi=new Zn,mi=new ti;class gi{constructor(t,e){this.center=void 0!==t?t:new Zn,this.radius=void 0!==e?e:-1}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;void 0!==e?n.copy(e):mi.setFromPoints(t).getCenter(n);let i=0;for(let e=0,r=t.length;e<r;e++)i=Math.max(i,n.distanceToSquared(t[e]));return this.radius=Math.sqrt(i),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return void 0===e&&(console.warn(\"THREE.Sphere: .clampPoint() target is now required\"),e=new Zn),e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return void 0===t&&(console.warn(\"THREE.Sphere: .getBoundingBox() target is now required\"),t=new ti),this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}}const vi=new Zn,yi=new Zn,bi=new Zn,_i=new Zn,xi=new Zn,wi=new Zn,Si=new Zn;class Mi{constructor(t,e){this.origin=void 0!==t?t:new Zn,this.direction=void 0!==e?e:new Zn(0,0,-1)}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return void 0===e&&(console.warn(\"THREE.Ray: .at() target is now required\"),e=new Zn),e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,vi)),this}closestPointToPoint(t,e){void 0===e&&(console.warn(\"THREE.Ray: .closestPointToPoint() target is now required\"),e=new Zn),e.subVectors(t,this.origin);const n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=vi.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(vi.copy(this.direction).multiplyScalar(e).add(this.origin),vi.distanceToSquared(t))}distanceSqToSegment(t,e,n,i){yi.copy(t).add(e).multiplyScalar(.5),bi.copy(e).sub(t).normalize(),_i.copy(this.origin).sub(yi);const r=.5*t.distanceTo(e),o=-this.direction.dot(bi),a=_i.dot(this.direction),s=-_i.dot(bi),c=_i.lengthSq(),l=Math.abs(1-o*o);let d,u,h,p;if(l>0)if(d=o*s-a,u=o*a-s,p=r*l,d>=0)if(u>=-p)if(u<=p){const t=1/l;d*=t,u*=t,h=d*(d+o*u+2*a)+u*(o*d+u+2*s)+c}else u=r,d=Math.max(0,-(o*u+a)),h=-d*d+u*(u+2*s)+c;else u=-r,d=Math.max(0,-(o*u+a)),h=-d*d+u*(u+2*s)+c;else u<=-p?(d=Math.max(0,-(-o*r+a)),u=d>0?-r:Math.min(Math.max(-r,-s),r),h=-d*d+u*(u+2*s)+c):u<=p?(d=0,u=Math.min(Math.max(-r,-s),r),h=u*(u+2*s)+c):(d=Math.max(0,-(o*r+a)),u=d>0?r:Math.min(Math.max(-r,-s),r),h=-d*d+u*(u+2*s)+c);else u=o>0?-r:r,d=Math.max(0,-(o*u+a)),h=-d*d+u*(u+2*s)+c;return n&&n.copy(this.direction).multiplyScalar(d).add(this.origin),i&&i.copy(bi).multiplyScalar(u).add(yi),h}intersectSphere(t,e){vi.subVectors(t.center,this.origin);const n=vi.dot(this.direction),i=vi.dot(vi)-n*n,r=t.radius*t.radius;if(i>r)return null;const o=Math.sqrt(r-i),a=n-o,s=n+o;return a<0&&s<0?null:a<0?this.at(s,e):this.at(a,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){const n=this.distanceToPlane(t);return null===n?null:this.at(n,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);if(0===e)return!0;return t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,i,r,o,a,s;const c=1/this.direction.x,l=1/this.direction.y,d=1/this.direction.z,u=this.origin;return c>=0?(n=(t.min.x-u.x)*c,i=(t.max.x-u.x)*c):(n=(t.max.x-u.x)*c,i=(t.min.x-u.x)*c),l>=0?(r=(t.min.y-u.y)*l,o=(t.max.y-u.y)*l):(r=(t.max.y-u.y)*l,o=(t.min.y-u.y)*l),n>o||r>i?null:((r>n||n!=n)&&(n=r),(o<i||i!=i)&&(i=o),d>=0?(a=(t.min.z-u.z)*d,s=(t.max.z-u.z)*d):(a=(t.max.z-u.z)*d,s=(t.min.z-u.z)*d),n>s||a>i?null:((a>n||n!=n)&&(n=a),(s<i||i!=i)&&(i=s),i<0?null:this.at(n>=0?n:i,e)))}intersectsBox(t){return null!==this.intersectBox(t,vi)}intersectTriangle(t,e,n,i,r){xi.subVectors(e,t),wi.subVectors(n,t),Si.crossVectors(xi,wi);let o,a=this.direction.dot(Si);if(a>0){if(i)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}_i.subVectors(this.origin,t);const s=o*this.direction.dot(wi.crossVectors(_i,wi));if(s<0)return null;const c=o*this.direction.dot(xi.cross(_i));if(c<0)return null;if(s+c>a)return null;const l=-o*_i.dot(Si);return l<0?null:this.at(l/a,r)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}}class Ei{constructor(){Object.defineProperty(this,\"isMatrix4\",{value:!0}),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error(\"THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.\")}set(t,e,n,i,r,o,a,s,c,l,d,u,h,p,f,m){const g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=i,g[1]=r,g[5]=o,g[9]=a,g[13]=s,g[2]=c,g[6]=l,g[10]=d,g[14]=u,g[3]=h,g[7]=p,g[11]=f,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Ei).fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,i=1/Ti.setFromMatrixColumn(t,0).length(),r=1/Ti.setFromMatrixColumn(t,1).length(),o=1/Ti.setFromMatrixColumn(t,2).length();return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=0,e[4]=n[4]*r,e[5]=n[5]*r,e[6]=n[6]*r,e[7]=0,e[8]=n[8]*o,e[9]=n[9]*o,e[10]=n[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){t&&t.isEuler||console.error(\"THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.\");const e=this.elements,n=t.x,i=t.y,r=t.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(i),c=Math.sin(i),l=Math.cos(r),d=Math.sin(r);if(\"XYZ\"===t.order){const t=o*l,n=o*d,i=a*l,r=a*d;e[0]=s*l,e[4]=-s*d,e[8]=c,e[1]=n+i*c,e[5]=t-r*c,e[9]=-a*s,e[2]=r-t*c,e[6]=i+n*c,e[10]=o*s}else if(\"YXZ\"===t.order){const t=s*l,n=s*d,i=c*l,r=c*d;e[0]=t+r*a,e[4]=i*a-n,e[8]=o*c,e[1]=o*d,e[5]=o*l,e[9]=-a,e[2]=n*a-i,e[6]=r+t*a,e[10]=o*s}else if(\"ZXY\"===t.order){const t=s*l,n=s*d,i=c*l,r=c*d;e[0]=t-r*a,e[4]=-o*d,e[8]=i+n*a,e[1]=n+i*a,e[5]=o*l,e[9]=r-t*a,e[2]=-o*c,e[6]=a,e[10]=o*s}else if(\"ZYX\"===t.order){const t=o*l,n=o*d,i=a*l,r=a*d;e[0]=s*l,e[4]=i*c-n,e[8]=t*c+r,e[1]=s*d,e[5]=r*c+t,e[9]=n*c-i,e[2]=-c,e[6]=a*s,e[10]=o*s}else if(\"YZX\"===t.order){const t=o*s,n=o*c,i=a*s,r=a*c;e[0]=s*l,e[4]=r-t*d,e[8]=i*d+n,e[1]=d,e[5]=o*l,e[9]=-a*l,e[2]=-c*l,e[6]=n*d+i,e[10]=t-r*d}else if(\"XZY\"===t.order){const t=o*s,n=o*c,i=a*s,r=a*c;e[0]=s*l,e[4]=-d,e[8]=c*l,e[1]=t*d+r,e[5]=o*l,e[9]=n*d-i,e[2]=i*d-n,e[6]=a*l,e[10]=r*d+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(Ai,t,Oi)}lookAt(t,e,n){const i=this.elements;return Ii.subVectors(t,e),0===Ii.lengthSq()&&(Ii.z=1),Ii.normalize(),ki.crossVectors(n,Ii),0===ki.lengthSq()&&(1===Math.abs(n.z)?Ii.x+=1e-4:Ii.z+=1e-4,Ii.normalize(),ki.crossVectors(n,Ii)),ki.normalize(),Li.crossVectors(Ii,ki),i[0]=ki.x,i[4]=Li.x,i[8]=Ii.x,i[1]=ki.y,i[5]=Li.y,i[9]=Ii.y,i[2]=ki.z,i[6]=Li.z,i[10]=Ii.z,this}multiply(t,e){return void 0!==e?(console.warn(\"THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.\"),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,i=e.elements,r=this.elements,o=n[0],a=n[4],s=n[8],c=n[12],l=n[1],d=n[5],u=n[9],h=n[13],p=n[2],f=n[6],m=n[10],g=n[14],v=n[3],y=n[7],b=n[11],_=n[15],x=i[0],w=i[4],S=i[8],M=i[12],E=i[1],T=i[5],C=i[9],A=i[13],O=i[2],k=i[6],L=i[10],I=i[14],R=i[3],P=i[7],D=i[11],N=i[15];return r[0]=o*x+a*E+s*O+c*R,r[4]=o*w+a*T+s*k+c*P,r[8]=o*S+a*C+s*L+c*D,r[12]=o*M+a*A+s*I+c*N,r[1]=l*x+d*E+u*O+h*R,r[5]=l*w+d*T+u*k+h*P,r[9]=l*S+d*C+u*L+h*D,r[13]=l*M+d*A+u*I+h*N,r[2]=p*x+f*E+m*O+g*R,r[6]=p*w+f*T+m*k+g*P,r[10]=p*S+f*C+m*L+g*D,r[14]=p*M+f*A+m*I+g*N,r[3]=v*x+y*E+b*O+_*R,r[7]=v*w+y*T+b*k+_*P,r[11]=v*S+y*C+b*L+_*D,r[15]=v*M+y*A+b*I+_*N,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],i=t[8],r=t[12],o=t[1],a=t[5],s=t[9],c=t[13],l=t[2],d=t[6],u=t[10],h=t[14];return t[3]*(+r*s*d-i*c*d-r*a*u+n*c*u+i*a*h-n*s*h)+t[7]*(+e*s*h-e*c*u+r*o*u-i*o*h+i*c*l-r*s*l)+t[11]*(+e*c*d-e*a*h-r*o*d+n*o*h+r*a*l-n*c*l)+t[15]*(-i*a*l-e*s*d+e*a*u+i*o*d-n*o*u+n*s*l)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=e,i[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],a=t[5],s=t[6],c=t[7],l=t[8],d=t[9],u=t[10],h=t[11],p=t[12],f=t[13],m=t[14],g=t[15],v=d*m*c-f*u*c+f*s*h-a*m*h-d*s*g+a*u*g,y=p*u*c-l*m*c-p*s*h+o*m*h+l*s*g-o*u*g,b=l*f*c-p*d*c+p*a*h-o*f*h-l*a*g+o*d*g,_=p*d*s-l*f*s-p*a*u+o*f*u+l*a*m-o*d*m,x=e*v+n*y+i*b+r*_;if(0===x)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const w=1/x;return t[0]=v*w,t[1]=(f*u*r-d*m*r-f*i*h+n*m*h+d*i*g-n*u*g)*w,t[2]=(a*m*r-f*s*r+f*i*c-n*m*c-a*i*g+n*s*g)*w,t[3]=(d*s*r-a*u*r-d*i*c+n*u*c+a*i*h-n*s*h)*w,t[4]=y*w,t[5]=(l*m*r-p*u*r+p*i*h-e*m*h-l*i*g+e*u*g)*w,t[6]=(p*s*r-o*m*r-p*i*c+e*m*c+o*i*g-e*s*g)*w,t[7]=(o*u*r-l*s*r+l*i*c-e*u*c-o*i*h+e*s*h)*w,t[8]=b*w,t[9]=(p*d*r-l*f*r-p*n*h+e*f*h+l*n*g-e*d*g)*w,t[10]=(o*f*r-p*a*r+p*n*c-e*f*c-o*n*g+e*a*g)*w,t[11]=(l*a*r-o*d*r-l*n*c+e*d*c+o*n*h-e*a*h)*w,t[12]=_*w,t[13]=(l*f*i-p*d*i+p*n*u-e*f*u-l*n*m+e*d*m)*w,t[14]=(p*a*i-o*f*i-p*n*s+e*f*s+o*n*m-e*a*m)*w,t[15]=(o*d*i-l*a*i+l*n*s-e*d*s-o*n*u+e*a*u)*w,this}scale(t){const e=this.elements,n=t.x,i=t.y,r=t.z;return e[0]*=n,e[4]*=i,e[8]*=r,e[1]*=n,e[5]*=i,e[9]*=r,e[2]*=n,e[6]*=i,e[10]*=r,e[3]*=n,e[7]*=i,e[11]*=r,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,i))}makeTranslation(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),i=Math.sin(e),r=1-n,o=t.x,a=t.y,s=t.z,c=r*o,l=r*a;return this.set(c*o+n,c*a-i*s,c*s+i*a,0,c*a+i*s,l*a+n,l*s-i*o,0,c*s-i*a,l*s+i*o,r*s*s+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this}compose(t,e,n){const i=this.elements,r=e._x,o=e._y,a=e._z,s=e._w,c=r+r,l=o+o,d=a+a,u=r*c,h=r*l,p=r*d,f=o*l,m=o*d,g=a*d,v=s*c,y=s*l,b=s*d,_=n.x,x=n.y,w=n.z;return i[0]=(1-(f+g))*_,i[1]=(h+b)*_,i[2]=(p-y)*_,i[3]=0,i[4]=(h-b)*x,i[5]=(1-(u+g))*x,i[6]=(m+v)*x,i[7]=0,i[8]=(p+y)*w,i[9]=(m-v)*w,i[10]=(1-(u+f))*w,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}decompose(t,e,n){const i=this.elements;let r=Ti.set(i[0],i[1],i[2]).length();const o=Ti.set(i[4],i[5],i[6]).length(),a=Ti.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),t.x=i[12],t.y=i[13],t.z=i[14],Ci.copy(this);const s=1/r,c=1/o,l=1/a;return Ci.elements[0]*=s,Ci.elements[1]*=s,Ci.elements[2]*=s,Ci.elements[4]*=c,Ci.elements[5]*=c,Ci.elements[6]*=c,Ci.elements[8]*=l,Ci.elements[9]*=l,Ci.elements[10]*=l,e.setFromRotationMatrix(Ci),n.x=r,n.y=o,n.z=a,this}makePerspective(t,e,n,i,r,o){void 0===o&&console.warn(\"THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.\");const a=this.elements,s=2*r/(e-t),c=2*r/(n-i),l=(e+t)/(e-t),d=(n+i)/(n-i),u=-(o+r)/(o-r),h=-2*o*r/(o-r);return a[0]=s,a[4]=0,a[8]=l,a[12]=0,a[1]=0,a[5]=c,a[9]=d,a[13]=0,a[2]=0,a[6]=0,a[10]=u,a[14]=h,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(t,e,n,i,r,o){const a=this.elements,s=1/(e-t),c=1/(n-i),l=1/(o-r),d=(e+t)*s,u=(n+i)*c,h=(o+r)*l;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-d,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-u,a[2]=0,a[6]=0,a[10]=-2*l,a[14]=-h,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let t=0;t<16;t++)if(e[t]!==n[t])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}const Ti=new Zn,Ci=new Ei,Ai=new Zn(0,0,0),Oi=new Zn(1,1,1),ki=new Zn,Li=new Zn,Ii=new Zn;class Ri{constructor(t=0,e=0,n=0,i=Ri.DefaultOrder){Object.defineProperty(this,\"isEuler\",{value:!0}),this._x=t,this._y=e,this._z=n,this._order=i}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._order=i||this._order,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e,n){const i=Bn.clamp,r=t.elements,o=r[0],a=r[4],s=r[8],c=r[1],l=r[5],d=r[9],u=r[2],h=r[6],p=r[10];switch(e=e||this._order){case\"XYZ\":this._y=Math.asin(i(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-d,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(h,l),this._z=0);break;case\"YXZ\":this._x=Math.asin(-i(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(s,p),this._z=Math.atan2(c,l)):(this._y=Math.atan2(-u,o),this._z=0);break;case\"ZXY\":this._x=Math.asin(i(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,p),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(c,o));break;case\"ZYX\":this._y=Math.asin(-i(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,p),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,l));break;case\"YZX\":this._z=Math.asin(i(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-d,l),this._y=Math.atan2(-u,o)):(this._x=0,this._y=Math.atan2(s,p));break;case\"XZY\":this._z=Math.asin(-i(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-d,p),this._y=0);break;default:console.warn(\"THREE.Euler: .setFromRotationMatrix() encountered an unknown order: \"+e)}return this._order=e,!1!==n&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return Pi.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Pi,e,n)}setFromVector3(t,e){return this.set(t.x,t.y,t.z,e||this._order)}reorder(t){return Di.setFromEuler(this),this.setFromQuaternion(Di,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}toVector3(t){return t?t.set(this._x,this._y,this._z):new Zn(this._x,this._y,this._z)}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}Ri.DefaultOrder=\"XYZ\",Ri.RotationOrders=[\"XYZ\",\"YZX\",\"ZXY\",\"XZY\",\"YXZ\",\"ZYX\"];const Pi=new Ei,Di=new Kn;class Ni{constructor(){this.mask=1}set(t){this.mask=1<<t|0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return 0!=(this.mask&t.mask)}}let Fi=0;const ji=new Zn,Bi=new Kn,zi=new Ei,Ui=new Zn,Hi=new Zn,$i=new Zn,Gi=new Kn,Vi=new Zn(1,0,0),Wi=new Zn(0,1,0),qi=new Zn(0,0,1),Xi={type:\"added\"},Yi={type:\"removed\"};function Ki(){Object.defineProperty(this,\"id\",{value:Fi++}),this.uuid=Bn.generateUUID(),this.name=\"\",this.type=\"Object3D\",this.parent=null,this.children=[],this.up=Ki.DefaultUp.clone();const t=new Zn,e=new Ri,n=new Kn,i=new Zn(1,1,1);e._onChange((function(){n.setFromEuler(e,!1)})),n._onChange((function(){e.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Ei},normalMatrix:{value:new Un}}),this.matrix=new Ei,this.matrixWorld=new Ei,this.matrixAutoUpdate=Ki.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Ni,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}Ki.DefaultUp=new Zn(0,1,0),Ki.DefaultMatrixAutoUpdate=!0,Ki.prototype=Object.assign(Object.create(Nn.prototype),{constructor:Ki,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,e){return Bi.setFromAxisAngle(t,e),this.quaternion.multiply(Bi),this},rotateOnWorldAxis:function(t,e){return Bi.setFromAxisAngle(t,e),this.quaternion.premultiply(Bi),this},rotateX:function(t){return this.rotateOnAxis(Vi,t)},rotateY:function(t){return this.rotateOnAxis(Wi,t)},rotateZ:function(t){return this.rotateOnAxis(qi,t)},translateOnAxis:function(t,e){return ji.copy(t).applyQuaternion(this.quaternion),this.position.add(ji.multiplyScalar(e)),this},translateX:function(t){return this.translateOnAxis(Vi,t)},translateY:function(t){return this.translateOnAxis(Wi,t)},translateZ:function(t){return this.translateOnAxis(qi,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(zi.copy(this.matrixWorld).invert())},lookAt:function(t,e,n){t.isVector3?Ui.copy(t):Ui.set(t,e,n);const i=this.parent;this.updateWorldMatrix(!0,!1),Hi.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?zi.lookAt(Hi,Ui,this.up):zi.lookAt(Ui,Hi,this.up),this.quaternion.setFromRotationMatrix(zi),i&&(zi.extractRotation(i.matrixWorld),Bi.setFromRotationMatrix(zi),this.quaternion.premultiply(Bi.invert()))},add:function(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return t===this?(console.error(\"THREE.Object3D.add: object can't be added as a child of itself.\",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(Xi)):console.error(\"THREE.Object3D.add: object not an instance of THREE.Object3D.\",t),this)},remove:function(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(Yi)),this},clear:function(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.parent=null,e.dispatchEvent(Yi)}return this.children.length=0,this},attach:function(t){return this.updateWorldMatrix(!0,!1),zi.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),zi.multiply(t.parent.matrixWorld)),t.applyMatrix4(zi),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty(\"id\",t)},getObjectByName:function(t){return this.getObjectByProperty(\"name\",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(let n=0,i=this.children.length;n<i;n++){const i=this.children[n].getObjectByProperty(t,e);if(void 0!==i)return i}},getWorldPosition:function(t){return void 0===t&&(console.warn(\"THREE.Object3D: .getWorldPosition() target is now required\"),t=new Zn),this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn(\"THREE.Object3D: .getWorldQuaternion() target is now required\"),t=new Kn),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Hi,t,$i),t},getWorldScale:function(t){return void 0===t&&(console.warn(\"THREE.Object3D: .getWorldScale() target is now required\"),t=new Zn),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Hi,Gi,t),t},getWorldDirection:function(t){void 0===t&&(console.warn(\"THREE.Object3D: .getWorldDirection() target is now required\"),t=new Zn),this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1===this.visible)return;t(this);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)},traverseAncestors:function(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){const n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e){const t=this.children;for(let e=0,n=t.length;e<n;e++)t[e].updateWorldMatrix(!1,!0)}},toJSON:function(t){const e=void 0===t||\"string\"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:\"Object\",generator:\"Object3D.toJSON\"});const i={};function r(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(i.uuid=this.uuid,i.type=this.type,\"\"!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),\"{}\"!==JSON.stringify(this.userData)&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type=\"InstancedMesh\",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){i.geometry=r(t.geometries,this.geometry);const e=this.geometry.parameters;if(void 0!==e&&void 0!==e.shapes){const n=e.shapes;if(Array.isArray(n))for(let e=0,i=n.length;e<i;e++){const i=n[e];r(t.shapes,i)}else r(t.shapes,n)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(t.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const e=[];for(let n=0,i=this.material.length;n<i;n++)e.push(r(t.materials,this.material[n]));i.material=e}else i.material=r(t.materials,this.material);if(this.children.length>0){i.children=[];for(let e=0;e<this.children.length;e++)i.children.push(this.children[e].toJSON(t).object)}if(this.animations.length>0){i.animations=[];for(let e=0;e<this.animations.length;e++){const n=this.animations[e];i.animations.push(r(t.animations,n))}}if(e){const e=o(t.geometries),i=o(t.materials),r=o(t.textures),a=o(t.images),s=o(t.shapes),c=o(t.skeletons),l=o(t.animations);e.length>0&&(n.geometries=e),i.length>0&&(n.materials=i),r.length>0&&(n.textures=r),a.length>0&&(n.images=a),s.length>0&&(n.shapes=s),c.length>0&&(n.skeletons=c),l.length>0&&(n.animations=l)}return n.object=i,n;function o(t){const e=[];for(const n in t){const i=t[n];delete i.metadata,e.push(i)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let e=0;e<t.children.length;e++){const n=t.children[e];this.add(n.clone())}return this}});const Zi=new Zn,Ji=new Zn,Qi=new Un;class tr{constructor(t,e){Object.defineProperty(this,\"isPlane\",{value:!0}),this.normal=void 0!==t?t:new Zn(1,0,0),this.constant=void 0!==e?e:0}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,n,i){return this.normal.set(t,e,n),this.constant=i,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,n){const i=Zi.subVectors(n,e).cross(Ji.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(i,t),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return void 0===e&&(console.warn(\"THREE.Plane: .projectPoint() target is now required\"),e=new Zn),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,e){void 0===e&&(console.warn(\"THREE.Plane: .intersectLine() target is now required\"),e=new Zn);const n=t.delta(Zi),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(t.start)?e.copy(t.start):void 0;const r=-(t.start.dot(this.normal)+this.constant)/i;return r<0||r>1?void 0:e.copy(n).multiplyScalar(r).add(t.start)}intersectsLine(t){const e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return void 0===t&&(console.warn(\"THREE.Plane: .coplanarPoint() target is now required\"),t=new Zn),t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const n=e||Qi.getNormalMatrix(t),i=this.coplanarPoint(Zi).applyMatrix4(t),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}}const er=new Zn,nr=new Zn,ir=new Zn,rr=new Zn,or=new Zn,ar=new Zn,sr=new Zn,cr=new Zn,lr=new Zn,dr=new Zn;class ur{constructor(t,e,n){this.a=void 0!==t?t:new Zn,this.b=void 0!==e?e:new Zn,this.c=void 0!==n?n:new Zn}static getNormal(t,e,n,i){void 0===i&&(console.warn(\"THREE.Triangle: .getNormal() target is now required\"),i=new Zn),i.subVectors(n,e),er.subVectors(t,e),i.cross(er);const r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(t,e,n,i,r){er.subVectors(i,e),nr.subVectors(n,e),ir.subVectors(t,e);const o=er.dot(er),a=er.dot(nr),s=er.dot(ir),c=nr.dot(nr),l=nr.dot(ir),d=o*c-a*a;if(void 0===r&&(console.warn(\"THREE.Triangle: .getBarycoord() target is now required\"),r=new Zn),0===d)return r.set(-2,-1,-1);const u=1/d,h=(c*s-a*l)*u,p=(o*l-a*s)*u;return r.set(1-h-p,p,h)}static containsPoint(t,e,n,i){return this.getBarycoord(t,e,n,i,rr),rr.x>=0&&rr.y>=0&&rr.x+rr.y<=1}static getUV(t,e,n,i,r,o,a,s){return this.getBarycoord(t,e,n,i,rr),s.set(0,0),s.addScaledVector(r,rr.x),s.addScaledVector(o,rr.y),s.addScaledVector(a,rr.z),s}static isFrontFacing(t,e,n,i){return er.subVectors(n,e),nr.subVectors(t,e),er.cross(nr).dot(i)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,i){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[i]),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return er.subVectors(this.c,this.b),nr.subVectors(this.a,this.b),.5*er.cross(nr).length()}getMidpoint(t){return void 0===t&&(console.warn(\"THREE.Triangle: .getMidpoint() target is now required\"),t=new Zn),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return ur.getNormal(this.a,this.b,this.c,t)}getPlane(t){return void 0===t&&(console.warn(\"THREE.Triangle: .getPlane() target is now required\"),t=new tr),t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return ur.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,n,i,r){return ur.getUV(t,this.a,this.b,this.c,e,n,i,r)}containsPoint(t){return ur.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return ur.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){void 0===e&&(console.warn(\"THREE.Triangle: .closestPointToPoint() target is now required\"),e=new Zn);const n=this.a,i=this.b,r=this.c;let o,a;or.subVectors(i,n),ar.subVectors(r,n),cr.subVectors(t,n);const s=or.dot(cr),c=ar.dot(cr);if(s<=0&&c<=0)return e.copy(n);lr.subVectors(t,i);const l=or.dot(lr),d=ar.dot(lr);if(l>=0&&d<=l)return e.copy(i);const u=s*d-l*c;if(u<=0&&s>=0&&l<=0)return o=s/(s-l),e.copy(n).addScaledVector(or,o);dr.subVectors(t,r);const h=or.dot(dr),p=ar.dot(dr);if(p>=0&&h<=p)return e.copy(r);const f=h*c-s*p;if(f<=0&&c>=0&&p<=0)return a=c/(c-p),e.copy(n).addScaledVector(ar,a);const m=l*p-h*d;if(m<=0&&d-l>=0&&h-p>=0)return sr.subVectors(r,i),a=(d-l)/(d-l+(h-p)),e.copy(i).addScaledVector(sr,a);const g=1/(m+f+u);return o=f*g,a=u*g,e.copy(n).addScaledVector(or,o).addScaledVector(ar,a)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}const hr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},pr={h:0,s:0,l:0},fr={h:0,s:0,l:0};function mr(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function gr(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function vr(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}class yr{constructor(t,e,n){return Object.defineProperty(this,\"isColor\",{value:!0}),void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}set(t){return t&&t.isColor?this.copy(t):\"number\"==typeof t?this.setHex(t):\"string\"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this}setRGB(t,e,n){return this.r=t,this.g=e,this.b=n,this}setHSL(t,e,n){if(t=Bn.euclideanModulo(t,1),e=Bn.clamp(e,0,1),n=Bn.clamp(n,0,1),0===e)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+e):n+e-n*e,r=2*n-i;this.r=mr(r,i,t+1/3),this.g=mr(r,i,t),this.b=mr(r,i,t-1/3)}return this}setStyle(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn(\"THREE.Color: Alpha component of \"+t+\" will be ignored.\")}let n;if(n=/^((?:rgb|hsl)a?)\\(([^\\)]*)\\)/.exec(t)){let t;const i=n[1],r=n[2];switch(i){case\"rgb\":case\"rgba\":if(t=/^\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(?:,\\s*(\\d*\\.?\\d+)\\s*)?$/.exec(r))return this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,e(t[4]),this;if(t=/^\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*(?:,\\s*(\\d*\\.?\\d+)\\s*)?$/.exec(r))return this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,e(t[4]),this;break;case\"hsl\":case\"hsla\":if(t=/^\\s*(\\d*\\.?\\d+)\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*(?:,\\s*(\\d*\\.?\\d+)\\s*)?$/.exec(r)){const n=parseFloat(t[1])/360,i=parseInt(t[2],10)/100,r=parseInt(t[3],10)/100;return e(t[4]),this.setHSL(n,i,r)}}}else if(n=/^\\#([A-Fa-f\\d]+)$/.exec(t)){const t=n[1],e=t.length;if(3===e)return this.r=parseInt(t.charAt(0)+t.charAt(0),16)/255,this.g=parseInt(t.charAt(1)+t.charAt(1),16)/255,this.b=parseInt(t.charAt(2)+t.charAt(2),16)/255,this;if(6===e)return this.r=parseInt(t.charAt(0)+t.charAt(1),16)/255,this.g=parseInt(t.charAt(2)+t.charAt(3),16)/255,this.b=parseInt(t.charAt(4)+t.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this}setColorName(t){const e=hr[t];return void 0!==e?this.setHex(e):console.warn(\"THREE.Color: Unknown color \"+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copyGammaToLinear(t,e=2){return this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this}copyLinearToGamma(t,e=2){const n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this}convertGammaToLinear(t){return this.copyGammaToLinear(this,t),this}convertLinearToGamma(t){return this.copyLinearToGamma(this,t),this}copySRGBToLinear(t){return this.r=gr(t.r),this.g=gr(t.g),this.b=gr(t.b),this}copyLinearToSRGB(t){return this.r=vr(t.r),this.g=vr(t.g),this.b=vr(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return(\"000000\"+this.getHex().toString(16)).slice(-6)}getHSL(t){void 0===t&&(console.warn(\"THREE.Color: .getHSL() target is now required\"),t={h:0,s:0,l:0});const e=this.r,n=this.g,i=this.b,r=Math.max(e,n,i),o=Math.min(e,n,i);let a,s;const c=(o+r)/2;if(o===r)a=0,s=0;else{const t=r-o;switch(s=c<=.5?t/(r+o):t/(2-r-o),r){case e:a=(n-i)/t+(n<i?6:0);break;case n:a=(i-e)/t+2;break;case i:a=(e-n)/t+4}a/=6}return t.h=a,t.s=s,t.l=c,t}getStyle(){return\"rgb(\"+(255*this.r|0)+\",\"+(255*this.g|0)+\",\"+(255*this.b|0)+\")\"}offsetHSL(t,e,n){return this.getHSL(pr),pr.h+=t,pr.s+=e,pr.l+=n,this.setHSL(pr.h,pr.s,pr.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(pr),t.getHSL(fr);const n=Bn.lerp(pr.h,fr.h,e),i=Bn.lerp(pr.s,fr.s,e),r=Bn.lerp(pr.l,fr.l,e);return this.setHSL(n,i,r),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}yr.NAMES=hr,yr.prototype.r=1,yr.prototype.g=1,yr.prototype.b=1;class br{constructor(t,e,n,i,r,o=0){this.a=t,this.b=e,this.c=n,this.normal=i&&i.isVector3?i:new Zn,this.vertexNormals=Array.isArray(i)?i:[],this.color=r&&r.isColor?r:new yr,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=o}clone(){return(new this.constructor).copy(this)}copy(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(let e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(let e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}}let _r=0;function xr(){Object.defineProperty(this,\"id\",{value:_r++}),this.uuid=Bn.generateUUID(),this.name=\"\",this.type=\"Material\",this.fog=!0,this.blending=_,this.side=f,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=P,this.blendDst=D,this.blendEquation=E,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=G,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Mn,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=dn,this.stencilZFail=dn,this.stencilZPass=dn,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function wr(t){xr.call(this),this.type=\"MeshBasicMaterial\",this.color=new yr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Y,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap=\"round\",this.wireframeLinejoin=\"round\",this.skinning=!1,this.morphTargets=!1,this.setValues(t)}xr.prototype=Object.assign(Object.create(Nn.prototype),{constructor:xr,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(t){if(void 0!==t)for(const e in t){const n=t[e];if(void 0===n){console.warn(\"THREE.Material: '\"+e+\"' parameter is undefined.\");continue}if(\"shading\"===e){console.warn(\"THREE.\"+this.type+\": .shading has been removed. Use the boolean .flatShading instead.\"),this.flatShading=n===v;continue}const i=this[e];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[e]=n:console.warn(\"THREE.\"+this.type+\": '\"+e+\"' is not a property of this material.\")}},toJSON:function(t){const e=void 0===t||\"string\"==typeof t;e&&(t={textures:{},images:{}});const n={metadata:{version:4.5,type:\"Material\",generator:\"Material.toJSON\"}};function i(t){const e=[];for(const n in t){const i=t[n];delete i.metadata,e.push(i)}return e}if(n.uuid=this.uuid,n.type=this.type,\"\"!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==_&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),this.side!==f&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),\"round\"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),\"round\"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),\"{}\"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e){const e=i(t.textures),r=i(t.images);e.length>0&&(n.textures=e),r.length>0&&(n.images=r)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(null!==e){const t=e.length;n=new Array(t);for(let i=0;i!==t;++i)n[i]=e[i].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:\"dispose\"})}}),Object.defineProperty(xr.prototype,\"needsUpdate\",{set:function(t){!0===t&&this.version++}}),wr.prototype=Object.create(xr.prototype),wr.prototype.constructor=wr,wr.prototype.isMeshBasicMaterial=!0,wr.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this};const Sr=new Zn,Mr=new zn;function Er(t,e,n){if(Array.isArray(t))throw new TypeError(\"THREE.BufferAttribute: array should be a Typed Array.\");this.name=\"\",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.usage=En,this.updateRange={offset:0,count:-1},this.version=0}function Tr(t,e,n){Er.call(this,new Int8Array(t),e,n)}function Cr(t,e,n){Er.call(this,new Uint8Array(t),e,n)}function Ar(t,e,n){Er.call(this,new Uint8ClampedArray(t),e,n)}function Or(t,e,n){Er.call(this,new Int16Array(t),e,n)}function kr(t,e,n){Er.call(this,new Uint16Array(t),e,n)}function Lr(t,e,n){Er.call(this,new Int32Array(t),e,n)}function Ir(t,e,n){Er.call(this,new Uint32Array(t),e,n)}function Rr(t,e,n){Er.call(this,new Uint16Array(t),e,n)}function Pr(t,e,n){Er.call(this,new Float32Array(t),e,n)}function Dr(t,e,n){Er.call(this,new Float64Array(t),e,n)}function Nr(t){if(0===t.length)return-1/0;let e=t[0];for(let n=1,i=t.length;n<i;++n)t[n]>e&&(e=t[n]);return e}Object.defineProperty(Er.prototype,\"needsUpdate\",{set:function(t){!0===t&&this.version++}}),Object.assign(Er.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[t+i]=e.array[n+i];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let r=t[i];void 0===r&&(console.warn(\"THREE.BufferAttribute.copyColorsArray(): color is undefined\",i),r=new yr),e[n++]=r.r,e[n++]=r.g,e[n++]=r.b}return this},copyVector2sArray:function(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let r=t[i];void 0===r&&(console.warn(\"THREE.BufferAttribute.copyVector2sArray(): vector is undefined\",i),r=new zn),e[n++]=r.x,e[n++]=r.y}return this},copyVector3sArray:function(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let r=t[i];void 0===r&&(console.warn(\"THREE.BufferAttribute.copyVector3sArray(): vector is undefined\",i),r=new Zn),e[n++]=r.x,e[n++]=r.y,e[n++]=r.z}return this},copyVector4sArray:function(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let r=t[i];void 0===r&&(console.warn(\"THREE.BufferAttribute.copyVector4sArray(): vector is undefined\",i),r=new qn),e[n++]=r.x,e[n++]=r.y,e[n++]=r.z,e[n++]=r.w}return this},applyMatrix3:function(t){if(2===this.itemSize)for(let e=0,n=this.count;e<n;e++)Mr.fromBufferAttribute(this,e),Mr.applyMatrix3(t),this.setXY(e,Mr.x,Mr.y);else if(3===this.itemSize)for(let e=0,n=this.count;e<n;e++)Sr.fromBufferAttribute(this,e),Sr.applyMatrix3(t),this.setXYZ(e,Sr.x,Sr.y,Sr.z);return this},applyMatrix4:function(t){for(let e=0,n=this.count;e<n;e++)Sr.x=this.getX(e),Sr.y=this.getY(e),Sr.z=this.getZ(e),Sr.applyMatrix4(t),this.setXYZ(e,Sr.x,Sr.y,Sr.z);return this},applyNormalMatrix:function(t){for(let e=0,n=this.count;e<n;e++)Sr.x=this.getX(e),Sr.y=this.getY(e),Sr.z=this.getZ(e),Sr.applyNormalMatrix(t),this.setXYZ(e,Sr.x,Sr.y,Sr.z);return this},transformDirection:function(t){for(let e=0,n=this.count;e<n;e++)Sr.x=this.getX(e),Sr.y=this.getY(e),Sr.z=this.getZ(e),Sr.transformDirection(t),this.setXYZ(e,Sr.x,Sr.y,Sr.z);return this},set:function(t,e=0){return this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this},setXYZW:function(t,e,n,i,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=r,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),Tr.prototype=Object.create(Er.prototype),Tr.prototype.constructor=Tr,Cr.prototype=Object.create(Er.prototype),Cr.prototype.constructor=Cr,Ar.prototype=Object.create(Er.prototype),Ar.prototype.constructor=Ar,Or.prototype=Object.create(Er.prototype),Or.prototype.constructor=Or,kr.prototype=Object.create(Er.prototype),kr.prototype.constructor=kr,Lr.prototype=Object.create(Er.prototype),Lr.prototype.constructor=Lr,Ir.prototype=Object.create(Er.prototype),Ir.prototype.constructor=Ir,Rr.prototype=Object.create(Er.prototype),Rr.prototype.constructor=Rr,Rr.prototype.isFloat16BufferAttribute=!0,Pr.prototype=Object.create(Er.prototype),Pr.prototype.constructor=Pr,Dr.prototype=Object.create(Er.prototype),Dr.prototype.constructor=Dr;const Fr={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:\"undefined\"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function jr(t,e){return new Fr[t](e)}let Br=0;const zr=new Ei,Ur=new Ki,Hr=new Zn,$r=new ti,Gr=new ti,Vr=new Zn;function Wr(){Object.defineProperty(this,\"id\",{value:Br++}),this.uuid=Bn.generateUUID(),this.name=\"\",this.type=\"BufferGeometry\",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}Wr.prototype=Object.assign(Object.create(Nn.prototype),{constructor:Wr,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){return Array.isArray(t)?this.index=new(Nr(t)>65535?Ir:kr)(t,1):this.index=t,this},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,e){return this.attributes[t]=e,this},deleteAttribute:function(t){return delete this.attributes[t],this},hasAttribute:function(t){return void 0!==this.attributes[t]},addGroup:function(t,e,n=0){this.groups.push({start:t,count:e,materialIndex:n})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix4:function(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const e=(new Un).getNormalMatrix(t);n.applyNormalMatrix(e),n.needsUpdate=!0}const i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(t),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return zr.makeRotationX(t),this.applyMatrix4(zr),this},rotateY:function(t){return zr.makeRotationY(t),this.applyMatrix4(zr),this},rotateZ:function(t){return zr.makeRotationZ(t),this.applyMatrix4(zr),this},translate:function(t,e,n){return zr.makeTranslation(t,e,n),this.applyMatrix4(zr),this},scale:function(t,e,n){return zr.makeScale(t,e,n),this.applyMatrix4(zr),this},lookAt:function(t){return Ur.lookAt(t),Ur.updateMatrix(),this.applyMatrix4(Ur.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Hr).negate(),this.translate(Hr.x,Hr.y,Hr.z),this},setFromPoints:function(t){const e=[];for(let n=0,i=t.length;n<i;n++){const i=t[n];e.push(i.x,i.y,i.z||0)}return this.setAttribute(\"position\",new Pr(e,3)),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new ti);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set \"mesh.frustumCulled\" to \"false\".',this),void this.boundingBox.set(new Zn(-1/0,-1/0,-1/0),new Zn(1/0,1/0,1/0));if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let t=0,n=e.length;t<n;t++){const n=e[t];$r.setFromBufferAttribute(n),this.morphTargetsRelative?(Vr.addVectors(this.boundingBox.min,$r.min),this.boundingBox.expandByPoint(Vr),Vr.addVectors(this.boundingBox.max,$r.max),this.boundingBox.expandByPoint(Vr)):(this.boundingBox.expandByPoint($r.min),this.boundingBox.expandByPoint($r.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The \"position\" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new gi);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set \"mesh.frustumCulled\" to \"false\".',this),void this.boundingSphere.set(new Zn,1/0);if(t){const n=this.boundingSphere.center;if($r.setFromBufferAttribute(t),e)for(let t=0,n=e.length;t<n;t++){const n=e[t];Gr.setFromBufferAttribute(n),this.morphTargetsRelative?(Vr.addVectors($r.min,Gr.min),$r.expandByPoint(Vr),Vr.addVectors($r.max,Gr.max),$r.expandByPoint(Vr)):($r.expandByPoint(Gr.min),$r.expandByPoint(Gr.max))}$r.getCenter(n);let i=0;for(let e=0,r=t.count;e<r;e++)Vr.fromBufferAttribute(t,e),i=Math.max(i,n.distanceToSquared(Vr));if(e)for(let r=0,o=e.length;r<o;r++){const o=e[r],a=this.morphTargetsRelative;for(let e=0,r=o.count;e<r;e++)Vr.fromBufferAttribute(o,e),a&&(Hr.fromBufferAttribute(t,e),Vr.add(Hr)),i=Math.max(i,n.distanceToSquared(Vr))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeTangents:function(){const t=this.index,e=this.attributes;if(null===t||void 0===e.position||void 0===e.normal||void 0===e.uv)return void console.error(\"THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)\");const n=t.array,i=e.position.array,r=e.normal.array,o=e.uv.array,a=i.length/3;void 0===e.tangent&&this.setAttribute(\"tangent\",new Er(new Float32Array(4*a),4));const s=e.tangent.array,c=[],l=[];for(let t=0;t<a;t++)c[t]=new Zn,l[t]=new Zn;const d=new Zn,u=new Zn,h=new Zn,p=new zn,f=new zn,m=new zn,g=new Zn,v=new Zn;function y(t,e,n){d.fromArray(i,3*t),u.fromArray(i,3*e),h.fromArray(i,3*n),p.fromArray(o,2*t),f.fromArray(o,2*e),m.fromArray(o,2*n),u.sub(d),h.sub(d),f.sub(p),m.sub(p);const r=1/(f.x*m.y-m.x*f.y);isFinite(r)&&(g.copy(u).multiplyScalar(m.y).addScaledVector(h,-f.y).multiplyScalar(r),v.copy(h).multiplyScalar(f.x).addScaledVector(u,-m.x).multiplyScalar(r),c[t].add(g),c[e].add(g),c[n].add(g),l[t].add(v),l[e].add(v),l[n].add(v))}let b=this.groups;0===b.length&&(b=[{start:0,count:n.length}]);for(let t=0,e=b.length;t<e;++t){const e=b[t],i=e.start;for(let t=i,r=i+e.count;t<r;t+=3)y(n[t+0],n[t+1],n[t+2])}const _=new Zn,x=new Zn,w=new Zn,S=new Zn;function M(t){w.fromArray(r,3*t),S.copy(w);const e=c[t];_.copy(e),_.sub(w.multiplyScalar(w.dot(e))).normalize(),x.crossVectors(S,e);const n=x.dot(l[t])<0?-1:1;s[4*t]=_.x,s[4*t+1]=_.y,s[4*t+2]=_.z,s[4*t+3]=n}for(let t=0,e=b.length;t<e;++t){const e=b[t],i=e.start;for(let t=i,r=i+e.count;t<r;t+=3)M(n[t+0]),M(n[t+1]),M(n[t+2])}},computeVertexNormals:function(){const t=this.index,e=this.getAttribute(\"position\");if(void 0!==e){let n=this.getAttribute(\"normal\");if(void 0===n)n=new Er(new Float32Array(3*e.count),3),this.setAttribute(\"normal\",n);else for(let t=0,e=n.count;t<e;t++)n.setXYZ(t,0,0,0);const i=new Zn,r=new Zn,o=new Zn,a=new Zn,s=new Zn,c=new Zn,l=new Zn,d=new Zn;if(t)for(let u=0,h=t.count;u<h;u+=3){const h=t.getX(u+0),p=t.getX(u+1),f=t.getX(u+2);i.fromBufferAttribute(e,h),r.fromBufferAttribute(e,p),o.fromBufferAttribute(e,f),l.subVectors(o,r),d.subVectors(i,r),l.cross(d),a.fromBufferAttribute(n,h),s.fromBufferAttribute(n,p),c.fromBufferAttribute(n,f),a.add(l),s.add(l),c.add(l),n.setXYZ(h,a.x,a.y,a.z),n.setXYZ(p,s.x,s.y,s.z),n.setXYZ(f,c.x,c.y,c.z)}else for(let t=0,a=e.count;t<a;t+=3)i.fromBufferAttribute(e,t+0),r.fromBufferAttribute(e,t+1),o.fromBufferAttribute(e,t+2),l.subVectors(o,r),d.subVectors(i,r),l.cross(d),n.setXYZ(t+0,l.x,l.y,l.z),n.setXYZ(t+1,l.x,l.y,l.z),n.setXYZ(t+2,l.x,l.y,l.z);this.normalizeNormals(),n.needsUpdate=!0}},merge:function(t,e){if(!t||!t.isBufferGeometry)return void console.error(\"THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.\",t);void 0===e&&(e=0,console.warn(\"THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge.\"));const n=this.attributes;for(const i in n){if(void 0===t.attributes[i])continue;const r=n[i].array,o=t.attributes[i],a=o.array,s=o.itemSize*e,c=Math.min(a.length,r.length-s);for(let t=0,e=s;t<c;t++,e++)r[e]=a[t]}return this},normalizeNormals:function(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)Vr.fromBufferAttribute(t,e),Vr.normalize(),t.setXYZ(e,Vr.x,Vr.y,Vr.z)},toNonIndexed:function(){function t(t,e){const n=t.array,i=t.itemSize,r=t.normalized,o=new n.constructor(e.length*i);let a=0,s=0;for(let t=0,r=e.length;t<r;t++){a=e[t]*i;for(let t=0;t<i;t++)o[s++]=n[a++]}return new Er(o,i,r)}if(null===this.index)return console.warn(\"THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed.\"),this;const e=new Wr,n=this.index.array,i=this.attributes;for(const r in i){const o=t(i[r],n);e.setAttribute(r,o)}const r=this.morphAttributes;for(const i in r){const o=[],a=r[i];for(let e=0,i=a.length;e<i;e++){const i=t(a[e],n);o.push(i)}e.morphAttributes[i]=o}e.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let t=0,n=o.length;t<n;t++){const n=o[t];e.addGroup(n.start,n.count,n.materialIndex)}return e},toJSON:function(){const t={metadata:{version:4.5,type:\"BufferGeometry\",generator:\"BufferGeometry.toJSON\"}};if(t.uuid=this.uuid,t.type=this.type,\"\"!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const e=this.parameters;for(const n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const e in n){const i=n[e],r=i.toJSON(t.data);\"\"!==i.name&&(r.name=i.name),t.data.attributes[e]=r}const i={};let r=!1;for(const e in this.morphAttributes){const n=this.morphAttributes[e],o=[];for(let e=0,i=n.length;e<i;e++){const i=n[e],r=i.toJSON(t.data);\"\"!==i.name&&(r.name=i.name),o.push(r)}o.length>0&&(i[e]=o,r=!0)}r&&(t.data.morphAttributes=i,t.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(t.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(t.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),t},clone:function(){return(new Wr).copy(this)},copy:function(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;null!==n&&this.setIndex(n.clone(e));const i=t.attributes;for(const t in i){const n=i[t];this.setAttribute(t,n.clone(e))}const r=t.morphAttributes;for(const t in r){const n=[],i=r[t];for(let t=0,r=i.length;t<r;t++)n.push(i[t].clone(e));this.morphAttributes[t]=n}this.morphTargetsRelative=t.morphTargetsRelative;const o=t.groups;for(let t=0,e=o.length;t<e;t++){const e=o[t];this.addGroup(e.start,e.count,e.materialIndex)}const a=t.boundingBox;null!==a&&(this.boundingBox=a.clone());const s=t.boundingSphere;return null!==s&&(this.boundingSphere=s.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:\"dispose\"})}});const qr=new Ei,Xr=new Mi,Yr=new gi,Kr=new Zn,Zr=new Zn,Jr=new Zn,Qr=new Zn,to=new Zn,eo=new Zn,no=new Zn,io=new Zn,ro=new Zn,oo=new zn,ao=new zn,so=new zn,co=new Zn,lo=new Zn;function uo(t=new Wr,e=new wr){Ki.call(this),this.type=\"Mesh\",this.geometry=t,this.material=e,this.updateMorphTargets()}function ho(t,e,n,i,r,o,a,s,c,l,d,u){Kr.fromBufferAttribute(r,l),Zr.fromBufferAttribute(r,d),Jr.fromBufferAttribute(r,u);const h=t.morphTargetInfluences;if(e.morphTargets&&o&&h){no.set(0,0,0),io.set(0,0,0),ro.set(0,0,0);for(let t=0,e=o.length;t<e;t++){const e=h[t],n=o[t];0!==e&&(Qr.fromBufferAttribute(n,l),to.fromBufferAttribute(n,d),eo.fromBufferAttribute(n,u),a?(no.addScaledVector(Qr,e),io.addScaledVector(to,e),ro.addScaledVector(eo,e)):(no.addScaledVector(Qr.sub(Kr),e),io.addScaledVector(to.sub(Zr),e),ro.addScaledVector(eo.sub(Jr),e)))}Kr.add(no),Zr.add(io),Jr.add(ro)}t.isSkinnedMesh&&(t.boneTransform(l,Kr),t.boneTransform(d,Zr),t.boneTransform(u,Jr));const p=function(t,e,n,i,r,o,a,s){let c;if(c=e.side===m?i.intersectTriangle(a,o,r,!0,s):i.intersectTriangle(r,o,a,e.side!==g,s),null===c)return null;lo.copy(s),lo.applyMatrix4(t.matrixWorld);const l=n.ray.origin.distanceTo(lo);return l<n.near||l>n.far?null:{distance:l,point:lo.clone(),object:t}}(t,e,n,i,Kr,Zr,Jr,co);if(p){s&&(oo.fromBufferAttribute(s,l),ao.fromBufferAttribute(s,d),so.fromBufferAttribute(s,u),p.uv=ur.getUV(co,Kr,Zr,Jr,oo,ao,so,new zn)),c&&(oo.fromBufferAttribute(c,l),ao.fromBufferAttribute(c,d),so.fromBufferAttribute(c,u),p.uv2=ur.getUV(co,Kr,Zr,Jr,oo,ao,so,new zn));const t=new br(l,d,u);ur.getNormal(Kr,Zr,Jr,t.normal),p.face=t}return p}uo.prototype=Object.assign(Object.create(Ki.prototype),{constructor:uo,isMesh:!0,copy:function(t){return Ki.prototype.copy.call(this,t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this},updateMorphTargets:function(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error(\"THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.\")}},raycast:function(t,e){const n=this.geometry,i=this.material,r=this.matrixWorld;if(void 0===i)return;if(null===n.boundingSphere&&n.computeBoundingSphere(),Yr.copy(n.boundingSphere),Yr.applyMatrix4(r),!1===t.ray.intersectsSphere(Yr))return;if(qr.copy(r).invert(),Xr.copy(t.ray).applyMatrix4(qr),null!==n.boundingBox&&!1===Xr.intersectsBox(n.boundingBox))return;let o;if(n.isBufferGeometry){const r=n.index,a=n.attributes.position,s=n.morphAttributes.position,c=n.morphTargetsRelative,l=n.attributes.uv,d=n.attributes.uv2,u=n.groups,h=n.drawRange;if(null!==r)if(Array.isArray(i))for(let n=0,p=u.length;n<p;n++){const p=u[n],f=i[p.materialIndex];for(let n=Math.max(p.start,h.start),i=Math.min(p.start+p.count,h.start+h.count);n<i;n+=3){const i=r.getX(n),u=r.getX(n+1),h=r.getX(n+2);o=ho(this,f,t,Xr,a,s,c,l,d,i,u,h),o&&(o.faceIndex=Math.floor(n/3),o.face.materialIndex=p.materialIndex,e.push(o))}}else{for(let n=Math.max(0,h.start),u=Math.min(r.count,h.start+h.count);n<u;n+=3){const u=r.getX(n),h=r.getX(n+1),p=r.getX(n+2);o=ho(this,i,t,Xr,a,s,c,l,d,u,h,p),o&&(o.faceIndex=Math.floor(n/3),e.push(o))}}else if(void 0!==a)if(Array.isArray(i))for(let n=0,r=u.length;n<r;n++){const r=u[n],p=i[r.materialIndex];for(let n=Math.max(r.start,h.start),i=Math.min(r.start+r.count,h.start+h.count);n<i;n+=3){o=ho(this,p,t,Xr,a,s,c,l,d,n,n+1,n+2),o&&(o.faceIndex=Math.floor(n/3),o.face.materialIndex=r.materialIndex,e.push(o))}}else{for(let n=Math.max(0,h.start),r=Math.min(a.count,h.start+h.count);n<r;n+=3){o=ho(this,i,t,Xr,a,s,c,l,d,n,n+1,n+2),o&&(o.faceIndex=Math.floor(n/3),e.push(o))}}}else n.isGeometry&&console.error(\"THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.\")}});class po extends Wr{constructor(t=1,e=1,n=1,i=1,r=1,o=1){super(),this.type=\"BoxGeometry\",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:r,depthSegments:o};const a=this;i=Math.floor(i),r=Math.floor(r),o=Math.floor(o);const s=[],c=[],l=[],d=[];let u=0,h=0;function p(t,e,n,i,r,o,p,f,m,g,v){const y=o/m,b=p/g,_=o/2,x=p/2,w=f/2,S=m+1,M=g+1;let E=0,T=0;const C=new Zn;for(let o=0;o<M;o++){const a=o*b-x;for(let s=0;s<S;s++){const u=s*y-_;C[t]=u*i,C[e]=a*r,C[n]=w,c.push(C.x,C.y,C.z),C[t]=0,C[e]=0,C[n]=f>0?1:-1,l.push(C.x,C.y,C.z),d.push(s/m),d.push(1-o/g),E+=1}}for(let t=0;t<g;t++)for(let e=0;e<m;e++){const n=u+e+S*t,i=u+e+S*(t+1),r=u+(e+1)+S*(t+1),o=u+(e+1)+S*t;s.push(n,i,o),s.push(i,r,o),T+=6}a.addGroup(h,T,v),h+=T,u+=E}p(\"z\",\"y\",\"x\",-1,-1,n,e,t,o,r,0),p(\"z\",\"y\",\"x\",1,-1,n,e,-t,o,r,1),p(\"x\",\"z\",\"y\",1,1,t,n,e,i,o,2),p(\"x\",\"z\",\"y\",1,-1,t,n,-e,i,o,3),p(\"x\",\"y\",\"z\",1,-1,t,e,n,i,r,4),p(\"x\",\"y\",\"z\",-1,-1,t,e,-n,i,r,5),this.setIndex(s),this.setAttribute(\"position\",new Pr(c,3)),this.setAttribute(\"normal\",new Pr(l,3)),this.setAttribute(\"uv\",new Pr(d,2))}}function fo(t){const e={};for(const n in t){e[n]={};for(const i in t[n]){const r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}function mo(t){const e={};for(let n=0;n<t.length;n++){const i=fo(t[n]);for(const t in i)e[t]=i[t]}return e}const go={clone:fo,merge:mo};function vo(t){xr.call(this),this.type=\"ShaderMaterial\",this.defines={},this.uniforms={},this.vertexShader=\"void main() {\\n\\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n}\",this.fragmentShader=\"void main() {\\n\\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\\n}\",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&(void 0!==t.attributes&&console.error(\"THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead.\"),this.setValues(t))}function yo(){Ki.call(this),this.type=\"Camera\",this.matrixWorldInverse=new Ei,this.projectionMatrix=new Ei,this.projectionMatrixInverse=new Ei}function bo(t=50,e=1,n=.1,i=2e3){yo.call(this),this.type=\"PerspectiveCamera\",this.fov=t,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}vo.prototype=Object.create(xr.prototype),vo.prototype.constructor=vo,vo.prototype.isShaderMaterial=!0,vo.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=fo(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this},vo.prototype.toJSON=function(t){const e=xr.prototype.toJSON.call(this,t);e.glslVersion=this.glslVersion,e.uniforms={};for(const n in this.uniforms){const i=this.uniforms[n].value;i&&i.isTexture?e.uniforms[n]={type:\"t\",value:i.toJSON(t).uuid}:i&&i.isColor?e.uniforms[n]={type:\"c\",value:i.getHex()}:i&&i.isVector2?e.uniforms[n]={type:\"v2\",value:i.toArray()}:i&&i.isVector3?e.uniforms[n]={type:\"v3\",value:i.toArray()}:i&&i.isVector4?e.uniforms[n]={type:\"v4\",value:i.toArray()}:i&&i.isMatrix3?e.uniforms[n]={type:\"m3\",value:i.toArray()}:i&&i.isMatrix4?e.uniforms[n]={type:\"m4\",value:i.toArray()}:e.uniforms[n]={value:i}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;const n={};for(const t in this.extensions)!0===this.extensions[t]&&(n[t]=!0);return Object.keys(n).length>0&&(e.extensions=n),e},yo.prototype=Object.assign(Object.create(Ki.prototype),{constructor:yo,isCamera:!0,copy:function(t,e){return Ki.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){void 0===t&&(console.warn(\"THREE.Camera: .getWorldDirection() target is now required\"),t=new Zn),this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()},updateMatrixWorld:function(t){Ki.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()},updateWorldMatrix:function(t,e){Ki.prototype.updateWorldMatrix.call(this,t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()},clone:function(){return(new this.constructor).copy(this)}}),bo.prototype=Object.assign(Object.create(yo.prototype),{constructor:bo,isPerspectiveCamera:!0,copy:function(t,e){return yo.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){const e=.5*this.getFilmHeight()/t;this.fov=2*Bn.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){const t=Math.tan(.5*Bn.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*Bn.RAD2DEG*Math.atan(Math.tan(.5*Bn.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,n,i,r,o){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const t=this.near;let e=t*Math.tan(.5*Bn.DEG2RAD*this.fov)/this.zoom,n=2*e,i=this.aspect*n,r=-.5*i;const o=this.view;if(null!==this.view&&this.view.enabled){const t=o.fullWidth,a=o.fullHeight;r+=o.offsetX*i/t,e-=o.offsetY*n/a,i*=o.width/t,n*=o.height/a}const a=this.filmOffset;0!==a&&(r+=t*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,e,e-n,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(t){const e=Ki.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}});function _o(t,e,n){if(Ki.call(this),this.type=\"CubeCamera\",!0!==n.isWebGLCubeRenderTarget)return void console.error(\"THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.\");this.renderTarget=n;const i=new bo(90,1,t,e);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new Zn(1,0,0)),this.add(i);const r=new bo(90,1,t,e);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new Zn(-1,0,0)),this.add(r);const o=new bo(90,1,t,e);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new Zn(0,1,0)),this.add(o);const a=new bo(90,1,t,e);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new Zn(0,-1,0)),this.add(a);const s=new bo(90,1,t,e);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new Zn(0,0,1)),this.add(s);const c=new bo(90,1,t,e);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new Zn(0,0,-1)),this.add(c),this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();const l=t.xr.enabled,d=t.getRenderTarget();t.xr.enabled=!1;const u=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(e,i),t.setRenderTarget(n,1),t.render(e,r),t.setRenderTarget(n,2),t.render(e,o),t.setRenderTarget(n,3),t.render(e,a),t.setRenderTarget(n,4),t.render(e,s),n.texture.generateMipmaps=u,t.setRenderTarget(n,5),t.render(e,c),t.setRenderTarget(d),t.xr.enabled=l}}function xo(t,e,n,i,r,o,a,s,c,l){t=void 0!==t?t:[],e=void 0!==e?e:ot,a=void 0!==a?a:Ft,Vn.call(this,t,e,n,i,r,o,a,s,c,l),this.flipY=!1,this._needsFlipEnvMap=!0}_o.prototype=Object.create(Ki.prototype),_o.prototype.constructor=_o,xo.prototype=Object.create(Vn.prototype),xo.prototype.constructor=xo,xo.prototype.isCubeTexture=!0,Object.defineProperty(xo.prototype,\"images\",{get:function(){return this.image},set:function(t){this.image=t}});class wo extends Xn{constructor(t,e,n){Number.isInteger(e)&&(console.warn(\"THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )\"),e=n),super(t,t,e),Object.defineProperty(this,\"isWebGLCubeRenderTarget\",{value:!0}),e=e||{},this.texture=new xo(void 0,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.format=jt,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:\"\\n\\n\\t\\t\\t\\tvarying vec3 vWorldDirection;\\n\\n\\t\\t\\t\\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\\n\\n\\t\\t\\t\\t\\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\\n\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\tvoid main() {\\n\\n\\t\\t\\t\\t\\tvWorldDirection = transformDirection( position, modelMatrix );\\n\\n\\t\\t\\t\\t\\t#include <begin_vertex>\\n\\t\\t\\t\\t\\t#include <project_vertex>\\n\\n\\t\\t\\t\\t}\\n\\t\\t\\t\",fragmentShader:\"\\n\\n\\t\\t\\t\\tuniform sampler2D tEquirect;\\n\\n\\t\\t\\t\\tvarying vec3 vWorldDirection;\\n\\n\\t\\t\\t\\t#include <common>\\n\\n\\t\\t\\t\\tvoid main() {\\n\\n\\t\\t\\t\\t\\tvec3 direction = normalize( vWorldDirection );\\n\\n\\t\\t\\t\\t\\tvec2 sampleUV = equirectUv( direction );\\n\\n\\t\\t\\t\\t\\tgl_FragColor = texture2D( tEquirect, sampleUV );\\n\\n\\t\\t\\t\\t}\\n\\t\\t\\t\"},i=new po(5,5,5),r=new vo({name:\"CubemapFromEquirect\",uniforms:fo(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:m,blending:b});r.uniforms.tEquirect.value=e;const o=new uo(i,r),a=e.minFilter;e.minFilter===wt&&(e.minFilter=bt);return new _o(1,10,this).update(t,o),e.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(t,e,n,i){const r=t.getRenderTarget();for(let r=0;r<6;r++)t.setRenderTarget(this,r),t.clear(e,n,i);t.setRenderTarget(r)}}function So(t,e,n,i,r,o,a,s,c,l,d,u){Vn.call(this,null,o,a,s,c,l,i,r,d,u),this.image={data:t||null,width:e||1,height:n||1},this.magFilter=void 0!==c?c:ft,this.minFilter=void 0!==l?l:ft,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}So.prototype=Object.create(Vn.prototype),So.prototype.constructor=So,So.prototype.isDataTexture=!0;const Mo=new gi,Eo=new Zn;class To{constructor(t,e,n,i,r,o){this.planes=[void 0!==t?t:new tr,void 0!==e?e:new tr,void 0!==n?n:new tr,void 0!==i?i:new tr,void 0!==r?r:new tr,void 0!==o?o:new tr]}set(t,e,n,i,r,o){const a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(i),a[4].copy(r),a[5].copy(o),this}clone(){return(new this.constructor).copy(this)}copy(t){const e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t){const e=this.planes,n=t.elements,i=n[0],r=n[1],o=n[2],a=n[3],s=n[4],c=n[5],l=n[6],d=n[7],u=n[8],h=n[9],p=n[10],f=n[11],m=n[12],g=n[13],v=n[14],y=n[15];return e[0].setComponents(a-i,d-s,f-u,y-m).normalize(),e[1].setComponents(a+i,d+s,f+u,y+m).normalize(),e[2].setComponents(a+r,d+c,f+h,y+g).normalize(),e[3].setComponents(a-r,d-c,f-h,y-g).normalize(),e[4].setComponents(a-o,d-l,f-p,y-v).normalize(),e[5].setComponents(a+o,d+l,f+p,y+v).normalize(),this}intersectsObject(t){const e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),Mo.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Mo)}intersectsSprite(t){return Mo.center.set(0,0,0),Mo.radius=.7071067811865476,Mo.applyMatrix4(t.matrixWorld),this.intersectsSphere(Mo)}intersectsSphere(t){const e=this.planes,n=t.center,i=-t.radius;for(let t=0;t<6;t++){if(e[t].distanceToPoint(n)<i)return!1}return!0}intersectsBox(t){const e=this.planes;for(let n=0;n<6;n++){const i=e[n];if(Eo.x=i.normal.x>0?t.max.x:t.min.x,Eo.y=i.normal.y>0?t.max.y:t.min.y,Eo.z=i.normal.z>0?t.max.z:t.min.z,i.distanceToPoint(Eo)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}}function Co(){let t=null,e=!1,n=null,i=null;function r(e,o){n(e,o),i=t.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==n&&(i=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(t){n=t},setContext:function(e){t=e}}}function Ao(t,e){const n=e.isWebGL2,i=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),i.get(t)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);const n=i.get(e);n&&(t.deleteBuffer(n.buffer),i.delete(e))},update:function(e,r){if(e.isGLBufferAttribute){const t=i.get(e);return void((!t||t.version<e.version)&&i.set(e,{buffer:e.buffer,type:e.type,bytesPerElement:e.elementSize,version:e.version}))}e.isInterleavedBufferAttribute&&(e=e.data);const o=i.get(e);void 0===o?i.set(e,function(e,i){const r=e.array,o=e.usage,a=t.createBuffer();t.bindBuffer(i,a),t.bufferData(i,r,o),e.onUploadCallback();let s=5126;return r instanceof Float32Array?s=5126:r instanceof Float64Array?console.warn(\"THREE.WebGLAttributes: Unsupported data buffer format: Float64Array.\"):r instanceof Uint16Array?e.isFloat16BufferAttribute?n?s=5131:console.warn(\"THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.\"):s=5123:r instanceof Int16Array?s=5122:r instanceof Uint32Array?s=5125:r instanceof Int32Array?s=5124:r instanceof Int8Array?s=5120:r instanceof Uint8Array&&(s=5121),{buffer:a,type:s,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version}}(e,r)):o.version<e.version&&(!function(e,i,r){const o=i.array,a=i.updateRange;t.bindBuffer(r,e),-1===a.count?t.bufferSubData(r,0,o):(n?t.bufferSubData(r,a.offset*o.BYTES_PER_ELEMENT,o,a.offset,a.count):t.bufferSubData(r,a.offset*o.BYTES_PER_ELEMENT,o.subarray(a.offset,a.offset+a.count)),a.count=-1)}(o.buffer,e,r),o.version=e.version)}}}class Oo extends Wr{constructor(t=1,e=1,n=1,i=1){super(),this.type=\"PlaneGeometry\",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i};const r=t/2,o=e/2,a=Math.floor(n),s=Math.floor(i),c=a+1,l=s+1,d=t/a,u=e/s,h=[],p=[],f=[],m=[];for(let t=0;t<l;t++){const e=t*u-o;for(let n=0;n<c;n++){const i=n*d-r;p.push(i,-e,0),f.push(0,0,1),m.push(n/a),m.push(1-t/s)}}for(let t=0;t<s;t++)for(let e=0;e<a;e++){const n=e+c*t,i=e+c*(t+1),r=e+1+c*(t+1),o=e+1+c*t;h.push(n,i,o),h.push(i,r,o)}this.setIndex(h),this.setAttribute(\"position\",new Pr(p,3)),this.setAttribute(\"normal\",new Pr(f,3)),this.setAttribute(\"uv\",new Pr(m,2))}}const ko={alphamap_fragment:\"#ifdef USE_ALPHAMAP\\n\\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\\n#endif\",alphamap_pars_fragment:\"#ifdef USE_ALPHAMAP\\n\\tuniform sampler2D alphaMap;\\n#endif\",alphatest_fragment:\"#ifdef ALPHATEST\\n\\tif ( diffuseColor.a < ALPHATEST ) discard;\\n#endif\",aomap_fragment:\"#ifdef USE_AOMAP\\n\\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\\n\\treflectedLight.indirectDiffuse *= ambientOcclusion;\\n\\t#if defined( USE_ENVMAP ) && defined( STANDARD )\\n\\t\\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\\n\\t\\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\\n\\t#endif\\n#endif\",aomap_pars_fragment:\"#ifdef USE_AOMAP\\n\\tuniform sampler2D aoMap;\\n\\tuniform float aoMapIntensity;\\n#endif\",begin_vertex:\"vec3 transformed = vec3( position );\",beginnormal_vertex:\"vec3 objectNormal = vec3( normal );\\n#ifdef USE_TANGENT\\n\\tvec3 objectTangent = vec3( tangent.xyz );\\n#endif\",bsdfs:\"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\\n\\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\\n\\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\\n\\tvec4 r = roughness * c0 + c1;\\n\\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\\n\\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\\n}\\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\\n\\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\\n\\tif( cutoffDistance > 0.0 ) {\\n\\t\\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\\n\\t}\\n\\treturn distanceFalloff;\\n#else\\n\\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\\n\\t\\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\\n\\t}\\n\\treturn 1.0;\\n#endif\\n}\\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\\n\\treturn RECIPROCAL_PI * diffuseColor;\\n}\\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\\n\\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\\n\\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\\n}\\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\\n\\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\\n\\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\\n\\treturn Fr * fresnel + F0;\\n}\\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\\n\\tfloat a2 = pow2( alpha );\\n\\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\\n\\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\\n\\treturn 1.0 / ( gl * gv );\\n}\\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\\n\\tfloat a2 = pow2( alpha );\\n\\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\\n\\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\\n\\treturn 0.5 / max( gv + gl, EPSILON );\\n}\\nfloat D_GGX( const in float alpha, const in float dotNH ) {\\n\\tfloat a2 = pow2( alpha );\\n\\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\\n\\treturn RECIPROCAL_PI * a2 / pow2( denom );\\n}\\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\\n\\tfloat alpha = pow2( roughness );\\n\\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\\n\\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\\n\\tfloat dotNV = saturate( dot( normal, viewDir ) );\\n\\tfloat dotNH = saturate( dot( normal, halfDir ) );\\n\\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\\n\\tvec3 F = F_Schlick( specularColor, dotLH );\\n\\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\\n\\tfloat D = D_GGX( alpha, dotNH );\\n\\treturn F * ( G * D );\\n}\\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\\n\\tconst float LUT_SIZE = 64.0;\\n\\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\\n\\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\\n\\tfloat dotNV = saturate( dot( N, V ) );\\n\\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\\n\\tuv = uv * LUT_SCALE + LUT_BIAS;\\n\\treturn uv;\\n}\\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\\n\\tfloat l = length( f );\\n\\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\\n}\\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\\n\\tfloat x = dot( v1, v2 );\\n\\tfloat y = abs( x );\\n\\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\\n\\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\\n\\tfloat v = a / b;\\n\\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\\n\\treturn cross( v1, v2 ) * theta_sintheta;\\n}\\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\\n\\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\\n\\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\\n\\tvec3 lightNormal = cross( v1, v2 );\\n\\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\\n\\tvec3 T1, T2;\\n\\tT1 = normalize( V - N * dot( V, N ) );\\n\\tT2 = - cross( N, T1 );\\n\\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\\n\\tvec3 coords[ 4 ];\\n\\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\\n\\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\\n\\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\\n\\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\\n\\tcoords[ 0 ] = normalize( coords[ 0 ] );\\n\\tcoords[ 1 ] = normalize( coords[ 1 ] );\\n\\tcoords[ 2 ] = normalize( coords[ 2 ] );\\n\\tcoords[ 3 ] = normalize( coords[ 3 ] );\\n\\tvec3 vectorFormFactor = vec3( 0.0 );\\n\\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\\n\\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\\n\\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\\n\\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\\n\\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\\n\\treturn vec3( result );\\n}\\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\\n\\tfloat dotNV = saturate( dot( normal, viewDir ) );\\n\\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\\n\\treturn specularColor * brdf.x + brdf.y;\\n}\\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\\n\\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\\n\\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\\n\\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\\n\\tvec3 FssEss = F * brdf.x + brdf.y;\\n\\tfloat Ess = brdf.x + brdf.y;\\n\\tfloat Ems = 1.0 - Ess;\\n\\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\\n\\tsingleScatter += FssEss;\\n\\tmultiScatter += Fms * Ems;\\n}\\nfloat G_BlinnPhong_Implicit( ) {\\n\\treturn 0.25;\\n}\\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\\n\\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\\n}\\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\\n\\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\\n\\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\\n\\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\\n\\tvec3 F = F_Schlick( specularColor, dotLH );\\n\\tfloat G = G_BlinnPhong_Implicit( );\\n\\tfloat D = D_BlinnPhong( shininess, dotNH );\\n\\treturn F * ( G * D );\\n}\\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\\n\\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\\n}\\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\\n\\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\\n}\\n#if defined( USE_SHEEN )\\nfloat D_Charlie(float roughness, float NoH) {\\n\\tfloat invAlpha = 1.0 / roughness;\\n\\tfloat cos2h = NoH * NoH;\\n\\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\\n}\\nfloat V_Neubelt(float NoV, float NoL) {\\n\\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\\n}\\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\\n\\tvec3 N = geometry.normal;\\n\\tvec3 V = geometry.viewDir;\\n\\tvec3 H = normalize( V + L );\\n\\tfloat dotNH = saturate( dot( N, H ) );\\n\\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\\n}\\n#endif\",bumpmap_pars_fragment:\"#ifdef USE_BUMPMAP\\n\\tuniform sampler2D bumpMap;\\n\\tuniform float bumpScale;\\n\\tvec2 dHdxy_fwd() {\\n\\t\\tvec2 dSTdx = dFdx( vUv );\\n\\t\\tvec2 dSTdy = dFdy( vUv );\\n\\t\\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\\n\\t\\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\\n\\t\\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\\n\\t\\treturn vec2( dBx, dBy );\\n\\t}\\n\\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\\n\\t\\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\\n\\t\\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\\n\\t\\tvec3 vN = surf_norm;\\n\\t\\tvec3 R1 = cross( vSigmaY, vN );\\n\\t\\tvec3 R2 = cross( vN, vSigmaX );\\n\\t\\tfloat fDet = dot( vSigmaX, R1 );\\n\\t\\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\\t\\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\\n\\t\\treturn normalize( abs( fDet ) * surf_norm - vGrad );\\n\\t}\\n#endif\",clipping_planes_fragment:\"#if NUM_CLIPPING_PLANES > 0\\n\\tvec4 plane;\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\\n\\t\\tplane = clippingPlanes[ i ];\\n\\t\\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\\n\\t}\\n\\t#pragma unroll_loop_end\\n\\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\\n\\t\\tbool clipped = true;\\n\\t\\t#pragma unroll_loop_start\\n\\t\\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\\n\\t\\t\\tplane = clippingPlanes[ i ];\\n\\t\\t\\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\\n\\t\\t}\\n\\t\\t#pragma unroll_loop_end\\n\\t\\tif ( clipped ) discard;\\n\\t#endif\\n#endif\",clipping_planes_pars_fragment:\"#if NUM_CLIPPING_PLANES > 0\\n\\tvarying vec3 vClipPosition;\\n\\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\\n#endif\",clipping_planes_pars_vertex:\"#if NUM_CLIPPING_PLANES > 0\\n\\tvarying vec3 vClipPosition;\\n#endif\",clipping_planes_vertex:\"#if NUM_CLIPPING_PLANES > 0\\n\\tvClipPosition = - mvPosition.xyz;\\n#endif\",color_fragment:\"#ifdef USE_COLOR\\n\\tdiffuseColor.rgb *= vColor;\\n#endif\",color_pars_fragment:\"#ifdef USE_COLOR\\n\\tvarying vec3 vColor;\\n#endif\",color_pars_vertex:\"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\\n\\tvarying vec3 vColor;\\n#endif\",color_vertex:\"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\\n\\tvColor = vec3( 1.0 );\\n#endif\\n#ifdef USE_COLOR\\n\\tvColor.xyz *= color.xyz;\\n#endif\\n#ifdef USE_INSTANCING_COLOR\\n\\tvColor.xyz *= instanceColor.xyz;\\n#endif\",common:\"#define PI 3.141592653589793\\n#define PI2 6.283185307179586\\n#define PI_HALF 1.5707963267948966\\n#define RECIPROCAL_PI 0.3183098861837907\\n#define RECIPROCAL_PI2 0.15915494309189535\\n#define EPSILON 1e-6\\n#ifndef saturate\\n#define saturate(a) clamp( a, 0.0, 1.0 )\\n#endif\\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\\nfloat pow2( const in float x ) { return x*x; }\\nfloat pow3( const in float x ) { return x*x*x; }\\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\\nhighp float rand( const in vec2 uv ) {\\n\\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\\n\\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\\n\\treturn fract(sin(sn) * c);\\n}\\n#ifdef HIGH_PRECISION\\n\\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\\n#else\\n\\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\\n\\tfloat precisionSafeLength( vec3 v ) {\\n\\t\\tfloat maxComponent = max3( abs( v ) );\\n\\t\\treturn length( v / maxComponent ) * maxComponent;\\n\\t}\\n#endif\\nstruct IncidentLight {\\n\\tvec3 color;\\n\\tvec3 direction;\\n\\tbool visible;\\n};\\nstruct ReflectedLight {\\n\\tvec3 directDiffuse;\\n\\tvec3 directSpecular;\\n\\tvec3 indirectDiffuse;\\n\\tvec3 indirectSpecular;\\n};\\nstruct GeometricContext {\\n\\tvec3 position;\\n\\tvec3 normal;\\n\\tvec3 viewDir;\\n#ifdef CLEARCOAT\\n\\tvec3 clearcoatNormal;\\n#endif\\n};\\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\\n\\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\\n}\\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\\n\\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\\n}\\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\\tfloat distance = dot( planeNormal, point - pointOnPlane );\\n\\treturn - distance * planeNormal + point;\\n}\\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\\treturn sign( dot( point - pointOnPlane, planeNormal ) );\\n}\\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\\n}\\nmat3 transposeMat3( const in mat3 m ) {\\n\\tmat3 tmp;\\n\\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\\n\\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\\n\\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\\n\\treturn tmp;\\n}\\nfloat linearToRelativeLuminance( const in vec3 color ) {\\n\\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\\n\\treturn dot( weights, color.rgb );\\n}\\nbool isPerspectiveMatrix( mat4 m ) {\\n\\treturn m[ 2 ][ 3 ] == - 1.0;\\n}\\nvec2 equirectUv( in vec3 dir ) {\\n\\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\\n\\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\\n\\treturn vec2( u, v );\\n}\",cube_uv_reflection_fragment:\"#ifdef ENVMAP_TYPE_CUBE_UV\\n\\t#define cubeUV_maxMipLevel 8.0\\n\\t#define cubeUV_minMipLevel 4.0\\n\\t#define cubeUV_maxTileSize 256.0\\n\\t#define cubeUV_minTileSize 16.0\\n\\tfloat getFace( vec3 direction ) {\\n\\t\\tvec3 absDirection = abs( direction );\\n\\t\\tfloat face = - 1.0;\\n\\t\\tif ( absDirection.x > absDirection.z ) {\\n\\t\\t\\tif ( absDirection.x > absDirection.y )\\n\\t\\t\\t\\tface = direction.x > 0.0 ? 0.0 : 3.0;\\n\\t\\t\\telse\\n\\t\\t\\t\\tface = direction.y > 0.0 ? 1.0 : 4.0;\\n\\t\\t} else {\\n\\t\\t\\tif ( absDirection.z > absDirection.y )\\n\\t\\t\\t\\tface = direction.z > 0.0 ? 2.0 : 5.0;\\n\\t\\t\\telse\\n\\t\\t\\t\\tface = direction.y > 0.0 ? 1.0 : 4.0;\\n\\t\\t}\\n\\t\\treturn face;\\n\\t}\\n\\tvec2 getUV( vec3 direction, float face ) {\\n\\t\\tvec2 uv;\\n\\t\\tif ( face == 0.0 ) {\\n\\t\\t\\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\\n\\t\\t} else if ( face == 1.0 ) {\\n\\t\\t\\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\\n\\t\\t} else if ( face == 2.0 ) {\\n\\t\\t\\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\\n\\t\\t} else if ( face == 3.0 ) {\\n\\t\\t\\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\\n\\t\\t} else if ( face == 4.0 ) {\\n\\t\\t\\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\\n\\t\\t} else {\\n\\t\\t\\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\\n\\t\\t}\\n\\t\\treturn 0.5 * ( uv + 1.0 );\\n\\t}\\n\\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\\n\\t\\tfloat face = getFace( direction );\\n\\t\\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\\n\\t\\tmipInt = max( mipInt, cubeUV_minMipLevel );\\n\\t\\tfloat faceSize = exp2( mipInt );\\n\\t\\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\\n\\t\\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\\n\\t\\tvec2 f = fract( uv );\\n\\t\\tuv += 0.5 - f;\\n\\t\\tif ( face > 2.0 ) {\\n\\t\\t\\tuv.y += faceSize;\\n\\t\\t\\tface -= 3.0;\\n\\t\\t}\\n\\t\\tuv.x += face * faceSize;\\n\\t\\tif ( mipInt < cubeUV_maxMipLevel ) {\\n\\t\\t\\tuv.y += 2.0 * cubeUV_maxTileSize;\\n\\t\\t}\\n\\t\\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\\n\\t\\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\\n\\t\\tuv *= texelSize;\\n\\t\\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\\n\\t\\tuv.x += texelSize;\\n\\t\\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\\n\\t\\tuv.y += texelSize;\\n\\t\\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\\n\\t\\tuv.x -= texelSize;\\n\\t\\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\\n\\t\\tvec3 tm = mix( tl, tr, f.x );\\n\\t\\tvec3 bm = mix( bl, br, f.x );\\n\\t\\treturn mix( tm, bm, f.y );\\n\\t}\\n\\t#define r0 1.0\\n\\t#define v0 0.339\\n\\t#define m0 - 2.0\\n\\t#define r1 0.8\\n\\t#define v1 0.276\\n\\t#define m1 - 1.0\\n\\t#define r4 0.4\\n\\t#define v4 0.046\\n\\t#define m4 2.0\\n\\t#define r5 0.305\\n\\t#define v5 0.016\\n\\t#define m5 3.0\\n\\t#define r6 0.21\\n\\t#define v6 0.0038\\n\\t#define m6 4.0\\n\\tfloat roughnessToMip( float roughness ) {\\n\\t\\tfloat mip = 0.0;\\n\\t\\tif ( roughness >= r1 ) {\\n\\t\\t\\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\\n\\t\\t} else if ( roughness >= r4 ) {\\n\\t\\t\\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\\n\\t\\t} else if ( roughness >= r5 ) {\\n\\t\\t\\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\\n\\t\\t} else if ( roughness >= r6 ) {\\n\\t\\t\\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\\n\\t\\t} else {\\n\\t\\t\\tmip = - 2.0 * log2( 1.16 * roughness );\\t\\t}\\n\\t\\treturn mip;\\n\\t}\\n\\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\\n\\t\\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\\n\\t\\tfloat mipF = fract( mip );\\n\\t\\tfloat mipInt = floor( mip );\\n\\t\\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\\n\\t\\tif ( mipF == 0.0 ) {\\n\\t\\t\\treturn vec4( color0, 1.0 );\\n\\t\\t} else {\\n\\t\\t\\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\\n\\t\\t\\treturn vec4( mix( color0, color1, mipF ), 1.0 );\\n\\t\\t}\\n\\t}\\n#endif\",defaultnormal_vertex:\"vec3 transformedNormal = objectNormal;\\n#ifdef USE_INSTANCING\\n\\tmat3 m = mat3( instanceMatrix );\\n\\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\\n\\ttransformedNormal = m * transformedNormal;\\n#endif\\ntransformedNormal = normalMatrix * transformedNormal;\\n#ifdef FLIP_SIDED\\n\\ttransformedNormal = - transformedNormal;\\n#endif\\n#ifdef USE_TANGENT\\n\\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\\n\\t#ifdef FLIP_SIDED\\n\\t\\ttransformedTangent = - transformedTangent;\\n\\t#endif\\n#endif\",displacementmap_pars_vertex:\"#ifdef USE_DISPLACEMENTMAP\\n\\tuniform sampler2D displacementMap;\\n\\tuniform float displacementScale;\\n\\tuniform float displacementBias;\\n#endif\",displacementmap_vertex:\"#ifdef USE_DISPLACEMENTMAP\\n\\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\\n#endif\",emissivemap_fragment:\"#ifdef USE_EMISSIVEMAP\\n\\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\\n\\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\\n\\ttotalEmissiveRadiance *= emissiveColor.rgb;\\n#endif\",emissivemap_pars_fragment:\"#ifdef USE_EMISSIVEMAP\\n\\tuniform sampler2D emissiveMap;\\n#endif\",encodings_fragment:\"gl_FragColor = linearToOutputTexel( gl_FragColor );\",encodings_pars_fragment:\"\\nvec4 LinearToLinear( in vec4 value ) {\\n\\treturn value;\\n}\\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\\n\\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\\n}\\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\\n\\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\\n}\\nvec4 sRGBToLinear( in vec4 value ) {\\n\\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\\n}\\nvec4 LinearTosRGB( in vec4 value ) {\\n\\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\\n}\\nvec4 RGBEToLinear( in vec4 value ) {\\n\\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\\n}\\nvec4 LinearToRGBE( in vec4 value ) {\\n\\tfloat maxComponent = max( max( value.r, value.g ), value.b );\\n\\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\\n\\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\\n}\\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\\n\\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\\n}\\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\\n\\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\\n\\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\\n\\tM = ceil( M * 255.0 ) / 255.0;\\n\\treturn vec4( value.rgb / ( M * maxRange ), M );\\n}\\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\\n\\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\\n}\\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\\n\\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\\n\\tfloat D = max( maxRange / maxRGB, 1.0 );\\n\\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\\n\\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\\n}\\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\\nvec4 LinearToLogLuv( in vec4 value ) {\\n\\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\\n\\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\\n\\tvec4 vResult;\\n\\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\\n\\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\\n\\tvResult.w = fract( Le );\\n\\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\\n\\treturn vResult;\\n}\\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\\nvec4 LogLuvToLinear( in vec4 value ) {\\n\\tfloat Le = value.z * 255.0 + value.w;\\n\\tvec3 Xp_Y_XYZp;\\n\\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\\n\\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\\n\\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\\n\\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\\n\\treturn vec4( max( vRGB, 0.0 ), 1.0 );\\n}\",envmap_fragment:\"#ifdef USE_ENVMAP\\n\\t#ifdef ENV_WORLDPOS\\n\\t\\tvec3 cameraToFrag;\\n\\t\\tif ( isOrthographic ) {\\n\\t\\t\\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\\n\\t\\t} else {\\n\\t\\t\\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\\n\\t\\t}\\n\\t\\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\\n\\t\\t#ifdef ENVMAP_MODE_REFLECTION\\n\\t\\t\\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\\n\\t\\t#else\\n\\t\\t\\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\\n\\t\\t#endif\\n\\t#else\\n\\t\\tvec3 reflectVec = vReflect;\\n\\t#endif\\n\\t#ifdef ENVMAP_TYPE_CUBE\\n\\t\\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\\n\\t#elif defined( ENVMAP_TYPE_CUBE_UV )\\n\\t\\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\\n\\t#else\\n\\t\\tvec4 envColor = vec4( 0.0 );\\n\\t#endif\\n\\t#ifndef ENVMAP_TYPE_CUBE_UV\\n\\t\\tenvColor = envMapTexelToLinear( envColor );\\n\\t#endif\\n\\t#ifdef ENVMAP_BLENDING_MULTIPLY\\n\\t\\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\\n\\t#elif defined( ENVMAP_BLENDING_MIX )\\n\\t\\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\\n\\t#elif defined( ENVMAP_BLENDING_ADD )\\n\\t\\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\\n\\t#endif\\n#endif\",envmap_common_pars_fragment:\"#ifdef USE_ENVMAP\\n\\tuniform float envMapIntensity;\\n\\tuniform float flipEnvMap;\\n\\tuniform int maxMipLevel;\\n\\t#ifdef ENVMAP_TYPE_CUBE\\n\\t\\tuniform samplerCube envMap;\\n\\t#else\\n\\t\\tuniform sampler2D envMap;\\n\\t#endif\\n\\t\\n#endif\",envmap_pars_fragment:\"#ifdef USE_ENVMAP\\n\\tuniform float reflectivity;\\n\\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\\t\\t#define ENV_WORLDPOS\\n\\t#endif\\n\\t#ifdef ENV_WORLDPOS\\n\\t\\tvarying vec3 vWorldPosition;\\n\\t\\tuniform float refractionRatio;\\n\\t#else\\n\\t\\tvarying vec3 vReflect;\\n\\t#endif\\n#endif\",envmap_pars_vertex:\"#ifdef USE_ENVMAP\\n\\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\\n\\t\\t#define ENV_WORLDPOS\\n\\t#endif\\n\\t#ifdef ENV_WORLDPOS\\n\\t\\t\\n\\t\\tvarying vec3 vWorldPosition;\\n\\t#else\\n\\t\\tvarying vec3 vReflect;\\n\\t\\tuniform float refractionRatio;\\n\\t#endif\\n#endif\",envmap_physical_pars_fragment:\"#if defined( USE_ENVMAP )\\n\\t#ifdef ENVMAP_MODE_REFRACTION\\n\\t\\tuniform float refractionRatio;\\n\\t#endif\\n\\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\\n\\t\\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\\n\\t\\t#ifdef ENVMAP_TYPE_CUBE\\n\\t\\t\\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\\n\\t\\t\\t#ifdef TEXTURE_LOD_EXT\\n\\t\\t\\t\\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\\n\\t\\t\\t#else\\n\\t\\t\\t\\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\\n\\t\\t\\t#endif\\n\\t\\t\\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\\n\\t\\t#elif defined( ENVMAP_TYPE_CUBE_UV )\\n\\t\\t\\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\\n\\t\\t#else\\n\\t\\t\\tvec4 envMapColor = vec4( 0.0 );\\n\\t\\t#endif\\n\\t\\treturn PI * envMapColor.rgb * envMapIntensity;\\n\\t}\\n\\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\\n\\t\\tfloat maxMIPLevelScalar = float( maxMIPLevel );\\n\\t\\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\\n\\t\\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\\n\\t\\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\\n\\t}\\n\\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\\n\\t\\t#ifdef ENVMAP_MODE_REFLECTION\\n\\t\\t\\tvec3 reflectVec = reflect( -viewDir, normal );\\n\\t\\t\\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\\n\\t\\t#else\\n\\t\\t\\tvec3 reflectVec = refract( -viewDir, normal, refractionRatio );\\n\\t\\t#endif\\n\\t\\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\\n\\t\\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\\n\\t\\t#ifdef ENVMAP_TYPE_CUBE\\n\\t\\t\\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\\n\\t\\t\\t#ifdef TEXTURE_LOD_EXT\\n\\t\\t\\t\\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\\n\\t\\t\\t#else\\n\\t\\t\\t\\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\\n\\t\\t\\t#endif\\n\\t\\t\\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\\n\\t\\t#elif defined( ENVMAP_TYPE_CUBE_UV )\\n\\t\\t\\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\\n\\t\\t#endif\\n\\t\\treturn envMapColor.rgb * envMapIntensity;\\n\\t}\\n#endif\",envmap_vertex:\"#ifdef USE_ENVMAP\\n\\t#ifdef ENV_WORLDPOS\\n\\t\\tvWorldPosition = worldPosition.xyz;\\n\\t#else\\n\\t\\tvec3 cameraToVertex;\\n\\t\\tif ( isOrthographic ) {\\n\\t\\t\\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\\n\\t\\t} else {\\n\\t\\t\\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\\n\\t\\t}\\n\\t\\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\\n\\t\\t#ifdef ENVMAP_MODE_REFLECTION\\n\\t\\t\\tvReflect = reflect( cameraToVertex, worldNormal );\\n\\t\\t#else\\n\\t\\t\\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\\n\\t\\t#endif\\n\\t#endif\\n#endif\",fog_vertex:\"#ifdef USE_FOG\\n\\tfogDepth = - mvPosition.z;\\n#endif\",fog_pars_vertex:\"#ifdef USE_FOG\\n\\tvarying float fogDepth;\\n#endif\",fog_fragment:\"#ifdef USE_FOG\\n\\t#ifdef FOG_EXP2\\n\\t\\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\\n\\t#else\\n\\t\\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\\n\\t#endif\\n\\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\\n#endif\",fog_pars_fragment:\"#ifdef USE_FOG\\n\\tuniform vec3 fogColor;\\n\\tvarying float fogDepth;\\n\\t#ifdef FOG_EXP2\\n\\t\\tuniform float fogDensity;\\n\\t#else\\n\\t\\tuniform float fogNear;\\n\\t\\tuniform float fogFar;\\n\\t#endif\\n#endif\",gradientmap_pars_fragment:\"#ifdef USE_GRADIENTMAP\\n\\tuniform sampler2D gradientMap;\\n#endif\\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\\n\\tfloat dotNL = dot( normal, lightDirection );\\n\\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\\n\\t#ifdef USE_GRADIENTMAP\\n\\t\\treturn texture2D( gradientMap, coord ).rgb;\\n\\t#else\\n\\t\\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\\n\\t#endif\\n}\",lightmap_fragment:\"#ifdef USE_LIGHTMAP\\n\\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\\n\\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\\n#endif\",lightmap_pars_fragment:\"#ifdef USE_LIGHTMAP\\n\\tuniform sampler2D lightMap;\\n\\tuniform float lightMapIntensity;\\n#endif\",lights_lambert_vertex:\"vec3 diffuse = vec3( 1.0 );\\nGeometricContext geometry;\\ngeometry.position = mvPosition.xyz;\\ngeometry.normal = normalize( transformedNormal );\\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\\nGeometricContext backGeometry;\\nbackGeometry.position = geometry.position;\\nbackGeometry.normal = -geometry.normal;\\nbackGeometry.viewDir = geometry.viewDir;\\nvLightFront = vec3( 0.0 );\\nvIndirectFront = vec3( 0.0 );\\n#ifdef DOUBLE_SIDED\\n\\tvLightBack = vec3( 0.0 );\\n\\tvIndirectBack = vec3( 0.0 );\\n#endif\\nIncidentLight directLight;\\nfloat dotNL;\\nvec3 directLightColor_Diffuse;\\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\\n#ifdef DOUBLE_SIDED\\n\\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\\n\\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\\n#endif\\n#if NUM_POINT_LIGHTS > 0\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\n\\t\\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\\n\\t\\tdotNL = dot( geometry.normal, directLight.direction );\\n\\t\\tdirectLightColor_Diffuse = PI * directLight.color;\\n\\t\\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\t\\t\\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\\n\\t\\t#endif\\n\\t}\\n\\t#pragma unroll_loop_end\\n#endif\\n#if NUM_SPOT_LIGHTS > 0\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\n\\t\\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\\n\\t\\tdotNL = dot( geometry.normal, directLight.direction );\\n\\t\\tdirectLightColor_Diffuse = PI * directLight.color;\\n\\t\\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\t\\t\\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\\n\\t\\t#endif\\n\\t}\\n\\t#pragma unroll_loop_end\\n#endif\\n#if NUM_DIR_LIGHTS > 0\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\n\\t\\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\\n\\t\\tdotNL = dot( geometry.normal, directLight.direction );\\n\\t\\tdirectLightColor_Diffuse = PI * directLight.color;\\n\\t\\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\t\\t\\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\\n\\t\\t#endif\\n\\t}\\n\\t#pragma unroll_loop_end\\n#endif\\n#if NUM_HEMI_LIGHTS > 0\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\\n\\t\\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\t\\t\\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\\n\\t\\t#endif\\n\\t}\\n\\t#pragma unroll_loop_end\\n#endif\",lights_pars_begin:\"uniform bool receiveShadow;\\nuniform vec3 ambientLightColor;\\nuniform vec3 lightProbe[ 9 ];\\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\\n\\tfloat x = normal.x, y = normal.y, z = normal.z;\\n\\tvec3 result = shCoefficients[ 0 ] * 0.886227;\\n\\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\\n\\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\\n\\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\\n\\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\\n\\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\\n\\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\\n\\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\\n\\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\\n\\treturn result;\\n}\\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\\n\\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\\n\\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\\n\\treturn irradiance;\\n}\\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\\n\\tvec3 irradiance = ambientLightColor;\\n\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\\t\\tirradiance *= PI;\\n\\t#endif\\n\\treturn irradiance;\\n}\\n#if NUM_DIR_LIGHTS > 0\\n\\tstruct DirectionalLight {\\n\\t\\tvec3 direction;\\n\\t\\tvec3 color;\\n\\t};\\n\\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\\n\\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\\n\\t\\tdirectLight.color = directionalLight.color;\\n\\t\\tdirectLight.direction = directionalLight.direction;\\n\\t\\tdirectLight.visible = true;\\n\\t}\\n#endif\\n#if NUM_POINT_LIGHTS > 0\\n\\tstruct PointLight {\\n\\t\\tvec3 position;\\n\\t\\tvec3 color;\\n\\t\\tfloat distance;\\n\\t\\tfloat decay;\\n\\t};\\n\\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\\n\\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\\n\\t\\tvec3 lVector = pointLight.position - geometry.position;\\n\\t\\tdirectLight.direction = normalize( lVector );\\n\\t\\tfloat lightDistance = length( lVector );\\n\\t\\tdirectLight.color = pointLight.color;\\n\\t\\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\\n\\t\\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\\n\\t}\\n#endif\\n#if NUM_SPOT_LIGHTS > 0\\n\\tstruct SpotLight {\\n\\t\\tvec3 position;\\n\\t\\tvec3 direction;\\n\\t\\tvec3 color;\\n\\t\\tfloat distance;\\n\\t\\tfloat decay;\\n\\t\\tfloat coneCos;\\n\\t\\tfloat penumbraCos;\\n\\t};\\n\\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\\n\\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {\\n\\t\\tvec3 lVector = spotLight.position - geometry.position;\\n\\t\\tdirectLight.direction = normalize( lVector );\\n\\t\\tfloat lightDistance = length( lVector );\\n\\t\\tfloat angleCos = dot( directLight.direction, spotLight.direction );\\n\\t\\tif ( angleCos > spotLight.coneCos ) {\\n\\t\\t\\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\\n\\t\\t\\tdirectLight.color = spotLight.color;\\n\\t\\t\\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\\n\\t\\t\\tdirectLight.visible = true;\\n\\t\\t} else {\\n\\t\\t\\tdirectLight.color = vec3( 0.0 );\\n\\t\\t\\tdirectLight.visible = false;\\n\\t\\t}\\n\\t}\\n#endif\\n#if NUM_RECT_AREA_LIGHTS > 0\\n\\tstruct RectAreaLight {\\n\\t\\tvec3 color;\\n\\t\\tvec3 position;\\n\\t\\tvec3 halfWidth;\\n\\t\\tvec3 halfHeight;\\n\\t};\\n\\tuniform sampler2D ltc_1;\\tuniform sampler2D ltc_2;\\n\\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\\n#endif\\n#if NUM_HEMI_LIGHTS > 0\\n\\tstruct HemisphereLight {\\n\\t\\tvec3 direction;\\n\\t\\tvec3 skyColor;\\n\\t\\tvec3 groundColor;\\n\\t};\\n\\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\\n\\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\\n\\t\\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\\n\\t\\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\\n\\t\\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\\n\\t\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\\t\\t\\tirradiance *= PI;\\n\\t\\t#endif\\n\\t\\treturn irradiance;\\n\\t}\\n#endif\",lights_toon_fragment:\"ToonMaterial material;\\nmaterial.diffuseColor = diffuseColor.rgb;\",lights_toon_pars_fragment:\"varying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\nstruct ToonMaterial {\\n\\tvec3 diffuseColor;\\n};\\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\\n\\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\\n\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\\t\\tirradiance *= PI;\\n\\t#endif\\n\\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\n}\\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\\n\\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\n}\\n#define RE_Direct\\t\\t\\t\\tRE_Direct_Toon\\n#define RE_IndirectDiffuse\\t\\tRE_IndirectDiffuse_Toon\\n#define Material_LightProbeLOD( material )\\t(0)\",lights_phong_fragment:\"BlinnPhongMaterial material;\\nmaterial.diffuseColor = diffuseColor.rgb;\\nmaterial.specularColor = specular;\\nmaterial.specularShininess = shininess;\\nmaterial.specularStrength = specularStrength;\",lights_phong_pars_fragment:\"varying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\nstruct BlinnPhongMaterial {\\n\\tvec3 diffuseColor;\\n\\tvec3 specularColor;\\n\\tfloat specularShininess;\\n\\tfloat specularStrength;\\n};\\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\\n\\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\\n\\tvec3 irradiance = dotNL * directLight.color;\\n\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\\t\\tirradiance *= PI;\\n\\t#endif\\n\\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\n\\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\\n}\\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\\n\\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\n}\\n#define RE_Direct\\t\\t\\t\\tRE_Direct_BlinnPhong\\n#define RE_IndirectDiffuse\\t\\tRE_IndirectDiffuse_BlinnPhong\\n#define Material_LightProbeLOD( material )\\t(0)\",lights_physical_fragment:\"PhysicalMaterial material;\\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\\n#ifdef REFLECTIVITY\\n\\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\\n#else\\n\\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\\n#endif\\n#ifdef CLEARCOAT\\n\\tmaterial.clearcoat = clearcoat;\\n\\tmaterial.clearcoatRoughness = clearcoatRoughness;\\n\\t#ifdef USE_CLEARCOATMAP\\n\\t\\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\\n\\t#endif\\n\\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\\n\\t\\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\\n\\t#endif\\n\\tmaterial.clearcoat = saturate( material.clearcoat );\\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\\n\\tmaterial.clearcoatRoughness += geometryRoughness;\\n\\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\\n#endif\\n#ifdef USE_SHEEN\\n\\tmaterial.sheenColor = sheen;\\n#endif\",lights_physical_pars_fragment:\"struct PhysicalMaterial {\\n\\tvec3 diffuseColor;\\n\\tfloat specularRoughness;\\n\\tvec3 specularColor;\\n#ifdef CLEARCOAT\\n\\tfloat clearcoat;\\n\\tfloat clearcoatRoughness;\\n#endif\\n#ifdef USE_SHEEN\\n\\tvec3 sheenColor;\\n#endif\\n};\\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\\n\\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\\n}\\n#if NUM_RECT_AREA_LIGHTS > 0\\n\\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\n\\t\\tvec3 normal = geometry.normal;\\n\\t\\tvec3 viewDir = geometry.viewDir;\\n\\t\\tvec3 position = geometry.position;\\n\\t\\tvec3 lightPos = rectAreaLight.position;\\n\\t\\tvec3 halfWidth = rectAreaLight.halfWidth;\\n\\t\\tvec3 halfHeight = rectAreaLight.halfHeight;\\n\\t\\tvec3 lightColor = rectAreaLight.color;\\n\\t\\tfloat roughness = material.specularRoughness;\\n\\t\\tvec3 rectCoords[ 4 ];\\n\\t\\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\\t\\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\\n\\t\\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\\n\\t\\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\\n\\t\\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\\n\\t\\tvec4 t1 = texture2D( ltc_1, uv );\\n\\t\\tvec4 t2 = texture2D( ltc_2, uv );\\n\\t\\tmat3 mInv = mat3(\\n\\t\\t\\tvec3( t1.x, 0, t1.y ),\\n\\t\\t\\tvec3(    0, 1,    0 ),\\n\\t\\t\\tvec3( t1.z, 0, t1.w )\\n\\t\\t);\\n\\t\\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\\n\\t\\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\\n\\t\\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\\n\\t}\\n#endif\\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\n\\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\\n\\tvec3 irradiance = dotNL * directLight.color;\\n\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\\t\\tirradiance *= PI;\\n\\t#endif\\n\\t#ifdef CLEARCOAT\\n\\t\\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\\n\\t\\tvec3 ccIrradiance = ccDotNL * directLight.color;\\n\\t\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\\t\\t\\tccIrradiance *= PI;\\n\\t\\t#endif\\n\\t\\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\\n\\t\\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\\n\\t#else\\n\\t\\tfloat clearcoatDHR = 0.0;\\n\\t#endif\\n\\t#ifdef USE_SHEEN\\n\\t\\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\\n\\t\\t\\tmaterial.specularRoughness,\\n\\t\\t\\tdirectLight.direction,\\n\\t\\t\\tgeometry,\\n\\t\\t\\tmaterial.sheenColor\\n\\t\\t);\\n\\t#else\\n\\t\\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\\n\\t#endif\\n\\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\n}\\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\n\\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\n}\\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\\n\\t#ifdef CLEARCOAT\\n\\t\\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\\n\\t\\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\\n\\t\\tfloat ccDotNL = ccDotNV;\\n\\t\\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\\n\\t#else\\n\\t\\tfloat clearcoatDHR = 0.0;\\n\\t#endif\\n\\tfloat clearcoatInv = 1.0 - clearcoatDHR;\\n\\tvec3 singleScattering = vec3( 0.0 );\\n\\tvec3 multiScattering = vec3( 0.0 );\\n\\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\\n\\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\\n\\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\\n\\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\\n\\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\\n\\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\\n}\\n#define RE_Direct\\t\\t\\t\\tRE_Direct_Physical\\n#define RE_Direct_RectArea\\t\\tRE_Direct_RectArea_Physical\\n#define RE_IndirectDiffuse\\t\\tRE_IndirectDiffuse_Physical\\n#define RE_IndirectSpecular\\t\\tRE_IndirectSpecular_Physical\\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\\n\\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\\n}\",lights_fragment_begin:\"\\nGeometricContext geometry;\\ngeometry.position = - vViewPosition;\\ngeometry.normal = normal;\\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\\n#ifdef CLEARCOAT\\n\\tgeometry.clearcoatNormal = clearcoatNormal;\\n#endif\\nIncidentLight directLight;\\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\\n\\tPointLight pointLight;\\n\\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\\n\\tPointLightShadow pointLightShadow;\\n\\t#endif\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\n\\t\\tpointLight = pointLights[ i ];\\n\\t\\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\\n\\t\\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\\n\\t\\tpointLightShadow = pointLightShadows[ i ];\\n\\t\\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\\n\\t\\t#endif\\n\\t\\tRE_Direct( directLight, geometry, material, reflectedLight );\\n\\t}\\n\\t#pragma unroll_loop_end\\n#endif\\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\\n\\tSpotLight spotLight;\\n\\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\\n\\tSpotLightShadow spotLightShadow;\\n\\t#endif\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\n\\t\\tspotLight = spotLights[ i ];\\n\\t\\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\\n\\t\\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\\n\\t\\tspotLightShadow = spotLightShadows[ i ];\\n\\t\\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\\n\\t\\t#endif\\n\\t\\tRE_Direct( directLight, geometry, material, reflectedLight );\\n\\t}\\n\\t#pragma unroll_loop_end\\n#endif\\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\\n\\tDirectionalLight directionalLight;\\n\\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\\n\\tDirectionalLightShadow directionalLightShadow;\\n\\t#endif\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\n\\t\\tdirectionalLight = directionalLights[ i ];\\n\\t\\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\\n\\t\\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\\n\\t\\tdirectionalLightShadow = directionalLightShadows[ i ];\\n\\t\\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\\n\\t\\t#endif\\n\\t\\tRE_Direct( directLight, geometry, material, reflectedLight );\\n\\t}\\n\\t#pragma unroll_loop_end\\n#endif\\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\\n\\tRectAreaLight rectAreaLight;\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\\n\\t\\trectAreaLight = rectAreaLights[ i ];\\n\\t\\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\\n\\t}\\n\\t#pragma unroll_loop_end\\n#endif\\n#if defined( RE_IndirectDiffuse )\\n\\tvec3 iblIrradiance = vec3( 0.0 );\\n\\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\\n\\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\\n\\t#if ( NUM_HEMI_LIGHTS > 0 )\\n\\t\\t#pragma unroll_loop_start\\n\\t\\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\\n\\t\\t\\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\\n\\t\\t}\\n\\t\\t#pragma unroll_loop_end\\n\\t#endif\\n#endif\\n#if defined( RE_IndirectSpecular )\\n\\tvec3 radiance = vec3( 0.0 );\\n\\tvec3 clearcoatRadiance = vec3( 0.0 );\\n#endif\",lights_fragment_maps:\"#if defined( RE_IndirectDiffuse )\\n\\t#ifdef USE_LIGHTMAP\\n\\t\\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\\n\\t\\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\\n\\t\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\\t\\t\\tlightMapIrradiance *= PI;\\n\\t\\t#endif\\n\\t\\tirradiance += lightMapIrradiance;\\n\\t#endif\\n\\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\\n\\t\\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\\n\\t#endif\\n#endif\\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\\n\\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\\n\\t#ifdef CLEARCOAT\\n\\t\\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\\n\\t#endif\\n#endif\",lights_fragment_end:\"#if defined( RE_IndirectDiffuse )\\n\\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\\n#endif\\n#if defined( RE_IndirectSpecular )\\n\\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\\n#endif\",logdepthbuf_fragment:\"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\\n\\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\\n#endif\",logdepthbuf_pars_fragment:\"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\\n\\tuniform float logDepthBufFC;\\n\\tvarying float vFragDepth;\\n\\tvarying float vIsPerspective;\\n#endif\",logdepthbuf_pars_vertex:\"#ifdef USE_LOGDEPTHBUF\\n\\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\t\\tvarying float vFragDepth;\\n\\t\\tvarying float vIsPerspective;\\n\\t#else\\n\\t\\tuniform float logDepthBufFC;\\n\\t#endif\\n#endif\",logdepthbuf_vertex:\"#ifdef USE_LOGDEPTHBUF\\n\\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\t\\tvFragDepth = 1.0 + gl_Position.w;\\n\\t\\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\\n\\t#else\\n\\t\\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\\n\\t\\t\\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\\n\\t\\t\\tgl_Position.z *= gl_Position.w;\\n\\t\\t}\\n\\t#endif\\n#endif\",map_fragment:\"#ifdef USE_MAP\\n\\tvec4 texelColor = texture2D( map, vUv );\\n\\ttexelColor = mapTexelToLinear( texelColor );\\n\\tdiffuseColor *= texelColor;\\n#endif\",map_pars_fragment:\"#ifdef USE_MAP\\n\\tuniform sampler2D map;\\n#endif\",map_particle_fragment:\"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\\n\\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\\n#endif\\n#ifdef USE_MAP\\n\\tvec4 mapTexel = texture2D( map, uv );\\n\\tdiffuseColor *= mapTexelToLinear( mapTexel );\\n#endif\\n#ifdef USE_ALPHAMAP\\n\\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\\n#endif\",map_particle_pars_fragment:\"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\\n\\tuniform mat3 uvTransform;\\n#endif\\n#ifdef USE_MAP\\n\\tuniform sampler2D map;\\n#endif\\n#ifdef USE_ALPHAMAP\\n\\tuniform sampler2D alphaMap;\\n#endif\",metalnessmap_fragment:\"float metalnessFactor = metalness;\\n#ifdef USE_METALNESSMAP\\n\\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\\n\\tmetalnessFactor *= texelMetalness.b;\\n#endif\",metalnessmap_pars_fragment:\"#ifdef USE_METALNESSMAP\\n\\tuniform sampler2D metalnessMap;\\n#endif\",morphnormal_vertex:\"#ifdef USE_MORPHNORMALS\\n\\tobjectNormal *= morphTargetBaseInfluence;\\n\\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\\n\\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\\n\\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\\n\\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\\n#endif\",morphtarget_pars_vertex:\"#ifdef USE_MORPHTARGETS\\n\\tuniform float morphTargetBaseInfluence;\\n\\t#ifndef USE_MORPHNORMALS\\n\\t\\tuniform float morphTargetInfluences[ 8 ];\\n\\t#else\\n\\t\\tuniform float morphTargetInfluences[ 4 ];\\n\\t#endif\\n#endif\",morphtarget_vertex:\"#ifdef USE_MORPHTARGETS\\n\\ttransformed *= morphTargetBaseInfluence;\\n\\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\\n\\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\\n\\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\\n\\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\\n\\t#ifndef USE_MORPHNORMALS\\n\\t\\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\\n\\t\\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\\n\\t\\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\\n\\t\\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\\n\\t#endif\\n#endif\",normal_fragment_begin:\"#ifdef FLAT_SHADED\\n\\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\\n\\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\\n\\tvec3 normal = normalize( cross( fdx, fdy ) );\\n#else\\n\\tvec3 normal = normalize( vNormal );\\n\\t#ifdef DOUBLE_SIDED\\n\\t\\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\\t#endif\\n\\t#ifdef USE_TANGENT\\n\\t\\tvec3 tangent = normalize( vTangent );\\n\\t\\tvec3 bitangent = normalize( vBitangent );\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\t\\t\\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\\t\\t\\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\\t\\t#endif\\n\\t\\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\\n\\t\\t\\tmat3 vTBN = mat3( tangent, bitangent, normal );\\n\\t\\t#endif\\n\\t#endif\\n#endif\\nvec3 geometryNormal = normal;\",normal_fragment_maps:\"#ifdef OBJECTSPACE_NORMALMAP\\n\\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\\n\\t#ifdef FLIP_SIDED\\n\\t\\tnormal = - normal;\\n\\t#endif\\n\\t#ifdef DOUBLE_SIDED\\n\\t\\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\\t#endif\\n\\tnormal = normalize( normalMatrix * normal );\\n#elif defined( TANGENTSPACE_NORMALMAP )\\n\\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\\n\\tmapN.xy *= normalScale;\\n\\t#ifdef USE_TANGENT\\n\\t\\tnormal = normalize( vTBN * mapN );\\n\\t#else\\n\\t\\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\\n\\t#endif\\n#elif defined( USE_BUMPMAP )\\n\\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\\n#endif\",normalmap_pars_fragment:\"#ifdef USE_NORMALMAP\\n\\tuniform sampler2D normalMap;\\n\\tuniform vec2 normalScale;\\n#endif\\n#ifdef OBJECTSPACE_NORMALMAP\\n\\tuniform mat3 normalMatrix;\\n#endif\\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\\n\\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\\n\\t\\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\\n\\t\\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\\n\\t\\tvec2 st0 = dFdx( vUv.st );\\n\\t\\tvec2 st1 = dFdy( vUv.st );\\n\\t\\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\\n\\t\\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\\n\\t\\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\\n\\t\\tvec3 N = normalize( surf_norm );\\n\\t\\tmat3 tsn = mat3( S, T, N );\\n\\t\\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\\t\\treturn normalize( tsn * mapN );\\n\\t}\\n#endif\",clearcoat_normal_fragment_begin:\"#ifdef CLEARCOAT\\n\\tvec3 clearcoatNormal = geometryNormal;\\n#endif\",clearcoat_normal_fragment_maps:\"#ifdef USE_CLEARCOAT_NORMALMAP\\n\\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\\n\\tclearcoatMapN.xy *= clearcoatNormalScale;\\n\\t#ifdef USE_TANGENT\\n\\t\\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\\n\\t#else\\n\\t\\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\\n\\t#endif\\n#endif\",clearcoat_pars_fragment:\"#ifdef USE_CLEARCOATMAP\\n\\tuniform sampler2D clearcoatMap;\\n#endif\\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\\n\\tuniform sampler2D clearcoatRoughnessMap;\\n#endif\\n#ifdef USE_CLEARCOAT_NORMALMAP\\n\\tuniform sampler2D clearcoatNormalMap;\\n\\tuniform vec2 clearcoatNormalScale;\\n#endif\",packing:\"vec3 packNormalToRGB( const in vec3 normal ) {\\n\\treturn normalize( normal ) * 0.5 + 0.5;\\n}\\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\\n\\treturn 2.0 * rgb.xyz - 1.0;\\n}\\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\\nconst float ShiftRight8 = 1. / 256.;\\nvec4 packDepthToRGBA( const in float v ) {\\n\\tvec4 r = vec4( fract( v * PackFactors ), v );\\n\\tr.yzw -= r.xyz * ShiftRight8;\\treturn r * PackUpscale;\\n}\\nfloat unpackRGBAToDepth( const in vec4 v ) {\\n\\treturn dot( v, UnpackFactors );\\n}\\nvec4 pack2HalfToRGBA( vec2 v ) {\\n\\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\\n\\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\\n}\\nvec2 unpackRGBATo2Half( vec4 v ) {\\n\\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\\n}\\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\\n\\treturn ( viewZ + near ) / ( near - far );\\n}\\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\\n\\treturn linearClipZ * ( near - far ) - near;\\n}\\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\\n\\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\\n}\\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\\n\\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\\n}\",premultiplied_alpha_fragment:\"#ifdef PREMULTIPLIED_ALPHA\\n\\tgl_FragColor.rgb *= gl_FragColor.a;\\n#endif\",project_vertex:\"vec4 mvPosition = vec4( transformed, 1.0 );\\n#ifdef USE_INSTANCING\\n\\tmvPosition = instanceMatrix * mvPosition;\\n#endif\\nmvPosition = modelViewMatrix * mvPosition;\\ngl_Position = projectionMatrix * mvPosition;\",dithering_fragment:\"#ifdef DITHERING\\n\\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\\n#endif\",dithering_pars_fragment:\"#ifdef DITHERING\\n\\tvec3 dithering( vec3 color ) {\\n\\t\\tfloat grid_position = rand( gl_FragCoord.xy );\\n\\t\\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\\n\\t\\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\\n\\t\\treturn color + dither_shift_RGB;\\n\\t}\\n#endif\",roughnessmap_fragment:\"float roughnessFactor = roughness;\\n#ifdef USE_ROUGHNESSMAP\\n\\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\\n\\troughnessFactor *= texelRoughness.g;\\n#endif\",roughnessmap_pars_fragment:\"#ifdef USE_ROUGHNESSMAP\\n\\tuniform sampler2D roughnessMap;\\n#endif\",shadowmap_pars_fragment:\"#ifdef USE_SHADOWMAP\\n\\t#if NUM_DIR_LIGHT_SHADOWS > 0\\n\\t\\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\\n\\t\\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\\n\\t\\tstruct DirectionalLightShadow {\\n\\t\\t\\tfloat shadowBias;\\n\\t\\t\\tfloat shadowNormalBias;\\n\\t\\t\\tfloat shadowRadius;\\n\\t\\t\\tvec2 shadowMapSize;\\n\\t\\t};\\n\\t\\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\\n\\t#endif\\n\\t#if NUM_SPOT_LIGHT_SHADOWS > 0\\n\\t\\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\\n\\t\\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\\n\\t\\tstruct SpotLightShadow {\\n\\t\\t\\tfloat shadowBias;\\n\\t\\t\\tfloat shadowNormalBias;\\n\\t\\t\\tfloat shadowRadius;\\n\\t\\t\\tvec2 shadowMapSize;\\n\\t\\t};\\n\\t\\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\\n\\t#endif\\n\\t#if NUM_POINT_LIGHT_SHADOWS > 0\\n\\t\\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\\n\\t\\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\\n\\t\\tstruct PointLightShadow {\\n\\t\\t\\tfloat shadowBias;\\n\\t\\t\\tfloat shadowNormalBias;\\n\\t\\t\\tfloat shadowRadius;\\n\\t\\t\\tvec2 shadowMapSize;\\n\\t\\t\\tfloat shadowCameraNear;\\n\\t\\t\\tfloat shadowCameraFar;\\n\\t\\t};\\n\\t\\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\\n\\t#endif\\n\\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\\n\\t\\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\\n\\t}\\n\\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\\n\\t\\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\\n\\t}\\n\\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\\n\\t\\tfloat occlusion = 1.0;\\n\\t\\tvec2 distribution = texture2DDistribution( shadow, uv );\\n\\t\\tfloat hard_shadow = step( compare , distribution.x );\\n\\t\\tif (hard_shadow != 1.0 ) {\\n\\t\\t\\tfloat distance = compare - distribution.x ;\\n\\t\\t\\tfloat variance = max( 0.00000, distribution.y * distribution.y );\\n\\t\\t\\tfloat softness_probability = variance / (variance + distance * distance );\\t\\t\\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\\t\\t\\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\\n\\t\\t}\\n\\t\\treturn occlusion;\\n\\t}\\n\\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\\n\\t\\tfloat shadow = 1.0;\\n\\t\\tshadowCoord.xyz /= shadowCoord.w;\\n\\t\\tshadowCoord.z += shadowBias;\\n\\t\\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\\n\\t\\tbool inFrustum = all( inFrustumVec );\\n\\t\\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\\n\\t\\tbool frustumTest = all( frustumTestVec );\\n\\t\\tif ( frustumTest ) {\\n\\t\\t#if defined( SHADOWMAP_TYPE_PCF )\\n\\t\\t\\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\\n\\t\\t\\tfloat dx0 = - texelSize.x * shadowRadius;\\n\\t\\t\\tfloat dy0 = - texelSize.y * shadowRadius;\\n\\t\\t\\tfloat dx1 = + texelSize.x * shadowRadius;\\n\\t\\t\\tfloat dy1 = + texelSize.y * shadowRadius;\\n\\t\\t\\tfloat dx2 = dx0 / 2.0;\\n\\t\\t\\tfloat dy2 = dy0 / 2.0;\\n\\t\\t\\tfloat dx3 = dx1 / 2.0;\\n\\t\\t\\tfloat dy3 = dy1 / 2.0;\\n\\t\\t\\tshadow = (\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\\n\\t\\t\\t) * ( 1.0 / 17.0 );\\n\\t\\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\\n\\t\\t\\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\\n\\t\\t\\tfloat dx = texelSize.x;\\n\\t\\t\\tfloat dy = texelSize.y;\\n\\t\\t\\tvec2 uv = shadowCoord.xy;\\n\\t\\t\\tvec2 f = fract( uv * shadowMapSize + 0.5 );\\n\\t\\t\\tuv -= f * texelSize;\\n\\t\\t\\tshadow = (\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\\n\\t\\t\\t\\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \\n\\t\\t\\t\\t\\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t f.x ) +\\n\\t\\t\\t\\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \\n\\t\\t\\t\\t\\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t f.x ) +\\n\\t\\t\\t\\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \\n\\t\\t\\t\\t\\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t f.y ) +\\n\\t\\t\\t\\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \\n\\t\\t\\t\\t\\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t f.y ) +\\n\\t\\t\\t\\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \\n\\t\\t\\t\\t\\t\\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t\\t  f.x ),\\n\\t\\t\\t\\t\\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \\n\\t\\t\\t\\t\\t\\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t\\t  f.x ),\\n\\t\\t\\t\\t\\t f.y )\\n\\t\\t\\t) * ( 1.0 / 9.0 );\\n\\t\\t#elif defined( SHADOWMAP_TYPE_VSM )\\n\\t\\t\\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\\n\\t\\t#else\\n\\t\\t\\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\\n\\t\\t#endif\\n\\t\\t}\\n\\t\\treturn shadow;\\n\\t}\\n\\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\\n\\t\\tvec3 absV = abs( v );\\n\\t\\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\\n\\t\\tabsV *= scaleToCube;\\n\\t\\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\\n\\t\\tvec2 planar = v.xy;\\n\\t\\tfloat almostATexel = 1.5 * texelSizeY;\\n\\t\\tfloat almostOne = 1.0 - almostATexel;\\n\\t\\tif ( absV.z >= almostOne ) {\\n\\t\\t\\tif ( v.z > 0.0 )\\n\\t\\t\\t\\tplanar.x = 4.0 - v.x;\\n\\t\\t} else if ( absV.x >= almostOne ) {\\n\\t\\t\\tfloat signX = sign( v.x );\\n\\t\\t\\tplanar.x = v.z * signX + 2.0 * signX;\\n\\t\\t} else if ( absV.y >= almostOne ) {\\n\\t\\t\\tfloat signY = sign( v.y );\\n\\t\\t\\tplanar.x = v.x + 2.0 * signY + 2.0;\\n\\t\\t\\tplanar.y = v.z * signY - 2.0;\\n\\t\\t}\\n\\t\\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\\n\\t}\\n\\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\\n\\t\\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\\n\\t\\tvec3 lightToPosition = shadowCoord.xyz;\\n\\t\\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\\t\\tdp += shadowBias;\\n\\t\\tvec3 bd3D = normalize( lightToPosition );\\n\\t\\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\\n\\t\\t\\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\\n\\t\\t\\treturn (\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\\n\\t\\t\\t) * ( 1.0 / 9.0 );\\n\\t\\t#else\\n\\t\\t\\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\\n\\t\\t#endif\\n\\t}\\n#endif\",shadowmap_pars_vertex:\"#ifdef USE_SHADOWMAP\\n\\t#if NUM_DIR_LIGHT_SHADOWS > 0\\n\\t\\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\\n\\t\\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\\n\\t\\tstruct DirectionalLightShadow {\\n\\t\\t\\tfloat shadowBias;\\n\\t\\t\\tfloat shadowNormalBias;\\n\\t\\t\\tfloat shadowRadius;\\n\\t\\t\\tvec2 shadowMapSize;\\n\\t\\t};\\n\\t\\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\\n\\t#endif\\n\\t#if NUM_SPOT_LIGHT_SHADOWS > 0\\n\\t\\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\\n\\t\\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\\n\\t\\tstruct SpotLightShadow {\\n\\t\\t\\tfloat shadowBias;\\n\\t\\t\\tfloat shadowNormalBias;\\n\\t\\t\\tfloat shadowRadius;\\n\\t\\t\\tvec2 shadowMapSize;\\n\\t\\t};\\n\\t\\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\\n\\t#endif\\n\\t#if NUM_POINT_LIGHT_SHADOWS > 0\\n\\t\\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\\n\\t\\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\\n\\t\\tstruct PointLightShadow {\\n\\t\\t\\tfloat shadowBias;\\n\\t\\t\\tfloat shadowNormalBias;\\n\\t\\t\\tfloat shadowRadius;\\n\\t\\t\\tvec2 shadowMapSize;\\n\\t\\t\\tfloat shadowCameraNear;\\n\\t\\t\\tfloat shadowCameraFar;\\n\\t\\t};\\n\\t\\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\\n\\t#endif\\n#endif\",shadowmap_vertex:\"#ifdef USE_SHADOWMAP\\n\\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\\n\\t\\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\\n\\t\\tvec4 shadowWorldPosition;\\n\\t#endif\\n\\t#if NUM_DIR_LIGHT_SHADOWS > 0\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\\n\\t\\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\\n\\t\\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\\n\\t}\\n\\t#pragma unroll_loop_end\\n\\t#endif\\n\\t#if NUM_SPOT_LIGHT_SHADOWS > 0\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\\n\\t\\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\\n\\t\\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\\n\\t}\\n\\t#pragma unroll_loop_end\\n\\t#endif\\n\\t#if NUM_POINT_LIGHT_SHADOWS > 0\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\\n\\t\\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\\n\\t\\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\\n\\t}\\n\\t#pragma unroll_loop_end\\n\\t#endif\\n#endif\",shadowmask_pars_fragment:\"float getShadowMask() {\\n\\tfloat shadow = 1.0;\\n\\t#ifdef USE_SHADOWMAP\\n\\t#if NUM_DIR_LIGHT_SHADOWS > 0\\n\\tDirectionalLightShadow directionalLight;\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\\n\\t\\tdirectionalLight = directionalLightShadows[ i ];\\n\\t\\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\\n\\t}\\n\\t#pragma unroll_loop_end\\n\\t#endif\\n\\t#if NUM_SPOT_LIGHT_SHADOWS > 0\\n\\tSpotLightShadow spotLight;\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\\n\\t\\tspotLight = spotLightShadows[ i ];\\n\\t\\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\\n\\t}\\n\\t#pragma unroll_loop_end\\n\\t#endif\\n\\t#if NUM_POINT_LIGHT_SHADOWS > 0\\n\\tPointLightShadow pointLight;\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\\n\\t\\tpointLight = pointLightShadows[ i ];\\n\\t\\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\\n\\t}\\n\\t#pragma unroll_loop_end\\n\\t#endif\\n\\t#endif\\n\\treturn shadow;\\n}\",skinbase_vertex:\"#ifdef USE_SKINNING\\n\\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\\n\\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\\n\\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\\n\\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\\n#endif\",skinning_pars_vertex:\"#ifdef USE_SKINNING\\n\\tuniform mat4 bindMatrix;\\n\\tuniform mat4 bindMatrixInverse;\\n\\t#ifdef BONE_TEXTURE\\n\\t\\tuniform highp sampler2D boneTexture;\\n\\t\\tuniform int boneTextureSize;\\n\\t\\tmat4 getBoneMatrix( const in float i ) {\\n\\t\\t\\tfloat j = i * 4.0;\\n\\t\\t\\tfloat x = mod( j, float( boneTextureSize ) );\\n\\t\\t\\tfloat y = floor( j / float( boneTextureSize ) );\\n\\t\\t\\tfloat dx = 1.0 / float( boneTextureSize );\\n\\t\\t\\tfloat dy = 1.0 / float( boneTextureSize );\\n\\t\\t\\ty = dy * ( y + 0.5 );\\n\\t\\t\\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\\n\\t\\t\\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\\n\\t\\t\\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\\n\\t\\t\\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\\n\\t\\t\\tmat4 bone = mat4( v1, v2, v3, v4 );\\n\\t\\t\\treturn bone;\\n\\t\\t}\\n\\t#else\\n\\t\\tuniform mat4 boneMatrices[ MAX_BONES ];\\n\\t\\tmat4 getBoneMatrix( const in float i ) {\\n\\t\\t\\tmat4 bone = boneMatrices[ int(i) ];\\n\\t\\t\\treturn bone;\\n\\t\\t}\\n\\t#endif\\n#endif\",skinning_vertex:\"#ifdef USE_SKINNING\\n\\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\\n\\tvec4 skinned = vec4( 0.0 );\\n\\tskinned += boneMatX * skinVertex * skinWeight.x;\\n\\tskinned += boneMatY * skinVertex * skinWeight.y;\\n\\tskinned += boneMatZ * skinVertex * skinWeight.z;\\n\\tskinned += boneMatW * skinVertex * skinWeight.w;\\n\\ttransformed = ( bindMatrixInverse * skinned ).xyz;\\n#endif\",skinnormal_vertex:\"#ifdef USE_SKINNING\\n\\tmat4 skinMatrix = mat4( 0.0 );\\n\\tskinMatrix += skinWeight.x * boneMatX;\\n\\tskinMatrix += skinWeight.y * boneMatY;\\n\\tskinMatrix += skinWeight.z * boneMatZ;\\n\\tskinMatrix += skinWeight.w * boneMatW;\\n\\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\\n\\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\\n\\t#ifdef USE_TANGENT\\n\\t\\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\\n\\t#endif\\n#endif\",specularmap_fragment:\"float specularStrength;\\n#ifdef USE_SPECULARMAP\\n\\tvec4 texelSpecular = texture2D( specularMap, vUv );\\n\\tspecularStrength = texelSpecular.r;\\n#else\\n\\tspecularStrength = 1.0;\\n#endif\",specularmap_pars_fragment:\"#ifdef USE_SPECULARMAP\\n\\tuniform sampler2D specularMap;\\n#endif\",tonemapping_fragment:\"#if defined( TONE_MAPPING )\\n\\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\\n#endif\",tonemapping_pars_fragment:\"#ifndef saturate\\n#define saturate(a) clamp( a, 0.0, 1.0 )\\n#endif\\nuniform float toneMappingExposure;\\nvec3 LinearToneMapping( vec3 color ) {\\n\\treturn toneMappingExposure * color;\\n}\\nvec3 ReinhardToneMapping( vec3 color ) {\\n\\tcolor *= toneMappingExposure;\\n\\treturn saturate( color / ( vec3( 1.0 ) + color ) );\\n}\\nvec3 OptimizedCineonToneMapping( vec3 color ) {\\n\\tcolor *= toneMappingExposure;\\n\\tcolor = max( vec3( 0.0 ), color - 0.004 );\\n\\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\\n}\\nvec3 RRTAndODTFit( vec3 v ) {\\n\\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\\n\\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\\n\\treturn a / b;\\n}\\nvec3 ACESFilmicToneMapping( vec3 color ) {\\n\\tconst mat3 ACESInputMat = mat3(\\n\\t\\tvec3( 0.59719, 0.07600, 0.02840 ),\\t\\tvec3( 0.35458, 0.90834, 0.13383 ),\\n\\t\\tvec3( 0.04823, 0.01566, 0.83777 )\\n\\t);\\n\\tconst mat3 ACESOutputMat = mat3(\\n\\t\\tvec3(  1.60475, -0.10208, -0.00327 ),\\t\\tvec3( -0.53108,  1.10813, -0.07276 ),\\n\\t\\tvec3( -0.07367, -0.00605,  1.07602 )\\n\\t);\\n\\tcolor *= toneMappingExposure / 0.6;\\n\\tcolor = ACESInputMat * color;\\n\\tcolor = RRTAndODTFit( color );\\n\\tcolor = ACESOutputMat * color;\\n\\treturn saturate( color );\\n}\\nvec3 CustomToneMapping( vec3 color ) { return color; }\",transmissionmap_fragment:\"#ifdef USE_TRANSMISSIONMAP\\n\\ttotalTransmission *= texture2D( transmissionMap, vUv ).r;\\n#endif\",transmissionmap_pars_fragment:\"#ifdef USE_TRANSMISSIONMAP\\n\\tuniform sampler2D transmissionMap;\\n#endif\",uv_pars_fragment:\"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\\n\\tvarying vec2 vUv;\\n#endif\",uv_pars_vertex:\"#ifdef USE_UV\\n\\t#ifdef UVS_VERTEX_ONLY\\n\\t\\tvec2 vUv;\\n\\t#else\\n\\t\\tvarying vec2 vUv;\\n\\t#endif\\n\\tuniform mat3 uvTransform;\\n#endif\",uv_vertex:\"#ifdef USE_UV\\n\\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\\n#endif\",uv2_pars_fragment:\"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\tvarying vec2 vUv2;\\n#endif\",uv2_pars_vertex:\"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\tattribute vec2 uv2;\\n\\tvarying vec2 vUv2;\\n\\tuniform mat3 uv2Transform;\\n#endif\",uv2_vertex:\"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\\n#endif\",worldpos_vertex:\"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\\n\\tvec4 worldPosition = vec4( transformed, 1.0 );\\n\\t#ifdef USE_INSTANCING\\n\\t\\tworldPosition = instanceMatrix * worldPosition;\\n\\t#endif\\n\\tworldPosition = modelMatrix * worldPosition;\\n#endif\",background_frag:\"uniform sampler2D t2D;\\nvarying vec2 vUv;\\nvoid main() {\\n\\tvec4 texColor = texture2D( t2D, vUv );\\n\\tgl_FragColor = mapTexelToLinear( texColor );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n}\",background_vert:\"varying vec2 vUv;\\nuniform mat3 uvTransform;\\nvoid main() {\\n\\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\\n\\tgl_Position = vec4( position.xy, 1.0, 1.0 );\\n}\",cube_frag:\"#include <envmap_common_pars_fragment>\\nuniform float opacity;\\nvarying vec3 vWorldDirection;\\n#include <cube_uv_reflection_fragment>\\nvoid main() {\\n\\tvec3 vReflect = vWorldDirection;\\n\\t#include <envmap_fragment>\\n\\tgl_FragColor = envColor;\\n\\tgl_FragColor.a *= opacity;\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n}\",cube_vert:\"varying vec3 vWorldDirection;\\n#include <common>\\nvoid main() {\\n\\tvWorldDirection = transformDirection( position, modelMatrix );\\n\\t#include <begin_vertex>\\n\\t#include <project_vertex>\\n\\tgl_Position.z = gl_Position.w;\\n}\",depth_frag:\"#if DEPTH_PACKING == 3200\\n\\tuniform float opacity;\\n#endif\\n#include <common>\\n#include <packing>\\n#include <uv_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvarying vec2 vHighPrecisionZW;\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( 1.0 );\\n\\t#if DEPTH_PACKING == 3200\\n\\t\\tdiffuseColor.a = opacity;\\n\\t#endif\\n\\t#include <map_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <logdepthbuf_fragment>\\n\\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\\n\\t#if DEPTH_PACKING == 3200\\n\\t\\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\\n\\t#elif DEPTH_PACKING == 3201\\n\\t\\tgl_FragColor = packDepthToRGBA( fragCoordZ );\\n\\t#endif\\n}\",depth_vert:\"#include <common>\\n#include <uv_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvarying vec2 vHighPrecisionZW;\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#ifdef USE_DISPLACEMENTMAP\\n\\t\\t#include <beginnormal_vertex>\\n\\t\\t#include <morphnormal_vertex>\\n\\t\\t#include <skinnormal_vertex>\\n\\t#endif\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\tvHighPrecisionZW = gl_Position.zw;\\n}\",distanceRGBA_frag:\"#define DISTANCE\\nuniform vec3 referencePosition;\\nuniform float nearDistance;\\nuniform float farDistance;\\nvarying vec3 vWorldPosition;\\n#include <common>\\n#include <packing>\\n#include <uv_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main () {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( 1.0 );\\n\\t#include <map_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\tfloat dist = length( vWorldPosition - referencePosition );\\n\\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\\n\\tdist = saturate( dist );\\n\\tgl_FragColor = packDepthToRGBA( dist );\\n}\",distanceRGBA_vert:\"#define DISTANCE\\nvarying vec3 vWorldPosition;\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#ifdef USE_DISPLACEMENTMAP\\n\\t\\t#include <beginnormal_vertex>\\n\\t\\t#include <morphnormal_vertex>\\n\\t\\t#include <skinnormal_vertex>\\n\\t#endif\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <worldpos_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\tvWorldPosition = worldPosition.xyz;\\n}\",equirect_frag:\"uniform sampler2D tEquirect;\\nvarying vec3 vWorldDirection;\\n#include <common>\\nvoid main() {\\n\\tvec3 direction = normalize( vWorldDirection );\\n\\tvec2 sampleUV = equirectUv( direction );\\n\\tvec4 texColor = texture2D( tEquirect, sampleUV );\\n\\tgl_FragColor = mapTexelToLinear( texColor );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n}\",equirect_vert:\"varying vec3 vWorldDirection;\\n#include <common>\\nvoid main() {\\n\\tvWorldDirection = transformDirection( position, modelMatrix );\\n\\t#include <begin_vertex>\\n\\t#include <project_vertex>\\n}\",linedashed_frag:\"uniform vec3 diffuse;\\nuniform float opacity;\\nuniform float dashSize;\\nuniform float totalSize;\\nvarying float vLineDistance;\\n#include <common>\\n#include <color_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\\n\\t\\tdiscard;\\n\\t}\\n\\tvec3 outgoingLight = vec3( 0.0 );\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <color_fragment>\\n\\toutgoingLight = diffuseColor.rgb;\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n}\",linedashed_vert:\"uniform float scale;\\nattribute float lineDistance;\\nvarying float vLineDistance;\\n#include <common>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\tvLineDistance = scale * lineDistance;\\n\\t#include <color_vertex>\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\t#include <fog_vertex>\\n}\",meshbasic_frag:\"uniform vec3 diffuse;\\nuniform float opacity;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\n#include <common>\\n#include <dithering_pars_fragment>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <envmap_common_pars_fragment>\\n#include <envmap_pars_fragment>\\n#include <cube_uv_reflection_fragment>\\n#include <fog_pars_fragment>\\n#include <specularmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <specularmap_fragment>\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\t#ifdef USE_LIGHTMAP\\n\\t\\n\\t\\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\\n\\t\\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\\n\\t#else\\n\\t\\treflectedLight.indirectDiffuse += vec3( 1.0 );\\n\\t#endif\\n\\t#include <aomap_fragment>\\n\\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\\n\\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\\n\\t#include <envmap_fragment>\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <dithering_fragment>\\n}\",meshbasic_vert:\"#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <envmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <uv2_vertex>\\n\\t#include <color_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#ifdef USE_ENVMAP\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n\\t#endif\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <worldpos_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\t#include <envmap_vertex>\\n\\t#include <fog_vertex>\\n}\",meshlambert_frag:\"uniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform float opacity;\\nvarying vec3 vLightFront;\\nvarying vec3 vIndirectFront;\\n#ifdef DOUBLE_SIDED\\n\\tvarying vec3 vLightBack;\\n\\tvarying vec3 vIndirectBack;\\n#endif\\n#include <common>\\n#include <packing>\\n#include <dithering_pars_fragment>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <emissivemap_pars_fragment>\\n#include <envmap_common_pars_fragment>\\n#include <envmap_pars_fragment>\\n#include <cube_uv_reflection_fragment>\\n#include <bsdfs>\\n#include <lights_pars_begin>\\n#include <fog_pars_fragment>\\n#include <shadowmap_pars_fragment>\\n#include <shadowmask_pars_fragment>\\n#include <specularmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\tvec3 totalEmissiveRadiance = emissive;\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <specularmap_fragment>\\n\\t#include <emissivemap_fragment>\\n\\t#ifdef DOUBLE_SIDED\\n\\t\\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\\n\\t#else\\n\\t\\treflectedLight.indirectDiffuse += vIndirectFront;\\n\\t#endif\\n\\t#include <lightmap_fragment>\\n\\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\\n\\t#ifdef DOUBLE_SIDED\\n\\t\\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\\n\\t#else\\n\\t\\treflectedLight.directDiffuse = vLightFront;\\n\\t#endif\\n\\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\\n\\t#include <aomap_fragment>\\n\\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\\n\\t#include <envmap_fragment>\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <dithering_fragment>\\n}\",meshlambert_vert:\"#define LAMBERT\\nvarying vec3 vLightFront;\\nvarying vec3 vIndirectFront;\\n#ifdef DOUBLE_SIDED\\n\\tvarying vec3 vLightBack;\\n\\tvarying vec3 vIndirectBack;\\n#endif\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <envmap_pars_vertex>\\n#include <bsdfs>\\n#include <lights_pars_begin>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <uv2_vertex>\\n\\t#include <color_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\t#include <worldpos_vertex>\\n\\t#include <envmap_vertex>\\n\\t#include <lights_lambert_vertex>\\n\\t#include <shadowmap_vertex>\\n\\t#include <fog_vertex>\\n}\",meshmatcap_frag:\"#define MATCAP\\nuniform vec3 diffuse;\\nuniform float opacity;\\nuniform sampler2D matcap;\\nvarying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\n#include <common>\\n#include <dithering_pars_fragment>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <normal_fragment_begin>\\n\\t#include <normal_fragment_maps>\\n\\tvec3 viewDir = normalize( vViewPosition );\\n\\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\\n\\tvec3 y = cross( viewDir, x );\\n\\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\\n\\t#ifdef USE_MATCAP\\n\\t\\tvec4 matcapColor = texture2D( matcap, uv );\\n\\t\\tmatcapColor = matcapTexelToLinear( matcapColor );\\n\\t#else\\n\\t\\tvec4 matcapColor = vec4( 1.0 );\\n\\t#endif\\n\\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <dithering_fragment>\\n}\",meshmatcap_vert:\"#define MATCAP\\nvarying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <color_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <color_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n\\t#ifndef FLAT_SHADED\\n\\t\\tvNormal = normalize( transformedNormal );\\n\\t#endif\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\t#include <fog_vertex>\\n\\tvViewPosition = - mvPosition.xyz;\\n}\",meshtoon_frag:\"#define TOON\\nuniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform float opacity;\\n#include <common>\\n#include <packing>\\n#include <dithering_pars_fragment>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <emissivemap_pars_fragment>\\n#include <gradientmap_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <bsdfs>\\n#include <lights_pars_begin>\\n#include <lights_toon_pars_fragment>\\n#include <shadowmap_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\tvec3 totalEmissiveRadiance = emissive;\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <normal_fragment_begin>\\n\\t#include <normal_fragment_maps>\\n\\t#include <emissivemap_fragment>\\n\\t#include <lights_toon_fragment>\\n\\t#include <lights_fragment_begin>\\n\\t#include <lights_fragment_maps>\\n\\t#include <lights_fragment_end>\\n\\t#include <aomap_fragment>\\n\\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <dithering_fragment>\\n}\",meshtoon_vert:\"#define TOON\\nvarying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <uv2_vertex>\\n\\t#include <color_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n#ifndef FLAT_SHADED\\n\\tvNormal = normalize( transformedNormal );\\n#endif\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\tvViewPosition = - mvPosition.xyz;\\n\\t#include <worldpos_vertex>\\n\\t#include <shadowmap_vertex>\\n\\t#include <fog_vertex>\\n}\",meshphong_frag:\"#define PHONG\\nuniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform vec3 specular;\\nuniform float shininess;\\nuniform float opacity;\\n#include <common>\\n#include <packing>\\n#include <dithering_pars_fragment>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <emissivemap_pars_fragment>\\n#include <envmap_common_pars_fragment>\\n#include <envmap_pars_fragment>\\n#include <cube_uv_reflection_fragment>\\n#include <fog_pars_fragment>\\n#include <bsdfs>\\n#include <lights_pars_begin>\\n#include <lights_phong_pars_fragment>\\n#include <shadowmap_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <specularmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\tvec3 totalEmissiveRadiance = emissive;\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <specularmap_fragment>\\n\\t#include <normal_fragment_begin>\\n\\t#include <normal_fragment_maps>\\n\\t#include <emissivemap_fragment>\\n\\t#include <lights_phong_fragment>\\n\\t#include <lights_fragment_begin>\\n\\t#include <lights_fragment_maps>\\n\\t#include <lights_fragment_end>\\n\\t#include <aomap_fragment>\\n\\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\\n\\t#include <envmap_fragment>\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <dithering_fragment>\\n}\",meshphong_vert:\"#define PHONG\\nvarying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <envmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <uv2_vertex>\\n\\t#include <color_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n#ifndef FLAT_SHADED\\n\\tvNormal = normalize( transformedNormal );\\n#endif\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\tvViewPosition = - mvPosition.xyz;\\n\\t#include <worldpos_vertex>\\n\\t#include <envmap_vertex>\\n\\t#include <shadowmap_vertex>\\n\\t#include <fog_vertex>\\n}\",meshphysical_frag:\"#define STANDARD\\n#ifdef PHYSICAL\\n\\t#define REFLECTIVITY\\n\\t#define CLEARCOAT\\n\\t#define TRANSMISSION\\n#endif\\nuniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform float roughness;\\nuniform float metalness;\\nuniform float opacity;\\n#ifdef TRANSMISSION\\n\\tuniform float transmission;\\n#endif\\n#ifdef REFLECTIVITY\\n\\tuniform float reflectivity;\\n#endif\\n#ifdef CLEARCOAT\\n\\tuniform float clearcoat;\\n\\tuniform float clearcoatRoughness;\\n#endif\\n#ifdef USE_SHEEN\\n\\tuniform vec3 sheen;\\n#endif\\nvarying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n\\t#ifdef USE_TANGENT\\n\\t\\tvarying vec3 vTangent;\\n\\t\\tvarying vec3 vBitangent;\\n\\t#endif\\n#endif\\n#include <common>\\n#include <packing>\\n#include <dithering_pars_fragment>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <emissivemap_pars_fragment>\\n#include <transmissionmap_pars_fragment>\\n#include <bsdfs>\\n#include <cube_uv_reflection_fragment>\\n#include <envmap_common_pars_fragment>\\n#include <envmap_physical_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <lights_pars_begin>\\n#include <lights_physical_pars_fragment>\\n#include <shadowmap_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <clearcoat_pars_fragment>\\n#include <roughnessmap_pars_fragment>\\n#include <metalnessmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\tvec3 totalEmissiveRadiance = emissive;\\n\\t#ifdef TRANSMISSION\\n\\t\\tfloat totalTransmission = transmission;\\n\\t#endif\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <roughnessmap_fragment>\\n\\t#include <metalnessmap_fragment>\\n\\t#include <normal_fragment_begin>\\n\\t#include <normal_fragment_maps>\\n\\t#include <clearcoat_normal_fragment_begin>\\n\\t#include <clearcoat_normal_fragment_maps>\\n\\t#include <emissivemap_fragment>\\n\\t#include <transmissionmap_fragment>\\n\\t#include <lights_physical_fragment>\\n\\t#include <lights_fragment_begin>\\n\\t#include <lights_fragment_maps>\\n\\t#include <lights_fragment_end>\\n\\t#include <aomap_fragment>\\n\\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\\n\\t#ifdef TRANSMISSION\\n\\t\\tdiffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );\\n\\t#endif\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <dithering_fragment>\\n}\",meshphysical_vert:\"#define STANDARD\\nvarying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n\\t#ifdef USE_TANGENT\\n\\t\\tvarying vec3 vTangent;\\n\\t\\tvarying vec3 vBitangent;\\n\\t#endif\\n#endif\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <uv2_vertex>\\n\\t#include <color_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n#ifndef FLAT_SHADED\\n\\tvNormal = normalize( transformedNormal );\\n\\t#ifdef USE_TANGENT\\n\\t\\tvTangent = normalize( transformedTangent );\\n\\t\\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\\n\\t#endif\\n#endif\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\tvViewPosition = - mvPosition.xyz;\\n\\t#include <worldpos_vertex>\\n\\t#include <shadowmap_vertex>\\n\\t#include <fog_vertex>\\n}\",normal_frag:\"#define NORMAL\\nuniform float opacity;\\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\\n\\tvarying vec3 vViewPosition;\\n#endif\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n\\t#ifdef USE_TANGENT\\n\\t\\tvarying vec3 vTangent;\\n\\t\\tvarying vec3 vBitangent;\\n\\t#endif\\n#endif\\n#include <packing>\\n#include <uv_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <normal_fragment_begin>\\n\\t#include <normal_fragment_maps>\\n\\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\\n}\",normal_vert:\"#define NORMAL\\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\\n\\tvarying vec3 vViewPosition;\\n#endif\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n\\t#ifdef USE_TANGENT\\n\\t\\tvarying vec3 vTangent;\\n\\t\\tvarying vec3 vBitangent;\\n\\t#endif\\n#endif\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n#ifndef FLAT_SHADED\\n\\tvNormal = normalize( transformedNormal );\\n\\t#ifdef USE_TANGENT\\n\\t\\tvTangent = normalize( transformedTangent );\\n\\t\\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\\n\\t#endif\\n#endif\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\\n\\tvViewPosition = - mvPosition.xyz;\\n#endif\\n}\",points_frag:\"uniform vec3 diffuse;\\nuniform float opacity;\\n#include <common>\\n#include <color_pars_fragment>\\n#include <map_particle_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec3 outgoingLight = vec3( 0.0 );\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_particle_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphatest_fragment>\\n\\toutgoingLight = diffuseColor.rgb;\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n}\",points_vert:\"uniform float size;\\nuniform float scale;\\n#include <common>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <color_vertex>\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <project_vertex>\\n\\tgl_PointSize = size;\\n\\t#ifdef USE_SIZEATTENUATION\\n\\t\\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\\n\\t\\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\\n\\t#endif\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\t#include <worldpos_vertex>\\n\\t#include <fog_vertex>\\n}\",shadow_frag:\"uniform vec3 color;\\nuniform float opacity;\\n#include <common>\\n#include <packing>\\n#include <fog_pars_fragment>\\n#include <bsdfs>\\n#include <lights_pars_begin>\\n#include <shadowmap_pars_fragment>\\n#include <shadowmask_pars_fragment>\\nvoid main() {\\n\\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n}\",shadow_vert:\"#include <common>\\n#include <fog_pars_vertex>\\n#include <shadowmap_pars_vertex>\\nvoid main() {\\n\\t#include <begin_vertex>\\n\\t#include <project_vertex>\\n\\t#include <worldpos_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n\\t#include <shadowmap_vertex>\\n\\t#include <fog_vertex>\\n}\",sprite_frag:\"uniform vec3 diffuse;\\nuniform float opacity;\\n#include <common>\\n#include <uv_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec3 outgoingLight = vec3( 0.0 );\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\toutgoingLight = diffuseColor.rgb;\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n}\",sprite_vert:\"uniform float rotation;\\nuniform vec2 center;\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\\n\\tvec2 scale;\\n\\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\\n\\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\\n\\t#ifndef USE_SIZEATTENUATION\\n\\t\\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\\n\\t\\tif ( isPerspective ) scale *= - mvPosition.z;\\n\\t#endif\\n\\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\\n\\tvec2 rotatedPosition;\\n\\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\\n\\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\\n\\tmvPosition.xy += rotatedPosition;\\n\\tgl_Position = projectionMatrix * mvPosition;\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\t#include <fog_vertex>\\n}\"},Lo={common:{diffuse:{value:new yr(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Un},uv2Transform:{value:new Un},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new zn(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new yr(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new yr(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Un}},sprite:{diffuse:{value:new yr(15658734)},opacity:{value:1},center:{value:new zn(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Un}}},Io={basic:{uniforms:mo([Lo.common,Lo.specularmap,Lo.envmap,Lo.aomap,Lo.lightmap,Lo.fog]),vertexShader:ko.meshbasic_vert,fragmentShader:ko.meshbasic_frag},lambert:{uniforms:mo([Lo.common,Lo.specularmap,Lo.envmap,Lo.aomap,Lo.lightmap,Lo.emissivemap,Lo.fog,Lo.lights,{emissive:{value:new yr(0)}}]),vertexShader:ko.meshlambert_vert,fragmentShader:ko.meshlambert_frag},phong:{uniforms:mo([Lo.common,Lo.specularmap,Lo.envmap,Lo.aomap,Lo.lightmap,Lo.emissivemap,Lo.bumpmap,Lo.normalmap,Lo.displacementmap,Lo.fog,Lo.lights,{emissive:{value:new yr(0)},specular:{value:new yr(1118481)},shininess:{value:30}}]),vertexShader:ko.meshphong_vert,fragmentShader:ko.meshphong_frag},standard:{uniforms:mo([Lo.common,Lo.envmap,Lo.aomap,Lo.lightmap,Lo.emissivemap,Lo.bumpmap,Lo.normalmap,Lo.displacementmap,Lo.roughnessmap,Lo.metalnessmap,Lo.fog,Lo.lights,{emissive:{value:new yr(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ko.meshphysical_vert,fragmentShader:ko.meshphysical_frag},toon:{uniforms:mo([Lo.common,Lo.aomap,Lo.lightmap,Lo.emissivemap,Lo.bumpmap,Lo.normalmap,Lo.displacementmap,Lo.gradientmap,Lo.fog,Lo.lights,{emissive:{value:new yr(0)}}]),vertexShader:ko.meshtoon_vert,fragmentShader:ko.meshtoon_frag},matcap:{uniforms:mo([Lo.common,Lo.bumpmap,Lo.normalmap,Lo.displacementmap,Lo.fog,{matcap:{value:null}}]),vertexShader:ko.meshmatcap_vert,fragmentShader:ko.meshmatcap_frag},points:{uniforms:mo([Lo.points,Lo.fog]),vertexShader:ko.points_vert,fragmentShader:ko.points_frag},dashed:{uniforms:mo([Lo.common,Lo.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ko.linedashed_vert,fragmentShader:ko.linedashed_frag},depth:{uniforms:mo([Lo.common,Lo.displacementmap]),vertexShader:ko.depth_vert,fragmentShader:ko.depth_frag},normal:{uniforms:mo([Lo.common,Lo.bumpmap,Lo.normalmap,Lo.displacementmap,{opacity:{value:1}}]),vertexShader:ko.normal_vert,fragmentShader:ko.normal_frag},sprite:{uniforms:mo([Lo.sprite,Lo.fog]),vertexShader:ko.sprite_vert,fragmentShader:ko.sprite_frag},background:{uniforms:{uvTransform:{value:new Un},t2D:{value:null}},vertexShader:ko.background_vert,fragmentShader:ko.background_frag},cube:{uniforms:mo([Lo.envmap,{opacity:{value:1}}]),vertexShader:ko.cube_vert,fragmentShader:ko.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ko.equirect_vert,fragmentShader:ko.equirect_frag},distanceRGBA:{uniforms:mo([Lo.common,Lo.displacementmap,{referencePosition:{value:new Zn},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ko.distanceRGBA_vert,fragmentShader:ko.distanceRGBA_frag},shadow:{uniforms:mo([Lo.lights,Lo.fog,{color:{value:new yr(0)},opacity:{value:1}}]),vertexShader:ko.shadow_vert,fragmentShader:ko.shadow_frag}};function Ro(t,e,n,i,r){const o=new yr(0);let a,s,c=0,l=null,d=0,u=null;function h(t,e){n.buffers.color.setClear(t.r,t.g,t.b,e,r)}return{getClearColor:function(){return o},setClearColor:function(t,e=1){o.set(t),c=e,h(o,c)},getClearAlpha:function(){return c},setClearAlpha:function(t){c=t,h(o,c)},render:function(n,r,p,g){let v=!0===r.isScene?r.background:null;v&&v.isTexture&&(v=e.get(v));const y=t.xr,b=y.getSession&&y.getSession();b&&\"additive\"===b.environmentBlendMode&&(v=null),null===v?h(o,c):v&&v.isColor&&(h(v,1),g=!0),(t.autoClear||g)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),v&&(v.isCubeTexture||v.isWebGLCubeRenderTarget||v.mapping===lt)?(void 0===s&&(s=new uo(new po(1,1,1),new vo({name:\"BackgroundCubeMaterial\",uniforms:fo(Io.cube.uniforms),vertexShader:Io.cube.vertexShader,fragmentShader:Io.cube.fragmentShader,side:m,depthTest:!1,depthWrite:!1,fog:!1})),s.geometry.deleteAttribute(\"normal\"),s.geometry.deleteAttribute(\"uv\"),s.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(s.material,\"envMap\",{get:function(){return this.uniforms.envMap.value}}),i.update(s)),v.isWebGLCubeRenderTarget&&(v=v.texture),s.material.uniforms.envMap.value=v,s.material.uniforms.flipEnvMap.value=v.isCubeTexture&&v._needsFlipEnvMap?-1:1,l===v&&d===v.version&&u===t.toneMapping||(s.material.needsUpdate=!0,l=v,d=v.version,u=t.toneMapping),n.unshift(s,s.geometry,s.material,0,0,null)):v&&v.isTexture&&(void 0===a&&(a=new uo(new Oo(2,2),new vo({name:\"BackgroundMaterial\",uniforms:fo(Io.background.uniforms),vertexShader:Io.background.vertexShader,fragmentShader:Io.background.fragmentShader,side:f,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.deleteAttribute(\"normal\"),Object.defineProperty(a.material,\"map\",{get:function(){return this.uniforms.t2D.value}}),i.update(a)),a.material.uniforms.t2D.value=v,!0===v.matrixAutoUpdate&&v.updateMatrix(),a.material.uniforms.uvTransform.value.copy(v.matrix),l===v&&d===v.version&&u===t.toneMapping||(a.material.needsUpdate=!0,l=v,d=v.version,u=t.toneMapping),n.unshift(a,a.geometry,a.material,0,0,null))}}}function Po(t,e,n,i){const r=t.getParameter(34921),o=i.isWebGL2?null:e.get(\"OES_vertex_array_object\"),a=i.isWebGL2||null!==o,s={},c=h(null);let l=c;function d(e){return i.isWebGL2?t.bindVertexArray(e):o.bindVertexArrayOES(e)}function u(e){return i.isWebGL2?t.deleteVertexArray(e):o.deleteVertexArrayOES(e)}function h(t){const e=[],n=[],i=[];for(let t=0;t<r;t++)e[t]=0,n[t]=0,i[t]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:e,enabledAttributes:n,attributeDivisors:i,object:t,attributes:{},index:null}}function p(){const t=l.newAttributes;for(let e=0,n=t.length;e<n;e++)t[e]=0}function f(t){m(t,0)}function m(n,r){const o=l.newAttributes,a=l.enabledAttributes,s=l.attributeDivisors;if(o[n]=1,0===a[n]&&(t.enableVertexAttribArray(n),a[n]=1),s[n]!==r){(i.isWebGL2?t:e.get(\"ANGLE_instanced_arrays\"))[i.isWebGL2?\"vertexAttribDivisor\":\"vertexAttribDivisorANGLE\"](n,r),s[n]=r}}function g(){const e=l.newAttributes,n=l.enabledAttributes;for(let i=0,r=n.length;i<r;i++)n[i]!==e[i]&&(t.disableVertexAttribArray(i),n[i]=0)}function v(e,n,r,o,a,s){!0!==i.isWebGL2||5124!==r&&5125!==r?t.vertexAttribPointer(e,n,r,o,a,s):t.vertexAttribIPointer(e,n,r,a,s)}function y(){b(),l!==c&&(l=c,d(l.object))}function b(){c.geometry=null,c.program=null,c.wireframe=!1}return{setup:function(r,c,u,y,b){let _=!1;if(a){const e=function(e,n,r){const a=!0===r.wireframe;let c=s[e.id];void 0===c&&(c={},s[e.id]=c);let l=c[n.id];void 0===l&&(l={},c[n.id]=l);let d=l[a];void 0===d&&(d=h(i.isWebGL2?t.createVertexArray():o.createVertexArrayOES()),l[a]=d);return d}(y,u,c);l!==e&&(l=e,d(l.object)),_=function(t,e){const n=l.attributes,i=t.attributes;let r=0;for(const t in i){const e=n[t],o=i[t];if(void 0===e)return!0;if(e.attribute!==o)return!0;if(e.data!==o.data)return!0;r++}return l.attributesNum!==r||l.index!==e}(y,b),_&&function(t,e){const n={},i=t.attributes;let r=0;for(const t in i){const e=i[t],o={};o.attribute=e,e.data&&(o.data=e.data),n[t]=o,r++}l.attributes=n,l.attributesNum=r,l.index=e}(y,b)}else{const t=!0===c.wireframe;l.geometry===y.id&&l.program===u.id&&l.wireframe===t||(l.geometry=y.id,l.program=u.id,l.wireframe=t,_=!0)}!0===r.isInstancedMesh&&(_=!0),null!==b&&n.update(b,34963),_&&(!function(r,o,a,s){if(!1===i.isWebGL2&&(r.isInstancedMesh||s.isInstancedBufferGeometry)&&null===e.get(\"ANGLE_instanced_arrays\"))return;p();const c=s.attributes,l=a.getAttributes(),d=o.defaultAttributeValues;for(const e in l){const i=l[e];if(i>=0){const o=c[e];if(void 0!==o){const e=o.normalized,r=o.itemSize,a=n.get(o);if(void 0===a)continue;const c=a.buffer,l=a.type,d=a.bytesPerElement;if(o.isInterleavedBufferAttribute){const n=o.data,a=n.stride,u=o.offset;n&&n.isInstancedInterleavedBuffer?(m(i,n.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=n.meshPerAttribute*n.count)):f(i),t.bindBuffer(34962,c),v(i,r,l,e,a*d,u*d)}else o.isInstancedBufferAttribute?(m(i,o.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=o.meshPerAttribute*o.count)):f(i),t.bindBuffer(34962,c),v(i,r,l,e,0,0)}else if(\"instanceMatrix\"===e){const e=n.get(r.instanceMatrix);if(void 0===e)continue;const o=e.buffer,a=e.type;m(i+0,1),m(i+1,1),m(i+2,1),m(i+3,1),t.bindBuffer(34962,o),t.vertexAttribPointer(i+0,4,a,!1,64,0),t.vertexAttribPointer(i+1,4,a,!1,64,16),t.vertexAttribPointer(i+2,4,a,!1,64,32),t.vertexAttribPointer(i+3,4,a,!1,64,48)}else if(\"instanceColor\"===e){const e=n.get(r.instanceColor);if(void 0===e)continue;const o=e.buffer,a=e.type;m(i,1),t.bindBuffer(34962,o),t.vertexAttribPointer(i,3,a,!1,12,0)}else if(void 0!==d){const n=d[e];if(void 0!==n)switch(n.length){case 2:t.vertexAttrib2fv(i,n);break;case 3:t.vertexAttrib3fv(i,n);break;case 4:t.vertexAttrib4fv(i,n);break;default:t.vertexAttrib1fv(i,n)}}}}g()}(r,c,u,y),null!==b&&t.bindBuffer(34963,n.get(b).buffer))},reset:y,resetDefaultState:b,dispose:function(){y();for(const t in s){const e=s[t];for(const t in e){const n=e[t];for(const t in n)u(n[t].object),delete n[t];delete e[t]}delete s[t]}},releaseStatesOfGeometry:function(t){if(void 0===s[t.id])return;const e=s[t.id];for(const t in e){const n=e[t];for(const t in n)u(n[t].object),delete n[t];delete e[t]}delete s[t.id]},releaseStatesOfProgram:function(t){for(const e in s){const n=s[e];if(void 0===n[t.id])continue;const i=n[t.id];for(const t in i)u(i[t].object),delete i[t];delete n[t.id]}},initAttributes:p,enableAttribute:f,disableUnusedAttributes:g}}function Do(t,e,n,i){const r=i.isWebGL2;let o;this.setMode=function(t){o=t},this.render=function(e,i){t.drawArrays(o,e,i),n.update(i,o,1)},this.renderInstances=function(i,a,s){if(0===s)return;let c,l;if(r)c=t,l=\"drawArraysInstanced\";else if(c=e.get(\"ANGLE_instanced_arrays\"),l=\"drawArraysInstancedANGLE\",null===c)return void console.error(\"THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.\");c[l](o,i,a,s),n.update(a,o,s)}}function No(t,e,n){let i;function r(e){if(\"highp\"===e){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return\"highp\";e=\"mediump\"}return\"mediump\"===e&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?\"mediump\":\"lowp\"}const o=\"undefined\"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||\"undefined\"!=typeof WebGL2ComputeRenderingContext&&t instanceof WebGL2ComputeRenderingContext;let a=void 0!==n.precision?n.precision:\"highp\";const s=r(a);s!==a&&(console.warn(\"THREE.WebGLRenderer:\",a,\"not supported, using\",s,\"instead.\"),a=s);const c=!0===n.logarithmicDepthBuffer,l=t.getParameter(34930),d=t.getParameter(35660),u=t.getParameter(3379),h=t.getParameter(34076),p=t.getParameter(34921),f=t.getParameter(36347),m=t.getParameter(36348),g=t.getParameter(36349),v=d>0,y=o||!!e.get(\"OES_texture_float\");return{isWebGL2:o,getMaxAnisotropy:function(){if(void 0!==i)return i;const n=e.get(\"EXT_texture_filter_anisotropic\");return i=null!==n?t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,i},getMaxPrecision:r,precision:a,logarithmicDepthBuffer:c,maxTextures:l,maxVertexTextures:d,maxTextureSize:u,maxCubemapSize:h,maxAttributes:p,maxVertexUniforms:f,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:v,floatFragmentTextures:y,floatVertexTextures:v&&y,maxSamples:o?t.getParameter(36183):0}}function Fo(t){const e=this;let n=null,i=0,r=!1,o=!1;const a=new tr,s=new Un,c={value:null,needsUpdate:!1};function l(){c.value!==n&&(c.value=n,c.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function d(t,n,i,r){const o=null!==t?t.length:0;let l=null;if(0!==o){if(l=c.value,!0!==r||null===l){const e=i+4*o,r=n.matrixWorldInverse;s.getNormalMatrix(r),(null===l||l.length<e)&&(l=new Float32Array(e));for(let e=0,n=i;e!==o;++e,n+=4)a.copy(t[e]).applyMatrix4(r,s),a.normal.toArray(l,n),l[n+3]=a.constant}c.value=l,c.needsUpdate=!0}return e.numPlanes=o,e.numIntersection=0,l}this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(t,e,o){const a=0!==t.length||e||0!==i||r;return r=e,n=d(t,o,0),i=t.length,a},this.beginShadows=function(){o=!0,d(null)},this.endShadows=function(){o=!1,l()},this.setState=function(e,a,s){const u=e.clippingPlanes,h=e.clipIntersection,p=e.clipShadows,f=t.get(e);if(!r||null===u||0===u.length||o&&!p)o?d(null):l();else{const t=o?0:i,e=4*t;let r=f.clippingState||null;c.value=r,r=d(u,a,e,s);for(let t=0;t!==e;++t)r[t]=n[t];f.clippingState=r,this.numIntersection=h?this.numPlanes:0,this.numPlanes+=t}}}function jo(t){let e=new WeakMap;function n(t,e){return e===st?t.mapping=ot:e===ct&&(t.mapping=at),t}function i(t){const n=t.target;n.removeEventListener(\"dispose\",i);const r=e.get(n);void 0!==r&&(e.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture){const o=r.mapping;if(o===st||o===ct){if(e.has(r)){return n(e.get(r).texture,r.mapping)}{const o=r.image;if(o&&o.height>0){const a=t.getRenderList(),s=t.getRenderTarget(),c=new wo(o.height/2);return c.fromEquirectangularTexture(t,r),e.set(r,c),t.setRenderTarget(s),t.setRenderList(a),r.addEventListener(\"dispose\",i),n(c.texture,r.mapping)}return null}}}return r},dispose:function(){e=new WeakMap}}}function Bo(t){const e={};function n(n){if(void 0!==e[n])return e[n];let i;switch(n){case\"WEBGL_depth_texture\":i=t.getExtension(\"WEBGL_depth_texture\")||t.getExtension(\"MOZ_WEBGL_depth_texture\")||t.getExtension(\"WEBKIT_WEBGL_depth_texture\");break;case\"EXT_texture_filter_anisotropic\":i=t.getExtension(\"EXT_texture_filter_anisotropic\")||t.getExtension(\"MOZ_EXT_texture_filter_anisotropic\")||t.getExtension(\"WEBKIT_EXT_texture_filter_anisotropic\");break;case\"WEBGL_compressed_texture_s3tc\":i=t.getExtension(\"WEBGL_compressed_texture_s3tc\")||t.getExtension(\"MOZ_WEBGL_compressed_texture_s3tc\")||t.getExtension(\"WEBKIT_WEBGL_compressed_texture_s3tc\");break;case\"WEBGL_compressed_texture_pvrtc\":i=t.getExtension(\"WEBGL_compressed_texture_pvrtc\")||t.getExtension(\"WEBKIT_WEBGL_compressed_texture_pvrtc\");break;default:i=t.getExtension(n)}return e[n]=i,i}return{has:function(t){return null!==n(t)},init:function(t){t.isWebGL2?n(\"EXT_color_buffer_float\"):(n(\"WEBGL_depth_texture\"),n(\"OES_texture_float\"),n(\"OES_texture_half_float\"),n(\"OES_texture_half_float_linear\"),n(\"OES_standard_derivatives\"),n(\"OES_element_index_uint\"),n(\"OES_vertex_array_object\"),n(\"ANGLE_instanced_arrays\")),n(\"OES_texture_float_linear\"),n(\"EXT_color_buffer_half_float\")},get:function(t){const e=n(t);return null===e&&console.warn(\"THREE.WebGLRenderer: \"+t+\" extension not supported.\"),e}}}function zo(t,e,n,i){const r={},o=new WeakMap;function a(t){const s=t.target;null!==s.index&&e.remove(s.index);for(const t in s.attributes)e.remove(s.attributes[t]);s.removeEventListener(\"dispose\",a),delete r[s.id];const c=o.get(s);c&&(e.remove(c),o.delete(s)),i.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,n.memory.geometries--}function s(t){const n=[],i=t.index,r=t.attributes.position;let a=0;if(null!==i){const t=i.array;a=i.version;for(let e=0,i=t.length;e<i;e+=3){const i=t[e+0],r=t[e+1],o=t[e+2];n.push(i,r,r,o,o,i)}}else{const t=r.array;a=r.version;for(let e=0,i=t.length/3-1;e<i;e+=3){const t=e+0,i=e+1,r=e+2;n.push(t,i,i,r,r,t)}}const s=new(Nr(n)>65535?Ir:kr)(n,1);s.version=a;const c=o.get(t);c&&e.remove(c),o.set(t,s)}return{get:function(t,e){return!0===r[e.id]||(e.addEventListener(\"dispose\",a),r[e.id]=!0,n.memory.geometries++),e},update:function(t){const n=t.attributes;for(const t in n)e.update(n[t],34962);const i=t.morphAttributes;for(const t in i){const n=i[t];for(let t=0,i=n.length;t<i;t++)e.update(n[t],34962)}},getWireframeAttribute:function(t){const e=o.get(t);if(e){const n=t.index;null!==n&&e.version<n.version&&s(t)}else s(t);return o.get(t)}}}function Uo(t,e,n,i){const r=i.isWebGL2;let o,a,s;this.setMode=function(t){o=t},this.setIndex=function(t){a=t.type,s=t.bytesPerElement},this.render=function(e,i){t.drawElements(o,i,a,e*s),n.update(i,o,1)},this.renderInstances=function(i,c,l){if(0===l)return;let d,u;if(r)d=t,u=\"drawElementsInstanced\";else if(d=e.get(\"ANGLE_instanced_arrays\"),u=\"drawElementsInstancedANGLE\",null===d)return void console.error(\"THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.\");d[u](o,c,a,i*s,l),n.update(c,o,l)}}function Ho(t){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,n,i){switch(e.calls++,n){case 4:e.triangles+=i*(t/3);break;case 1:e.lines+=i*(t/2);break;case 3:e.lines+=i*(t-1);break;case 2:e.lines+=i*t;break;case 0:e.points+=i*t;break;default:console.error(\"THREE.WebGLInfo: Unknown draw mode:\",n)}}}}function $o(t,e){return t[0]-e[0]}function Go(t,e){return Math.abs(e[1])-Math.abs(t[1])}function Vo(t){const e={},n=new Float32Array(8),i=[];for(let t=0;t<8;t++)i[t]=[t,0];return{update:function(r,o,a,s){const c=r.morphTargetInfluences,l=void 0===c?0:c.length;let d=e[o.id];if(void 0===d){d=[];for(let t=0;t<l;t++)d[t]=[t,0];e[o.id]=d}for(let t=0;t<l;t++){const e=d[t];e[0]=t,e[1]=c[t]}d.sort(Go);for(let t=0;t<8;t++)t<l&&d[t][1]?(i[t][0]=d[t][0],i[t][1]=d[t][1]):(i[t][0]=Number.MAX_SAFE_INTEGER,i[t][1]=0);i.sort($o);const u=a.morphTargets&&o.morphAttributes.position,h=a.morphNormals&&o.morphAttributes.normal;let p=0;for(let t=0;t<8;t++){const e=i[t],r=e[0],a=e[1];r!==Number.MAX_SAFE_INTEGER&&a?(u&&o.getAttribute(\"morphTarget\"+t)!==u[r]&&o.setAttribute(\"morphTarget\"+t,u[r]),h&&o.getAttribute(\"morphNormal\"+t)!==h[r]&&o.setAttribute(\"morphNormal\"+t,h[r]),n[t]=a,p+=a):(u&&!0===o.hasAttribute(\"morphTarget\"+t)&&o.deleteAttribute(\"morphTarget\"+t),h&&!0===o.hasAttribute(\"morphNormal\"+t)&&o.deleteAttribute(\"morphNormal\"+t),n[t]=0)}const f=o.morphTargetsRelative?1:1-p;s.getUniforms().setValue(t,\"morphTargetBaseInfluence\",f),s.getUniforms().setValue(t,\"morphTargetInfluences\",n)}}}function Wo(t,e,n,i){let r=new WeakMap;function o(t){const e=t.target;e.removeEventListener(\"dispose\",o),n.remove(e.instanceMatrix),null!==e.instanceColor&&n.remove(e.instanceColor)}return{update:function(t){const a=i.render.frame,s=t.geometry,c=e.get(t,s);return r.get(c)!==a&&(e.update(c),r.set(c,a)),t.isInstancedMesh&&(!1===t.hasEventListener(\"dispose\",o)&&t.addEventListener(\"dispose\",o),n.update(t.instanceMatrix,34962),null!==t.instanceColor&&n.update(t.instanceColor,34962)),c},dispose:function(){r=new WeakMap}}}function qo(t=null,e=1,n=1,i=1){Vn.call(this,null),this.image={data:t,width:e,height:n,depth:i},this.magFilter=ft,this.minFilter=ft,this.wrapR=ht,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function Xo(t=null,e=1,n=1,i=1){Vn.call(this,null),this.image={data:t,width:e,height:n,depth:i},this.magFilter=ft,this.minFilter=ft,this.wrapR=ht,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}Io.physical={uniforms:mo([Io.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new zn(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new yr(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:ko.meshphysical_vert,fragmentShader:ko.meshphysical_frag},qo.prototype=Object.create(Vn.prototype),qo.prototype.constructor=qo,qo.prototype.isDataTexture2DArray=!0,Xo.prototype=Object.create(Vn.prototype),Xo.prototype.constructor=Xo,Xo.prototype.isDataTexture3D=!0;const Yo=new Vn,Ko=new qo,Zo=new Xo,Jo=new xo,Qo=[],ta=[],ea=new Float32Array(16),na=new Float32Array(9),ia=new Float32Array(4);function ra(t,e,n){const i=t[0];if(i<=0||i>0)return t;const r=e*n;let o=Qo[r];if(void 0===o&&(o=new Float32Array(r),Qo[r]=o),0!==e){i.toArray(o,0);for(let i=1,r=0;i!==e;++i)r+=n,t[i].toArray(o,r)}return o}function oa(t,e){if(t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function aa(t,e){for(let n=0,i=e.length;n<i;n++)t[n]=e[n]}function sa(t,e){let n=ta[e];void 0===n&&(n=new Int32Array(e),ta[e]=n);for(let i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function ca(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function la(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(oa(n,e))return;t.uniform2fv(this.addr,e),aa(n,e)}}function da(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)n[0]===e.r&&n[1]===e.g&&n[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(oa(n,e))return;t.uniform3fv(this.addr,e),aa(n,e)}}function ua(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(oa(n,e))return;t.uniform4fv(this.addr,e),aa(n,e)}}function ha(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(oa(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),aa(n,e)}else{if(oa(n,i))return;ia.set(i),t.uniformMatrix2fv(this.addr,!1,ia),aa(n,i)}}function pa(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(oa(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),aa(n,e)}else{if(oa(n,i))return;na.set(i),t.uniformMatrix3fv(this.addr,!1,na),aa(n,i)}}function fa(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(oa(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),aa(n,e)}else{if(oa(n,i))return;ea.set(i),t.uniformMatrix4fv(this.addr,!1,ea),aa(n,i)}}function ma(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.safeSetTexture2D(e||Yo,r)}function ga(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||Ko,r)}function va(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||Zo,r)}function ya(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.safeSetTextureCube(e||Jo,r)}function ba(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function _a(t,e){const n=this.cache;oa(n,e)||(t.uniform2iv(this.addr,e),aa(n,e))}function xa(t,e){const n=this.cache;oa(n,e)||(t.uniform3iv(this.addr,e),aa(n,e))}function wa(t,e){const n=this.cache;oa(n,e)||(t.uniform4iv(this.addr,e),aa(n,e))}function Sa(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function Ma(t,e){t.uniform1fv(this.addr,e)}function Ea(t,e){t.uniform1iv(this.addr,e)}function Ta(t,e){t.uniform2iv(this.addr,e)}function Ca(t,e){t.uniform3iv(this.addr,e)}function Aa(t,e){t.uniform4iv(this.addr,e)}function Oa(t,e){const n=ra(e,this.size,2);t.uniform2fv(this.addr,n)}function ka(t,e){const n=ra(e,this.size,3);t.uniform3fv(this.addr,n)}function La(t,e){const n=ra(e,this.size,4);t.uniform4fv(this.addr,n)}function Ia(t,e){const n=ra(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function Ra(t,e){const n=ra(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function Pa(t,e){const n=ra(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function Da(t,e,n){const i=e.length,r=sa(n,i);t.uniform1iv(this.addr,r);for(let t=0;t!==i;++t)n.safeSetTexture2D(e[t]||Yo,r[t])}function Na(t,e,n){const i=e.length,r=sa(n,i);t.uniform1iv(this.addr,r);for(let t=0;t!==i;++t)n.safeSetTextureCube(e[t]||Jo,r[t])}function Fa(t,e,n){this.id=t,this.addr=n,this.cache=[],this.setValue=function(t){switch(t){case 5126:return ca;case 35664:return la;case 35665:return da;case 35666:return ua;case 35674:return ha;case 35675:return pa;case 35676:return fa;case 5124:case 35670:return ba;case 35667:case 35671:return _a;case 35668:case 35672:return xa;case 35669:case 35673:return wa;case 5125:return Sa;case 35678:case 36198:case 36298:case 36306:case 35682:return ma;case 35679:case 36299:case 36307:return va;case 35680:case 36300:case 36308:case 36293:return ya;case 36289:case 36303:case 36311:case 36292:return ga}}(e.type)}function ja(t,e,n){this.id=t,this.addr=n,this.cache=[],this.size=e.size,this.setValue=function(t){switch(t){case 5126:return Ma;case 35664:return Oa;case 35665:return ka;case 35666:return La;case 35674:return Ia;case 35675:return Ra;case 35676:return Pa;case 5124:case 35670:return Ea;case 35667:case 35671:return Ta;case 35668:case 35672:return Ca;case 35669:case 35673:return Aa;case 35678:case 36198:case 36298:case 36306:case 35682:return Da;case 35680:case 36300:case 36308:case 36293:return Na}}(e.type)}function Ba(t){this.id=t,this.seq=[],this.map={}}ja.prototype.updateCache=function(t){const e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),aa(e,t)},Ba.prototype.setValue=function(t,e,n){const i=this.seq;for(let r=0,o=i.length;r!==o;++r){const o=i[r];o.setValue(t,e[o.id],n)}};const za=/(\\w+)(\\])?(\\[|\\.)?/g;function Ua(t,e){t.seq.push(e),t.map[e.id]=e}function Ha(t,e,n){const i=t.name,r=i.length;for(za.lastIndex=0;;){const o=za.exec(i),a=za.lastIndex;let s=o[1];const c=\"]\"===o[2],l=o[3];if(c&&(s|=0),void 0===l||\"[\"===l&&a+2===r){Ua(n,void 0===l?new Fa(s,t,e):new ja(s,t,e));break}{let t=n.map[s];void 0===t&&(t=new Ba(s),Ua(n,t)),n=t}}}function $a(t,e){this.seq=[],this.map={};const n=t.getProgramParameter(e,35718);for(let i=0;i<n;++i){const n=t.getActiveUniform(e,i);Ha(n,t.getUniformLocation(e,n.name),this)}}function Ga(t,e,n){const i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}$a.prototype.setValue=function(t,e,n,i){const r=this.map[e];void 0!==r&&r.setValue(t,n,i)},$a.prototype.setOptional=function(t,e,n){const i=e[n];void 0!==i&&this.setValue(t,n,i)},$a.upload=function(t,e,n,i){for(let r=0,o=e.length;r!==o;++r){const o=e[r],a=n[o.id];!1!==a.needsUpdate&&o.setValue(t,a.value,i)}},$a.seqWithValue=function(t,e){const n=[];for(let i=0,r=t.length;i!==r;++i){const r=t[i];r.id in e&&n.push(r)}return n};let Va=0;function Wa(t){switch(t){case Ke:return[\"Linear\",\"( value )\"];case Ze:return[\"sRGB\",\"( value )\"];case Qe:return[\"RGBE\",\"( value )\"];case en:return[\"RGBM\",\"( value, 7.0 )\"];case nn:return[\"RGBM\",\"( value, 16.0 )\"];case rn:return[\"RGBD\",\"( value, 256.0 )\"];case Je:return[\"Gamma\",\"( value, float( GAMMA_FACTOR ) )\"];case tn:return[\"LogLuv\",\"( value )\"];default:return console.warn(\"THREE.WebGLProgram: Unsupported encoding:\",t),[\"Linear\",\"( value )\"]}}function qa(t,e,n){const i=t.getShaderParameter(e,35713),r=t.getShaderInfoLog(e).trim();if(i&&\"\"===r)return\"\";return\"THREE.WebGLShader: gl.getShaderInfoLog() \"+n+\"\\n\"+r+function(t){const e=t.split(\"\\n\");for(let t=0;t<e.length;t++)e[t]=t+1+\": \"+e[t];return e.join(\"\\n\")}(t.getShaderSource(e))}function Xa(t,e){const n=Wa(e);return\"vec4 \"+t+\"( vec4 value ) { return \"+n[0]+\"ToLinear\"+n[1]+\"; }\"}function Ya(t,e){const n=Wa(e);return\"vec4 \"+t+\"( vec4 value ) { return LinearTo\"+n[0]+n[1]+\"; }\"}function Ka(t,e){let n;switch(e){case Q:n=\"Linear\";break;case tt:n=\"Reinhard\";break;case et:n=\"OptimizedCineon\";break;case nt:n=\"ACESFilmic\";break;case it:n=\"Custom\";break;default:console.warn(\"THREE.WebGLProgram: Unsupported toneMapping:\",e),n=\"Linear\"}return\"vec3 \"+t+\"( vec3 color ) { return \"+n+\"ToneMapping( color ); }\"}function Za(t){return\"\"!==t}function Ja(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Qa(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const ts=/^[ \\t]*#include +<([\\w\\d./]+)>/gm;function es(t){return t.replace(ts,ns)}function ns(t,e){const n=ko[e];if(void 0===n)throw new Error(\"Can not resolve #include <\"+e+\">\");return es(n)}const is=/#pragma unroll_loop[\\s]+?for \\( int i \\= (\\d+)\\; i < (\\d+)\\; i \\+\\+ \\) \\{([\\s\\S]+?)(?=\\})\\}/g,rs=/#pragma unroll_loop_start\\s+for\\s*\\(\\s*int\\s+i\\s*=\\s*(\\d+)\\s*;\\s*i\\s*<\\s*(\\d+)\\s*;\\s*i\\s*\\+\\+\\s*\\)\\s*{([\\s\\S]+?)}\\s+#pragma unroll_loop_end/g;function os(t){return t.replace(rs,ss).replace(is,as)}function as(t,e,n,i){return console.warn(\"WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead.\"),ss(t,e,n,i)}function ss(t,e,n,i){let r=\"\";for(let t=parseInt(e);t<parseInt(n);t++)r+=i.replace(/\\[\\s*i\\s*\\]/g,\"[ \"+t+\" ]\").replace(/UNROLLED_LOOP_INDEX/g,t);return r}function cs(t){let e=\"precision \"+t.precision+\" float;\\nprecision \"+t.precision+\" int;\";return\"highp\"===t.precision?e+=\"\\n#define HIGH_PRECISION\":\"mediump\"===t.precision?e+=\"\\n#define MEDIUM_PRECISION\":\"lowp\"===t.precision&&(e+=\"\\n#define LOW_PRECISION\"),e}function ls(t,e,n,i){const r=t.getContext(),o=n.defines;let a=n.vertexShader,s=n.fragmentShader;const c=function(t){let e=\"SHADOWMAP_TYPE_BASIC\";return t.shadowMapType===u?e=\"SHADOWMAP_TYPE_PCF\":t.shadowMapType===h?e=\"SHADOWMAP_TYPE_PCF_SOFT\":t.shadowMapType===p&&(e=\"SHADOWMAP_TYPE_VSM\"),e}(n),l=function(t){let e=\"ENVMAP_TYPE_CUBE\";if(t.envMap)switch(t.envMapMode){case ot:case at:e=\"ENVMAP_TYPE_CUBE\";break;case lt:case dt:e=\"ENVMAP_TYPE_CUBE_UV\"}return e}(n),d=function(t){let e=\"ENVMAP_MODE_REFLECTION\";if(t.envMap)switch(t.envMapMode){case at:case dt:e=\"ENVMAP_MODE_REFRACTION\"}return e}(n),f=function(t){let e=\"ENVMAP_BLENDING_NONE\";if(t.envMap)switch(t.combine){case Y:e=\"ENVMAP_BLENDING_MULTIPLY\";break;case K:e=\"ENVMAP_BLENDING_MIX\";break;case Z:e=\"ENVMAP_BLENDING_ADD\"}return e}(n),m=t.gammaFactor>0?t.gammaFactor:1,g=n.isWebGL2?\"\":function(t){return[t.extensionDerivatives||t.envMapCubeUV||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||\"physical\"===t.shaderID?\"#extension GL_OES_standard_derivatives : enable\":\"\",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?\"#extension GL_EXT_frag_depth : enable\":\"\",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?\"#extension GL_EXT_draw_buffers : require\":\"\",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?\"#extension GL_EXT_shader_texture_lod : enable\":\"\"].filter(Za).join(\"\\n\")}(n),v=function(t){const e=[];for(const n in t){const i=t[n];!1!==i&&e.push(\"#define \"+n+\" \"+i)}return e.join(\"\\n\")}(o),y=r.createProgram();let b,_,x=n.glslVersion?\"#version \"+n.glslVersion+\"\\n\":\"\";n.isRawShaderMaterial?(b=[v].filter(Za).join(\"\\n\"),b.length>0&&(b+=\"\\n\"),_=[g,v].filter(Za).join(\"\\n\"),_.length>0&&(_+=\"\\n\")):(b=[cs(n),\"#define SHADER_NAME \"+n.shaderName,v,n.instancing?\"#define USE_INSTANCING\":\"\",n.instancingColor?\"#define USE_INSTANCING_COLOR\":\"\",n.supportsVertexTextures?\"#define VERTEX_TEXTURES\":\"\",\"#define GAMMA_FACTOR \"+m,\"#define MAX_BONES \"+n.maxBones,n.useFog&&n.fog?\"#define USE_FOG\":\"\",n.useFog&&n.fogExp2?\"#define FOG_EXP2\":\"\",n.map?\"#define USE_MAP\":\"\",n.envMap?\"#define USE_ENVMAP\":\"\",n.envMap?\"#define \"+d:\"\",n.lightMap?\"#define USE_LIGHTMAP\":\"\",n.aoMap?\"#define USE_AOMAP\":\"\",n.emissiveMap?\"#define USE_EMISSIVEMAP\":\"\",n.bumpMap?\"#define USE_BUMPMAP\":\"\",n.normalMap?\"#define USE_NORMALMAP\":\"\",n.normalMap&&n.objectSpaceNormalMap?\"#define OBJECTSPACE_NORMALMAP\":\"\",n.normalMap&&n.tangentSpaceNormalMap?\"#define TANGENTSPACE_NORMALMAP\":\"\",n.clearcoatMap?\"#define USE_CLEARCOATMAP\":\"\",n.clearcoatRoughnessMap?\"#define USE_CLEARCOAT_ROUGHNESSMAP\":\"\",n.clearcoatNormalMap?\"#define USE_CLEARCOAT_NORMALMAP\":\"\",n.displacementMap&&n.supportsVertexTextures?\"#define USE_DISPLACEMENTMAP\":\"\",n.specularMap?\"#define USE_SPECULARMAP\":\"\",n.roughnessMap?\"#define USE_ROUGHNESSMAP\":\"\",n.metalnessMap?\"#define USE_METALNESSMAP\":\"\",n.alphaMap?\"#define USE_ALPHAMAP\":\"\",n.transmissionMap?\"#define USE_TRANSMISSIONMAP\":\"\",n.vertexTangents?\"#define USE_TANGENT\":\"\",n.vertexColors?\"#define USE_COLOR\":\"\",n.vertexUvs?\"#define USE_UV\":\"\",n.uvsVertexOnly?\"#define UVS_VERTEX_ONLY\":\"\",n.flatShading?\"#define FLAT_SHADED\":\"\",n.skinning?\"#define USE_SKINNING\":\"\",n.useVertexTexture?\"#define BONE_TEXTURE\":\"\",n.morphTargets?\"#define USE_MORPHTARGETS\":\"\",n.morphNormals&&!1===n.flatShading?\"#define USE_MORPHNORMALS\":\"\",n.doubleSided?\"#define DOUBLE_SIDED\":\"\",n.flipSided?\"#define FLIP_SIDED\":\"\",n.shadowMapEnabled?\"#define USE_SHADOWMAP\":\"\",n.shadowMapEnabled?\"#define \"+c:\"\",n.sizeAttenuation?\"#define USE_SIZEATTENUATION\":\"\",n.logarithmicDepthBuffer?\"#define USE_LOGDEPTHBUF\":\"\",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?\"#define USE_LOGDEPTHBUF_EXT\":\"\",\"uniform mat4 modelMatrix;\",\"uniform mat4 modelViewMatrix;\",\"uniform mat4 projectionMatrix;\",\"uniform mat4 viewMatrix;\",\"uniform mat3 normalMatrix;\",\"uniform vec3 cameraPosition;\",\"uniform bool isOrthographic;\",\"#ifdef USE_INSTANCING\",\"\\tattribute mat4 instanceMatrix;\",\"#endif\",\"#ifdef USE_INSTANCING_COLOR\",\"\\tattribute vec3 instanceColor;\",\"#endif\",\"attribute vec3 position;\",\"attribute vec3 normal;\",\"attribute vec2 uv;\",\"#ifdef USE_TANGENT\",\"\\tattribute vec4 tangent;\",\"#endif\",\"#ifdef USE_COLOR\",\"\\tattribute vec3 color;\",\"#endif\",\"#ifdef USE_MORPHTARGETS\",\"\\tattribute vec3 morphTarget0;\",\"\\tattribute vec3 morphTarget1;\",\"\\tattribute vec3 morphTarget2;\",\"\\tattribute vec3 morphTarget3;\",\"\\t#ifdef USE_MORPHNORMALS\",\"\\t\\tattribute vec3 morphNormal0;\",\"\\t\\tattribute vec3 morphNormal1;\",\"\\t\\tattribute vec3 morphNormal2;\",\"\\t\\tattribute vec3 morphNormal3;\",\"\\t#else\",\"\\t\\tattribute vec3 morphTarget4;\",\"\\t\\tattribute vec3 morphTarget5;\",\"\\t\\tattribute vec3 morphTarget6;\",\"\\t\\tattribute vec3 morphTarget7;\",\"\\t#endif\",\"#endif\",\"#ifdef USE_SKINNING\",\"\\tattribute vec4 skinIndex;\",\"\\tattribute vec4 skinWeight;\",\"#endif\",\"\\n\"].filter(Za).join(\"\\n\"),_=[g,cs(n),\"#define SHADER_NAME \"+n.shaderName,v,n.alphaTest?\"#define ALPHATEST \"+n.alphaTest+(n.alphaTest%1?\"\":\".0\"):\"\",\"#define GAMMA_FACTOR \"+m,n.useFog&&n.fog?\"#define USE_FOG\":\"\",n.useFog&&n.fogExp2?\"#define FOG_EXP2\":\"\",n.map?\"#define USE_MAP\":\"\",n.matcap?\"#define USE_MATCAP\":\"\",n.envMap?\"#define USE_ENVMAP\":\"\",n.envMap?\"#define \"+l:\"\",n.envMap?\"#define \"+d:\"\",n.envMap?\"#define \"+f:\"\",n.lightMap?\"#define USE_LIGHTMAP\":\"\",n.aoMap?\"#define USE_AOMAP\":\"\",n.emissiveMap?\"#define USE_EMISSIVEMAP\":\"\",n.bumpMap?\"#define USE_BUMPMAP\":\"\",n.normalMap?\"#define USE_NORMALMAP\":\"\",n.normalMap&&n.objectSpaceNormalMap?\"#define OBJECTSPACE_NORMALMAP\":\"\",n.normalMap&&n.tangentSpaceNormalMap?\"#define TANGENTSPACE_NORMALMAP\":\"\",n.clearcoatMap?\"#define USE_CLEARCOATMAP\":\"\",n.clearcoatRoughnessMap?\"#define USE_CLEARCOAT_ROUGHNESSMAP\":\"\",n.clearcoatNormalMap?\"#define USE_CLEARCOAT_NORMALMAP\":\"\",n.specularMap?\"#define USE_SPECULARMAP\":\"\",n.roughnessMap?\"#define USE_ROUGHNESSMAP\":\"\",n.metalnessMap?\"#define USE_METALNESSMAP\":\"\",n.alphaMap?\"#define USE_ALPHAMAP\":\"\",n.sheen?\"#define USE_SHEEN\":\"\",n.transmissionMap?\"#define USE_TRANSMISSIONMAP\":\"\",n.vertexTangents?\"#define USE_TANGENT\":\"\",n.vertexColors||n.instancingColor?\"#define USE_COLOR\":\"\",n.vertexUvs?\"#define USE_UV\":\"\",n.uvsVertexOnly?\"#define UVS_VERTEX_ONLY\":\"\",n.gradientMap?\"#define USE_GRADIENTMAP\":\"\",n.flatShading?\"#define FLAT_SHADED\":\"\",n.doubleSided?\"#define DOUBLE_SIDED\":\"\",n.flipSided?\"#define FLIP_SIDED\":\"\",n.shadowMapEnabled?\"#define USE_SHADOWMAP\":\"\",n.shadowMapEnabled?\"#define \"+c:\"\",n.premultipliedAlpha?\"#define PREMULTIPLIED_ALPHA\":\"\",n.physicallyCorrectLights?\"#define PHYSICALLY_CORRECT_LIGHTS\":\"\",n.logarithmicDepthBuffer?\"#define USE_LOGDEPTHBUF\":\"\",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?\"#define USE_LOGDEPTHBUF_EXT\":\"\",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?\"#define TEXTURE_LOD_EXT\":\"\",\"uniform mat4 viewMatrix;\",\"uniform vec3 cameraPosition;\",\"uniform bool isOrthographic;\",n.toneMapping!==J?\"#define TONE_MAPPING\":\"\",n.toneMapping!==J?ko.tonemapping_pars_fragment:\"\",n.toneMapping!==J?Ka(\"toneMapping\",n.toneMapping):\"\",n.dithering?\"#define DITHERING\":\"\",ko.encodings_pars_fragment,n.map?Xa(\"mapTexelToLinear\",n.mapEncoding):\"\",n.matcap?Xa(\"matcapTexelToLinear\",n.matcapEncoding):\"\",n.envMap?Xa(\"envMapTexelToLinear\",n.envMapEncoding):\"\",n.emissiveMap?Xa(\"emissiveMapTexelToLinear\",n.emissiveMapEncoding):\"\",n.lightMap?Xa(\"lightMapTexelToLinear\",n.lightMapEncoding):\"\",Ya(\"linearToOutputTexel\",n.outputEncoding),n.depthPacking?\"#define DEPTH_PACKING \"+n.depthPacking:\"\",\"\\n\"].filter(Za).join(\"\\n\")),a=es(a),a=Ja(a,n),a=Qa(a,n),s=es(s),s=Ja(s,n),s=Qa(s,n),a=os(a),s=os(s),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(x=\"#version 300 es\\n\",b=[\"#define attribute in\",\"#define varying out\",\"#define texture2D texture\"].join(\"\\n\")+\"\\n\"+b,_=[\"#define varying in\",n.glslVersion===Dn?\"\":\"out highp vec4 pc_fragColor;\",n.glslVersion===Dn?\"\":\"#define gl_FragColor pc_fragColor\",\"#define gl_FragDepthEXT gl_FragDepth\",\"#define texture2D texture\",\"#define textureCube texture\",\"#define texture2DProj textureProj\",\"#define texture2DLodEXT textureLod\",\"#define texture2DProjLodEXT textureProjLod\",\"#define textureCubeLodEXT textureLod\",\"#define texture2DGradEXT textureGrad\",\"#define texture2DProjGradEXT textureProjGrad\",\"#define textureCubeGradEXT textureGrad\"].join(\"\\n\")+\"\\n\"+_);const w=x+_+s,S=Ga(r,35633,x+b+a),M=Ga(r,35632,w);if(r.attachShader(y,S),r.attachShader(y,M),void 0!==n.index0AttributeName?r.bindAttribLocation(y,0,n.index0AttributeName):!0===n.morphTargets&&r.bindAttribLocation(y,0,\"position\"),r.linkProgram(y),t.debug.checkShaderErrors){const t=r.getProgramInfoLog(y).trim(),e=r.getShaderInfoLog(S).trim(),n=r.getShaderInfoLog(M).trim();let i=!0,o=!0;if(!1===r.getProgramParameter(y,35714)){i=!1;const e=qa(r,S,\"vertex\"),n=qa(r,M,\"fragment\");console.error(\"THREE.WebGLProgram: shader error: \",r.getError(),\"35715\",r.getProgramParameter(y,35715),\"gl.getProgramInfoLog\",t,e,n)}else\"\"!==t?console.warn(\"THREE.WebGLProgram: gl.getProgramInfoLog()\",t):\"\"!==e&&\"\"!==n||(o=!1);o&&(this.diagnostics={runnable:i,programLog:t,vertexShader:{log:e,prefix:b},fragmentShader:{log:n,prefix:_}})}let E,T;return r.deleteShader(S),r.deleteShader(M),this.getUniforms=function(){return void 0===E&&(E=new $a(r,y)),E},this.getAttributes=function(){return void 0===T&&(T=function(t,e){const n={},i=t.getProgramParameter(e,35721);for(let r=0;r<i;r++){const i=t.getActiveAttrib(e,r).name;n[i]=t.getAttribLocation(e,i)}return n}(r,y)),T},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(y),this.program=void 0},this.name=n.shaderName,this.id=Va++,this.cacheKey=e,this.usedTimes=1,this.program=y,this.vertexShader=S,this.fragmentShader=M,this}function ds(t,e,n,i,r,o){const a=[],s=i.isWebGL2,c=i.logarithmicDepthBuffer,l=i.floatVertexTextures,d=i.maxVertexUniforms,u=i.vertexTextures;let h=i.precision;const p={MeshDepthMaterial:\"depth\",MeshDistanceMaterial:\"distanceRGBA\",MeshNormalMaterial:\"normal\",MeshBasicMaterial:\"basic\",MeshLambertMaterial:\"lambert\",MeshPhongMaterial:\"phong\",MeshToonMaterial:\"toon\",MeshStandardMaterial:\"physical\",MeshPhysicalMaterial:\"physical\",MeshMatcapMaterial:\"matcap\",LineBasicMaterial:\"basic\",LineDashedMaterial:\"dashed\",PointsMaterial:\"points\",ShadowMaterial:\"shadow\",SpriteMaterial:\"sprite\"},f=[\"precision\",\"isWebGL2\",\"supportsVertexTextures\",\"outputEncoding\",\"instancing\",\"instancingColor\",\"map\",\"mapEncoding\",\"matcap\",\"matcapEncoding\",\"envMap\",\"envMapMode\",\"envMapEncoding\",\"envMapCubeUV\",\"lightMap\",\"lightMapEncoding\",\"aoMap\",\"emissiveMap\",\"emissiveMapEncoding\",\"bumpMap\",\"normalMap\",\"objectSpaceNormalMap\",\"tangentSpaceNormalMap\",\"clearcoatMap\",\"clearcoatRoughnessMap\",\"clearcoatNormalMap\",\"displacementMap\",\"specularMap\",\"roughnessMap\",\"metalnessMap\",\"gradientMap\",\"alphaMap\",\"combine\",\"vertexColors\",\"vertexTangents\",\"vertexUvs\",\"uvsVertexOnly\",\"fog\",\"useFog\",\"fogExp2\",\"flatShading\",\"sizeAttenuation\",\"logarithmicDepthBuffer\",\"skinning\",\"maxBones\",\"useVertexTexture\",\"morphTargets\",\"morphNormals\",\"maxMorphTargets\",\"maxMorphNormals\",\"premultipliedAlpha\",\"numDirLights\",\"numPointLights\",\"numSpotLights\",\"numHemiLights\",\"numRectAreaLights\",\"numDirLightShadows\",\"numPointLightShadows\",\"numSpotLightShadows\",\"shadowMapEnabled\",\"shadowMapType\",\"toneMapping\",\"physicallyCorrectLights\",\"alphaTest\",\"doubleSided\",\"flipSided\",\"numClippingPlanes\",\"numClipIntersection\",\"depthPacking\",\"dithering\",\"sheen\",\"transmissionMap\"];function v(t){let e;return t&&t.isTexture?e=t.encoding:t&&t.isWebGLRenderTarget?(console.warn(\"THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead.\"),e=t.texture.encoding):e=Ke,e}return{getParameters:function(r,a,f,y,b){const _=y.fog,x=r.isMeshStandardMaterial?y.environment:null,w=e.get(r.envMap||x),S=p[r.type],M=b.isSkinnedMesh?function(t){const e=t.skeleton.bones;if(l)return 1024;{const t=d,n=Math.floor((t-20)/4),i=Math.min(n,e.length);return i<e.length?(console.warn(\"THREE.WebGLRenderer: Skeleton has \"+e.length+\" bones. This GPU supports \"+i+\".\"),0):i}}(b):0;let E,T;if(null!==r.precision&&(h=i.getMaxPrecision(r.precision),h!==r.precision&&console.warn(\"THREE.WebGLProgram.getParameters:\",r.precision,\"not supported, using\",h,\"instead.\")),S){const t=Io[S];E=t.vertexShader,T=t.fragmentShader}else E=r.vertexShader,T=r.fragmentShader;const C=t.getRenderTarget();return{isWebGL2:s,shaderID:S,shaderName:r.type,vertexShader:E,fragmentShader:T,defines:r.defines,isRawShaderMaterial:!0===r.isRawShaderMaterial,glslVersion:r.glslVersion,precision:h,instancing:!0===b.isInstancedMesh,instancingColor:!0===b.isInstancedMesh&&null!==b.instanceColor,supportsVertexTextures:u,outputEncoding:null!==C?v(C.texture):t.outputEncoding,map:!!r.map,mapEncoding:v(r.map),matcap:!!r.matcap,matcapEncoding:v(r.matcap),envMap:!!w,envMapMode:w&&w.mapping,envMapEncoding:v(w),envMapCubeUV:!!w&&(w.mapping===lt||w.mapping===dt),lightMap:!!r.lightMap,lightMapEncoding:v(r.lightMap),aoMap:!!r.aoMap,emissiveMap:!!r.emissiveMap,emissiveMapEncoding:v(r.emissiveMap),bumpMap:!!r.bumpMap,normalMap:!!r.normalMap,objectSpaceNormalMap:r.normalMapType===cn,tangentSpaceNormalMap:r.normalMapType===sn,clearcoatMap:!!r.clearcoatMap,clearcoatRoughnessMap:!!r.clearcoatRoughnessMap,clearcoatNormalMap:!!r.clearcoatNormalMap,displacementMap:!!r.displacementMap,roughnessMap:!!r.roughnessMap,metalnessMap:!!r.metalnessMap,specularMap:!!r.specularMap,alphaMap:!!r.alphaMap,gradientMap:!!r.gradientMap,sheen:!!r.sheen,transmissionMap:!!r.transmissionMap,combine:r.combine,vertexTangents:r.normalMap&&r.vertexTangents,vertexColors:r.vertexColors,vertexUvs:!!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatMap||r.clearcoatRoughnessMap||r.clearcoatNormalMap||r.displacementMap||r.transmissionMap),uvsVertexOnly:!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatNormalMap||r.transmissionMap||!r.displacementMap),fog:!!_,useFog:r.fog,fogExp2:_&&_.isFogExp2,flatShading:r.flatShading,sizeAttenuation:r.sizeAttenuation,logarithmicDepthBuffer:c,skinning:r.skinning&&M>0,maxBones:M,useVertexTexture:l,morphTargets:r.morphTargets,morphNormals:r.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:a.directional.length,numPointLights:a.point.length,numSpotLights:a.spot.length,numRectAreaLights:a.rectArea.length,numHemiLights:a.hemi.length,numDirLightShadows:a.directionalShadowMap.length,numPointLightShadows:a.pointShadowMap.length,numSpotLightShadows:a.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:r.dithering,shadowMapEnabled:t.shadowMap.enabled&&f.length>0,shadowMapType:t.shadowMap.type,toneMapping:r.toneMapped?t.toneMapping:J,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:r.premultipliedAlpha,alphaTest:r.alphaTest,doubleSided:r.side===g,flipSided:r.side===m,depthPacking:void 0!==r.depthPacking&&r.depthPacking,index0AttributeName:r.index0AttributeName,extensionDerivatives:r.extensions&&r.extensions.derivatives,extensionFragDepth:r.extensions&&r.extensions.fragDepth,extensionDrawBuffers:r.extensions&&r.extensions.drawBuffers,extensionShaderTextureLOD:r.extensions&&r.extensions.shaderTextureLOD,rendererExtensionFragDepth:s||n.has(\"EXT_frag_depth\"),rendererExtensionDrawBuffers:s||n.has(\"WEBGL_draw_buffers\"),rendererExtensionShaderTextureLod:s||n.has(\"EXT_shader_texture_lod\"),customProgramCacheKey:r.customProgramCacheKey()}},getProgramCacheKey:function(e){const n=[];if(e.shaderID?n.push(e.shaderID):(n.push(e.fragmentShader),n.push(e.vertexShader)),void 0!==e.defines)for(const t in e.defines)n.push(t),n.push(e.defines[t]);if(!1===e.isRawShaderMaterial){for(let t=0;t<f.length;t++)n.push(e[f[t]]);n.push(t.outputEncoding),n.push(t.gammaFactor)}return n.push(e.customProgramCacheKey),n.join()},getUniforms:function(t){const e=p[t.type];let n;if(e){const t=Io[e];n=go.clone(t.uniforms)}else n=t.uniforms;return n},acquireProgram:function(e,n){let i;for(let t=0,e=a.length;t<e;t++){const e=a[t];if(e.cacheKey===n){i=e,++i.usedTimes;break}}return void 0===i&&(i=new ls(t,n,e,r),a.push(i)),i},releaseProgram:function(t){if(0==--t.usedTimes){const e=a.indexOf(t);a[e]=a[a.length-1],a.pop(),t.destroy()}},programs:a}}function us(){let t=new WeakMap;return{get:function(e){let n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n},remove:function(e){t.delete(e)},update:function(e,n,i){t.get(e)[n]=i},dispose:function(){t=new WeakMap}}}function hs(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function ps(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function fs(t){const e=[];let n=0;const i=[],r=[],o={id:-1};function a(i,r,a,s,c,l){let d=e[n];const u=t.get(a);return void 0===d?(d={id:i.id,object:i,geometry:r,material:a,program:u.program||o,groupOrder:s,renderOrder:i.renderOrder,z:c,group:l},e[n]=d):(d.id=i.id,d.object=i,d.geometry=r,d.material=a,d.program=u.program||o,d.groupOrder=s,d.renderOrder=i.renderOrder,d.z=c,d.group=l),n++,d}return{opaque:i,transparent:r,init:function(){n=0,i.length=0,r.length=0},push:function(t,e,n,o,s,c){const l=a(t,e,n,o,s,c);(!0===n.transparent?r:i).push(l)},unshift:function(t,e,n,o,s,c){const l=a(t,e,n,o,s,c);(!0===n.transparent?r:i).unshift(l)},finish:function(){for(let t=n,i=e.length;t<i;t++){const n=e[t];if(null===n.id)break;n.id=null,n.object=null,n.geometry=null,n.material=null,n.program=null,n.group=null}},sort:function(t,e){i.length>1&&i.sort(t||hs),r.length>1&&r.sort(e||ps)}}}function ms(t){let e=new WeakMap;return{get:function(n,i){const r=e.get(n);let o;return void 0===r?(o=new fs(t),e.set(n,new WeakMap),e.get(n).set(i,o)):(o=r.get(i),void 0===o&&(o=new fs(t),r.set(i,o))),o},dispose:function(){e=new WeakMap}}}function gs(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case\"DirectionalLight\":n={direction:new Zn,color:new yr};break;case\"SpotLight\":n={position:new Zn,direction:new Zn,color:new yr,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case\"PointLight\":n={position:new Zn,color:new yr,distance:0,decay:0};break;case\"HemisphereLight\":n={direction:new Zn,skyColor:new yr,groundColor:new yr};break;case\"RectAreaLight\":n={color:new yr,position:new Zn,halfWidth:new Zn,halfHeight:new Zn}}return t[e.id]=n,n}}}let vs=0;function ys(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function bs(t,e){const n=new gs,i=function(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case\"DirectionalLight\":case\"SpotLight\":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new zn};break;case\"PointLight\":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new zn,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=n,n}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let t=0;t<9;t++)r.probe.push(new Zn);const o=new Zn,a=new Ei,s=new Ei;return{setup:function(o){let a=0,s=0,c=0;for(let t=0;t<9;t++)r.probe[t].set(0,0,0);let l=0,d=0,u=0,h=0,p=0,f=0,m=0,g=0;o.sort(ys);for(let t=0,e=o.length;t<e;t++){const e=o[t],v=e.color,y=e.intensity,b=e.distance,_=e.shadow&&e.shadow.map?e.shadow.map.texture:null;if(e.isAmbientLight)a+=v.r*y,s+=v.g*y,c+=v.b*y;else if(e.isLightProbe)for(let t=0;t<9;t++)r.probe[t].addScaledVector(e.sh.coefficients[t],y);else if(e.isDirectionalLight){const t=n.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity),e.castShadow){const t=e.shadow,n=i.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,r.directionalShadow[l]=n,r.directionalShadowMap[l]=_,r.directionalShadowMatrix[l]=e.shadow.matrix,f++}r.directional[l]=t,l++}else if(e.isSpotLight){const t=n.get(e);if(t.position.setFromMatrixPosition(e.matrixWorld),t.color.copy(v).multiplyScalar(y),t.distance=b,t.coneCos=Math.cos(e.angle),t.penumbraCos=Math.cos(e.angle*(1-e.penumbra)),t.decay=e.decay,e.castShadow){const t=e.shadow,n=i.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,r.spotShadow[u]=n,r.spotShadowMap[u]=_,r.spotShadowMatrix[u]=e.shadow.matrix,g++}r.spot[u]=t,u++}else if(e.isRectAreaLight){const t=n.get(e);t.color.copy(v).multiplyScalar(y),t.halfWidth.set(.5*e.width,0,0),t.halfHeight.set(0,.5*e.height,0),r.rectArea[h]=t,h++}else if(e.isPointLight){const t=n.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity),t.distance=e.distance,t.decay=e.decay,e.castShadow){const t=e.shadow,n=i.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,n.shadowCameraNear=t.camera.near,n.shadowCameraFar=t.camera.far,r.pointShadow[d]=n,r.pointShadowMap[d]=_,r.pointShadowMatrix[d]=e.shadow.matrix,m++}r.point[d]=t,d++}else if(e.isHemisphereLight){const t=n.get(e);t.skyColor.copy(e.color).multiplyScalar(y),t.groundColor.copy(e.groundColor).multiplyScalar(y),r.hemi[p]=t,p++}}h>0&&(e.isWebGL2||!0===t.has(\"OES_texture_float_linear\")?(r.rectAreaLTC1=Lo.LTC_FLOAT_1,r.rectAreaLTC2=Lo.LTC_FLOAT_2):!0===t.has(\"OES_texture_half_float_linear\")?(r.rectAreaLTC1=Lo.LTC_HALF_1,r.rectAreaLTC2=Lo.LTC_HALF_2):console.error(\"THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.\")),r.ambient[0]=a,r.ambient[1]=s,r.ambient[2]=c;const v=r.hash;v.directionalLength===l&&v.pointLength===d&&v.spotLength===u&&v.rectAreaLength===h&&v.hemiLength===p&&v.numDirectionalShadows===f&&v.numPointShadows===m&&v.numSpotShadows===g||(r.directional.length=l,r.spot.length=u,r.rectArea.length=h,r.point.length=d,r.hemi.length=p,r.directionalShadow.length=f,r.directionalShadowMap.length=f,r.pointShadow.length=m,r.pointShadowMap.length=m,r.spotShadow.length=g,r.spotShadowMap.length=g,r.directionalShadowMatrix.length=f,r.pointShadowMatrix.length=m,r.spotShadowMatrix.length=g,v.directionalLength=l,v.pointLength=d,v.spotLength=u,v.rectAreaLength=h,v.hemiLength=p,v.numDirectionalShadows=f,v.numPointShadows=m,v.numSpotShadows=g,r.version=vs++)},setupView:function(t,e){let n=0,i=0,c=0,l=0,d=0;const u=e.matrixWorldInverse;for(let e=0,h=t.length;e<h;e++){const h=t[e];if(h.isDirectionalLight){const t=r.directional[n];t.direction.setFromMatrixPosition(h.matrixWorld),o.setFromMatrixPosition(h.target.matrixWorld),t.direction.sub(o),t.direction.transformDirection(u),n++}else if(h.isSpotLight){const t=r.spot[c];t.position.setFromMatrixPosition(h.matrixWorld),t.position.applyMatrix4(u),t.direction.setFromMatrixPosition(h.matrixWorld),o.setFromMatrixPosition(h.target.matrixWorld),t.direction.sub(o),t.direction.transformDirection(u),c++}else if(h.isRectAreaLight){const t=r.rectArea[l];t.position.setFromMatrixPosition(h.matrixWorld),t.position.applyMatrix4(u),s.identity(),a.copy(h.matrixWorld),a.premultiply(u),s.extractRotation(a),t.halfWidth.set(.5*h.width,0,0),t.halfHeight.set(0,.5*h.height,0),t.halfWidth.applyMatrix4(s),t.halfHeight.applyMatrix4(s),l++}else if(h.isPointLight){const t=r.point[i];t.position.setFromMatrixPosition(h.matrixWorld),t.position.applyMatrix4(u),i++}else if(h.isHemisphereLight){const t=r.hemi[d];t.direction.setFromMatrixPosition(h.matrixWorld),t.direction.transformDirection(u),t.direction.normalize(),d++}}},state:r}}function _s(t,e){const n=new bs(t,e),i=[],r=[];return{init:function(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:n},setupLights:function(){n.setup(i)},setupLightsView:function(t){n.setupView(i,t)},pushLight:function(t){i.push(t)},pushShadow:function(t){r.push(t)}}}function xs(t,e){let n=new WeakMap;return{get:function(i,r=0){let o;return!1===n.has(i)?(o=new _s(t,e),n.set(i,[]),n.get(i).push(o)):r>=n.get(i).length?(o=new _s(t,e),n.get(i).push(o)):o=n.get(i)[r],o},dispose:function(){n=new WeakMap}}}function ws(t){xr.call(this),this.type=\"MeshDepthMaterial\",this.depthPacking=on,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}function Ss(t){xr.call(this),this.type=\"MeshDistanceMaterial\",this.referencePosition=new Zn,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}ws.prototype=Object.create(xr.prototype),ws.prototype.constructor=ws,ws.prototype.isMeshDepthMaterial=!0,ws.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},Ss.prototype=Object.create(xr.prototype),Ss.prototype.constructor=Ss,Ss.prototype.isMeshDistanceMaterial=!0,Ss.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this};function Ms(t,e,n){let i=new To;const r=new zn,o=new zn,a=new qn,s=[],c=[],l={},d={0:m,1:f,2:g},h=new vo({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new zn},radius:{value:4}},vertexShader:\"void main() {\\n\\tgl_Position = vec4( position, 1.0 );\\n}\",fragmentShader:\"uniform sampler2D shadow_pass;\\nuniform vec2 resolution;\\nuniform float radius;\\n#include <packing>\\nvoid main() {\\n\\tfloat mean = 0.0;\\n\\tfloat squared_mean = 0.0;\\n\\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\\n\\tfor ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\\n\\t\\t#ifdef HORIZONTAL_PASS\\n\\t\\t\\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\\n\\t\\t\\tmean += distribution.x;\\n\\t\\t\\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\\n\\t\\t#else\\n\\t\\t\\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );\\n\\t\\t\\tmean += depth;\\n\\t\\t\\tsquared_mean += depth * depth;\\n\\t\\t#endif\\n\\t}\\n\\tmean = mean * HALF_SAMPLE_RATE;\\n\\tsquared_mean = squared_mean * HALF_SAMPLE_RATE;\\n\\tfloat std_dev = sqrt( squared_mean - mean * mean );\\n\\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\\n}\"}),v=h.clone();v.defines.HORIZONTAL_PASS=1;const y=new Wr;y.setAttribute(\"position\",new Er(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const _=new uo(y,h),x=this;function w(n,i){const r=e.update(_);h.uniforms.shadow_pass.value=n.map.texture,h.uniforms.resolution.value=n.mapSize,h.uniforms.radius.value=n.radius,t.setRenderTarget(n.mapPass),t.clear(),t.renderBufferDirect(i,null,r,h,_,null),v.uniforms.shadow_pass.value=n.mapPass.texture,v.uniforms.resolution.value=n.mapSize,v.uniforms.radius.value=n.radius,t.setRenderTarget(n.map),t.clear(),t.renderBufferDirect(i,null,r,v,_,null)}function S(t,e,n){const i=t<<0|e<<1|n<<2;let r=s[i];return void 0===r&&(r=new ws({depthPacking:an,morphTargets:t,skinning:e}),s[i]=r),r}function M(t,e,n){const i=t<<0|e<<1|n<<2;let r=c[i];return void 0===r&&(r=new Ss({morphTargets:t,skinning:e}),c[i]=r),r}function E(e,n,i,r,o,a,s){let c=null,u=S,h=e.customDepthMaterial;if(!0===r.isPointLight&&(u=M,h=e.customDistanceMaterial),void 0===h){let t=!1;!0===i.morphTargets&&(t=n.morphAttributes&&n.morphAttributes.position&&n.morphAttributes.position.length>0);let r=!1;!0===e.isSkinnedMesh&&(!0===i.skinning?r=!0:console.warn(\"THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:\",e));c=u(t,r,!0===e.isInstancedMesh)}else c=h;if(t.localClippingEnabled&&!0===i.clipShadows&&0!==i.clippingPlanes.length){const t=c.uuid,e=i.uuid;let n=l[t];void 0===n&&(n={},l[t]=n);let r=n[e];void 0===r&&(r=c.clone(),n[e]=r),c=r}return c.visible=i.visible,c.wireframe=i.wireframe,c.side=s===p?null!==i.shadowSide?i.shadowSide:i.side:null!==i.shadowSide?i.shadowSide:d[i.side],c.clipShadows=i.clipShadows,c.clippingPlanes=i.clippingPlanes,c.clipIntersection=i.clipIntersection,c.wireframeLinewidth=i.wireframeLinewidth,c.linewidth=i.linewidth,!0===r.isPointLight&&!0===c.isMeshDistanceMaterial&&(c.referencePosition.setFromMatrixPosition(r.matrixWorld),c.nearDistance=o,c.farDistance=a),c}function T(n,r,o,a,s){if(!1===n.visible)return;if(n.layers.test(r.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&s===p)&&(!n.frustumCulled||i.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);const i=e.update(n),r=n.material;if(Array.isArray(r)){const e=i.groups;for(let c=0,l=e.length;c<l;c++){const l=e[c],d=r[l.materialIndex];if(d&&d.visible){const e=E(n,i,d,a,o.near,o.far,s);t.renderBufferDirect(o,null,i,e,n,l)}}}else if(r.visible){const e=E(n,i,r,a,o.near,o.far,s);t.renderBufferDirect(o,null,i,e,n,null)}}const c=n.children;for(let t=0,e=c.length;t<e;t++)T(c[t],r,o,a,s)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=u,this.render=function(e,s,c){if(!1===x.enabled)return;if(!1===x.autoUpdate&&!1===x.needsUpdate)return;if(0===e.length)return;const l=t.getRenderTarget(),d=t.getActiveCubeFace(),u=t.getActiveMipmapLevel(),h=t.state;h.setBlending(b),h.buffers.color.setClear(1,1,1,1),h.buffers.depth.setTest(!0),h.setScissorTest(!1);for(let l=0,d=e.length;l<d;l++){const d=e[l],u=d.shadow;if(void 0===u){console.warn(\"THREE.WebGLShadowMap:\",d,\"has no shadow.\");continue}if(!1===u.autoUpdate&&!1===u.needsUpdate)continue;r.copy(u.mapSize);const f=u.getFrameExtents();if(r.multiply(f),o.copy(u.mapSize),(r.x>n||r.y>n)&&(r.x>n&&(o.x=Math.floor(n/f.x),r.x=o.x*f.x,u.mapSize.x=o.x),r.y>n&&(o.y=Math.floor(n/f.y),r.y=o.y*f.y,u.mapSize.y=o.y)),null===u.map&&!u.isPointLightShadow&&this.type===p){const t={minFilter:bt,magFilter:bt,format:jt};u.map=new Xn(r.x,r.y,t),u.map.texture.name=d.name+\".shadowMap\",u.mapPass=new Xn(r.x,r.y,t),u.camera.updateProjectionMatrix()}if(null===u.map){const t={minFilter:ft,magFilter:ft,format:jt};u.map=new Xn(r.x,r.y,t),u.map.texture.name=d.name+\".shadowMap\",u.camera.updateProjectionMatrix()}t.setRenderTarget(u.map),t.clear();const m=u.getViewportCount();for(let t=0;t<m;t++){const e=u.getViewport(t);a.set(o.x*e.x,o.y*e.y,o.x*e.z,o.y*e.w),h.viewport(a),u.updateMatrices(d,t),i=u.getFrustum(),T(s,c,u.camera,d,this.type)}u.isPointLightShadow||this.type!==p||w(u,c),u.needsUpdate=!1}x.needsUpdate=!1,t.setRenderTarget(l,d,u)}}function Es(t,e,n){const i=n.isWebGL2;const r=new function(){let e=!1;const n=new qn;let i=null;const r=new qn(0,0,0,0);return{setMask:function(n){i===n||e||(t.colorMask(n,n,n,n),i=n)},setLocked:function(t){e=t},setClear:function(e,i,o,a,s){!0===s&&(e*=a,i*=a,o*=a),n.set(e,i,o,a),!1===r.equals(n)&&(t.clearColor(e,i,o,a),r.copy(n))},reset:function(){e=!1,i=null,r.set(-1,0,0,0)}}},o=new function(){let e=!1,n=null,i=null,r=null;return{setTest:function(t){t?ft(2929):mt(2929)},setMask:function(i){n===i||e||(t.depthMask(i),n=i)},setFunc:function(e){if(i!==e){if(e)switch(e){case U:t.depthFunc(512);break;case H:t.depthFunc(519);break;case $:t.depthFunc(513);break;case G:t.depthFunc(515);break;case V:t.depthFunc(514);break;case W:t.depthFunc(518);break;case q:t.depthFunc(516);break;case X:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);i=e}},setLocked:function(t){e=t},setClear:function(e){r!==e&&(t.clearDepth(e),r=e)},reset:function(){e=!1,n=null,i=null,r=null}}},l=new function(){let e=!1,n=null,i=null,r=null,o=null,a=null,s=null,c=null,l=null;return{setTest:function(t){e||(t?ft(2960):mt(2960))},setMask:function(i){n===i||e||(t.stencilMask(i),n=i)},setFunc:function(e,n,a){i===e&&r===n&&o===a||(t.stencilFunc(e,n,a),i=e,r=n,o=a)},setOp:function(e,n,i){a===e&&s===n&&c===i||(t.stencilOp(e,n,i),a=e,s=n,c=i)},setLocked:function(t){e=t},setClear:function(e){l!==e&&(t.clearStencil(e),l=e)},reset:function(){e=!1,n=null,i=null,r=null,o=null,a=null,s=null,c=null,l=null}}};let d={},u=null,h=null,p=null,f=null,v=null,y=null,Y=null,K=null,Z=null,J=!1,Q=null,tt=null,et=null,nt=null,it=null;const rt=t.getParameter(35661);let ot=!1,at=0;const st=t.getParameter(7938);-1!==st.indexOf(\"WebGL\")?(at=parseFloat(/^WebGL (\\d)/.exec(st)[1]),ot=at>=1):-1!==st.indexOf(\"OpenGL ES\")&&(at=parseFloat(/^OpenGL ES (\\d)/.exec(st)[1]),ot=at>=2);let ct=null,lt={};const dt=new qn,ut=new qn;function ht(e,n,i){const r=new Uint8Array(4),o=t.createTexture();t.bindTexture(e,o),t.texParameteri(e,10241,9728),t.texParameteri(e,10240,9728);for(let e=0;e<i;e++)t.texImage2D(n+e,0,6408,1,1,0,6408,5121,r);return o}const pt={};function ft(e){!0!==d[e]&&(t.enable(e),d[e]=!0)}function mt(e){!1!==d[e]&&(t.disable(e),d[e]=!1)}pt[3553]=ht(3553,3553,1),pt[34067]=ht(34067,34069,6),r.setClear(0,0,0,1),o.setClear(1),l.setClear(0),ft(2929),o.setFunc(G),bt(!1),_t(s),ft(2884),yt(b);const gt={[E]:32774,[T]:32778,[C]:32779};if(i)gt[A]=32775,gt[O]=32776;else{const t=e.get(\"EXT_blend_minmax\");null!==t&&(gt[A]=t.MIN_EXT,gt[O]=t.MAX_EXT)}const vt={[k]:0,[L]:1,[I]:768,[P]:770,[z]:776,[j]:774,[N]:772,[R]:769,[D]:771,[B]:775,[F]:773};function yt(e,n,i,r,o,a,s,c){if(e!==b){if(h||(ft(3042),h=!0),e===M)o=o||n,a=a||i,s=s||r,n===f&&o===Y||(t.blendEquationSeparate(gt[n],gt[o]),f=n,Y=o),i===v&&r===y&&a===K&&s===Z||(t.blendFuncSeparate(vt[i],vt[r],vt[a],vt[s]),v=i,y=r,K=a,Z=s),p=e,J=null;else if(e!==p||c!==J){if(f===E&&Y===E||(t.blendEquation(32774),f=E,Y=E),c)switch(e){case _:t.blendFuncSeparate(1,771,1,771);break;case x:t.blendFunc(1,1);break;case w:t.blendFuncSeparate(0,0,769,771);break;case S:t.blendFuncSeparate(0,768,0,770);break;default:console.error(\"THREE.WebGLState: Invalid blending: \",e)}else switch(e){case _:t.blendFuncSeparate(770,771,1,771);break;case x:t.blendFunc(770,1);break;case w:t.blendFunc(0,769);break;case S:t.blendFunc(0,768);break;default:console.error(\"THREE.WebGLState: Invalid blending: \",e)}v=null,y=null,K=null,Z=null,p=e,J=c}}else h&&(mt(3042),h=!1)}function bt(e){Q!==e&&(e?t.frontFace(2304):t.frontFace(2305),Q=e)}function _t(e){e!==a?(ft(2884),e!==tt&&(e===s?t.cullFace(1029):e===c?t.cullFace(1028):t.cullFace(1032))):mt(2884),tt=e}function xt(e,n,i){e?(ft(32823),nt===n&&it===i||(t.polygonOffset(n,i),nt=n,it=i)):mt(32823)}function wt(e){void 0===e&&(e=33984+rt-1),ct!==e&&(t.activeTexture(e),ct=e)}return{buffers:{color:r,depth:o,stencil:l},enable:ft,disable:mt,useProgram:function(e){return u!==e&&(t.useProgram(e),u=e,!0)},setBlending:yt,setMaterial:function(t,e){t.side===g?mt(2884):ft(2884);let n=t.side===m;e&&(n=!n),bt(n),t.blending===_&&!1===t.transparent?yt(b):yt(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),o.setFunc(t.depthFunc),o.setTest(t.depthTest),o.setMask(t.depthWrite),r.setMask(t.colorWrite);const i=t.stencilWrite;l.setTest(i),i&&(l.setMask(t.stencilWriteMask),l.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),l.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),xt(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:bt,setCullFace:_t,setLineWidth:function(e){e!==et&&(ot&&t.lineWidth(e),et=e)},setPolygonOffset:xt,setScissorTest:function(t){t?ft(3089):mt(3089)},activeTexture:wt,bindTexture:function(e,n){null===ct&&wt();let i=lt[ct];void 0===i&&(i={type:void 0,texture:void 0},lt[ct]=i),i.type===e&&i.texture===n||(t.bindTexture(e,n||pt[e]),i.type=e,i.texture=n)},unbindTexture:function(){const e=lt[ct];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error(\"THREE.WebGLState:\",t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error(\"THREE.WebGLState:\",t)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(t){console.error(\"THREE.WebGLState:\",t)}},scissor:function(e){!1===dt.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),dt.copy(e))},viewport:function(e){!1===ut.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),ut.copy(e))},reset:function(){d={},ct=null,lt={},u=null,h=null,p=null,f=null,v=null,y=null,Y=null,K=null,Z=null,J=!1,Q=null,tt=null,et=null,nt=null,it=null,r.reset(),o.reset(),l.reset()}}}function Ts(t,e,n,i,r,o,a){const s=r.isWebGL2,c=r.maxTextures,l=r.maxCubemapSize,d=r.maxTextureSize,u=r.maxSamples,h=new WeakMap;let p,f=!1;try{f=\"undefined\"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext(\"2d\")}catch(t){}function m(t,e){return f?new OffscreenCanvas(t,e):document.createElementNS(\"http://www.w3.org/1999/xhtml\",\"canvas\")}function g(t,e,n,i){let r=1;if((t.width>i||t.height>i)&&(r=i/Math.max(t.width,t.height)),r<1||!0===e){if(\"undefined\"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||\"undefined\"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||\"undefined\"!=typeof ImageBitmap&&t instanceof ImageBitmap){const i=e?Bn.floorPowerOfTwo:Math.floor,o=i(r*t.width),a=i(r*t.height);void 0===p&&(p=m(o,a));const s=n?m(o,a):p;s.width=o,s.height=a;return s.getContext(\"2d\").drawImage(t,0,0,o,a),console.warn(\"THREE.WebGLRenderer: Texture has been resized from (\"+t.width+\"x\"+t.height+\") to (\"+o+\"x\"+a+\").\"),s}return\"data\"in t&&console.warn(\"THREE.WebGLRenderer: Image in DataTexture is too big (\"+t.width+\"x\"+t.height+\").\"),t}return t}function v(t){return Bn.isPowerOfTwo(t.width)&&Bn.isPowerOfTwo(t.height)}function y(t,e){return t.generateMipmaps&&e&&t.minFilter!==ft&&t.minFilter!==bt}function b(e,n,r,o){t.generateMipmap(e);i.get(n).__maxMipLevel=Math.log(Math.max(r,o))*Math.LOG2E}function _(n,i,r){if(!1===s)return i;if(null!==n){if(void 0!==t[n])return t[n];console.warn(\"THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '\"+n+\"'\")}let o=i;return 6403===i&&(5126===r&&(o=33326),5131===r&&(o=33325),5121===r&&(o=33321)),6407===i&&(5126===r&&(o=34837),5131===r&&(o=34843),5121===r&&(o=32849)),6408===i&&(5126===r&&(o=34836),5131===r&&(o=34842),5121===r&&(o=32856)),33325!==o&&33326!==o&&34842!==o&&34836!==o||e.get(\"EXT_color_buffer_float\"),o}function x(t){return t===ft||t===mt||t===vt?9728:9729}function w(e){const n=e.target;n.removeEventListener(\"dispose\",w),function(e){const n=i.get(e);if(void 0===n.__webglInit)return;t.deleteTexture(n.__webglTexture),i.remove(e)}(n),n.isVideoTexture&&h.delete(n),a.memory.textures--}function S(e){const n=e.target;n.removeEventListener(\"dispose\",S),function(e){const n=i.get(e),r=i.get(e.texture);if(!e)return;void 0!==r.__webglTexture&&t.deleteTexture(r.__webglTexture);e.depthTexture&&e.depthTexture.dispose();if(e.isWebGLCubeRenderTarget)for(let e=0;e<6;e++)t.deleteFramebuffer(n.__webglFramebuffer[e]),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer[e]);else t.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&t.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer&&t.deleteRenderbuffer(n.__webglColorRenderbuffer),n.__webglDepthRenderbuffer&&t.deleteRenderbuffer(n.__webglDepthRenderbuffer);i.remove(e.texture),i.remove(e)}(n),a.memory.textures--}let M=0;function E(t,e){const r=i.get(t);if(t.isVideoTexture&&function(t){const e=a.render.frame;h.get(t)!==e&&(h.set(t,e),t.update())}(t),t.version>0&&r.__version!==t.version){const n=t.image;if(void 0===n)console.warn(\"THREE.WebGLRenderer: Texture marked for update but image is undefined\");else{if(!1!==n.complete)return void L(r,t,e);console.warn(\"THREE.WebGLRenderer: Texture marked for update but image is incomplete\")}}n.activeTexture(33984+e),n.bindTexture(3553,r.__webglTexture)}function T(e,r){const a=i.get(e);e.version>0&&a.__version!==e.version?function(e,i,r){if(6!==i.image.length)return;k(e,i),n.activeTexture(33984+r),n.bindTexture(34067,e.__webglTexture),t.pixelStorei(37440,i.flipY),t.pixelStorei(37441,i.premultiplyAlpha),t.pixelStorei(3317,i.unpackAlignment);const a=i&&(i.isCompressedTexture||i.image[0].isCompressedTexture),c=i.image[0]&&i.image[0].isDataTexture,d=[];for(let t=0;t<6;t++)d[t]=a||c?c?i.image[t].image:i.image[t]:g(i.image[t],!1,!0,l);const u=d[0],h=v(u)||s,p=o.convert(i.format),f=o.convert(i.type),m=_(i.internalFormat,p,f);let x;if(O(34067,i,h),a){for(let t=0;t<6;t++){x=d[t].mipmaps;for(let e=0;e<x.length;e++){const r=x[e];i.format!==jt&&i.format!==Ft?null!==p?n.compressedTexImage2D(34069+t,e,m,r.width,r.height,0,r.data):console.warn(\"THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()\"):n.texImage2D(34069+t,e,m,r.width,r.height,0,p,f,r.data)}}e.__maxMipLevel=x.length-1}else{x=i.mipmaps;for(let t=0;t<6;t++)if(c){n.texImage2D(34069+t,0,m,d[t].width,d[t].height,0,p,f,d[t].data);for(let e=0;e<x.length;e++){const i=x[e].image[t].image;n.texImage2D(34069+t,e+1,m,i.width,i.height,0,p,f,i.data)}}else{n.texImage2D(34069+t,0,m,p,f,d[t]);for(let e=0;e<x.length;e++){const i=x[e];n.texImage2D(34069+t,e+1,m,p,f,i.image[t])}}e.__maxMipLevel=x.length}y(i,h)&&b(34067,i,u.width,u.height);e.__version=i.version,i.onUpdate&&i.onUpdate(i)}(a,e,r):(n.activeTexture(33984+r),n.bindTexture(34067,a.__webglTexture))}const C={[ut]:10497,[ht]:33071,[pt]:33648},A={[ft]:9728,[mt]:9984,[vt]:9986,[bt]:9729,[_t]:9985,[wt]:9987};function O(n,o,a){a?(t.texParameteri(n,10242,C[o.wrapS]),t.texParameteri(n,10243,C[o.wrapT]),32879!==n&&35866!==n||t.texParameteri(n,32882,C[o.wrapR]),t.texParameteri(n,10240,A[o.magFilter]),t.texParameteri(n,10241,A[o.minFilter])):(t.texParameteri(n,10242,33071),t.texParameteri(n,10243,33071),32879!==n&&35866!==n||t.texParameteri(n,32882,33071),o.wrapS===ht&&o.wrapT===ht||console.warn(\"THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.\"),t.texParameteri(n,10240,x(o.magFilter)),t.texParameteri(n,10241,x(o.minFilter)),o.minFilter!==ft&&o.minFilter!==bt&&console.warn(\"THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.\"));const c=e.get(\"EXT_texture_filter_anisotropic\");if(c){if(o.type===kt&&null===e.get(\"OES_texture_float_linear\"))return;if(o.type===Lt&&null===(s||e.get(\"OES_texture_half_float_linear\")))return;(o.anisotropy>1||i.get(o).__currentAnisotropy)&&(t.texParameterf(n,c.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,r.getMaxAnisotropy())),i.get(o).__currentAnisotropy=o.anisotropy)}}function k(e,n){void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener(\"dispose\",w),e.__webglTexture=t.createTexture(),a.memory.textures++)}function L(e,i,r){let a=3553;i.isDataTexture2DArray&&(a=35866),i.isDataTexture3D&&(a=32879),k(e,i),n.activeTexture(33984+r),n.bindTexture(a,e.__webglTexture),t.pixelStorei(37440,i.flipY),t.pixelStorei(37441,i.premultiplyAlpha),t.pixelStorei(3317,i.unpackAlignment);const c=function(t){return!s&&(t.wrapS!==ht||t.wrapT!==ht||t.minFilter!==ft&&t.minFilter!==bt)}(i)&&!1===v(i.image),l=g(i.image,c,!1,d),u=v(l)||s,h=o.convert(i.format);let p,f=o.convert(i.type),m=_(i.internalFormat,h,f);O(a,i,u);const x=i.mipmaps;if(i.isDepthTexture)m=6402,s?m=i.type===kt?36012:i.type===Ot?33190:i.type===Dt?35056:33189:i.type===kt&&console.error(\"WebGLRenderer: Floating point depth texture requires WebGL2.\"),i.format===Ht&&6402===m&&i.type!==Ct&&i.type!==Ot&&(console.warn(\"THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture.\"),i.type=Ct,f=o.convert(i.type)),i.format===$t&&6402===m&&(m=34041,i.type!==Dt&&(console.warn(\"THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture.\"),i.type=Dt,f=o.convert(i.type))),n.texImage2D(3553,0,m,l.width,l.height,0,h,f,null);else if(i.isDataTexture)if(x.length>0&&u){for(let t=0,e=x.length;t<e;t++)p=x[t],n.texImage2D(3553,t,m,p.width,p.height,0,h,f,p.data);i.generateMipmaps=!1,e.__maxMipLevel=x.length-1}else n.texImage2D(3553,0,m,l.width,l.height,0,h,f,l.data),e.__maxMipLevel=0;else if(i.isCompressedTexture){for(let t=0,e=x.length;t<e;t++)p=x[t],i.format!==jt&&i.format!==Ft?null!==h?n.compressedTexImage2D(3553,t,m,p.width,p.height,0,p.data):console.warn(\"THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()\"):n.texImage2D(3553,t,m,p.width,p.height,0,h,f,p.data);e.__maxMipLevel=x.length-1}else if(i.isDataTexture2DArray)n.texImage3D(35866,0,m,l.width,l.height,l.depth,0,h,f,l.data),e.__maxMipLevel=0;else if(i.isDataTexture3D)n.texImage3D(32879,0,m,l.width,l.height,l.depth,0,h,f,l.data),e.__maxMipLevel=0;else if(x.length>0&&u){for(let t=0,e=x.length;t<e;t++)p=x[t],n.texImage2D(3553,t,m,h,f,p);i.generateMipmaps=!1,e.__maxMipLevel=x.length-1}else n.texImage2D(3553,0,m,h,f,l),e.__maxMipLevel=0;y(i,u)&&b(a,i,l.width,l.height),e.__version=i.version,i.onUpdate&&i.onUpdate(i)}function I(e,r,a,s){const c=o.convert(r.texture.format),l=o.convert(r.texture.type),d=_(r.texture.internalFormat,c,l);n.texImage2D(s,0,d,r.width,r.height,0,c,l,null),t.bindFramebuffer(36160,e),t.framebufferTexture2D(36160,a,s,i.get(r.texture).__webglTexture,0),t.bindFramebuffer(36160,null)}function R(e,n,i){if(t.bindRenderbuffer(36161,e),n.depthBuffer&&!n.stencilBuffer){let r=33189;if(i){const e=n.depthTexture;e&&e.isDepthTexture&&(e.type===kt?r=36012:e.type===Ot&&(r=33190));const i=D(n);t.renderbufferStorageMultisample(36161,i,r,n.width,n.height)}else t.renderbufferStorage(36161,r,n.width,n.height);t.framebufferRenderbuffer(36160,36096,36161,e)}else if(n.depthBuffer&&n.stencilBuffer){if(i){const e=D(n);t.renderbufferStorageMultisample(36161,e,35056,n.width,n.height)}else t.renderbufferStorage(36161,34041,n.width,n.height);t.framebufferRenderbuffer(36160,33306,36161,e)}else{const e=o.convert(n.texture.format),r=o.convert(n.texture.type),a=_(n.texture.internalFormat,e,r);if(i){const e=D(n);t.renderbufferStorageMultisample(36161,e,a,n.width,n.height)}else t.renderbufferStorage(36161,a,n.width,n.height)}t.bindRenderbuffer(36161,null)}function P(e){const n=i.get(e),r=!0===e.isWebGLCubeRenderTarget;if(e.depthTexture){if(r)throw new Error(\"target.depthTexture not supported in Cube render targets\");!function(e,n){if(n&&n.isWebGLCubeRenderTarget)throw new Error(\"Depth Texture with cube render targets is not supported\");if(t.bindFramebuffer(36160,e),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error(\"renderTarget.depthTexture must be an instance of THREE.DepthTexture\");i.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),E(n.depthTexture,0);const r=i.get(n.depthTexture).__webglTexture;if(n.depthTexture.format===Ht)t.framebufferTexture2D(36160,36096,3553,r,0);else{if(n.depthTexture.format!==$t)throw new Error(\"Unknown depthTexture format\");t.framebufferTexture2D(36160,33306,3553,r,0)}}(n.__webglFramebuffer,e)}else if(r){n.__webglDepthbuffer=[];for(let i=0;i<6;i++)t.bindFramebuffer(36160,n.__webglFramebuffer[i]),n.__webglDepthbuffer[i]=t.createRenderbuffer(),R(n.__webglDepthbuffer[i],e,!1)}else t.bindFramebuffer(36160,n.__webglFramebuffer),n.__webglDepthbuffer=t.createRenderbuffer(),R(n.__webglDepthbuffer,e,!1);t.bindFramebuffer(36160,null)}function D(t){return s&&t.isWebGLMultisampleRenderTarget?Math.min(u,t.samples):0}let N=!1,F=!1;this.allocateTextureUnit=function(){const t=M;return t>=c&&console.warn(\"THREE.WebGLTextures: Trying to use \"+t+\" texture units while this GPU supports only \"+c),M+=1,t},this.resetTextureUnits=function(){M=0},this.setTexture2D=E,this.setTexture2DArray=function(t,e){const r=i.get(t);t.version>0&&r.__version!==t.version?L(r,t,e):(n.activeTexture(33984+e),n.bindTexture(35866,r.__webglTexture))},this.setTexture3D=function(t,e){const r=i.get(t);t.version>0&&r.__version!==t.version?L(r,t,e):(n.activeTexture(33984+e),n.bindTexture(32879,r.__webglTexture))},this.setTextureCube=T,this.setupRenderTarget=function(e){const r=i.get(e),c=i.get(e.texture);e.addEventListener(\"dispose\",S),c.__webglTexture=t.createTexture(),a.memory.textures++;const l=!0===e.isWebGLCubeRenderTarget,d=!0===e.isWebGLMultisampleRenderTarget,u=v(e)||s;if(!s||e.texture.format!==Ft||e.texture.type!==kt&&e.texture.type!==Lt||(e.texture.format=jt,console.warn(\"THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.\")),l){r.__webglFramebuffer=[];for(let e=0;e<6;e++)r.__webglFramebuffer[e]=t.createFramebuffer()}else if(r.__webglFramebuffer=t.createFramebuffer(),d)if(s){r.__webglMultisampledFramebuffer=t.createFramebuffer(),r.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,r.__webglColorRenderbuffer);const n=o.convert(e.texture.format),i=o.convert(e.texture.type),a=_(e.texture.internalFormat,n,i),s=D(e);t.renderbufferStorageMultisample(36161,s,a,e.width,e.height),t.bindFramebuffer(36160,r.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,r.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),e.depthBuffer&&(r.__webglDepthRenderbuffer=t.createRenderbuffer(),R(r.__webglDepthRenderbuffer,e,!0)),t.bindFramebuffer(36160,null)}else console.warn(\"THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.\");if(l){n.bindTexture(34067,c.__webglTexture),O(34067,e.texture,u);for(let t=0;t<6;t++)I(r.__webglFramebuffer[t],e,36064,34069+t);y(e.texture,u)&&b(34067,e.texture,e.width,e.height),n.bindTexture(34067,null)}else n.bindTexture(3553,c.__webglTexture),O(3553,e.texture,u),I(r.__webglFramebuffer,e,36064,3553),y(e.texture,u)&&b(3553,e.texture,e.width,e.height),n.bindTexture(3553,null);e.depthBuffer&&P(e)},this.updateRenderTargetMipmap=function(t){const e=t.texture;if(y(e,v(t)||s)){const r=t.isWebGLCubeRenderTarget?34067:3553,o=i.get(e).__webglTexture;n.bindTexture(r,o),b(r,e,t.width,t.height),n.bindTexture(r,null)}},this.updateMultisampleRenderTarget=function(e){if(e.isWebGLMultisampleRenderTarget)if(s){const n=i.get(e);t.bindFramebuffer(36008,n.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,n.__webglFramebuffer);const r=e.width,o=e.height;let a=16384;e.depthBuffer&&(a|=256),e.stencilBuffer&&(a|=1024),t.blitFramebuffer(0,0,r,o,0,0,r,o,a,9728),t.bindFramebuffer(36160,n.__webglMultisampledFramebuffer)}else console.warn(\"THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.\")},this.safeSetTexture2D=function(t,e){t&&t.isWebGLRenderTarget&&(!1===N&&(console.warn(\"THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead.\"),N=!0),t=t.texture),E(t,e)},this.safeSetTextureCube=function(t,e){t&&t.isWebGLCubeRenderTarget&&(!1===F&&(console.warn(\"THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead.\"),F=!0),t=t.texture),T(t,e)}}function Cs(t,e,n){const i=n.isWebGL2;return{convert:function(t){let n;if(t===Mt)return 5121;if(t===It)return 32819;if(t===Rt)return 32820;if(t===Pt)return 33635;if(t===Et)return 5120;if(t===Tt)return 5122;if(t===Ct)return 5123;if(t===At)return 5124;if(t===Ot)return 5125;if(t===kt)return 5126;if(t===Lt)return i?5131:(n=e.get(\"OES_texture_half_float\"),null!==n?n.HALF_FLOAT_OES:null);if(t===Nt)return 6406;if(t===Ft)return 6407;if(t===jt)return 6408;if(t===Bt)return 6409;if(t===zt)return 6410;if(t===Ht)return 6402;if(t===$t)return 34041;if(t===Gt)return 6403;if(t===Vt)return 36244;if(t===Wt)return 33319;if(t===qt)return 33320;if(t===Xt)return 36248;if(t===Yt)return 36249;if(t===Kt||t===Zt||t===Jt||t===Qt){if(n=e.get(\"WEBGL_compressed_texture_s3tc\"),null===n)return null;if(t===Kt)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===Zt)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===Jt)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===Qt)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(t===te||t===ee||t===ne||t===ie){if(n=e.get(\"WEBGL_compressed_texture_pvrtc\"),null===n)return null;if(t===te)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===ee)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===ne)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===ie)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(t===re)return n=e.get(\"WEBGL_compressed_texture_etc1\"),null!==n?n.COMPRESSED_RGB_ETC1_WEBGL:null;if((t===oe||t===ae)&&(n=e.get(\"WEBGL_compressed_texture_etc\"),null!==n)){if(t===oe)return n.COMPRESSED_RGB8_ETC2;if(t===ae)return n.COMPRESSED_RGBA8_ETC2_EAC}return t===se||t===ce||t===le||t===de||t===ue||t===he||t===pe||t===fe||t===me||t===ge||t===ve||t===ye||t===be||t===_e||t===we||t===Se||t===Me||t===Ee||t===Te||t===Ce||t===Ae||t===Oe||t===ke||t===Le||t===Ie||t===Re||t===Pe||t===De?(n=e.get(\"WEBGL_compressed_texture_astc\"),null!==n?t:null):t===xe?(n=e.get(\"EXT_texture_compression_bptc\"),null!==n?t:null):t===Dt?i?34042:(n=e.get(\"WEBGL_depth_texture\"),null!==n?n.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}function As(t=[]){bo.call(this),this.cameras=t}function Os(){Ki.call(this),this.type=\"Group\"}function ks(){this._targetRay=null,this._grip=null,this._hand=null}function Ls(t,e){const n=this;let i=null,r=1,o=null,a=\"local-floor\",s=null;const c=[],l=new Map,d=new bo;d.layers.enable(1),d.viewport=new qn;const u=new bo;u.layers.enable(2),u.viewport=new qn;const h=[d,u],p=new As;p.layers.enable(1),p.layers.enable(2);let f=null,m=null;function g(t){const e=l.get(t.inputSource);e&&e.dispatchEvent({type:t.type,data:t.inputSource})}function v(){l.forEach((function(t,e){t.disconnect(e)})),l.clear(),f=null,m=null,t.setFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),S.stop(),n.isPresenting=!1,n.dispatchEvent({type:\"sessionend\"})}function y(t){const e=i.inputSources;for(let t=0;t<c.length;t++)l.set(e[t],c[t]);for(let e=0;e<t.removed.length;e++){const n=t.removed[e],i=l.get(n);i&&(i.dispatchEvent({type:\"disconnected\",data:n}),l.delete(n))}for(let e=0;e<t.added.length;e++){const n=t.added[e],i=l.get(n);i&&i.dispatchEvent({type:\"connected\",data:n})}}this.enabled=!1,this.isPresenting=!1,this.getController=function(t){let e=c[t];return void 0===e&&(e=new ks,c[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){let e=c[t];return void 0===e&&(e=new ks,c[t]=e),e.getGripSpace()},this.getHand=function(t){let e=c[t];return void 0===e&&(e=new ks,c[t]=e),e.getHandSpace()},this.setFramebufferScaleFactor=function(t){r=t,!0===n.isPresenting&&console.warn(\"THREE.WebXRManager: Cannot change framebuffer scale while presenting.\")},this.setReferenceSpaceType=function(t){a=t,!0===n.isPresenting&&console.warn(\"THREE.WebXRManager: Cannot change reference space type while presenting.\")},this.getReferenceSpace=function(){return o},this.getSession=function(){return i},this.setSession=async function(t){if(i=t,null!==i){i.addEventListener(\"select\",g),i.addEventListener(\"selectstart\",g),i.addEventListener(\"selectend\",g),i.addEventListener(\"squeeze\",g),i.addEventListener(\"squeezestart\",g),i.addEventListener(\"squeezeend\",g),i.addEventListener(\"end\",v),i.addEventListener(\"inputsourceschange\",y);const t=e.getContextAttributes();!0!==t.xrCompatible&&await e.makeXRCompatible();const s={antialias:t.antialias,alpha:t.alpha,depth:t.depth,stencil:t.stencil,framebufferScaleFactor:r},c=new XRWebGLLayer(i,e,s);i.updateRenderState({baseLayer:c}),o=await i.requestReferenceSpace(a),S.setContext(i),S.start(),n.isPresenting=!0,n.dispatchEvent({type:\"sessionstart\"})}};const b=new Zn,_=new Zn;function x(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.copy(t.matrixWorld).invert()}this.getCamera=function(t){p.near=u.near=d.near=t.near,p.far=u.far=d.far=t.far,f===p.near&&m===p.far||(i.updateRenderState({depthNear:p.near,depthFar:p.far}),f=p.near,m=p.far);const e=t.parent,n=p.cameras;x(p,e);for(let t=0;t<n.length;t++)x(n[t],e);t.matrixWorld.copy(p.matrixWorld),t.matrix.copy(p.matrix),t.matrix.decompose(t.position,t.quaternion,t.scale);const r=t.children;for(let t=0,e=r.length;t<e;t++)r[t].updateMatrixWorld(!0);return 2===n.length?function(t,e,n){b.setFromMatrixPosition(e.matrixWorld),_.setFromMatrixPosition(n.matrixWorld);const i=b.distanceTo(_),r=e.projectionMatrix.elements,o=n.projectionMatrix.elements,a=r[14]/(r[10]-1),s=r[14]/(r[10]+1),c=(r[9]+1)/r[5],l=(r[9]-1)/r[5],d=(r[8]-1)/r[0],u=(o[8]+1)/o[0],h=a*d,p=a*u,f=i/(-d+u),m=f*-d;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(f),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.copy(t.matrixWorld).invert();const g=a+f,v=s+f,y=h-m,x=p+(i-m),w=c*s/v*g,S=l*s/v*g;t.projectionMatrix.makePerspective(y,x,w,S,g,v)}(p,d,u):p.projectionMatrix.copy(d.projectionMatrix),p};let w=null;const S=new Co;S.setAnimationLoop((function(e,n){if(s=n.getViewerPose(o),null!==s){const e=s.views,n=i.renderState.baseLayer;t.setFramebuffer(n.framebuffer);let r=!1;e.length!==p.cameras.length&&(p.cameras.length=0,r=!0);for(let t=0;t<e.length;t++){const i=e[t],o=n.getViewport(i),a=h[t];a.matrix.fromArray(i.transform.matrix),a.projectionMatrix.fromArray(i.projectionMatrix),a.viewport.set(o.x,o.y,o.width,o.height),0===t&&p.matrix.copy(a.matrix),!0===r&&p.cameras.push(a)}}const r=i.inputSources;for(let t=0;t<c.length;t++){const e=c[t],i=r[t];e.update(i,n,o)}w&&w(e,n)})),this.setAnimationLoop=function(t){w=t},this.dispose=function(){}}function Is(t){function e(e,n){e.opacity.value=n.opacity,n.color&&e.diffuse.value.copy(n.color),n.emissive&&e.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(e.map.value=n.map),n.alphaMap&&(e.alphaMap.value=n.alphaMap),n.specularMap&&(e.specularMap.value=n.specularMap);const i=t.get(n).envMap;if(i){e.envMap.value=i,e.flipEnvMap.value=i.isCubeTexture&&i._needsFlipEnvMap?-1:1,e.reflectivity.value=n.reflectivity,e.refractionRatio.value=n.refractionRatio;const r=t.get(i).__maxMipLevel;void 0!==r&&(e.maxMipLevel.value=r)}let r,o;n.lightMap&&(e.lightMap.value=n.lightMap,e.lightMapIntensity.value=n.lightMapIntensity),n.aoMap&&(e.aoMap.value=n.aoMap,e.aoMapIntensity.value=n.aoMapIntensity),n.map?r=n.map:n.specularMap?r=n.specularMap:n.displacementMap?r=n.displacementMap:n.normalMap?r=n.normalMap:n.bumpMap?r=n.bumpMap:n.roughnessMap?r=n.roughnessMap:n.metalnessMap?r=n.metalnessMap:n.alphaMap?r=n.alphaMap:n.emissiveMap?r=n.emissiveMap:n.clearcoatMap?r=n.clearcoatMap:n.clearcoatNormalMap?r=n.clearcoatNormalMap:n.clearcoatRoughnessMap&&(r=n.clearcoatRoughnessMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix)),n.aoMap?o=n.aoMap:n.lightMap&&(o=n.lightMap),void 0!==o&&(o.isWebGLRenderTarget&&(o=o.texture),!0===o.matrixAutoUpdate&&o.updateMatrix(),e.uv2Transform.value.copy(o.matrix))}function n(e,n){e.roughness.value=n.roughness,e.metalness.value=n.metalness,n.roughnessMap&&(e.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(e.metalnessMap.value=n.metalnessMap),n.emissiveMap&&(e.emissiveMap.value=n.emissiveMap),n.bumpMap&&(e.bumpMap.value=n.bumpMap,e.bumpScale.value=n.bumpScale,n.side===m&&(e.bumpScale.value*=-1)),n.normalMap&&(e.normalMap.value=n.normalMap,e.normalScale.value.copy(n.normalScale),n.side===m&&e.normalScale.value.negate()),n.displacementMap&&(e.displacementMap.value=n.displacementMap,e.displacementScale.value=n.displacementScale,e.displacementBias.value=n.displacementBias);t.get(n).envMap&&(e.envMapIntensity.value=n.envMapIntensity)}return{refreshFogUniforms:function(t,e){t.fogColor.value.copy(e.color),e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)},refreshMaterialUniforms:function(t,i,r,o){i.isMeshBasicMaterial?e(t,i):i.isMeshLambertMaterial?(e(t,i),function(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}(t,i)):i.isMeshToonMaterial?(e(t,i),function(t,e){e.gradientMap&&(t.gradientMap.value=e.gradientMap);e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===m&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===m&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,i)):i.isMeshPhongMaterial?(e(t,i),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===m&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===m&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,i)):i.isMeshStandardMaterial?(e(t,i),i.isMeshPhysicalMaterial?function(t,e){n(t,e),t.reflectivity.value=e.reflectivity,t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.sheen&&t.sheen.value.copy(e.sheen);e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap);e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap);e.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),t.clearcoatNormalMap.value=e.clearcoatNormalMap,e.side===m&&t.clearcoatNormalScale.value.negate());t.transmission.value=e.transmission,e.transmissionMap&&(t.transmissionMap.value=e.transmissionMap)}(t,i):n(t,i)):i.isMeshMatcapMaterial?(e(t,i),function(t,e){e.matcap&&(t.matcap.value=e.matcap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===m&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===m&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,i)):i.isMeshDepthMaterial?(e(t,i),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,i)):i.isMeshDistanceMaterial?(e(t,i),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias);t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(t,i)):i.isMeshNormalMaterial?(e(t,i),function(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===m&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===m&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,i)):i.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity}(t,i),i.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(t,i)):i.isPointsMaterial?function(t,e,n,i){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*n,t.scale.value=.5*i,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);let r;e.map?r=e.map:e.alphaMap&&(r=e.alphaMap);void 0!==r&&(!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix))}(t,i,r,o):i.isSpriteMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);let n;e.map?n=e.map:e.alphaMap&&(n=e.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}(t,i):i.isShadowMaterial?(t.color.value.copy(i.color),t.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function Rs(t){const e=void 0!==(t=t||{}).canvas?t.canvas:function(){const t=document.createElementNS(\"http://www.w3.org/1999/xhtml\",\"canvas\");return t.style.display=\"block\",t}(),n=void 0!==t.context?t.context:null,i=void 0!==t.alpha&&t.alpha,r=void 0===t.depth||t.depth,o=void 0===t.stencil||t.stencil,a=void 0!==t.antialias&&t.antialias,s=void 0===t.premultipliedAlpha||t.premultipliedAlpha,c=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,l=void 0!==t.powerPreference?t.powerPreference:\"default\",d=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat;let u=null,h=null;const p=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Ke,this.physicallyCorrectLights=!1,this.toneMapping=J,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;const f=this;let m=!1,g=null,v=0,y=0,b=null,_=null,x=-1,w=null;const S=new qn,M=new qn;let E=null,T=e.width,C=e.height,A=1,O=null,k=null;const L=new qn(0,0,T,C),I=new qn(0,0,T,C);let R=!1;const P=new To;let D=!1,N=!1;const F=new Ei,j=new Zn,B={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function z(){return null===b?A:1}let U,H,$,G,V,W,q,X,Y,K,Z,Q,tt,et,nt,it,rt,ot,at,st,ct,lt=n;function dt(t,n){for(let i=0;i<t.length;i++){const r=t[i],o=e.getContext(r,n);if(null!==o)return o}return null}try{const t={alpha:i,depth:r,stencil:o,antialias:a,premultipliedAlpha:s,preserveDrawingBuffer:c,powerPreference:l,failIfMajorPerformanceCaveat:d};if(e.addEventListener(\"webglcontextlost\",ft,!1),e.addEventListener(\"webglcontextrestored\",mt,!1),null===lt){const e=[\"webgl2\",\"webgl\",\"experimental-webgl\"];if(!0===f.isWebGL1Renderer&&e.shift(),lt=dt(e,t),null===lt)throw dt(e)?new Error(\"Error creating WebGL context with your selected attributes.\"):new Error(\"Error creating WebGL context.\")}void 0===lt.getShaderPrecisionFormat&&(lt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){throw console.error(\"THREE.WebGLRenderer: \"+t.message),t}function ut(){U=new Bo(lt),H=new No(lt,U,t),U.init(H),st=new Cs(lt,U,H),$=new Es(lt,U,H),$.scissor(M.copy(I).multiplyScalar(A).floor()),$.viewport(S.copy(L).multiplyScalar(A).floor()),G=new Ho(lt),V=new us,W=new Ts(lt,U,$,V,H,st,G),q=new jo(f),X=new Ao(lt,H),ct=new Po(lt,U,X,H),Y=new zo(lt,X,G,ct),K=new Wo(lt,Y,X,G),rt=new Vo(lt),nt=new Fo(V),Z=new ds(f,q,U,H,ct,nt),Q=new Is(V),tt=new ms(V),et=new xs(U,H),it=new Ro(f,q,$,K,s),ot=new Do(lt,U,G,H),at=new Uo(lt,U,G,H),G.programs=Z.programs,f.capabilities=H,f.extensions=U,f.properties=V,f.renderLists=tt,f.state=$,f.info=G}ut();const ht=new Ls(f,lt);this.xr=ht;const pt=new Ms(f,K,H.maxTextureSize);function ft(t){t.preventDefault(),console.log(\"THREE.WebGLRenderer: Context Lost.\"),m=!0}function mt(){console.log(\"THREE.WebGLRenderer: Context Restored.\"),m=!1,ut()}function gt(t){const e=t.target;e.removeEventListener(\"dispose\",gt),function(t){vt(t),V.remove(t)}(e)}function vt(t){const e=V.get(t).program;void 0!==e&&Z.releaseProgram(e)}this.shadowMap=pt,this.getContext=function(){return lt},this.getContextAttributes=function(){return lt.getContextAttributes()},this.forceContextLoss=function(){const t=U.get(\"WEBGL_lose_context\");t&&t.loseContext()},this.forceContextRestore=function(){const t=U.get(\"WEBGL_lose_context\");t&&t.restoreContext()},this.getPixelRatio=function(){return A},this.setPixelRatio=function(t){void 0!==t&&(A=t,this.setSize(T,C,!1))},this.getSize=function(t){return void 0===t&&(console.warn(\"WebGLRenderer: .getsize() now requires a Vector2 as an argument\"),t=new zn),t.set(T,C)},this.setSize=function(t,n,i){ht.isPresenting?console.warn(\"THREE.WebGLRenderer: Can't change size while VR device is presenting.\"):(T=t,C=n,e.width=Math.floor(t*A),e.height=Math.floor(n*A),!1!==i&&(e.style.width=t+\"px\",e.style.height=n+\"px\"),this.setViewport(0,0,t,n))},this.getDrawingBufferSize=function(t){return void 0===t&&(console.warn(\"WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument\"),t=new zn),t.set(T*A,C*A).floor()},this.setDrawingBufferSize=function(t,n,i){T=t,C=n,A=i,e.width=Math.floor(t*i),e.height=Math.floor(n*i),this.setViewport(0,0,t,n)},this.getCurrentViewport=function(t){return void 0===t&&(console.warn(\"WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument\"),t=new qn),t.copy(S)},this.getViewport=function(t){return t.copy(L)},this.setViewport=function(t,e,n,i){t.isVector4?L.set(t.x,t.y,t.z,t.w):L.set(t,e,n,i),$.viewport(S.copy(L).multiplyScalar(A).floor())},this.getScissor=function(t){return t.copy(I)},this.setScissor=function(t,e,n,i){t.isVector4?I.set(t.x,t.y,t.z,t.w):I.set(t,e,n,i),$.scissor(M.copy(I).multiplyScalar(A).floor())},this.getScissorTest=function(){return R},this.setScissorTest=function(t){$.setScissorTest(R=t)},this.setOpaqueSort=function(t){O=t},this.setTransparentSort=function(t){k=t},this.getClearColor=function(t){return void 0===t&&(console.warn(\"WebGLRenderer: .getClearColor() now requires a Color as an argument\"),t=new yr),t.copy(it.getClearColor())},this.setClearColor=function(){it.setClearColor.apply(it,arguments)},this.getClearAlpha=function(){return it.getClearAlpha()},this.setClearAlpha=function(){it.setClearAlpha.apply(it,arguments)},this.clear=function(t,e,n){let i=0;(void 0===t||t)&&(i|=16384),(void 0===e||e)&&(i|=256),(void 0===n||n)&&(i|=1024),lt.clear(i)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener(\"webglcontextlost\",ft,!1),e.removeEventListener(\"webglcontextrestored\",mt,!1),tt.dispose(),et.dispose(),V.dispose(),q.dispose(),K.dispose(),ct.dispose(),ht.dispose(),bt.stop()},this.renderBufferImmediate=function(t,e){ct.initAttributes();const n=V.get(t);t.hasPositions&&!n.position&&(n.position=lt.createBuffer()),t.hasNormals&&!n.normal&&(n.normal=lt.createBuffer()),t.hasUvs&&!n.uv&&(n.uv=lt.createBuffer()),t.hasColors&&!n.color&&(n.color=lt.createBuffer());const i=e.getAttributes();t.hasPositions&&(lt.bindBuffer(34962,n.position),lt.bufferData(34962,t.positionArray,35048),ct.enableAttribute(i.position),lt.vertexAttribPointer(i.position,3,5126,!1,0,0)),t.hasNormals&&(lt.bindBuffer(34962,n.normal),lt.bufferData(34962,t.normalArray,35048),ct.enableAttribute(i.normal),lt.vertexAttribPointer(i.normal,3,5126,!1,0,0)),t.hasUvs&&(lt.bindBuffer(34962,n.uv),lt.bufferData(34962,t.uvArray,35048),ct.enableAttribute(i.uv),lt.vertexAttribPointer(i.uv,2,5126,!1,0,0)),t.hasColors&&(lt.bindBuffer(34962,n.color),lt.bufferData(34962,t.colorArray,35048),ct.enableAttribute(i.color),lt.vertexAttribPointer(i.color,3,5126,!1,0,0)),ct.disableUnusedAttributes(),lt.drawArrays(4,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,n,i,r,o){null===e&&(e=B);const a=r.isMesh&&r.matrixWorld.determinant()<0,s=Et(t,e,i,r);$.setMaterial(i,a);let c=n.index;const l=n.attributes.position;if(null===c){if(void 0===l||0===l.count)return}else if(0===c.count)return;let d,u=1;!0===i.wireframe&&(c=Y.getWireframeAttribute(n),u=2),(i.morphTargets||i.morphNormals)&&rt.update(r,n,i,s),ct.setup(r,i,s,n,c);let h=ot;null!==c&&(d=X.get(c),h=at,h.setIndex(d));const p=null!==c?c.count:l.count,f=n.drawRange.start*u,m=n.drawRange.count*u,g=null!==o?o.start*u:0,v=null!==o?o.count*u:1/0,y=Math.max(f,g),b=Math.min(p,f+m,g+v)-1,_=Math.max(0,b-y+1);if(0!==_){if(r.isMesh)!0===i.wireframe?($.setLineWidth(i.wireframeLinewidth*z()),h.setMode(1)):h.setMode(4);else if(r.isLine){let t=i.linewidth;void 0===t&&(t=1),$.setLineWidth(t*z()),r.isLineSegments?h.setMode(1):r.isLineLoop?h.setMode(2):h.setMode(3)}else r.isPoints?h.setMode(0):r.isSprite&&h.setMode(4);if(r.isInstancedMesh)h.renderInstances(y,_,r.count);else if(n.isInstancedBufferGeometry){const t=Math.min(n.instanceCount,n._maxInstanceCount);h.renderInstances(y,_,t)}else h.render(y,_)}},this.compile=function(t,e){h=et.get(t),h.init(),t.traverseVisible((function(t){t.isLight&&t.layers.test(e.layers)&&(h.pushLight(t),t.castShadow&&h.pushShadow(t))})),h.setupLights();const n=new WeakMap;t.traverse((function(e){const i=e.material;if(i)if(Array.isArray(i))for(let r=0;r<i.length;r++){const o=i[r];!1===n.has(o)&&(St(o,t,e),n.set(o))}else!1===n.has(i)&&(St(i,t,e),n.set(i))}))};let yt=null;const bt=new Co;function _t(t,e,n,i){if(!1===t.visible)return;if(t.layers.test(e.layers))if(t.isGroup)n=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)h.pushLight(t),t.castShadow&&h.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||P.intersectsSprite(t)){i&&j.setFromMatrixPosition(t.matrixWorld).applyMatrix4(F);const e=K.update(t),r=t.material;r.visible&&u.push(t,e,r,n,j.z,null)}}else if(t.isImmediateRenderObject)i&&j.setFromMatrixPosition(t.matrixWorld).applyMatrix4(F),u.push(t,null,t.material,n,j.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==G.render.frame&&(t.skeleton.update(),t.skeleton.frame=G.render.frame),!t.frustumCulled||P.intersectsObject(t))){i&&j.setFromMatrixPosition(t.matrixWorld).applyMatrix4(F);const e=K.update(t),r=t.material;if(Array.isArray(r)){const i=e.groups;for(let o=0,a=i.length;o<a;o++){const a=i[o],s=r[a.materialIndex];s&&s.visible&&u.push(t,e,s,n,j.z,a)}}else r.visible&&u.push(t,e,r,n,j.z,null)}const r=t.children;for(let t=0,o=r.length;t<o;t++)_t(r[t],e,n,i)}function xt(t,e,n){const i=!0===e.isScene?e.overrideMaterial:null;for(let r=0,o=t.length;r<o;r++){const o=t[r],a=o.object,s=o.geometry,c=null===i?o.material:i,l=o.group;if(n.isArrayCamera){const t=n.cameras;for(let n=0,i=t.length;n<i;n++){const i=t[n];a.layers.test(i.layers)&&($.viewport(S.copy(i.viewport)),h.setupLightsView(i),wt(a,e,i,s,c,l))}}else wt(a,e,n,s,c,l)}}function wt(t,e,n,i,r,o){if(t.onBeforeRender(f,e,n,i,r,o),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){const i=Et(n,e,r,t);$.setMaterial(r),ct.reset(),function(t,e){t.render((function(t){f.renderBufferImmediate(t,e)}))}(t,i)}else f.renderBufferDirect(n,e,i,r,t,o);t.onAfterRender(f,e,n,i,r,o)}function St(t,e,n){!0!==e.isScene&&(e=B);const i=V.get(t),r=h.state.lights,o=h.state.shadowsArray,a=r.state.version,s=Z.getParameters(t,r.state,o,e,n),c=Z.getProgramCacheKey(s);let l=i.program,d=!0;if(i.environment=t.isMeshStandardMaterial?e.environment:null,i.fog=e.fog,i.envMap=q.get(t.envMap||i.environment),void 0===l)t.addEventListener(\"dispose\",gt);else if(l.cacheKey!==c)vt(t);else if(i.lightsStateVersion!==a)d=!1;else{if(void 0!==s.shaderID)return;d=!1}d&&(s.uniforms=Z.getUniforms(t),t.onBeforeCompile(s,f),l=Z.acquireProgram(s,c),i.program=l,i.uniforms=s.uniforms,i.outputEncoding=s.outputEncoding);const u=i.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(i.numClippingPlanes=nt.numPlanes,i.numIntersection=nt.numIntersection,u.clippingPlanes=nt.uniform),i.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),i.lightsStateVersion=a,i.needsLights&&(u.ambientLightColor.value=r.state.ambient,u.lightProbe.value=r.state.probe,u.directionalLights.value=r.state.directional,u.directionalLightShadows.value=r.state.directionalShadow,u.spotLights.value=r.state.spot,u.spotLightShadows.value=r.state.spotShadow,u.rectAreaLights.value=r.state.rectArea,u.ltc_1.value=r.state.rectAreaLTC1,u.ltc_2.value=r.state.rectAreaLTC2,u.pointLights.value=r.state.point,u.pointLightShadows.value=r.state.pointShadow,u.hemisphereLights.value=r.state.hemi,u.directionalShadowMap.value=r.state.directionalShadowMap,u.directionalShadowMatrix.value=r.state.directionalShadowMatrix,u.spotShadowMap.value=r.state.spotShadowMap,u.spotShadowMatrix.value=r.state.spotShadowMatrix,u.pointShadowMap.value=r.state.pointShadowMap,u.pointShadowMatrix.value=r.state.pointShadowMatrix);const p=i.program.getUniforms(),m=$a.seqWithValue(p.seq,u);i.uniformsList=m}function Et(t,e,n,i){!0!==e.isScene&&(e=B),W.resetTextureUnits();const r=e.fog,o=n.isMeshStandardMaterial?e.environment:null,a=null===b?f.outputEncoding:b.texture.encoding,s=q.get(n.envMap||o),c=V.get(n),l=h.state.lights;if(!0===D&&(!0===N||t!==w)){const e=t===w&&n.id===x;nt.setState(n,t,e)}n.version===c.__version?n.fog&&c.fog!==r||c.environment!==o||c.needsLights&&c.lightsStateVersion!==l.state.version?St(n,e,i):void 0===c.numClippingPlanes||c.numClippingPlanes===nt.numPlanes&&c.numIntersection===nt.numIntersection?(c.outputEncoding!==a||c.envMap!==s)&&St(n,e,i):St(n,e,i):(St(n,e,i),c.__version=n.version);let d=!1,u=!1,p=!1;const m=c.program,g=m.getUniforms(),v=c.uniforms;if($.useProgram(m.program)&&(d=!0,u=!0,p=!0),n.id!==x&&(x=n.id,u=!0),d||w!==t){if(g.setValue(lt,\"projectionMatrix\",t.projectionMatrix),H.logarithmicDepthBuffer&&g.setValue(lt,\"logDepthBufFC\",2/(Math.log(t.far+1)/Math.LN2)),w!==t&&(w=t,u=!0,p=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){const e=g.map.cameraPosition;void 0!==e&&e.setValue(lt,j.setFromMatrixPosition(t.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&g.setValue(lt,\"isOrthographic\",!0===t.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.isShadowMaterial||n.skinning)&&g.setValue(lt,\"viewMatrix\",t.matrixWorldInverse)}if(n.skinning){g.setOptional(lt,i,\"bindMatrix\"),g.setOptional(lt,i,\"bindMatrixInverse\");const t=i.skeleton;if(t){const e=t.bones;if(H.floatVertexTextures){if(null===t.boneTexture){let n=Math.sqrt(4*e.length);n=Bn.ceilPowerOfTwo(n),n=Math.max(n,4);const i=new Float32Array(n*n*4);i.set(t.boneMatrices);const r=new So(i,n,n,jt,kt);t.boneMatrices=i,t.boneTexture=r,t.boneTextureSize=n}g.setValue(lt,\"boneTexture\",t.boneTexture,W),g.setValue(lt,\"boneTextureSize\",t.boneTextureSize)}else g.setOptional(lt,t,\"boneMatrices\")}}var y,_;return(u||c.receiveShadow!==i.receiveShadow)&&(c.receiveShadow=i.receiveShadow,g.setValue(lt,\"receiveShadow\",i.receiveShadow)),u&&(g.setValue(lt,\"toneMappingExposure\",f.toneMappingExposure),c.needsLights&&(_=p,(y=v).ambientLightColor.needsUpdate=_,y.lightProbe.needsUpdate=_,y.directionalLights.needsUpdate=_,y.directionalLightShadows.needsUpdate=_,y.pointLights.needsUpdate=_,y.pointLightShadows.needsUpdate=_,y.spotLights.needsUpdate=_,y.spotLightShadows.needsUpdate=_,y.rectAreaLights.needsUpdate=_,y.hemisphereLights.needsUpdate=_),r&&n.fog&&Q.refreshFogUniforms(v,r),Q.refreshMaterialUniforms(v,n,A,C),$a.upload(lt,c.uniformsList,v,W)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&($a.upload(lt,c.uniformsList,v,W),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&g.setValue(lt,\"center\",i.center),g.setValue(lt,\"modelViewMatrix\",i.modelViewMatrix),g.setValue(lt,\"normalMatrix\",i.normalMatrix),g.setValue(lt,\"modelMatrix\",i.matrixWorld),m}bt.setAnimationLoop((function(t){ht.isPresenting||yt&&yt(t)})),\"undefined\"!=typeof window&&bt.setContext(window),this.setAnimationLoop=function(t){yt=t,ht.setAnimationLoop(t),null===t?bt.stop():bt.start()},this.render=function(t,e){let n,i;if(void 0!==arguments[2]&&(console.warn(\"THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead.\"),n=arguments[2]),void 0!==arguments[3]&&(console.warn(\"THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead.\"),i=arguments[3]),void 0!==e&&!0!==e.isCamera)return void console.error(\"THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.\");if(!0===m)return;ct.resetDefaultState(),x=-1,w=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),!0===ht.enabled&&!0===ht.isPresenting&&(e=ht.getCamera(e)),!0===t.isScene&&t.onBeforeRender(f,t,e,n||b),h=et.get(t,p.length),h.init(),p.push(h),F.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),P.setFromProjectionMatrix(F),N=this.localClippingEnabled,D=nt.init(this.clippingPlanes,N,e),u=tt.get(t,e),u.init(),_t(t,e,0,f.sortObjects),u.finish(),!0===f.sortObjects&&u.sort(O,k),!0===D&&nt.beginShadows();const r=h.state.shadowsArray;pt.render(r,t,e),h.setupLights(),h.setupLightsView(e),!0===D&&nt.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),it.render(u,t,e,i);const o=u.opaque,a=u.transparent;o.length>0&&xt(o,t,e),a.length>0&&xt(a,t,e),!0===t.isScene&&t.onAfterRender(f,t,e),null!==b&&(W.updateRenderTargetMipmap(b),W.updateMultisampleRenderTarget(b)),$.buffers.depth.setTest(!0),$.buffers.depth.setMask(!0),$.buffers.color.setMask(!0),$.setPolygonOffset(!1),p.pop(),h=p.length>0?p[p.length-1]:null,u=null},this.setFramebuffer=function(t){g!==t&&null===b&&lt.bindFramebuffer(36160,t),g=t},this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return y},this.getRenderList=function(){return u},this.setRenderList=function(t){u=t},this.getRenderTarget=function(){return b},this.setRenderTarget=function(t,e=0,n=0){b=t,v=e,y=n,t&&void 0===V.get(t).__webglFramebuffer&&W.setupRenderTarget(t);let i=g,r=!1;if(t){const n=V.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(i=n[e],r=!0):i=t.isWebGLMultisampleRenderTarget?V.get(t).__webglMultisampledFramebuffer:n,S.copy(t.viewport),M.copy(t.scissor),E=t.scissorTest}else S.copy(L).multiplyScalar(A).floor(),M.copy(I).multiplyScalar(A).floor(),E=R;if(_!==i&&(lt.bindFramebuffer(36160,i),_=i),$.viewport(S),$.scissor(M),$.setScissorTest(E),r){const i=V.get(t.texture);lt.framebufferTexture2D(36160,36064,34069+e,i.__webglTexture,n)}},this.readRenderTargetPixels=function(t,e,n,i,r,o,a){if(!t||!t.isWebGLRenderTarget)return void console.error(\"THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.\");let s=V.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==a&&(s=s[a]),s){let a=!1;s!==_&&(lt.bindFramebuffer(36160,s),a=!0);try{const s=t.texture,c=s.format,l=s.type;if(c!==jt&&st.convert(c)!==lt.getParameter(35739))return void console.error(\"THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.\");const d=l===Lt&&(U.has(\"EXT_color_buffer_half_float\")||H.isWebGL2&&U.has(\"EXT_color_buffer_float\"));if(!(l===Mt||st.convert(l)===lt.getParameter(35738)||l===kt&&(H.isWebGL2||U.has(\"OES_texture_float\")||U.has(\"WEBGL_color_buffer_float\"))||d))return void console.error(\"THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.\");36053===lt.checkFramebufferStatus(36160)?e>=0&&e<=t.width-i&&n>=0&&n<=t.height-r&&lt.readPixels(e,n,i,r,st.convert(c),st.convert(l),o):console.error(\"THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.\")}finally{a&&lt.bindFramebuffer(36160,_)}}},this.copyFramebufferToTexture=function(t,e,n=0){const i=Math.pow(2,-n),r=Math.floor(e.image.width*i),o=Math.floor(e.image.height*i),a=st.convert(e.format);W.setTexture2D(e,0),lt.copyTexImage2D(3553,n,a,t.x,t.y,r,o,0),$.unbindTexture()},this.copyTextureToTexture=function(t,e,n,i=0){const r=e.image.width,o=e.image.height,a=st.convert(n.format),s=st.convert(n.type);W.setTexture2D(n,0),lt.pixelStorei(37440,n.flipY),lt.pixelStorei(37441,n.premultiplyAlpha),lt.pixelStorei(3317,n.unpackAlignment),e.isDataTexture?lt.texSubImage2D(3553,i,t.x,t.y,r,o,a,s,e.image.data):e.isCompressedTexture?lt.compressedTexSubImage2D(3553,i,t.x,t.y,e.mipmaps[0].width,e.mipmaps[0].height,a,e.mipmaps[0].data):lt.texSubImage2D(3553,i,t.x,t.y,a,s,e.image),0===i&&n.generateMipmaps&&lt.generateMipmap(3553),$.unbindTexture()},this.initTexture=function(t){W.setTexture2D(t,0),$.unbindTexture()},this.resetState=function(){$.reset(),ct.reset()},\"undefined\"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent(\"observe\",{detail:this}))}function Ps(t){Rs.call(this,t)}As.prototype=Object.assign(Object.create(bo.prototype),{constructor:As,isArrayCamera:!0}),Os.prototype=Object.assign(Object.create(Ki.prototype),{constructor:Os,isGroup:!0}),Object.assign(ks.prototype,{constructor:ks,getHandSpace:function(){return null===this._hand&&(this._hand=new Os,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand},getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new Os,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new Os,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this},disconnect:function(t){return this.dispatchEvent({type:\"disconnected\",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this},update:function(t,e,n){let i=null,r=null,o=null;const a=this._targetRay,s=this._grip,c=this._hand;if(t&&\"visible-blurred\"!==e.session.visibilityState)if(c&&t.hand){o=!0;for(const i of t.hand.values()){const t=e.getJointPose(i,n);if(void 0===c.joints[i.jointName]){const t=new Os;t.matrixAutoUpdate=!1,t.visible=!1,c.joints[i.jointName]=t,c.add(t)}const r=c.joints[i.jointName];null!==t&&(r.matrix.fromArray(t.transform.matrix),r.matrix.decompose(r.position,r.rotation,r.scale),r.jointRadius=t.radius),r.visible=null!==t}const i=c.joints[\"index-finger-tip\"],r=c.joints[\"thumb-tip\"],a=i.position.distanceTo(r.position),s=.02,l=.005;c.inputState.pinching&&a>s+l?(c.inputState.pinching=!1,this.dispatchEvent({type:\"pinchend\",handedness:t.handedness,target:this})):!c.inputState.pinching&&a<=s-l&&(c.inputState.pinching=!0,this.dispatchEvent({type:\"pinchstart\",handedness:t.handedness,target:this}))}else null!==a&&(i=e.getPose(t.targetRaySpace,n),null!==i&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale))),null!==s&&t.gripSpace&&(r=e.getPose(t.gripSpace,n),null!==r&&(s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale)));return null!==a&&(a.visible=null!==i),null!==s&&(s.visible=null!==r),null!==c&&(c.visible=null!==o),this}}),Object.assign(Ls.prototype,Nn.prototype),Ps.prototype=Object.assign(Object.create(Rs.prototype),{constructor:Ps,isWebGL1Renderer:!0});class Ds{constructor(t,e){Object.defineProperty(this,\"isFogExp2\",{value:!0}),this.name=\"\",this.color=new yr(t),this.density=void 0!==e?e:25e-5}clone(){return new Ds(this.color,this.density)}toJSON(){return{type:\"FogExp2\",color:this.color.getHex(),density:this.density}}}class Ns{constructor(t,e,n){Object.defineProperty(this,\"isFog\",{value:!0}),this.name=\"\",this.color=new yr(t),this.near=void 0!==e?e:1,this.far=void 0!==n?n:1e3}clone(){return new Ns(this.color,this.near,this.far)}toJSON(){return{type:\"Fog\",color:this.color.getHex(),near:this.near,far:this.far}}}class Fs extends Ki{constructor(){super(),Object.defineProperty(this,\"isScene\",{value:!0}),this.type=\"Scene\",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,\"undefined\"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent(\"observe\",{detail:this}))}copy(t,e){return super.copy(t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.environment&&(e.object.environment=this.environment.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}}function js(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=En,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Bn.generateUUID()}Object.defineProperty(js.prototype,\"needsUpdate\",{set:function(t){!0===t&&this.version++}}),Object.assign(js.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.stride,n*=e.stride;for(let i=0,r=this.stride;i<r;i++)this.array[t+i]=e.array[n+i];return this},set:function(t,e=0){return this.array.set(t,e),this},clone:function(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Bn.generateUUID()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const e=new js(new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),this.stride);return e.setUsage(this.usage),e},onUpload:function(t){return this.onUploadCallback=t,this},toJSON:function(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Bn.generateUUID()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});const Bs=new Zn;function zs(t,e,n,i){this.name=\"\",this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===i}function Us(t){xr.call(this),this.type=\"SpriteMaterial\",this.color=new yr(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}let Hs;Object.defineProperties(zs.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(t){this.data.needsUpdate=t}}}),Object.assign(zs.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(let e=0,n=this.data.count;e<n;e++)Bs.x=this.getX(e),Bs.y=this.getY(e),Bs.z=this.getZ(e),Bs.applyMatrix4(t),this.setXYZ(e,Bs.x,Bs.y,Bs.z);return this},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this},setXYZ:function(t,e,n,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this},setXYZW:function(t,e,n,i,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this.data.array[t+3]=r,this},clone:function(t){if(void 0===t){console.log(\"THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.\");const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return new Er(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new zs(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(t){if(void 0===t){console.log(\"THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.\");const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}),Us.prototype=Object.create(xr.prototype),Us.prototype.constructor=Us,Us.prototype.isSpriteMaterial=!0,Us.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};const $s=new Zn,Gs=new Zn,Vs=new Zn,Ws=new zn,qs=new zn,Xs=new Ei,Ys=new Zn,Ks=new Zn,Zs=new Zn,Js=new zn,Qs=new zn,tc=new zn;function ec(t){if(Ki.call(this),this.type=\"Sprite\",void 0===Hs){Hs=new Wr;const t=new js(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);Hs.setIndex([0,1,2,0,2,3]),Hs.setAttribute(\"position\",new zs(t,3,0,!1)),Hs.setAttribute(\"uv\",new zs(t,2,3,!1))}this.geometry=Hs,this.material=void 0!==t?t:new Us,this.center=new zn(.5,.5)}function nc(t,e,n,i,r,o){Ws.subVectors(t,n).addScalar(.5).multiply(i),void 0!==r?(qs.x=o*Ws.x-r*Ws.y,qs.y=r*Ws.x+o*Ws.y):qs.copy(Ws),t.copy(e),t.x+=qs.x,t.y+=qs.y,t.applyMatrix4(Xs)}ec.prototype=Object.assign(Object.create(Ki.prototype),{constructor:ec,isSprite:!0,raycast:function(t,e){null===t.camera&&console.error('THREE.Sprite: \"Raycaster.camera\" needs to be set in order to raycast against sprites.'),Gs.setFromMatrixScale(this.matrixWorld),Xs.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),Vs.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Gs.multiplyScalar(-Vs.z);const n=this.material.rotation;let i,r;0!==n&&(r=Math.cos(n),i=Math.sin(n));const o=this.center;nc(Ys.set(-.5,-.5,0),Vs,o,Gs,i,r),nc(Ks.set(.5,-.5,0),Vs,o,Gs,i,r),nc(Zs.set(.5,.5,0),Vs,o,Gs,i,r),Js.set(0,0),Qs.set(1,0),tc.set(1,1);let a=t.ray.intersectTriangle(Ys,Ks,Zs,!1,$s);if(null===a&&(nc(Ks.set(-.5,.5,0),Vs,o,Gs,i,r),Qs.set(0,1),a=t.ray.intersectTriangle(Ys,Zs,Ks,!1,$s),null===a))return;const s=t.ray.origin.distanceTo($s);s<t.near||s>t.far||e.push({distance:s,point:$s.clone(),uv:ur.getUV($s,Ys,Ks,Zs,Js,Qs,tc,new zn),face:null,object:this})},copy:function(t){return Ki.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this.material=t.material,this}});const ic=new Zn,rc=new Zn;function oc(){Ki.call(this),this._currentLevel=0,this.type=\"LOD\",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}oc.prototype=Object.assign(Object.create(Ki.prototype),{constructor:oc,isLOD:!0,copy:function(t){Ki.prototype.copy.call(this,t,!1);const e=t.levels;for(let t=0,n=e.length;t<n;t++){const n=e[t];this.addLevel(n.object.clone(),n.distance)}return this.autoUpdate=t.autoUpdate,this},addLevel:function(t,e=0){e=Math.abs(e);const n=this.levels;let i;for(i=0;i<n.length&&!(e<n[i].distance);i++);return n.splice(i,0,{distance:e,object:t}),this.add(t),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(t){const e=this.levels;if(e.length>0){let n,i;for(n=1,i=e.length;n<i&&!(t<e[n].distance);n++);return e[n-1].object}return null},raycast:function(t,e){if(this.levels.length>0){ic.setFromMatrixPosition(this.matrixWorld);const n=t.ray.origin.distanceTo(ic);this.getObjectForDistance(n).raycast(t,e)}},update:function(t){const e=this.levels;if(e.length>1){ic.setFromMatrixPosition(t.matrixWorld),rc.setFromMatrixPosition(this.matrixWorld);const n=ic.distanceTo(rc)/t.zoom;let i,r;for(e[0].object.visible=!0,i=1,r=e.length;i<r&&n>=e[i].distance;i++)e[i-1].object.visible=!1,e[i].object.visible=!0;for(this._currentLevel=i-1;i<r;i++)e[i].object.visible=!1}},toJSON:function(t){const e=Ki.prototype.toJSON.call(this,t);!1===this.autoUpdate&&(e.object.autoUpdate=!1),e.object.levels=[];const n=this.levels;for(let t=0,i=n.length;t<i;t++){const i=n[t];e.object.levels.push({object:i.object.uuid,distance:i.distance})}return e}});const ac=new Zn,sc=new qn,cc=new qn,lc=new Zn,dc=new Ei;function uc(t,e){t&&t.isGeometry&&console.error(\"THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.\"),uo.call(this,t,e),this.type=\"SkinnedMesh\",this.bindMode=\"attached\",this.bindMatrix=new Ei,this.bindMatrixInverse=new Ei}function hc(){Ki.call(this),this.type=\"Bone\"}uc.prototype=Object.assign(Object.create(uo.prototype),{constructor:uc,isSkinnedMesh:!0,copy:function(t){return uo.prototype.copy.call(this,t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this},bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){const t=new qn,e=this.geometry.attributes.skinWeight;for(let n=0,i=e.count;n<i;n++){t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.w=e.getW(n);const i=1/t.manhattanLength();i!==1/0?t.multiplyScalar(i):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){uo.prototype.updateMatrixWorld.call(this,t),\"attached\"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():\"detached\"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn(\"THREE.SkinnedMesh: Unrecognized bindMode: \"+this.bindMode)},boneTransform:function(t,e){const n=this.skeleton,i=this.geometry;sc.fromBufferAttribute(i.attributes.skinIndex,t),cc.fromBufferAttribute(i.attributes.skinWeight,t),ac.fromBufferAttribute(i.attributes.position,t).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let t=0;t<4;t++){const i=cc.getComponent(t);if(0!==i){const r=sc.getComponent(t);dc.multiplyMatrices(n.bones[r].matrixWorld,n.boneInverses[r]),e.addScaledVector(lc.copy(ac).applyMatrix4(dc),i)}}return e.applyMatrix4(this.bindMatrixInverse)}}),hc.prototype=Object.assign(Object.create(Ki.prototype),{constructor:hc,isBone:!0});const pc=new Ei,fc=new Ei;function mc(t=[],e=[]){this.uuid=Bn.generateUUID(),this.bones=t.slice(0),this.boneInverses=e,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}Object.assign(mc.prototype,{init:function(){const t=this.bones,e=this.boneInverses;if(this.boneMatrices=new Float32Array(16*t.length),0===e.length)this.calculateInverses();else if(t.length!==e.length){console.warn(\"THREE.Skeleton: Number of inverse bone matrices does not match amount of bones.\"),this.boneInverses=[];for(let t=0,e=this.bones.length;t<e;t++)this.boneInverses.push(new Ei)}},calculateInverses:function(){this.boneInverses.length=0;for(let t=0,e=this.bones.length;t<e;t++){const e=new Ei;this.bones[t]&&e.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(e)}},pose:function(){for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&e.matrixWorld.copy(this.boneInverses[t]).invert()}for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&(e.parent&&e.parent.isBone?(e.matrix.copy(e.parent.matrixWorld).invert(),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))}},update:function(){const t=this.bones,e=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let i=0,r=t.length;i<r;i++){const r=t[i]?t[i].matrixWorld:fc;pc.multiplyMatrices(r,e[i]),pc.toArray(n,16*i)}null!==i&&(i.needsUpdate=!0)},clone:function(){return new mc(this.bones,this.boneInverses)},getBoneByName:function(t){for(let e=0,n=this.bones.length;e<n;e++){const n=this.bones[e];if(n.name===t)return n}},dispose:function(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)},fromJSON:function(t,e){this.uuid=t.uuid;for(let n=0,i=t.bones.length;n<i;n++){const i=t.bones[n];let r=e[i];void 0===r&&(console.warn(\"THREE.Skeleton: No bone found with UUID:\",i),r=new hc),this.bones.push(r),this.boneInverses.push((new Ei).fromArray(t.boneInverses[n]))}return this.init(),this},toJSON:function(){const t={metadata:{version:4.5,type:\"Skeleton\",generator:\"Skeleton.toJSON\"},bones:[],boneInverses:[]};t.uuid=this.uuid;const e=this.bones,n=this.boneInverses;for(let i=0,r=e.length;i<r;i++){const r=e[i];t.bones.push(r.uuid);const o=n[i];t.boneInverses.push(o.toArray())}return t}});const gc=new Ei,vc=new Ei,yc=[],bc=new uo;function _c(t,e,n){uo.call(this,t,e),this.instanceMatrix=new Er(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}function xc(t){xr.call(this),this.type=\"LineBasicMaterial\",this.color=new yr(16777215),this.linewidth=1,this.linecap=\"round\",this.linejoin=\"round\",this.morphTargets=!1,this.setValues(t)}_c.prototype=Object.assign(Object.create(uo.prototype),{constructor:_c,isInstancedMesh:!0,copy:function(t){return uo.prototype.copy.call(this,t),this.instanceMatrix.copy(t.instanceMatrix),null!==t.instanceColor&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this},getColorAt:function(t,e){e.fromArray(this.instanceColor.array,3*t)},getMatrixAt:function(t,e){e.fromArray(this.instanceMatrix.array,16*t)},raycast:function(t,e){const n=this.matrixWorld,i=this.count;if(bc.geometry=this.geometry,bc.material=this.material,void 0!==bc.material)for(let r=0;r<i;r++){this.getMatrixAt(r,gc),vc.multiplyMatrices(n,gc),bc.matrixWorld=vc,bc.raycast(t,yc);for(let t=0,n=yc.length;t<n;t++){const n=yc[t];n.instanceId=r,n.object=this,e.push(n)}yc.length=0}},setColorAt:function(t,e){null===this.instanceColor&&(this.instanceColor=new Er(new Float32Array(3*this.count),3)),e.toArray(this.instanceColor.array,3*t)},setMatrixAt:function(t,e){e.toArray(this.instanceMatrix.array,16*t)},updateMorphTargets:function(){},dispose:function(){this.dispatchEvent({type:\"dispose\"})}}),xc.prototype=Object.create(xr.prototype),xc.prototype.constructor=xc,xc.prototype.isLineBasicMaterial=!0,xc.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.morphTargets=t.morphTargets,this};const wc=new Zn,Sc=new Zn,Mc=new Ei,Ec=new Mi,Tc=new gi;function Cc(t=new Wr,e=new xc){Ki.call(this),this.type=\"Line\",this.geometry=t,this.material=e,this.updateMorphTargets()}Cc.prototype=Object.assign(Object.create(Ki.prototype),{constructor:Cc,isLine:!0,copy:function(t){return Ki.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},computeLineDistances:function(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const e=t.attributes.position,n=[0];for(let t=1,i=e.count;t<i;t++)wc.fromBufferAttribute(e,t-1),Sc.fromBufferAttribute(e,t),n[t]=n[t-1],n[t]+=wc.distanceTo(Sc);t.setAttribute(\"lineDistance\",new Pr(n,1))}else console.warn(\"THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.\");else t.isGeometry&&console.error(\"THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.\");return this},raycast:function(t,e){const n=this.geometry,i=this.matrixWorld,r=t.params.Line.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),Tc.copy(n.boundingSphere),Tc.applyMatrix4(i),Tc.radius+=r,!1===t.ray.intersectsSphere(Tc))return;Mc.copy(i).invert(),Ec.copy(t.ray).applyMatrix4(Mc);const o=r/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,s=new Zn,c=new Zn,l=new Zn,d=new Zn,u=this.isLineSegments?2:1;if(n.isBufferGeometry){const i=n.index,r=n.attributes.position;if(null!==i){const n=i.array;for(let i=0,o=n.length-1;i<o;i+=u){const o=n[i],u=n[i+1];s.fromBufferAttribute(r,o),c.fromBufferAttribute(r,u);if(Ec.distanceSqToSegment(s,c,d,l)>a)continue;d.applyMatrix4(this.matrixWorld);const h=t.ray.origin.distanceTo(d);h<t.near||h>t.far||e.push({distance:h,point:l.clone().applyMatrix4(this.matrixWorld),index:i,face:null,faceIndex:null,object:this})}}else for(let n=0,i=r.count-1;n<i;n+=u){s.fromBufferAttribute(r,n),c.fromBufferAttribute(r,n+1);if(Ec.distanceSqToSegment(s,c,d,l)>a)continue;d.applyMatrix4(this.matrixWorld);const i=t.ray.origin.distanceTo(d);i<t.near||i>t.far||e.push({distance:i,point:l.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}else n.isGeometry&&console.error(\"THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.\")},updateMorphTargets:function(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error(\"THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.\")}}});const Ac=new Zn,Oc=new Zn;function kc(t,e){Cc.call(this,t,e),this.type=\"LineSegments\"}function Lc(t,e){Cc.call(this,t,e),this.type=\"LineLoop\"}function Ic(t){xr.call(this),this.type=\"PointsMaterial\",this.color=new yr(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}kc.prototype=Object.assign(Object.create(Cc.prototype),{constructor:kc,isLineSegments:!0,computeLineDistances:function(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const e=t.attributes.position,n=[];for(let t=0,i=e.count;t<i;t+=2)Ac.fromBufferAttribute(e,t),Oc.fromBufferAttribute(e,t+1),n[t]=0===t?0:n[t-1],n[t+1]=n[t]+Ac.distanceTo(Oc);t.setAttribute(\"lineDistance\",new Pr(n,1))}else console.warn(\"THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.\");else t.isGeometry&&console.error(\"THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.\");return this}}),Lc.prototype=Object.assign(Object.create(Cc.prototype),{constructor:Lc,isLineLoop:!0}),Ic.prototype=Object.create(xr.prototype),Ic.prototype.constructor=Ic,Ic.prototype.isPointsMaterial=!0,Ic.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this};const Rc=new Ei,Pc=new Mi,Dc=new gi,Nc=new Zn;function Fc(t=new Wr,e=new Ic){Ki.call(this),this.type=\"Points\",this.geometry=t,this.material=e,this.updateMorphTargets()}function jc(t,e,n,i,r,o,a){const s=Pc.distanceSqToPoint(t);if(s<n){const n=new Zn;Pc.closestPointToPoint(t,n),n.applyMatrix4(i);const c=r.ray.origin.distanceTo(n);if(c<r.near||c>r.far)return;o.push({distance:c,distanceToRay:Math.sqrt(s),point:n,index:e,face:null,object:a})}}function Bc(t,e,n,i,r,o,a,s,c){Vn.call(this,t,e,n,i,r,o,a,s,c),this.format=void 0!==a?a:Ft,this.minFilter=void 0!==o?o:bt,this.magFilter=void 0!==r?r:bt,this.generateMipmaps=!1;const l=this;\"requestVideoFrameCallback\"in t&&t.requestVideoFrameCallback((function e(){l.needsUpdate=!0,t.requestVideoFrameCallback(e)}))}function zc(t,e,n,i,r,o,a,s,c,l,d,u){Vn.call(this,null,o,a,s,c,l,i,r,d,u),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function Uc(t,e,n,i,r,o,a,s,c){Vn.call(this,t,e,n,i,r,o,a,s,c),this.needsUpdate=!0}function Hc(t,e,n,i,r,o,a,s,c,l){if((l=void 0!==l?l:Ht)!==Ht&&l!==$t)throw new Error(\"DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat\");void 0===n&&l===Ht&&(n=Ct),void 0===n&&l===$t&&(n=Dt),Vn.call(this,null,i,r,o,a,s,l,n,c),this.image={width:t,height:e},this.magFilter=void 0!==a?a:ft,this.minFilter=void 0!==s?s:ft,this.flipY=!1,this.generateMipmaps=!1}Fc.prototype=Object.assign(Object.create(Ki.prototype),{constructor:Fc,isPoints:!0,copy:function(t){return Ki.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},raycast:function(t,e){const n=this.geometry,i=this.matrixWorld,r=t.params.Points.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),Dc.copy(n.boundingSphere),Dc.applyMatrix4(i),Dc.radius+=r,!1===t.ray.intersectsSphere(Dc))return;Rc.copy(i).invert(),Pc.copy(t.ray).applyMatrix4(Rc);const o=r/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o;if(n.isBufferGeometry){const r=n.index,o=n.attributes.position;if(null!==r){const n=r.array;for(let r=0,s=n.length;r<s;r++){const s=n[r];Nc.fromBufferAttribute(o,s),jc(Nc,s,a,i,t,e,this)}}else for(let n=0,r=o.count;n<r;n++)Nc.fromBufferAttribute(o,n),jc(Nc,n,a,i,t,e,this)}else console.error(\"THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.\")},updateMorphTargets:function(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error(\"THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.\")}}}),Bc.prototype=Object.assign(Object.create(Vn.prototype),{constructor:Bc,clone:function(){return new this.constructor(this.image).copy(this)},isVideoTexture:!0,update:function(){const t=this.image;!1===\"requestVideoFrameCallback\"in t&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),zc.prototype=Object.create(Vn.prototype),zc.prototype.constructor=zc,zc.prototype.isCompressedTexture=!0,Uc.prototype=Object.create(Vn.prototype),Uc.prototype.constructor=Uc,Uc.prototype.isCanvasTexture=!0,Hc.prototype=Object.create(Vn.prototype),Hc.prototype.constructor=Hc,Hc.prototype.isDepthTexture=!0;class $c extends Wr{constructor(t=1,e=8,n=0,i=2*Math.PI){super(),this.type=\"CircleGeometry\",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:i},e=Math.max(3,e);const r=[],o=[],a=[],s=[],c=new Zn,l=new zn;o.push(0,0,0),a.push(0,0,1),s.push(.5,.5);for(let r=0,d=3;r<=e;r++,d+=3){const u=n+r/e*i;c.x=t*Math.cos(u),c.y=t*Math.sin(u),o.push(c.x,c.y,c.z),a.push(0,0,1),l.x=(o[d]/t+1)/2,l.y=(o[d+1]/t+1)/2,s.push(l.x,l.y)}for(let t=1;t<=e;t++)r.push(t,t+1,0);this.setIndex(r),this.setAttribute(\"position\",new Pr(o,3)),this.setAttribute(\"normal\",new Pr(a,3)),this.setAttribute(\"uv\",new Pr(s,2))}}class Gc extends Wr{constructor(t=1,e=1,n=1,i=8,r=1,o=!1,a=0,s=2*Math.PI){super(),this.type=\"CylinderGeometry\",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:i,heightSegments:r,openEnded:o,thetaStart:a,thetaLength:s};const c=this;i=Math.floor(i),r=Math.floor(r);const l=[],d=[],u=[],h=[];let p=0;const f=[],m=n/2;let g=0;function v(n){const r=p,o=new zn,f=new Zn;let v=0;const y=!0===n?t:e,b=!0===n?1:-1;for(let t=1;t<=i;t++)d.push(0,m*b,0),u.push(0,b,0),h.push(.5,.5),p++;const _=p;for(let t=0;t<=i;t++){const e=t/i*s+a,n=Math.cos(e),r=Math.sin(e);f.x=y*r,f.y=m*b,f.z=y*n,d.push(f.x,f.y,f.z),u.push(0,b,0),o.x=.5*n+.5,o.y=.5*r*b+.5,h.push(o.x,o.y),p++}for(let t=0;t<i;t++){const e=r+t,i=_+t;!0===n?l.push(i,i+1,e):l.push(i+1,i,e),v+=3}c.addGroup(g,v,!0===n?1:2),g+=v}!function(){const o=new Zn,v=new Zn;let y=0;const b=(e-t)/n;for(let c=0;c<=r;c++){const l=[],g=c/r,y=g*(e-t)+t;for(let t=0;t<=i;t++){const e=t/i,r=e*s+a,c=Math.sin(r),f=Math.cos(r);v.x=y*c,v.y=-g*n+m,v.z=y*f,d.push(v.x,v.y,v.z),o.set(c,b,f).normalize(),u.push(o.x,o.y,o.z),h.push(e,1-g),l.push(p++)}f.push(l)}for(let t=0;t<i;t++)for(let e=0;e<r;e++){const n=f[e][t],i=f[e+1][t],r=f[e+1][t+1],o=f[e][t+1];l.push(n,i,o),l.push(i,r,o),y+=6}c.addGroup(g,y,0),g+=y}(),!1===o&&(t>0&&v(!0),e>0&&v(!1)),this.setIndex(l),this.setAttribute(\"position\",new Pr(d,3)),this.setAttribute(\"normal\",new Pr(u,3)),this.setAttribute(\"uv\",new Pr(h,2))}}class Vc extends Gc{constructor(t=1,e=1,n=8,i=1,r=!1,o=0,a=2*Math.PI){super(0,t,e,n,i,r,o,a),this.type=\"ConeGeometry\",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:o,thetaLength:a}}}class Wc extends Wr{constructor(t,e,n=1,i=0){super(),this.type=\"PolyhedronGeometry\",this.parameters={vertices:t,indices:e,radius:n,detail:i};const r=[],o=[];function a(t,e,n,i){const r=i+1,o=[];for(let i=0;i<=r;i++){o[i]=[];const a=t.clone().lerp(n,i/r),s=e.clone().lerp(n,i/r),c=r-i;for(let t=0;t<=c;t++)o[i][t]=0===t&&i===r?a:a.clone().lerp(s,t/c)}for(let t=0;t<r;t++)for(let e=0;e<2*(r-t)-1;e++){const n=Math.floor(e/2);e%2==0?(s(o[t][n+1]),s(o[t+1][n]),s(o[t][n])):(s(o[t][n+1]),s(o[t+1][n+1]),s(o[t+1][n]))}}function s(t){r.push(t.x,t.y,t.z)}function c(e,n){const i=3*e;n.x=t[i+0],n.y=t[i+1],n.z=t[i+2]}function l(t,e,n,i){i<0&&1===t.x&&(o[e]=t.x-1),0===n.x&&0===n.z&&(o[e]=i/2/Math.PI+.5)}function d(t){return Math.atan2(t.z,-t.x)}!function(t){const n=new Zn,i=new Zn,r=new Zn;for(let o=0;o<e.length;o+=3)c(e[o+0],n),c(e[o+1],i),c(e[o+2],r),a(n,i,r,t)}(i),function(t){const e=new Zn;for(let n=0;n<r.length;n+=3)e.x=r[n+0],e.y=r[n+1],e.z=r[n+2],e.normalize().multiplyScalar(t),r[n+0]=e.x,r[n+1]=e.y,r[n+2]=e.z}(n),function(){const t=new Zn;for(let n=0;n<r.length;n+=3){t.x=r[n+0],t.y=r[n+1],t.z=r[n+2];const i=d(t)/2/Math.PI+.5,a=(e=t,Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))/Math.PI+.5);o.push(i,1-a)}var e;(function(){const t=new Zn,e=new Zn,n=new Zn,i=new Zn,a=new zn,s=new zn,c=new zn;for(let u=0,h=0;u<r.length;u+=9,h+=6){t.set(r[u+0],r[u+1],r[u+2]),e.set(r[u+3],r[u+4],r[u+5]),n.set(r[u+6],r[u+7],r[u+8]),a.set(o[h+0],o[h+1]),s.set(o[h+2],o[h+3]),c.set(o[h+4],o[h+5]),i.copy(t).add(e).add(n).divideScalar(3);const p=d(i);l(a,h+0,t,p),l(s,h+2,e,p),l(c,h+4,n,p)}})(),function(){for(let t=0;t<o.length;t+=6){const e=o[t+0],n=o[t+2],i=o[t+4],r=Math.max(e,n,i),a=Math.min(e,n,i);r>.9&&a<.1&&(e<.2&&(o[t+0]+=1),n<.2&&(o[t+2]+=1),i<.2&&(o[t+4]+=1))}}()}(),this.setAttribute(\"position\",new Pr(r,3)),this.setAttribute(\"normal\",new Pr(r.slice(),3)),this.setAttribute(\"uv\",new Pr(o,2)),0===i?this.computeVertexNormals():this.normalizeNormals()}}class qc extends Wc{constructor(t=1,e=0){const n=(1+Math.sqrt(5))/2,i=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type=\"DodecahedronGeometry\",this.parameters={radius:t,detail:e}}}const Xc=new Zn,Yc=new Zn,Kc=new Zn,Zc=new ur;class Jc extends Wr{constructor(t,e){if(super(),this.type=\"EdgesGeometry\",this.parameters={thresholdAngle:e},e=void 0!==e?e:1,!0===t.isGeometry)return void console.error(\"THREE.EdgesGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.\");const n=Math.pow(10,4),i=Math.cos(Bn.DEG2RAD*e),r=t.getIndex(),o=t.getAttribute(\"position\"),a=r?r.count:o.count,s=[0,0,0],c=[\"a\",\"b\",\"c\"],l=new Array(3),d={},u=[];for(let t=0;t<a;t+=3){r?(s[0]=r.getX(t),s[1]=r.getX(t+1),s[2]=r.getX(t+2)):(s[0]=t,s[1]=t+1,s[2]=t+2);const{a:e,b:a,c:h}=Zc;if(e.fromBufferAttribute(o,s[0]),a.fromBufferAttribute(o,s[1]),h.fromBufferAttribute(o,s[2]),Zc.getNormal(Kc),l[0]=`${Math.round(e.x*n)},${Math.round(e.y*n)},${Math.round(e.z*n)}`,l[1]=`${Math.round(a.x*n)},${Math.round(a.y*n)},${Math.round(a.z*n)}`,l[2]=`${Math.round(h.x*n)},${Math.round(h.y*n)},${Math.round(h.z*n)}`,l[0]!==l[1]&&l[1]!==l[2]&&l[2]!==l[0])for(let t=0;t<3;t++){const e=(t+1)%3,n=l[t],r=l[e],o=Zc[c[t]],a=Zc[c[e]],h=`${n}_${r}`,p=`${r}_${n}`;p in d&&d[p]?(Kc.dot(d[p].normal)<=i&&(u.push(o.x,o.y,o.z),u.push(a.x,a.y,a.z)),d[p]=null):h in d||(d[h]={index0:s[t],index1:s[e],normal:Kc.clone()})}}for(const t in d)if(d[t]){const{index0:e,index1:n}=d[t];Xc.fromBufferAttribute(o,e),Yc.fromBufferAttribute(o,n),u.push(Xc.x,Xc.y,Xc.z),u.push(Yc.x,Yc.y,Yc.z)}this.setAttribute(\"position\",new Pr(u,3))}}const Qc=function(t,e,n){n=n||2;const i=e&&e.length,r=i?e[0]*n:t.length;let o=tl(t,0,r,n,!0);const a=[];if(!o||o.next===o.prev)return a;let s,c,l,d,u,h,p;if(i&&(o=function(t,e,n,i){const r=[];let o,a,s,c,l;for(o=0,a=e.length;o<a;o++)s=e[o]*i,c=o<a-1?e[o+1]*i:t.length,l=tl(t,s,c,i,!1),l===l.next&&(l.steiner=!0),r.push(ul(l));for(r.sort(sl),o=0;o<r.length;o++)cl(r[o],n),n=el(n,n.next);return n}(t,e,o,n)),t.length>80*n){s=l=t[0],c=d=t[1];for(let e=n;e<r;e+=n)u=t[e],h=t[e+1],u<s&&(s=u),h<c&&(c=h),u>l&&(l=u),h>d&&(d=h);p=Math.max(l-s,d-c),p=0!==p?1/p:0}return nl(o,a,n,s,c,p),a};function tl(t,e,n,i,r){let o,a;if(r===function(t,e,n,i){let r=0;for(let o=e,a=n-i;o<n;o+=i)r+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return r}(t,e,n,i)>0)for(o=e;o<n;o+=i)a=xl(o,t[o],t[o+1],a);else for(o=n-i;o>=e;o-=i)a=xl(o,t[o],t[o+1],a);return a&&ml(a,a.next)&&(wl(a),a=a.next),a}function el(t,e){if(!t)return t;e||(e=t);let n,i=t;do{if(n=!1,i.steiner||!ml(i,i.next)&&0!==fl(i.prev,i,i.next))i=i.next;else{if(wl(i),i=e=i.prev,i===i.next)break;n=!0}}while(n||i!==e);return e}function nl(t,e,n,i,r,o,a){if(!t)return;!a&&o&&function(t,e,n,i){let r=t;do{null===r.z&&(r.z=dl(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){let e,n,i,r,o,a,s,c,l=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,i=n,s=0,e=0;e<l&&(s++,i=i.nextZ,i);e++);for(c=l;s>0||c>0&&i;)0!==s&&(0===c||!i||n.z<=i.z)?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,c--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,l*=2}while(a>1)}(r)}(t,i,r,o);let s,c,l=t;for(;t.prev!==t.next;)if(s=t.prev,c=t.next,o?rl(t,i,r,o):il(t))e.push(s.i/n),e.push(t.i/n),e.push(c.i/n),wl(t),t=c.next,l=c.next;else if((t=c)===l){a?1===a?nl(t=ol(el(t),e,n),e,n,i,r,o,2):2===a&&al(t,e,n,i,r,o):nl(el(t),e,n,i,r,o,1);break}}function il(t){const e=t.prev,n=t,i=t.next;if(fl(e,n,i)>=0)return!1;let r=t.next.next;for(;r!==t.prev;){if(hl(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&fl(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function rl(t,e,n,i){const r=t.prev,o=t,a=t.next;if(fl(r,o,a)>=0)return!1;const s=r.x<o.x?r.x<a.x?r.x:a.x:o.x<a.x?o.x:a.x,c=r.y<o.y?r.y<a.y?r.y:a.y:o.y<a.y?o.y:a.y,l=r.x>o.x?r.x>a.x?r.x:a.x:o.x>a.x?o.x:a.x,d=r.y>o.y?r.y>a.y?r.y:a.y:o.y>a.y?o.y:a.y,u=dl(s,c,e,n,i),h=dl(l,d,e,n,i);let p=t.prevZ,f=t.nextZ;for(;p&&p.z>=u&&f&&f.z<=h;){if(p!==t.prev&&p!==t.next&&hl(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&fl(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,f!==t.prev&&f!==t.next&&hl(r.x,r.y,o.x,o.y,a.x,a.y,f.x,f.y)&&fl(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;p&&p.z>=u;){if(p!==t.prev&&p!==t.next&&hl(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&fl(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;f&&f.z<=h;){if(f!==t.prev&&f!==t.next&&hl(r.x,r.y,o.x,o.y,a.x,a.y,f.x,f.y)&&fl(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function ol(t,e,n){let i=t;do{const r=i.prev,o=i.next.next;!ml(r,o)&&gl(r,i,i.next,o)&&bl(r,o)&&bl(o,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(o.i/n),wl(i),wl(i.next),i=t=o),i=i.next}while(i!==t);return el(i)}function al(t,e,n,i,r,o){let a=t;do{let t=a.next.next;for(;t!==a.prev;){if(a.i!==t.i&&pl(a,t)){let s=_l(a,t);return a=el(a,a.next),s=el(s,s.next),nl(a,e,n,i,r,o),void nl(s,e,n,i,r,o)}t=t.next}a=a.next}while(a!==t)}function sl(t,e){return t.x-e.x}function cl(t,e){if(e=function(t,e){let n=e;const i=t.x,r=t.y;let o,a=-1/0;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){const t=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=i&&t>a){if(a=t,t===i){if(r===n.y)return n;if(r===n.next.y)return n.next}o=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!o)return null;if(i===a)return o;const s=o,c=o.x,l=o.y;let d,u=1/0;n=o;do{i>=n.x&&n.x>=c&&i!==n.x&&hl(r<l?i:a,r,c,l,r<l?a:i,r,n.x,n.y)&&(d=Math.abs(r-n.y)/(i-n.x),bl(n,t)&&(d<u||d===u&&(n.x>o.x||n.x===o.x&&ll(o,n)))&&(o=n,u=d)),n=n.next}while(n!==s);return o}(t,e)){const n=_l(e,t);el(e,e.next),el(n,n.next)}}function ll(t,e){return fl(t.prev,t,e.prev)<0&&fl(e.next,t,t.next)<0}function dl(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function ul(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function hl(t,e,n,i,r,o,a,s){return(r-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(i-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(r-a)*(i-s)>=0}function pl(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&gl(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(bl(t,e)&&bl(e,t)&&function(t,e){let n=t,i=!1;const r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(fl(t.prev,t,e.prev)||fl(t,e.prev,e))||ml(t,e)&&fl(t.prev,t,t.next)>0&&fl(e.prev,e,e.next)>0)}function fl(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function ml(t,e){return t.x===e.x&&t.y===e.y}function gl(t,e,n,i){const r=yl(fl(t,e,n)),o=yl(fl(t,e,i)),a=yl(fl(n,i,t)),s=yl(fl(n,i,e));return r!==o&&a!==s||(!(0!==r||!vl(t,n,e))||(!(0!==o||!vl(t,i,e))||(!(0!==a||!vl(n,t,i))||!(0!==s||!vl(n,e,i)))))}function vl(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function yl(t){return t>0?1:t<0?-1:0}function bl(t,e){return fl(t.prev,t,t.next)<0?fl(t,e,t.next)>=0&&fl(t,t.prev,e)>=0:fl(t,e,t.prev)<0||fl(t,t.next,e)<0}function _l(t,e){const n=new Sl(t.i,t.x,t.y),i=new Sl(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function xl(t,e,n,i){const r=new Sl(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function wl(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Sl(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}const Ml={area:function(t){const e=t.length;let n=0;for(let i=e-1,r=0;r<e;i=r++)n+=t[i].x*t[r].y-t[r].x*t[i].y;return.5*n},isClockWise:function(t){return Ml.area(t)<0},triangulateShape:function(t,e){const n=[],i=[],r=[];El(t),Tl(n,t);let o=t.length;e.forEach(El);for(let t=0;t<e.length;t++)i.push(o),o+=e[t].length,Tl(n,e[t]);const a=Qc(n,i);for(let t=0;t<a.length;t+=3)r.push(a.slice(t,t+3));return r}};function El(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function Tl(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}class Cl extends Wr{constructor(t,e){super(),this.type=\"ExtrudeGeometry\",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];const n=this,i=[],r=[];for(let e=0,n=t.length;e<n;e++){o(t[e])}function o(t){const o=[],a=void 0!==e.curveSegments?e.curveSegments:12,s=void 0!==e.steps?e.steps:1;let c=void 0!==e.depth?e.depth:100,l=void 0===e.bevelEnabled||e.bevelEnabled,d=void 0!==e.bevelThickness?e.bevelThickness:6,u=void 0!==e.bevelSize?e.bevelSize:d-2,h=void 0!==e.bevelOffset?e.bevelOffset:0,p=void 0!==e.bevelSegments?e.bevelSegments:3;const f=e.extrudePath,m=void 0!==e.UVGenerator?e.UVGenerator:Al;void 0!==e.amount&&(console.warn(\"THREE.ExtrudeBufferGeometry: amount has been renamed to depth.\"),c=e.amount);let g,v,y,b,_,x=!1;f&&(g=f.getSpacedPoints(s),x=!0,l=!1,v=f.computeFrenetFrames(s,!1),y=new Zn,b=new Zn,_=new Zn),l||(p=0,d=0,u=0,h=0);const w=t.extractPoints(a);let S=w.shape;const M=w.holes;if(!Ml.isClockWise(S)){S=S.reverse();for(let t=0,e=M.length;t<e;t++){const e=M[t];Ml.isClockWise(e)&&(M[t]=e.reverse())}}const E=Ml.triangulateShape(S,M),T=S;for(let t=0,e=M.length;t<e;t++){const e=M[t];S=S.concat(e)}function C(t,e,n){return e||console.error(\"THREE.ExtrudeGeometry: vec does not exist\"),e.clone().multiplyScalar(n).add(t)}const A=S.length,O=E.length;function k(t,e,n){let i,r,o;const a=t.x-e.x,s=t.y-e.y,c=n.x-t.x,l=n.y-t.y,d=a*a+s*s,u=a*l-s*c;if(Math.abs(u)>Number.EPSILON){const u=Math.sqrt(d),h=Math.sqrt(c*c+l*l),p=e.x-s/u,f=e.y+a/u,m=((n.x-l/h-p)*l-(n.y+c/h-f)*c)/(a*l-s*c);i=p+a*m-t.x,r=f+s*m-t.y;const g=i*i+r*r;if(g<=2)return new zn(i,r);o=Math.sqrt(g/2)}else{let t=!1;a>Number.EPSILON?c>Number.EPSILON&&(t=!0):a<-Number.EPSILON?c<-Number.EPSILON&&(t=!0):Math.sign(s)===Math.sign(l)&&(t=!0),t?(i=-s,r=a,o=Math.sqrt(d)):(i=a,r=s,o=Math.sqrt(d/2))}return new zn(i/o,r/o)}const L=[];for(let t=0,e=T.length,n=e-1,i=t+1;t<e;t++,n++,i++)n===e&&(n=0),i===e&&(i=0),L[t]=k(T[t],T[n],T[i]);const I=[];let R,P=L.concat();for(let t=0,e=M.length;t<e;t++){const e=M[t];R=[];for(let t=0,n=e.length,i=n-1,r=t+1;t<n;t++,i++,r++)i===n&&(i=0),r===n&&(r=0),R[t]=k(e[t],e[i],e[r]);I.push(R),P=P.concat(R)}for(let t=0;t<p;t++){const e=t/p,n=d*Math.cos(e*Math.PI/2),i=u*Math.sin(e*Math.PI/2)+h;for(let t=0,e=T.length;t<e;t++){const e=C(T[t],L[t],i);F(e.x,e.y,-n)}for(let t=0,e=M.length;t<e;t++){const e=M[t];R=I[t];for(let t=0,r=e.length;t<r;t++){const r=C(e[t],R[t],i);F(r.x,r.y,-n)}}}const D=u+h;for(let t=0;t<A;t++){const e=l?C(S[t],P[t],D):S[t];x?(b.copy(v.normals[0]).multiplyScalar(e.x),y.copy(v.binormals[0]).multiplyScalar(e.y),_.copy(g[0]).add(b).add(y),F(_.x,_.y,_.z)):F(e.x,e.y,0)}for(let t=1;t<=s;t++)for(let e=0;e<A;e++){const n=l?C(S[e],P[e],D):S[e];x?(b.copy(v.normals[t]).multiplyScalar(n.x),y.copy(v.binormals[t]).multiplyScalar(n.y),_.copy(g[t]).add(b).add(y),F(_.x,_.y,_.z)):F(n.x,n.y,c/s*t)}for(let t=p-1;t>=0;t--){const e=t/p,n=d*Math.cos(e*Math.PI/2),i=u*Math.sin(e*Math.PI/2)+h;for(let t=0,e=T.length;t<e;t++){const e=C(T[t],L[t],i);F(e.x,e.y,c+n)}for(let t=0,e=M.length;t<e;t++){const e=M[t];R=I[t];for(let t=0,r=e.length;t<r;t++){const r=C(e[t],R[t],i);x?F(r.x,r.y+g[s-1].y,g[s-1].x+n):F(r.x,r.y,c+n)}}}function N(t,e){let n=t.length;for(;--n>=0;){const i=n;let r=n-1;r<0&&(r=t.length-1);for(let t=0,n=s+2*p;t<n;t++){const n=A*t,o=A*(t+1);B(e+i+n,e+r+n,e+r+o,e+i+o)}}}function F(t,e,n){o.push(t),o.push(e),o.push(n)}function j(t,e,r){z(t),z(e),z(r);const o=i.length/3,a=m.generateTopUV(n,i,o-3,o-2,o-1);U(a[0]),U(a[1]),U(a[2])}function B(t,e,r,o){z(t),z(e),z(o),z(e),z(r),z(o);const a=i.length/3,s=m.generateSideWallUV(n,i,a-6,a-3,a-2,a-1);U(s[0]),U(s[1]),U(s[3]),U(s[1]),U(s[2]),U(s[3])}function z(t){i.push(o[3*t+0]),i.push(o[3*t+1]),i.push(o[3*t+2])}function U(t){r.push(t.x),r.push(t.y)}!function(){const t=i.length/3;if(l){let t=0,e=A*t;for(let t=0;t<O;t++){const n=E[t];j(n[2]+e,n[1]+e,n[0]+e)}t=s+2*p,e=A*t;for(let t=0;t<O;t++){const n=E[t];j(n[0]+e,n[1]+e,n[2]+e)}}else{for(let t=0;t<O;t++){const e=E[t];j(e[2],e[1],e[0])}for(let t=0;t<O;t++){const e=E[t];j(e[0]+A*s,e[1]+A*s,e[2]+A*s)}}n.addGroup(t,i.length/3-t,0)}(),function(){const t=i.length/3;let e=0;N(T,e),e+=T.length;for(let t=0,n=M.length;t<n;t++){const n=M[t];N(n,e),e+=n.length}n.addGroup(t,i.length/3-t,1)}()}this.setAttribute(\"position\",new Pr(i,3)),this.setAttribute(\"uv\",new Pr(r,2)),this.computeVertexNormals()}toJSON(){const t=Wr.prototype.toJSON.call(this);return function(t,e,n){if(n.shapes=[],Array.isArray(t))for(let e=0,i=t.length;e<i;e++){const i=t[e];n.shapes.push(i.uuid)}else n.shapes.push(t.uuid);void 0!==e.extrudePath&&(n.options.extrudePath=e.extrudePath.toJSON());return n}(this.parameters.shapes,this.parameters.options,t)}}const Al={generateTopUV:function(t,e,n,i,r){const o=e[3*n],a=e[3*n+1],s=e[3*i],c=e[3*i+1],l=e[3*r],d=e[3*r+1];return[new zn(o,a),new zn(s,c),new zn(l,d)]},generateSideWallUV:function(t,e,n,i,r,o){const a=e[3*n],s=e[3*n+1],c=e[3*n+2],l=e[3*i],d=e[3*i+1],u=e[3*i+2],h=e[3*r],p=e[3*r+1],f=e[3*r+2],m=e[3*o],g=e[3*o+1],v=e[3*o+2];return Math.abs(s-d)<.01?[new zn(a,1-c),new zn(l,1-u),new zn(h,1-f),new zn(m,1-v)]:[new zn(s,1-c),new zn(d,1-u),new zn(p,1-f),new zn(g,1-v)]}};class Ol extends Wc{constructor(t=1,e=0){const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type=\"IcosahedronGeometry\",this.parameters={radius:t,detail:e}}}class kl extends Wr{constructor(t,e=12,n=0,i=2*Math.PI){super(),this.type=\"LatheGeometry\",this.parameters={points:t,segments:e,phiStart:n,phiLength:i},e=Math.floor(e),i=Bn.clamp(i,0,2*Math.PI);const r=[],o=[],a=[],s=1/e,c=new Zn,l=new zn;for(let r=0;r<=e;r++){const d=n+r*s*i,u=Math.sin(d),h=Math.cos(d);for(let n=0;n<=t.length-1;n++)c.x=t[n].x*u,c.y=t[n].y,c.z=t[n].x*h,o.push(c.x,c.y,c.z),l.x=r/e,l.y=n/(t.length-1),a.push(l.x,l.y)}for(let n=0;n<e;n++)for(let e=0;e<t.length-1;e++){const i=e+n*t.length,o=i,a=i+t.length,s=i+t.length+1,c=i+1;r.push(o,a,c),r.push(a,s,c)}if(this.setIndex(r),this.setAttribute(\"position\",new Pr(o,3)),this.setAttribute(\"uv\",new Pr(a,2)),this.computeVertexNormals(),i===2*Math.PI){const n=this.attributes.normal.array,i=new Zn,r=new Zn,o=new Zn,a=e*t.length*3;for(let e=0,s=0;e<t.length;e++,s+=3)i.x=n[s+0],i.y=n[s+1],i.z=n[s+2],r.x=n[a+s+0],r.y=n[a+s+1],r.z=n[a+s+2],o.addVectors(i,r).normalize(),n[s+0]=n[a+s+0]=o.x,n[s+1]=n[a+s+1]=o.y,n[s+2]=n[a+s+2]=o.z}}}class Ll extends Wc{constructor(t=1,e=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type=\"OctahedronGeometry\",this.parameters={radius:t,detail:e}}}function Il(t,e,n){Wr.call(this),this.type=\"ParametricGeometry\",this.parameters={func:t,slices:e,stacks:n};const i=[],r=[],o=[],a=[],s=1e-5,c=new Zn,l=new Zn,d=new Zn,u=new Zn,h=new Zn;t.length<3&&console.error(\"THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.\");const p=e+1;for(let i=0;i<=n;i++){const p=i/n;for(let n=0;n<=e;n++){const i=n/e;t(i,p,l),r.push(l.x,l.y,l.z),i-s>=0?(t(i-s,p,d),u.subVectors(l,d)):(t(i+s,p,d),u.subVectors(d,l)),p-s>=0?(t(i,p-s,d),h.subVectors(l,d)):(t(i,p+s,d),h.subVectors(d,l)),c.crossVectors(u,h).normalize(),o.push(c.x,c.y,c.z),a.push(i,p)}}for(let t=0;t<n;t++)for(let n=0;n<e;n++){const e=t*p+n,r=t*p+n+1,o=(t+1)*p+n+1,a=(t+1)*p+n;i.push(e,r,a),i.push(r,o,a)}this.setIndex(i),this.setAttribute(\"position\",new Pr(r,3)),this.setAttribute(\"normal\",new Pr(o,3)),this.setAttribute(\"uv\",new Pr(a,2))}Il.prototype=Object.create(Wr.prototype),Il.prototype.constructor=Il;class Rl extends Wr{constructor(t=.5,e=1,n=8,i=1,r=0,o=2*Math.PI){super(),this.type=\"RingGeometry\",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:o},n=Math.max(3,n);const a=[],s=[],c=[],l=[];let d=t;const u=(e-t)/(i=Math.max(1,i)),h=new Zn,p=new zn;for(let t=0;t<=i;t++){for(let t=0;t<=n;t++){const i=r+t/n*o;h.x=d*Math.cos(i),h.y=d*Math.sin(i),s.push(h.x,h.y,h.z),c.push(0,0,1),p.x=(h.x/e+1)/2,p.y=(h.y/e+1)/2,l.push(p.x,p.y)}d+=u}for(let t=0;t<i;t++){const e=t*(n+1);for(let t=0;t<n;t++){const i=t+e,r=i,o=i+n+1,s=i+n+2,c=i+1;a.push(r,o,c),a.push(o,s,c)}}this.setIndex(a),this.setAttribute(\"position\",new Pr(s,3)),this.setAttribute(\"normal\",new Pr(c,3)),this.setAttribute(\"uv\",new Pr(l,2))}}class Pl extends Wr{constructor(t,e=12){super(),this.type=\"ShapeGeometry\",this.parameters={shapes:t,curveSegments:e};const n=[],i=[],r=[],o=[];let a=0,s=0;if(!1===Array.isArray(t))c(t);else for(let e=0;e<t.length;e++)c(t[e]),this.addGroup(a,s,e),a+=s,s=0;function c(t){const a=i.length/3,c=t.extractPoints(e);let l=c.shape;const d=c.holes;!1===Ml.isClockWise(l)&&(l=l.reverse());for(let t=0,e=d.length;t<e;t++){const e=d[t];!0===Ml.isClockWise(e)&&(d[t]=e.reverse())}const u=Ml.triangulateShape(l,d);for(let t=0,e=d.length;t<e;t++){const e=d[t];l=l.concat(e)}for(let t=0,e=l.length;t<e;t++){const e=l[t];i.push(e.x,e.y,0),r.push(0,0,1),o.push(e.x,e.y)}for(let t=0,e=u.length;t<e;t++){const e=u[t],i=e[0]+a,r=e[1]+a,o=e[2]+a;n.push(i,r,o),s+=3}}this.setIndex(n),this.setAttribute(\"position\",new Pr(i,3)),this.setAttribute(\"normal\",new Pr(r,3)),this.setAttribute(\"uv\",new Pr(o,2))}toJSON(){const t=Wr.prototype.toJSON.call(this);return function(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,i=t.length;n<i;n++){const i=t[n];e.shapes.push(i.uuid)}else e.shapes.push(t.uuid);return e}(this.parameters.shapes,t)}}class Dl extends Wr{constructor(t=1,e=8,n=6,i=0,r=2*Math.PI,o=0,a=Math.PI){super(),this.type=\"SphereGeometry\",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:i,phiLength:r,thetaStart:o,thetaLength:a},e=Math.max(3,Math.floor(e)),n=Math.max(2,Math.floor(n));const s=Math.min(o+a,Math.PI);let c=0;const l=[],d=new Zn,u=new Zn,h=[],p=[],f=[],m=[];for(let h=0;h<=n;h++){const g=[],v=h/n;let y=0;0==h&&0==o?y=.5/e:h==n&&s==Math.PI&&(y=-.5/e);for(let n=0;n<=e;n++){const s=n/e;d.x=-t*Math.cos(i+s*r)*Math.sin(o+v*a),d.y=t*Math.cos(o+v*a),d.z=t*Math.sin(i+s*r)*Math.sin(o+v*a),p.push(d.x,d.y,d.z),u.copy(d).normalize(),f.push(u.x,u.y,u.z),m.push(s+y,1-v),g.push(c++)}l.push(g)}for(let t=0;t<n;t++)for(let i=0;i<e;i++){const e=l[t][i+1],r=l[t][i],a=l[t+1][i],c=l[t+1][i+1];(0!==t||o>0)&&h.push(e,r,c),(t!==n-1||s<Math.PI)&&h.push(r,a,c)}this.setIndex(h),this.setAttribute(\"position\",new Pr(p,3)),this.setAttribute(\"normal\",new Pr(f,3)),this.setAttribute(\"uv\",new Pr(m,2))}}class Nl extends Wc{constructor(t=1,e=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type=\"TetrahedronGeometry\",this.parameters={radius:t,detail:e}}}class Fl extends Cl{constructor(t,e={}){const n=e.font;if(!n||!n.isFont)return console.error(\"THREE.TextGeometry: font parameter is not an instance of THREE.Font.\"),new Wr;const i=n.generateShapes(t,e.size);e.depth=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),super(i,e),this.type=\"TextGeometry\"}}class jl extends Wr{constructor(t=1,e=.4,n=8,i=6,r=2*Math.PI){super(),this.type=\"TorusGeometry\",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:i,arc:r},n=Math.floor(n),i=Math.floor(i);const o=[],a=[],s=[],c=[],l=new Zn,d=new Zn,u=new Zn;for(let o=0;o<=n;o++)for(let h=0;h<=i;h++){const p=h/i*r,f=o/n*Math.PI*2;d.x=(t+e*Math.cos(f))*Math.cos(p),d.y=(t+e*Math.cos(f))*Math.sin(p),d.z=e*Math.sin(f),a.push(d.x,d.y,d.z),l.x=t*Math.cos(p),l.y=t*Math.sin(p),u.subVectors(d,l).normalize(),s.push(u.x,u.y,u.z),c.push(h/i),c.push(o/n)}for(let t=1;t<=n;t++)for(let e=1;e<=i;e++){const n=(i+1)*t+e-1,r=(i+1)*(t-1)+e-1,a=(i+1)*(t-1)+e,s=(i+1)*t+e;o.push(n,r,s),o.push(r,a,s)}this.setIndex(o),this.setAttribute(\"position\",new Pr(a,3)),this.setAttribute(\"normal\",new Pr(s,3)),this.setAttribute(\"uv\",new Pr(c,2))}}class Bl extends Wr{constructor(t=1,e=.4,n=64,i=8,r=2,o=3){super(),this.type=\"TorusKnotGeometry\",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:i,p:r,q:o},n=Math.floor(n),i=Math.floor(i);const a=[],s=[],c=[],l=[],d=new Zn,u=new Zn,h=new Zn,p=new Zn,f=new Zn,m=new Zn,g=new Zn;for(let a=0;a<=n;++a){const y=a/n*r*Math.PI*2;v(y,r,o,t,h),v(y+.01,r,o,t,p),m.subVectors(p,h),g.addVectors(p,h),f.crossVectors(m,g),g.crossVectors(f,m),f.normalize(),g.normalize();for(let t=0;t<=i;++t){const r=t/i*Math.PI*2,o=-e*Math.cos(r),p=e*Math.sin(r);d.x=h.x+(o*g.x+p*f.x),d.y=h.y+(o*g.y+p*f.y),d.z=h.z+(o*g.z+p*f.z),s.push(d.x,d.y,d.z),u.subVectors(d,h).normalize(),c.push(u.x,u.y,u.z),l.push(a/n),l.push(t/i)}}for(let t=1;t<=n;t++)for(let e=1;e<=i;e++){const n=(i+1)*(t-1)+(e-1),r=(i+1)*t+(e-1),o=(i+1)*t+e,s=(i+1)*(t-1)+e;a.push(n,r,s),a.push(r,o,s)}function v(t,e,n,i,r){const o=Math.cos(t),a=Math.sin(t),s=n/e*t,c=Math.cos(s);r.x=i*(2+c)*.5*o,r.y=i*(2+c)*a*.5,r.z=i*Math.sin(s)*.5}this.setIndex(a),this.setAttribute(\"position\",new Pr(s,3)),this.setAttribute(\"normal\",new Pr(c,3)),this.setAttribute(\"uv\",new Pr(l,2))}}class zl extends Wr{constructor(t,e=64,n=1,i=8,r=!1){super(),this.type=\"TubeGeometry\",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:i,closed:r};const o=t.computeFrenetFrames(e,r);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new Zn,s=new Zn,c=new zn;let l=new Zn;const d=[],u=[],h=[],p=[];function f(r){l=t.getPointAt(r/e,l);const c=o.normals[r],h=o.binormals[r];for(let t=0;t<=i;t++){const e=t/i*Math.PI*2,r=Math.sin(e),o=-Math.cos(e);s.x=o*c.x+r*h.x,s.y=o*c.y+r*h.y,s.z=o*c.z+r*h.z,s.normalize(),u.push(s.x,s.y,s.z),a.x=l.x+n*s.x,a.y=l.y+n*s.y,a.z=l.z+n*s.z,d.push(a.x,a.y,a.z)}}!function(){for(let t=0;t<e;t++)f(t);f(!1===r?e:0),function(){for(let t=0;t<=e;t++)for(let n=0;n<=i;n++)c.x=t/e,c.y=n/i,h.push(c.x,c.y)}(),function(){for(let t=1;t<=e;t++)for(let e=1;e<=i;e++){const n=(i+1)*(t-1)+(e-1),r=(i+1)*t+(e-1),o=(i+1)*t+e,a=(i+1)*(t-1)+e;p.push(n,r,a),p.push(r,o,a)}}()}(),this.setIndex(p),this.setAttribute(\"position\",new Pr(d,3)),this.setAttribute(\"normal\",new Pr(u,3)),this.setAttribute(\"uv\",new Pr(h,2))}toJSON(){const t=Wr.prototype.toJSON.call(this);return t.path=this.parameters.path.toJSON(),t}}class Ul extends Wr{constructor(t){if(super(),this.type=\"WireframeGeometry\",!0===t.isGeometry)return void console.error(\"THREE.WireframeGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.\");const e=[],n=[0,0],i={},r=new Zn;if(null!==t.index){const o=t.attributes.position,a=t.index;let s=t.groups;0===s.length&&(s=[{start:0,count:a.count,materialIndex:0}]);for(let t=0,e=s.length;t<e;++t){const e=s[t],r=e.start;for(let t=r,o=r+e.count;t<o;t+=3)for(let e=0;e<3;e++){const r=a.getX(t+e),o=a.getX(t+(e+1)%3);n[0]=Math.min(r,o),n[1]=Math.max(r,o);const s=n[0]+\",\"+n[1];void 0===i[s]&&(i[s]={index1:n[0],index2:n[1]})}}for(const t in i){const n=i[t];r.fromBufferAttribute(o,n.index1),e.push(r.x,r.y,r.z),r.fromBufferAttribute(o,n.index2),e.push(r.x,r.y,r.z)}}else{const n=t.attributes.position;for(let t=0,i=n.count/3;t<i;t++)for(let i=0;i<3;i++){const o=3*t+i;r.fromBufferAttribute(n,o),e.push(r.x,r.y,r.z);const a=3*t+(i+1)%3;r.fromBufferAttribute(n,a),e.push(r.x,r.y,r.z)}}this.setAttribute(\"position\",new Pr(e,3))}}var Hl=Object.freeze({__proto__:null,BoxGeometry:po,BoxBufferGeometry:po,CircleGeometry:$c,CircleBufferGeometry:$c,ConeGeometry:Vc,ConeBufferGeometry:Vc,CylinderGeometry:Gc,CylinderBufferGeometry:Gc,DodecahedronGeometry:qc,DodecahedronBufferGeometry:qc,EdgesGeometry:Jc,ExtrudeGeometry:Cl,ExtrudeBufferGeometry:Cl,IcosahedronGeometry:Ol,IcosahedronBufferGeometry:Ol,LatheGeometry:kl,LatheBufferGeometry:kl,OctahedronGeometry:Ll,OctahedronBufferGeometry:Ll,ParametricGeometry:Il,ParametricBufferGeometry:Il,PlaneGeometry:Oo,PlaneBufferGeometry:Oo,PolyhedronGeometry:Wc,PolyhedronBufferGeometry:Wc,RingGeometry:Rl,RingBufferGeometry:Rl,ShapeGeometry:Pl,ShapeBufferGeometry:Pl,SphereGeometry:Dl,SphereBufferGeometry:Dl,TetrahedronGeometry:Nl,TetrahedronBufferGeometry:Nl,TextGeometry:Fl,TextBufferGeometry:Fl,TorusGeometry:jl,TorusBufferGeometry:jl,TorusKnotGeometry:Bl,TorusKnotBufferGeometry:Bl,TubeGeometry:zl,TubeBufferGeometry:zl,WireframeGeometry:Ul});function $l(t){xr.call(this),this.type=\"ShadowMaterial\",this.color=new yr(0),this.transparent=!0,this.setValues(t)}function Gl(t){vo.call(this,t),this.type=\"RawShaderMaterial\"}function Vl(t){xr.call(this),this.defines={STANDARD:\"\"},this.type=\"MeshStandardMaterial\",this.color=new yr(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new yr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=sn,this.normalScale=new zn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap=\"round\",this.wireframeLinejoin=\"round\",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(t)}function Wl(t){Vl.call(this),this.defines={STANDARD:\"\",PHYSICAL:\"\"},this.type=\"MeshPhysicalMaterial\",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new zn(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,\"ior\",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(t){this.reflectivity=Bn.clamp(2.5*(t-1)/(t+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(t)}function ql(t){xr.call(this),this.type=\"MeshPhongMaterial\",this.color=new yr(16777215),this.specular=new yr(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new yr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=sn,this.normalScale=new zn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Y,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap=\"round\",this.wireframeLinejoin=\"round\",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Xl(t){xr.call(this),this.defines={TOON:\"\"},this.type=\"MeshToonMaterial\",this.color=new yr(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new yr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=sn,this.normalScale=new zn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap=\"round\",this.wireframeLinejoin=\"round\",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Yl(t){xr.call(this),this.type=\"MeshNormalMaterial\",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=sn,this.normalScale=new zn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Kl(t){xr.call(this),this.type=\"MeshLambertMaterial\",this.color=new yr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new yr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Y,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap=\"round\",this.wireframeLinejoin=\"round\",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Zl(t){xr.call(this),this.defines={MATCAP:\"\"},this.type=\"MeshMatcapMaterial\",this.color=new yr(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=sn,this.normalScale=new zn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Jl(t){xc.call(this),this.type=\"LineDashedMaterial\",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}$l.prototype=Object.create(xr.prototype),$l.prototype.constructor=$l,$l.prototype.isShadowMaterial=!0,$l.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.color.copy(t.color),this},Gl.prototype=Object.create(vo.prototype),Gl.prototype.constructor=Gl,Gl.prototype.isRawShaderMaterial=!0,Vl.prototype=Object.create(xr.prototype),Vl.prototype.constructor=Vl,Vl.prototype.isMeshStandardMaterial=!0,Vl.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.defines={STANDARD:\"\"},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.vertexTangents=t.vertexTangents,this},Wl.prototype=Object.create(Vl.prototype),Wl.prototype.constructor=Wl,Wl.prototype.isMeshPhysicalMaterial=!0,Wl.prototype.copy=function(t){return Vl.prototype.copy.call(this,t),this.defines={STANDARD:\"\",PHYSICAL:\"\"},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,t.sheen?this.sheen=(this.sheen||new yr).copy(t.sheen):this.sheen=null,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this},ql.prototype=Object.create(xr.prototype),ql.prototype.constructor=ql,ql.prototype.isMeshPhongMaterial=!0,ql.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Xl.prototype=Object.create(xr.prototype),Xl.prototype.constructor=Xl,Xl.prototype.isMeshToonMaterial=!0,Xl.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Yl.prototype=Object.create(xr.prototype),Yl.prototype.constructor=Yl,Yl.prototype.isMeshNormalMaterial=!0,Yl.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Kl.prototype=Object.create(xr.prototype),Kl.prototype.constructor=Kl,Kl.prototype.isMeshLambertMaterial=!0,Kl.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Zl.prototype=Object.create(xr.prototype),Zl.prototype.constructor=Zl,Zl.prototype.isMeshMatcapMaterial=!0,Zl.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.defines={MATCAP:\"\"},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Jl.prototype=Object.create(xc.prototype),Jl.prototype.constructor=Jl,Jl.prototype.isLineDashedMaterial=!0,Jl.prototype.copy=function(t){return xc.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var Ql=Object.freeze({__proto__:null,ShadowMaterial:$l,SpriteMaterial:Us,RawShaderMaterial:Gl,ShaderMaterial:vo,PointsMaterial:Ic,MeshPhysicalMaterial:Wl,MeshStandardMaterial:Vl,MeshPhongMaterial:ql,MeshToonMaterial:Xl,MeshNormalMaterial:Yl,MeshLambertMaterial:Kl,MeshDepthMaterial:ws,MeshDistanceMaterial:Ss,MeshBasicMaterial:wr,MeshMatcapMaterial:Zl,LineDashedMaterial:Jl,LineBasicMaterial:xc,Material:xr});const td={arraySlice:function(t,e,n){return td.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:\"number\"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){const e=t.length,n=new Array(e);for(let t=0;t!==e;++t)n[t]=t;return n.sort((function(e,n){return t[e]-t[n]})),n},sortedArray:function(t,e,n){const i=t.length,r=new t.constructor(i);for(let o=0,a=0;a!==i;++o){const i=n[o]*e;for(let n=0;n!==e;++n)r[a++]=t[i+n]}return r},flattenJSON:function(t,e,n,i){let r=1,o=t[0];for(;void 0!==o&&void 0===o[i];)o=t[r++];if(void 0===o)return;let a=o[i];if(void 0!==a)if(Array.isArray(a))do{a=o[i],void 0!==a&&(e.push(o.time),n.push.apply(n,a)),o=t[r++]}while(void 0!==o);else if(void 0!==a.toArray)do{a=o[i],void 0!==a&&(e.push(o.time),a.toArray(n,n.length)),o=t[r++]}while(void 0!==o);else do{a=o[i],void 0!==a&&(e.push(o.time),n.push(a)),o=t[r++]}while(void 0!==o)},subclip:function(t,e,n,i,r=30){const o=t.clone();o.name=e;const a=[];for(let t=0;t<o.tracks.length;++t){const e=o.tracks[t],s=e.getValueSize(),c=[],l=[];for(let t=0;t<e.times.length;++t){const o=e.times[t]*r;if(!(o<n||o>=i)){c.push(e.times[t]);for(let n=0;n<s;++n)l.push(e.values[t*s+n])}}0!==c.length&&(e.times=td.convertArray(c,e.times.constructor),e.values=td.convertArray(l,e.values.constructor),a.push(e))}o.tracks=a;let s=1/0;for(let t=0;t<o.tracks.length;++t)s>o.tracks[t].times[0]&&(s=o.tracks[t].times[0]);for(let t=0;t<o.tracks.length;++t)o.tracks[t].shift(-1*s);return o.resetDuration(),o},makeClipAdditive:function(t,e=0,n=t,i=30){i<=0&&(i=30);const r=n.tracks.length,o=e/i;for(let e=0;e<r;++e){const i=n.tracks[e],r=i.ValueTypeName;if(\"bool\"===r||\"string\"===r)continue;const a=t.tracks.find((function(t){return t.name===i.name&&t.ValueTypeName===r}));if(void 0===a)continue;let s=0;const c=i.getValueSize();i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(s=c/3);let l=0;const d=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(l=d/3);const u=i.times.length-1;let h;if(o<=i.times[0]){const t=s,e=c-s;h=td.arraySlice(i.values,t,e)}else if(o>=i.times[u]){const t=u*c+s,e=t+c-s;h=td.arraySlice(i.values,t,e)}else{const t=i.createInterpolant(),e=s,n=c-s;t.evaluate(o),h=td.arraySlice(t.resultBuffer,e,n)}if(\"quaternion\"===r){(new Kn).fromArray(h).normalize().conjugate().toArray(h)}const p=a.times.length;for(let t=0;t<p;++t){const e=t*d+l;if(\"quaternion\"===r)Kn.multiplyQuaternionsFlat(a.values,e,h,0,a.values,e);else{const t=d-2*l;for(let n=0;n<t;++n)a.values[e+n]-=h[n]}}}return t.blendMode=We,t}};function ed(t,e,n,i){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new e.constructor(n),this.sampleValues=e,this.valueSize=n}function nd(t,e,n,i){ed.call(this,t,e,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function id(t,e,n,i){ed.call(this,t,e,n,i)}function rd(t,e,n,i){ed.call(this,t,e,n,i)}function od(t,e,n,i){if(void 0===t)throw new Error(\"THREE.KeyframeTrack: track name is undefined\");if(void 0===e||0===e.length)throw new Error(\"THREE.KeyframeTrack: no keyframes in track named \"+t);this.name=t,this.times=td.convertArray(e,this.TimeBufferType),this.values=td.convertArray(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}function ad(t,e,n){od.call(this,t,e,n)}function sd(t,e,n,i){od.call(this,t,e,n,i)}function cd(t,e,n,i){od.call(this,t,e,n,i)}function ld(t,e,n,i){ed.call(this,t,e,n,i)}function dd(t,e,n,i){od.call(this,t,e,n,i)}function ud(t,e,n,i){od.call(this,t,e,n,i)}function hd(t,e,n,i){od.call(this,t,e,n,i)}function pd(t,e=-1,n,i=Ve){this.name=t,this.tracks=n,this.duration=e,this.blendMode=i,this.uuid=Bn.generateUUID(),this.duration<0&&this.resetDuration()}function fd(t){if(void 0===t.type)throw new Error(\"THREE.KeyframeTrack: track type undefined, can not parse\");const e=function(t){switch(t.toLowerCase()){case\"scalar\":case\"double\":case\"float\":case\"number\":case\"integer\":return cd;case\"vector\":case\"vector2\":case\"vector3\":case\"vector4\":return hd;case\"color\":return sd;case\"quaternion\":return dd;case\"bool\":case\"boolean\":return ad;case\"string\":return ud}throw new Error(\"THREE.KeyframeTrack: Unsupported typeName: \"+t)}(t.type);if(void 0===t.times){const e=[],n=[];td.flattenJSON(t.keys,e,n,\"value\"),t.times=e,t.values=n}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}Object.assign(ed.prototype,{evaluate:function(t){const e=this.parameterPositions;let n=this._cachedIndex,i=e[n],r=e[n-1];t:{e:{let o;n:{i:if(!(t<i)){for(let o=n+2;;){if(void 0===i){if(t<r)break i;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,r)}if(n===o)break;if(r=i,i=e[++n],t<i)break e}o=e.length;break n}if(t>=r)break t;{const a=e[1];t<a&&(n=2,r=a);for(let o=n-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,i);if(n===o)break;if(i=r,r=e[--n-1],t>=r)break e}o=n,n=0}}for(;n<o;){const i=n+o>>>1;t<e[i]?o=i:n=i+1}if(i=e[n],r=e[n-1],void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,i);if(void 0===i)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,r,t)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,t,i)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){const e=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=t*i;for(let t=0;t!==i;++t)e[t]=n[r+t];return e},interpolate_:function(){throw new Error(\"call to abstract method\")},intervalChanged_:function(){}}),Object.assign(ed.prototype,{beforeStart_:ed.prototype.copySampleValue_,afterEnd_:ed.prototype.copySampleValue_}),nd.prototype=Object.assign(Object.create(ed.prototype),{constructor:nd,DefaultSettings_:{endingStart:He,endingEnd:He},intervalChanged_:function(t,e,n){const i=this.parameterPositions;let r=t-2,o=t+1,a=i[r],s=i[o];if(void 0===a)switch(this.getSettings_().endingStart){case $e:r=t,a=2*e-n;break;case Ge:r=i.length-2,a=e+i[r]-i[r+1];break;default:r=t,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case $e:o=t,s=2*n-e;break;case Ge:o=1,s=n+i[1]-i[0];break;default:o=t-1,s=e}const c=.5*(n-e),l=this.valueSize;this._weightPrev=c/(e-a),this._weightNext=c/(s-n),this._offsetPrev=r*l,this._offsetNext=o*l},interpolate_:function(t,e,n,i){const r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,c=s-a,l=this._offsetPrev,d=this._offsetNext,u=this._weightPrev,h=this._weightNext,p=(n-e)/(i-e),f=p*p,m=f*p,g=-u*m+2*u*f-u*p,v=(1+u)*m+(-1.5-2*u)*f+(-.5+u)*p+1,y=(-1-h)*m+(1.5+h)*f+.5*p,b=h*m-h*f;for(let t=0;t!==a;++t)r[t]=g*o[l+t]+v*o[c+t]+y*o[s+t]+b*o[d+t];return r}}),id.prototype=Object.assign(Object.create(ed.prototype),{constructor:id,interpolate_:function(t,e,n,i){const r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,c=s-a,l=(n-e)/(i-e),d=1-l;for(let t=0;t!==a;++t)r[t]=o[c+t]*d+o[s+t]*l;return r}}),rd.prototype=Object.assign(Object.create(ed.prototype),{constructor:rd,interpolate_:function(t){return this.copySampleValue_(t-1)}}),Object.assign(od,{toJSON:function(t){const e=t.constructor;let n;if(void 0!==e.toJSON)n=e.toJSON(t);else{n={name:t.name,times:td.convertArray(t.times,Array),values:td.convertArray(t.values,Array)};const e=t.getInterpolation();e!==t.DefaultInterpolation&&(n.interpolation=e)}return n.type=t.ValueTypeName,n}}),Object.assign(od.prototype,{constructor:od,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:ze,InterpolantFactoryMethodDiscrete:function(t){return new rd(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new id(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new nd(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){let e;switch(t){case Be:e=this.InterpolantFactoryMethodDiscrete;break;case ze:e=this.InterpolantFactoryMethodLinear;break;case Ue:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){const e=\"unsupported interpolation for \"+this.ValueTypeName+\" keyframe track named \"+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(e);this.setInterpolation(this.DefaultInterpolation)}return console.warn(\"THREE.KeyframeTrack:\",e),this}return this.createInterpolant=e,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Be;case this.InterpolantFactoryMethodLinear:return ze;case this.InterpolantFactoryMethodSmooth:return Ue}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t){const e=this.times;for(let n=0,i=e.length;n!==i;++n)e[n]+=t}return this},scale:function(t){if(1!==t){const e=this.times;for(let n=0,i=e.length;n!==i;++n)e[n]*=t}return this},trim:function(t,e){const n=this.times,i=n.length;let r=0,o=i-1;for(;r!==i&&n[r]<t;)++r;for(;-1!==o&&n[o]>e;)--o;if(++o,0!==r||o!==i){r>=o&&(o=Math.max(o,1),r=o-1);const t=this.getValueSize();this.times=td.arraySlice(n,r,o),this.values=td.arraySlice(this.values,r*t,o*t)}return this},validate:function(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!=0&&(console.error(\"THREE.KeyframeTrack: Invalid value size in track.\",this),t=!1);const n=this.times,i=this.values,r=n.length;0===r&&(console.error(\"THREE.KeyframeTrack: Track is empty.\",this),t=!1);let o=null;for(let e=0;e!==r;e++){const i=n[e];if(\"number\"==typeof i&&isNaN(i)){console.error(\"THREE.KeyframeTrack: Time is not a valid number.\",this,e,i),t=!1;break}if(null!==o&&o>i){console.error(\"THREE.KeyframeTrack: Out of order keys.\",this,e,i,o),t=!1;break}o=i}if(void 0!==i&&td.isTypedArray(i))for(let e=0,n=i.length;e!==n;++e){const n=i[e];if(isNaN(n)){console.error(\"THREE.KeyframeTrack: Value is not a valid number.\",this,e,n),t=!1;break}}return t},optimize:function(){const t=td.arraySlice(this.times),e=td.arraySlice(this.values),n=this.getValueSize(),i=this.getInterpolation()===Ue,r=t.length-1;let o=1;for(let a=1;a<r;++a){let r=!1;const s=t[a];if(s!==t[a+1]&&(1!==a||s!==t[0]))if(i)r=!0;else{const t=a*n,i=t-n,o=t+n;for(let a=0;a!==n;++a){const n=e[t+a];if(n!==e[i+a]||n!==e[o+a]){r=!0;break}}}if(r){if(a!==o){t[o]=t[a];const i=a*n,r=o*n;for(let t=0;t!==n;++t)e[r+t]=e[i+t]}++o}}if(r>0){t[o]=t[r];for(let t=r*n,i=o*n,a=0;a!==n;++a)e[i+a]=e[t+a];++o}return o!==t.length?(this.times=td.arraySlice(t,0,o),this.values=td.arraySlice(e,0,o*n)):(this.times=t,this.values=e),this},clone:function(){const t=td.arraySlice(this.times,0),e=td.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}),ad.prototype=Object.assign(Object.create(od.prototype),{constructor:ad,ValueTypeName:\"bool\",ValueBufferType:Array,DefaultInterpolation:Be,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),sd.prototype=Object.assign(Object.create(od.prototype),{constructor:sd,ValueTypeName:\"color\"}),cd.prototype=Object.assign(Object.create(od.prototype),{constructor:cd,ValueTypeName:\"number\"}),ld.prototype=Object.assign(Object.create(ed.prototype),{constructor:ld,interpolate_:function(t,e,n,i){const r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=(n-e)/(i-e);let c=t*a;for(let t=c+a;c!==t;c+=4)Kn.slerpFlat(r,0,o,c-a,o,c,s);return r}}),dd.prototype=Object.assign(Object.create(od.prototype),{constructor:dd,ValueTypeName:\"quaternion\",DefaultInterpolation:ze,InterpolantFactoryMethodLinear:function(t){return new ld(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),ud.prototype=Object.assign(Object.create(od.prototype),{constructor:ud,ValueTypeName:\"string\",ValueBufferType:Array,DefaultInterpolation:Be,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),hd.prototype=Object.assign(Object.create(od.prototype),{constructor:hd,ValueTypeName:\"vector\"}),Object.assign(pd,{parse:function(t){const e=[],n=t.tracks,i=1/(t.fps||1);for(let t=0,r=n.length;t!==r;++t)e.push(fd(n[t]).scale(i));const r=new pd(t.name,t.duration,e,t.blendMode);return r.uuid=t.uuid,r},toJSON:function(t){const e=[],n=t.tracks,i={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let t=0,i=n.length;t!==i;++t)e.push(od.toJSON(n[t]));return i},CreateFromMorphTargetSequence:function(t,e,n,i){const r=e.length,o=[];for(let t=0;t<r;t++){let a=[],s=[];a.push((t+r-1)%r,t,(t+1)%r),s.push(0,1,0);const c=td.getKeyframeOrder(a);a=td.sortedArray(a,1,c),s=td.sortedArray(s,1,c),i||0!==a[0]||(a.push(r),s.push(s[0])),o.push(new cd(\".morphTargetInfluences[\"+e[t].name+\"]\",a,s).scale(1/n))}return new pd(t,-1,o)},findByName:function(t,e){let n=t;if(!Array.isArray(t)){const e=t;n=e.geometry&&e.geometry.animations||e.animations}for(let t=0;t<n.length;t++)if(n[t].name===e)return n[t];return null},CreateClipsFromMorphTargetSequences:function(t,e,n){const i={},r=/^([\\w-]*?)([\\d]+)$/;for(let e=0,n=t.length;e<n;e++){const n=t[e],o=n.name.match(r);if(o&&o.length>1){const t=o[1];let e=i[t];e||(i[t]=e=[]),e.push(n)}}const o=[];for(const t in i)o.push(pd.CreateFromMorphTargetSequence(t,i[t],e,n));return o},parseAnimation:function(t,e){if(!t)return console.error(\"THREE.AnimationClip: No animation in JSONLoader data.\"),null;const n=function(t,e,n,i,r){if(0!==n.length){const o=[],a=[];td.flattenJSON(n,o,a,i),0!==o.length&&r.push(new t(e,o,a))}},i=[],r=t.name||\"default\",o=t.fps||30,a=t.blendMode;let s=t.length||-1;const c=t.hierarchy||[];for(let t=0;t<c.length;t++){const r=c[t].keys;if(r&&0!==r.length)if(r[0].morphTargets){const t={};let e;for(e=0;e<r.length;e++)if(r[e].morphTargets)for(let n=0;n<r[e].morphTargets.length;n++)t[r[e].morphTargets[n]]=-1;for(const n in t){const t=[],o=[];for(let i=0;i!==r[e].morphTargets.length;++i){const i=r[e];t.push(i.time),o.push(i.morphTarget===n?1:0)}i.push(new cd(\".morphTargetInfluence[\"+n+\"]\",t,o))}s=t.length*(o||1)}else{const o=\".bones[\"+e[t].name+\"]\";n(hd,o+\".position\",r,\"pos\",i),n(dd,o+\".quaternion\",r,\"rot\",i),n(hd,o+\".scale\",r,\"scl\",i)}}if(0===i.length)return null;return new pd(r,s,i,a)}}),Object.assign(pd.prototype,{resetDuration:function(){let t=0;for(let e=0,n=this.tracks.length;e!==n;++e){const n=this.tracks[e];t=Math.max(t,n.times[n.times.length-1])}return this.duration=t,this},trim:function(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t},optimize:function(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){const t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new pd(this.name,this.duration,t,this.blendMode)},toJSON:function(){return pd.toJSON(this)}});const md={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function gd(t,e,n){const i=this;let r=!1,o=0,a=0,s=void 0;const c=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){a++,!1===r&&void 0!==i.onStart&&i.onStart(t,o,a),r=!0},this.itemEnd=function(t){o++,void 0!==i.onProgress&&i.onProgress(t,o,a),o===a&&(r=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(t){void 0!==i.onError&&i.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this},this.addHandler=function(t,e){return c.push(t,e),this},this.removeHandler=function(t){const e=c.indexOf(t);return-1!==e&&c.splice(e,2),this},this.getHandler=function(t){for(let e=0,n=c.length;e<n;e+=2){const n=c[e],i=c[e+1];if(n.global&&(n.lastIndex=0),n.test(t))return i}return null}}const vd=new gd;function yd(t){this.manager=void 0!==t?t:vd,this.crossOrigin=\"anonymous\",this.withCredentials=!1,this.path=\"\",this.resourcePath=\"\",this.requestHeader={}}Object.assign(yd.prototype,{load:function(){},loadAsync:function(t,e){const n=this;return new Promise((function(i,r){n.load(t,i,e,r)}))},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}});const bd={};function _d(t){yd.call(this,t)}function xd(t){yd.call(this,t)}function wd(t){yd.call(this,t)}function Sd(t){yd.call(this,t)}function Md(t){yd.call(this,t)}function Ed(t){yd.call(this,t)}function Td(t){yd.call(this,t)}function Cd(){this.type=\"Curve\",this.arcLengthDivisions=200}function Ad(t,e,n,i,r,o,a,s){Cd.call(this),this.type=\"EllipseCurve\",this.aX=t||0,this.aY=e||0,this.xRadius=n||1,this.yRadius=i||1,this.aStartAngle=r||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function Od(t,e,n,i,r,o){Ad.call(this,t,e,n,n,i,r,o),this.type=\"ArcCurve\"}function kd(){let t=0,e=0,n=0,i=0;function r(r,o,a,s){t=r,e=a,n=-3*r+3*o-2*a-s,i=2*r-2*o+a+s}return{initCatmullRom:function(t,e,n,i,o){r(e,n,o*(n-t),o*(i-e))},initNonuniformCatmullRom:function(t,e,n,i,o,a,s){let c=(e-t)/o-(n-t)/(o+a)+(n-e)/a,l=(n-e)/a-(i-e)/(a+s)+(i-n)/s;c*=a,l*=a,r(e,n,c,l)},calc:function(r){const o=r*r;return t+e*r+n*o+i*(o*r)}}}_d.prototype=Object.assign(Object.create(yd.prototype),{constructor:_d,load:function(t,e,n,i){void 0===t&&(t=\"\"),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=this,o=md.get(t);if(void 0!==o)return r.manager.itemStart(t),setTimeout((function(){e&&e(o),r.manager.itemEnd(t)}),0),o;if(void 0!==bd[t])return void bd[t].push({onLoad:e,onProgress:n,onError:i});const a=t.match(/^data:(.*?)(;base64)?,(.*)$/);let s;if(a){const n=a[1],o=!!a[2];let s=a[3];s=decodeURIComponent(s),o&&(s=atob(s));try{let i;const o=(this.responseType||\"\").toLowerCase();switch(o){case\"arraybuffer\":case\"blob\":const t=new Uint8Array(s.length);for(let e=0;e<s.length;e++)t[e]=s.charCodeAt(e);i=\"blob\"===o?new Blob([t.buffer],{type:n}):t.buffer;break;case\"document\":const e=new DOMParser;i=e.parseFromString(s,n);break;case\"json\":i=JSON.parse(s);break;default:i=s}setTimeout((function(){e&&e(i),r.manager.itemEnd(t)}),0)}catch(e){setTimeout((function(){i&&i(e),r.manager.itemError(t),r.manager.itemEnd(t)}),0)}}else{bd[t]=[],bd[t].push({onLoad:e,onProgress:n,onError:i}),s=new XMLHttpRequest,s.open(\"GET\",t,!0),s.addEventListener(\"load\",(function(e){const n=this.response,i=bd[t];if(delete bd[t],200===this.status||0===this.status){0===this.status&&console.warn(\"THREE.FileLoader: HTTP Status 0 received.\"),md.add(t,n);for(let t=0,e=i.length;t<e;t++){const e=i[t];e.onLoad&&e.onLoad(n)}r.manager.itemEnd(t)}else{for(let t=0,n=i.length;t<n;t++){const n=i[t];n.onError&&n.onError(e)}r.manager.itemError(t),r.manager.itemEnd(t)}}),!1),s.addEventListener(\"progress\",(function(e){const n=bd[t];for(let t=0,i=n.length;t<i;t++){const i=n[t];i.onProgress&&i.onProgress(e)}}),!1),s.addEventListener(\"error\",(function(e){const n=bd[t];delete bd[t];for(let t=0,i=n.length;t<i;t++){const i=n[t];i.onError&&i.onError(e)}r.manager.itemError(t),r.manager.itemEnd(t)}),!1),s.addEventListener(\"abort\",(function(e){const n=bd[t];delete bd[t];for(let t=0,i=n.length;t<i;t++){const i=n[t];i.onError&&i.onError(e)}r.manager.itemError(t),r.manager.itemEnd(t)}),!1),void 0!==this.responseType&&(s.responseType=this.responseType),void 0!==this.withCredentials&&(s.withCredentials=this.withCredentials),s.overrideMimeType&&s.overrideMimeType(void 0!==this.mimeType?this.mimeType:\"text/plain\");for(const t in this.requestHeader)s.setRequestHeader(t,this.requestHeader[t]);s.send(null)}return r.manager.itemStart(t),s},setResponseType:function(t){return this.responseType=t,this},setMimeType:function(t){return this.mimeType=t,this}}),xd.prototype=Object.assign(Object.create(yd.prototype),{constructor:xd,load:function(t,e,n,i){const r=this,o=new _d(r.manager);o.setPath(r.path),o.setRequestHeader(r.requestHeader),o.setWithCredentials(r.withCredentials),o.load(t,(function(n){try{e(r.parse(JSON.parse(n)))}catch(e){i?i(e):console.error(e),r.manager.itemError(t)}}),n,i)},parse:function(t){const e=[];for(let n=0;n<t.length;n++){const i=pd.parse(t[n]);e.push(i)}return e}}),wd.prototype=Object.assign(Object.create(yd.prototype),{constructor:wd,load:function(t,e,n,i){const r=this,o=[],a=new zc,s=new _d(this.manager);s.setPath(this.path),s.setResponseType(\"arraybuffer\"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(r.withCredentials);let c=0;function l(l){s.load(t[l],(function(t){const n=r.parse(t,!0);o[l]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},c+=1,6===c&&(1===n.mipmapCount&&(a.minFilter=bt),a.image=o,a.format=n.format,a.needsUpdate=!0,e&&e(a))}),n,i)}if(Array.isArray(t))for(let e=0,n=t.length;e<n;++e)l(e);else s.load(t,(function(t){const n=r.parse(t,!0);if(n.isCubemap){const t=n.mipmaps.length/n.mipmapCount;for(let e=0;e<t;e++){o[e]={mipmaps:[]};for(let t=0;t<n.mipmapCount;t++)o[e].mipmaps.push(n.mipmaps[e*n.mipmapCount+t]),o[e].format=n.format,o[e].width=n.width,o[e].height=n.height}a.image=o}else a.image.width=n.width,a.image.height=n.height,a.mipmaps=n.mipmaps;1===n.mipmapCount&&(a.minFilter=bt),a.format=n.format,a.needsUpdate=!0,e&&e(a)}),n,i);return a}}),Sd.prototype=Object.assign(Object.create(yd.prototype),{constructor:Sd,load:function(t,e,n,i){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=this,o=md.get(t);if(void 0!==o)return r.manager.itemStart(t),setTimeout((function(){e&&e(o),r.manager.itemEnd(t)}),0),o;const a=document.createElementNS(\"http://www.w3.org/1999/xhtml\",\"img\");function s(){a.removeEventListener(\"load\",s,!1),a.removeEventListener(\"error\",c,!1),md.add(t,this),e&&e(this),r.manager.itemEnd(t)}function c(e){a.removeEventListener(\"load\",s,!1),a.removeEventListener(\"error\",c,!1),i&&i(e),r.manager.itemError(t),r.manager.itemEnd(t)}return a.addEventListener(\"load\",s,!1),a.addEventListener(\"error\",c,!1),\"data:\"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),r.manager.itemStart(t),a.src=t,a}}),Md.prototype=Object.assign(Object.create(yd.prototype),{constructor:Md,load:function(t,e,n,i){const r=new xo,o=new Sd(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function s(n){o.load(t[n],(function(t){r.images[n]=t,a++,6===a&&(r.needsUpdate=!0,e&&e(r))}),void 0,i)}for(let e=0;e<t.length;++e)s(e);return r}}),Ed.prototype=Object.assign(Object.create(yd.prototype),{constructor:Ed,load:function(t,e,n,i){const r=this,o=new So,a=new _d(this.manager);return a.setResponseType(\"arraybuffer\"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(r.withCredentials),a.load(t,(function(t){const n=r.parse(t);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:ht,o.wrapT=void 0!==n.wrapT?n.wrapT:ht,o.magFilter=void 0!==n.magFilter?n.magFilter:bt,o.minFilter=void 0!==n.minFilter?n.minFilter:bt,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.encoding&&(o.encoding=n.encoding),void 0!==n.flipY&&(o.flipY=n.flipY),void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps,o.minFilter=wt),1===n.mipmapCount&&(o.minFilter=bt),o.needsUpdate=!0,e&&e(o,n))}),n,i),o}}),Td.prototype=Object.assign(Object.create(yd.prototype),{constructor:Td,load:function(t,e,n,i){const r=new Vn,o=new Sd(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,(function(n){r.image=n;const i=t.search(/\\.jpe?g($|\\?)/i)>0||0===t.search(/^data\\:image\\/jpeg/);r.format=i?Ft:jt,r.needsUpdate=!0,void 0!==e&&e(r)}),n,i),r}}),Object.assign(Cd.prototype,{getPoint:function(){return console.warn(\"THREE.Curve: .getPoint() not implemented.\"),null},getPointAt:function(t,e){const n=this.getUtoTmapping(t);return this.getPoint(n,e)},getPoints:function(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return e},getSpacedPoints:function(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e},getLength:function(){const t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let n,i=this.getPoint(0),r=0;e.push(0);for(let o=1;o<=t;o++)n=this.getPoint(o/t),r+=n.distanceTo(i),e.push(r),i=n;return this.cacheArcLengths=e,e},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){const n=this.getLengths();let i=0;const r=n.length;let o;o=e||t*n[r-1];let a,s=0,c=r-1;for(;s<=c;)if(i=Math.floor(s+(c-s)/2),a=n[i]-o,a<0)s=i+1;else{if(!(a>0)){c=i;break}c=i-1}if(i=c,n[i]===o)return i/(r-1);const l=n[i];return(i+(o-l)/(n[i+1]-l))/(r-1)},getTangent:function(t,e){let n=t-1e-4,i=t+1e-4;n<0&&(n=0),i>1&&(i=1);const r=this.getPoint(n),o=this.getPoint(i),a=e||(r.isVector2?new zn:new Zn);return a.copy(o).sub(r).normalize(),a},getTangentAt:function(t,e){const n=this.getUtoTmapping(t);return this.getTangent(n,e)},computeFrenetFrames:function(t,e){const n=new Zn,i=[],r=[],o=[],a=new Zn,s=new Ei;for(let e=0;e<=t;e++){const n=e/t;i[e]=this.getTangentAt(n,new Zn),i[e].normalize()}r[0]=new Zn,o[0]=new Zn;let c=Number.MAX_VALUE;const l=Math.abs(i[0].x),d=Math.abs(i[0].y),u=Math.abs(i[0].z);l<=c&&(c=l,n.set(1,0,0)),d<=c&&(c=d,n.set(0,1,0)),u<=c&&n.set(0,0,1),a.crossVectors(i[0],n).normalize(),r[0].crossVectors(i[0],a),o[0].crossVectors(i[0],r[0]);for(let e=1;e<=t;e++){if(r[e]=r[e-1].clone(),o[e]=o[e-1].clone(),a.crossVectors(i[e-1],i[e]),a.length()>Number.EPSILON){a.normalize();const t=Math.acos(Bn.clamp(i[e-1].dot(i[e]),-1,1));r[e].applyMatrix4(s.makeRotationAxis(a,t))}o[e].crossVectors(i[e],r[e])}if(!0===e){let e=Math.acos(Bn.clamp(r[0].dot(r[t]),-1,1));e/=t,i[0].dot(a.crossVectors(r[0],r[t]))>0&&(e=-e);for(let n=1;n<=t;n++)r[n].applyMatrix4(s.makeRotationAxis(i[n],e*n)),o[n].crossVectors(i[n],r[n])}return{tangents:i,normals:r,binormals:o}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){const t={metadata:{version:4.5,type:\"Curve\",generator:\"Curve.toJSON\"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),Ad.prototype=Object.create(Cd.prototype),Ad.prototype.constructor=Ad,Ad.prototype.isEllipseCurve=!0,Ad.prototype.getPoint=function(t,e){const n=e||new zn,i=2*Math.PI;let r=this.aEndAngle-this.aStartAngle;const o=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=i;for(;r>i;)r-=i;r<Number.EPSILON&&(r=o?0:i),!0!==this.aClockwise||o||(r===i?r=-i:r-=i);const a=this.aStartAngle+t*r;let s=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){const t=Math.cos(this.aRotation),e=Math.sin(this.aRotation),n=s-this.aX,i=c-this.aY;s=n*t-i*e+this.aX,c=n*e+i*t+this.aY}return n.set(s,c)},Ad.prototype.copy=function(t){return Cd.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Ad.prototype.toJSON=function(){const t=Cd.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},Ad.prototype.fromJSON=function(t){return Cd.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Od.prototype=Object.create(Ad.prototype),Od.prototype.constructor=Od,Od.prototype.isArcCurve=!0;const Ld=new Zn,Id=new kd,Rd=new kd,Pd=new kd;function Dd(t=[],e=!1,n=\"centripetal\",i=.5){Cd.call(this),this.type=\"CatmullRomCurve3\",this.points=t,this.closed=e,this.curveType=n,this.tension=i}function Nd(t,e,n,i,r){const o=.5*(i-e),a=.5*(r-n),s=t*t;return(2*n-2*i+o+a)*(t*s)+(-3*n+3*i-2*o-a)*s+o*t+n}function Fd(t,e,n,i){return function(t,e){const n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,i)}function jd(t,e,n,i,r){return function(t,e){const n=1-t;return n*n*n*e}(t,e)+function(t,e){const n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,i)+function(t,e){return t*t*t*e}(t,r)}function Bd(t=new zn,e=new zn,n=new zn,i=new zn){Cd.call(this),this.type=\"CubicBezierCurve\",this.v0=t,this.v1=e,this.v2=n,this.v3=i}function zd(t=new Zn,e=new Zn,n=new Zn,i=new Zn){Cd.call(this),this.type=\"CubicBezierCurve3\",this.v0=t,this.v1=e,this.v2=n,this.v3=i}function Ud(t=new zn,e=new zn){Cd.call(this),this.type=\"LineCurve\",this.v1=t,this.v2=e}function Hd(t=new Zn,e=new Zn){Cd.call(this),this.type=\"LineCurve3\",this.v1=t,this.v2=e}function $d(t=new zn,e=new zn,n=new zn){Cd.call(this),this.type=\"QuadraticBezierCurve\",this.v0=t,this.v1=e,this.v2=n}function Gd(t=new Zn,e=new Zn,n=new Zn){Cd.call(this),this.type=\"QuadraticBezierCurve3\",this.v0=t,this.v1=e,this.v2=n}function Vd(t=[]){Cd.call(this),this.type=\"SplineCurve\",this.points=t}Dd.prototype=Object.create(Cd.prototype),Dd.prototype.constructor=Dd,Dd.prototype.isCatmullRomCurve3=!0,Dd.prototype.getPoint=function(t,e=new Zn){const n=e,i=this.points,r=i.length,o=(r-(this.closed?0:1))*t;let a,s,c=Math.floor(o),l=o-c;this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/r)+1)*r:0===l&&c===r-1&&(c=r-2,l=1),this.closed||c>0?a=i[(c-1)%r]:(Ld.subVectors(i[0],i[1]).add(i[0]),a=Ld);const d=i[c%r],u=i[(c+1)%r];if(this.closed||c+2<r?s=i[(c+2)%r]:(Ld.subVectors(i[r-1],i[r-2]).add(i[r-1]),s=Ld),\"centripetal\"===this.curveType||\"chordal\"===this.curveType){const t=\"chordal\"===this.curveType?.5:.25;let e=Math.pow(a.distanceToSquared(d),t),n=Math.pow(d.distanceToSquared(u),t),i=Math.pow(u.distanceToSquared(s),t);n<1e-4&&(n=1),e<1e-4&&(e=n),i<1e-4&&(i=n),Id.initNonuniformCatmullRom(a.x,d.x,u.x,s.x,e,n,i),Rd.initNonuniformCatmullRom(a.y,d.y,u.y,s.y,e,n,i),Pd.initNonuniformCatmullRom(a.z,d.z,u.z,s.z,e,n,i)}else\"catmullrom\"===this.curveType&&(Id.initCatmullRom(a.x,d.x,u.x,s.x,this.tension),Rd.initCatmullRom(a.y,d.y,u.y,s.y,this.tension),Pd.initCatmullRom(a.z,d.z,u.z,s.z,this.tension));return n.set(Id.calc(l),Rd.calc(l),Pd.calc(l)),n},Dd.prototype.copy=function(t){Cd.prototype.copy.call(this,t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push(n.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Dd.prototype.toJSON=function(){const t=Cd.prototype.toJSON.call(this);t.points=[];for(let e=0,n=this.points.length;e<n;e++){const n=this.points[e];t.points.push(n.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},Dd.prototype.fromJSON=function(t){Cd.prototype.fromJSON.call(this,t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new Zn).fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Bd.prototype=Object.create(Cd.prototype),Bd.prototype.constructor=Bd,Bd.prototype.isCubicBezierCurve=!0,Bd.prototype.getPoint=function(t,e=new zn){const n=e,i=this.v0,r=this.v1,o=this.v2,a=this.v3;return n.set(jd(t,i.x,r.x,o.x,a.x),jd(t,i.y,r.y,o.y,a.y)),n},Bd.prototype.copy=function(t){return Cd.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Bd.prototype.toJSON=function(){const t=Cd.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Bd.prototype.fromJSON=function(t){return Cd.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},zd.prototype=Object.create(Cd.prototype),zd.prototype.constructor=zd,zd.prototype.isCubicBezierCurve3=!0,zd.prototype.getPoint=function(t,e=new Zn){const n=e,i=this.v0,r=this.v1,o=this.v2,a=this.v3;return n.set(jd(t,i.x,r.x,o.x,a.x),jd(t,i.y,r.y,o.y,a.y),jd(t,i.z,r.z,o.z,a.z)),n},zd.prototype.copy=function(t){return Cd.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},zd.prototype.toJSON=function(){const t=Cd.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},zd.prototype.fromJSON=function(t){return Cd.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},Ud.prototype=Object.create(Cd.prototype),Ud.prototype.constructor=Ud,Ud.prototype.isLineCurve=!0,Ud.prototype.getPoint=function(t,e=new zn){const n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},Ud.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},Ud.prototype.getTangent=function(t,e){const n=e||new zn;return n.copy(this.v2).sub(this.v1).normalize(),n},Ud.prototype.copy=function(t){return Cd.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Ud.prototype.toJSON=function(){const t=Cd.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Ud.prototype.fromJSON=function(t){return Cd.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Hd.prototype=Object.create(Cd.prototype),Hd.prototype.constructor=Hd,Hd.prototype.isLineCurve3=!0,Hd.prototype.getPoint=function(t,e=new Zn){const n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},Hd.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},Hd.prototype.copy=function(t){return Cd.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Hd.prototype.toJSON=function(){const t=Cd.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Hd.prototype.fromJSON=function(t){return Cd.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},$d.prototype=Object.create(Cd.prototype),$d.prototype.constructor=$d,$d.prototype.isQuadraticBezierCurve=!0,$d.prototype.getPoint=function(t,e=new zn){const n=e,i=this.v0,r=this.v1,o=this.v2;return n.set(Fd(t,i.x,r.x,o.x),Fd(t,i.y,r.y,o.y)),n},$d.prototype.copy=function(t){return Cd.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},$d.prototype.toJSON=function(){const t=Cd.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},$d.prototype.fromJSON=function(t){return Cd.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Gd.prototype=Object.create(Cd.prototype),Gd.prototype.constructor=Gd,Gd.prototype.isQuadraticBezierCurve3=!0,Gd.prototype.getPoint=function(t,e=new Zn){const n=e,i=this.v0,r=this.v1,o=this.v2;return n.set(Fd(t,i.x,r.x,o.x),Fd(t,i.y,r.y,o.y),Fd(t,i.z,r.z,o.z)),n},Gd.prototype.copy=function(t){return Cd.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Gd.prototype.toJSON=function(){const t=Cd.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Gd.prototype.fromJSON=function(t){return Cd.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Vd.prototype=Object.create(Cd.prototype),Vd.prototype.constructor=Vd,Vd.prototype.isSplineCurve=!0,Vd.prototype.getPoint=function(t,e=new zn){const n=e,i=this.points,r=(i.length-1)*t,o=Math.floor(r),a=r-o,s=i[0===o?o:o-1],c=i[o],l=i[o>i.length-2?i.length-1:o+1],d=i[o>i.length-3?i.length-1:o+2];return n.set(Nd(a,s.x,c.x,l.x,d.x),Nd(a,s.y,c.y,l.y,d.y)),n},Vd.prototype.copy=function(t){Cd.prototype.copy.call(this,t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push(n.clone())}return this},Vd.prototype.toJSON=function(){const t=Cd.prototype.toJSON.call(this);t.points=[];for(let e=0,n=this.points.length;e<n;e++){const n=this.points[e];t.points.push(n.toArray())}return t},Vd.prototype.fromJSON=function(t){Cd.prototype.fromJSON.call(this,t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new zn).fromArray(n))}return this};var Wd=Object.freeze({__proto__:null,ArcCurve:Od,CatmullRomCurve3:Dd,CubicBezierCurve:Bd,CubicBezierCurve3:zd,EllipseCurve:Ad,LineCurve:Ud,LineCurve3:Hd,QuadraticBezierCurve:$d,QuadraticBezierCurve3:Gd,SplineCurve:Vd});function qd(){Cd.call(this),this.type=\"CurvePath\",this.curves=[],this.autoClose=!1}function Xd(t){qd.call(this),this.type=\"Path\",this.currentPoint=new zn,t&&this.setFromPoints(t)}function Yd(t){Xd.call(this,t),this.uuid=Bn.generateUUID(),this.type=\"Shape\",this.holes=[]}function Kd(t,e=1){Ki.call(this),this.type=\"Light\",this.color=new yr(t),this.intensity=e}function Zd(t,e,n){Kd.call(this,t,n),this.type=\"HemisphereLight\",this.position.copy(Ki.DefaultUp),this.updateMatrix(),this.groundColor=new yr(e)}function Jd(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new zn(512,512),this.map=null,this.mapPass=null,this.matrix=new Ei,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new To,this._frameExtents=new zn(1,1),this._viewportCount=1,this._viewports=[new qn(0,0,1,1)]}function Qd(){Jd.call(this,new bo(50,1,.5,500)),this.focus=1}function tu(t,e,n,i,r,o){Kd.call(this,t,e),this.type=\"SpotLight\",this.position.copy(Ki.DefaultUp),this.updateMatrix(),this.target=new Ki,Object.defineProperty(this,\"power\",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==i?i:Math.PI/3,this.penumbra=void 0!==r?r:0,this.decay=void 0!==o?o:1,this.shadow=new Qd}function eu(){Jd.call(this,new bo(90,1,.5,500)),this._frameExtents=new zn(4,2),this._viewportCount=6,this._viewports=[new qn(2,1,1,1),new qn(0,1,1,1),new qn(3,1,1,1),new qn(1,1,1,1),new qn(3,0,1,1),new qn(1,0,1,1)],this._cubeDirections=[new Zn(1,0,0),new Zn(-1,0,0),new Zn(0,0,1),new Zn(0,0,-1),new Zn(0,1,0),new Zn(0,-1,0)],this._cubeUps=[new Zn(0,1,0),new Zn(0,1,0),new Zn(0,1,0),new Zn(0,1,0),new Zn(0,0,1),new Zn(0,0,-1)]}function nu(t,e,n,i){Kd.call(this,t,e),this.type=\"PointLight\",Object.defineProperty(this,\"power\",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==i?i:1,this.shadow=new eu}function iu(t=-1,e=1,n=1,i=-1,r=.1,o=2e3){yo.call(this),this.type=\"OrthographicCamera\",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=i,this.near=r,this.far=o,this.updateProjectionMatrix()}function ru(){Jd.call(this,new iu(-5,5,5,-5,.5,500))}function ou(t,e){Kd.call(this,t,e),this.type=\"DirectionalLight\",this.position.copy(Ki.DefaultUp),this.updateMatrix(),this.target=new Ki,this.shadow=new ru}function au(t,e){Kd.call(this,t,e),this.type=\"AmbientLight\"}function su(t,e,n,i){Kd.call(this,t,e),this.type=\"RectAreaLight\",this.width=void 0!==n?n:10,this.height=void 0!==i?i:10}qd.prototype=Object.assign(Object.create(Cd.prototype),{constructor:qd,add:function(t){this.curves.push(t)},closePath:function(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Ud(e,t))},getPoint:function(t){const e=t*this.getLength(),n=this.getCurveLengths();let i=0;for(;i<n.length;){if(n[i]>=e){const t=n[i]-e,r=this.curves[i],o=r.getLength(),a=0===o?0:1-t/o;return r.getPointAt(a)}i++}return null},getLength:function(){const t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let n=0,i=this.curves.length;n<i;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t},getSpacedPoints:function(t=40){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t=12){const e=[];let n;for(let i=0,r=this.curves;i<r.length;i++){const o=r[i],a=o&&o.isEllipseCurve?2*t:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?t*o.points.length:t,s=o.getPoints(a);for(let t=0;t<s.length;t++){const i=s[t];n&&n.equals(i)||(e.push(i),n=i)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e},copy:function(t){Cd.prototype.copy.call(this,t),this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const n=t.curves[e];this.curves.push(n.clone())}return this.autoClose=t.autoClose,this},toJSON:function(){const t=Cd.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(let e=0,n=this.curves.length;e<n;e++){const n=this.curves[e];t.curves.push(n.toJSON())}return t},fromJSON:function(t){Cd.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const n=t.curves[e];this.curves.push((new Wd[n.type]).fromJSON(n))}return this}}),Xd.prototype=Object.assign(Object.create(qd.prototype),{constructor:Xd,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(let e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this},moveTo:function(t,e){return this.currentPoint.set(t,e),this},lineTo:function(t,e){const n=new Ud(this.currentPoint.clone(),new zn(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this},quadraticCurveTo:function(t,e,n,i){const r=new $d(this.currentPoint.clone(),new zn(t,e),new zn(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this},bezierCurveTo:function(t,e,n,i,r,o){const a=new Bd(this.currentPoint.clone(),new zn(t,e),new zn(n,i),new zn(r,o));return this.curves.push(a),this.currentPoint.set(r,o),this},splineThru:function(t){const e=new Vd([this.currentPoint.clone()].concat(t));return this.curves.push(e),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,e,n,i,r,o){const a=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(t+a,e+s,n,i,r,o),this},absarc:function(t,e,n,i,r,o){return this.absellipse(t,e,n,n,i,r,o),this},ellipse:function(t,e,n,i,r,o,a,s){const c=this.currentPoint.x,l=this.currentPoint.y;return this.absellipse(t+c,e+l,n,i,r,o,a,s),this},absellipse:function(t,e,n,i,r,o,a,s){const c=new Ad(t,e,n,i,r,o,a,s);if(this.curves.length>0){const t=c.getPoint(0);t.equals(this.currentPoint)||this.lineTo(t.x,t.y)}this.curves.push(c);const l=c.getPoint(1);return this.currentPoint.copy(l),this},copy:function(t){return qd.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){const t=qd.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return qd.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),Yd.prototype=Object.assign(Object.create(Xd.prototype),{constructor:Yd,getPointsHoles:function(t){const e=[];for(let n=0,i=this.holes.length;n<i;n++)e[n]=this.holes[n].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){Xd.prototype.copy.call(this,t),this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const n=t.holes[e];this.holes.push(n.clone())}return this},toJSON:function(){const t=Xd.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(let e=0,n=this.holes.length;e<n;e++){const n=this.holes[e];t.holes.push(n.toJSON())}return t},fromJSON:function(t){Xd.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const n=t.holes[e];this.holes.push((new Xd).fromJSON(n))}return this}}),Kd.prototype=Object.assign(Object.create(Ki.prototype),{constructor:Kd,isLight:!0,copy:function(t){return Ki.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){const e=Ki.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),Zd.prototype=Object.assign(Object.create(Kd.prototype),{constructor:Zd,isHemisphereLight:!0,copy:function(t){return Kd.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(Jd.prototype,{_projScreenMatrix:new Ei,_lightPositionWorld:new Zn,_lookTarget:new Zn,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(t){const e=this.camera,n=this.matrix,i=this._projScreenMatrix,r=this._lookTarget,o=this._lightPositionWorld;o.setFromMatrixPosition(t.matrixWorld),e.position.copy(o),r.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(r),e.updateMatrixWorld(),i.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(i),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(e.projectionMatrix),n.multiply(e.matrixWorldInverse)},getViewport:function(t){return this._viewports[t]},getFrameExtents:function(){return this._frameExtents},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){const t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),Qd.prototype=Object.assign(Object.create(Jd.prototype),{constructor:Qd,isSpotLightShadow:!0,updateMatrices:function(t){const e=this.camera,n=2*Bn.RAD2DEG*t.angle*this.focus,i=this.mapSize.width/this.mapSize.height,r=t.distance||e.far;n===e.fov&&i===e.aspect&&r===e.far||(e.fov=n,e.aspect=i,e.far=r,e.updateProjectionMatrix()),Jd.prototype.updateMatrices.call(this,t)}}),tu.prototype=Object.assign(Object.create(Kd.prototype),{constructor:tu,isSpotLight:!0,copy:function(t){return Kd.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),eu.prototype=Object.assign(Object.create(Jd.prototype),{constructor:eu,isPointLightShadow:!0,updateMatrices:function(t,e=0){const n=this.camera,i=this.matrix,r=this._lightPositionWorld,o=this._lookTarget,a=this._projScreenMatrix;r.setFromMatrixPosition(t.matrixWorld),n.position.copy(r),o.copy(n.position),o.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(o),n.updateMatrixWorld(),i.makeTranslation(-r.x,-r.y,-r.z),a.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(a)}}),nu.prototype=Object.assign(Object.create(Kd.prototype),{constructor:nu,isPointLight:!0,copy:function(t){return Kd.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),iu.prototype=Object.assign(Object.create(yo.prototype),{constructor:iu,isOrthographicCamera:!0,copy:function(t,e){return yo.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,n,i,r,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let r=n-t,o=n+t,a=i+e,s=i-e;if(null!==this.view&&this.view.enabled){const t=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=t*this.view.offsetX,o=r+t*this.view.width,a-=e*this.view.offsetY,s=a-e*this.view.height}this.projectionMatrix.makeOrthographic(r,o,a,s,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(t){const e=Ki.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}),ru.prototype=Object.assign(Object.create(Jd.prototype),{constructor:ru,isDirectionalLightShadow:!0,updateMatrices:function(t){Jd.prototype.updateMatrices.call(this,t)}}),ou.prototype=Object.assign(Object.create(Kd.prototype),{constructor:ou,isDirectionalLight:!0,copy:function(t){return Kd.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),au.prototype=Object.assign(Object.create(Kd.prototype),{constructor:au,isAmbientLight:!0}),su.prototype=Object.assign(Object.create(Kd.prototype),{constructor:su,isRectAreaLight:!0,copy:function(t){return Kd.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){const e=Kd.prototype.toJSON.call(this,t);return e.object.width=this.width,e.object.height=this.height,e}});class cu{constructor(){Object.defineProperty(this,\"isSphericalHarmonics3\",{value:!0}),this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new Zn)}set(t){for(let e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this}zero(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this}getAt(t,e){const n=t.x,i=t.y,r=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.282095),e.addScaledVector(o[1],.488603*i),e.addScaledVector(o[2],.488603*r),e.addScaledVector(o[3],.488603*n),e.addScaledVector(o[4],n*i*1.092548),e.addScaledVector(o[5],i*r*1.092548),e.addScaledVector(o[6],.315392*(3*r*r-1)),e.addScaledVector(o[7],n*r*1.092548),e.addScaledVector(o[8],.546274*(n*n-i*i)),e}getIrradianceAt(t,e){const n=t.x,i=t.y,r=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.886227),e.addScaledVector(o[1],1.023328*i),e.addScaledVector(o[2],1.023328*r),e.addScaledVector(o[3],1.023328*n),e.addScaledVector(o[4],.858086*n*i),e.addScaledVector(o[5],.858086*i*r),e.addScaledVector(o[6],.743125*r*r-.247708),e.addScaledVector(o[7],.858086*n*r),e.addScaledVector(o[8],.429043*(n*n-i*i)),e}add(t){for(let e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this}addScaledSH(t,e){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],e);return this}scale(t){for(let e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this}lerp(t,e){for(let n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this}equals(t){for(let e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0}copy(t){return this.set(t.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(t,e=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(t,e+3*i);return this}toArray(t=[],e=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(t,e+3*i);return t}static getBasisAt(t,e){const n=t.x,i=t.y,r=t.z;e[0]=.282095,e[1]=.488603*i,e[2]=.488603*r,e[3]=.488603*n,e[4]=1.092548*n*i,e[5]=1.092548*i*r,e[6]=.315392*(3*r*r-1),e[7]=1.092548*n*r,e[8]=.546274*(n*n-i*i)}}function lu(t,e){Kd.call(this,void 0,e),this.type=\"LightProbe\",this.sh=void 0!==t?t:new cu}function du(t){yd.call(this,t),this.textures={}}lu.prototype=Object.assign(Object.create(Kd.prototype),{constructor:lu,isLightProbe:!0,copy:function(t){return Kd.prototype.copy.call(this,t),this.sh.copy(t.sh),this},fromJSON:function(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this},toJSON:function(t){const e=Kd.prototype.toJSON.call(this,t);return e.object.sh=this.sh.toArray(),e}}),du.prototype=Object.assign(Object.create(yd.prototype),{constructor:du,load:function(t,e,n,i){const r=this,o=new _d(r.manager);o.setPath(r.path),o.setRequestHeader(r.requestHeader),o.setWithCredentials(r.withCredentials),o.load(t,(function(n){try{e(r.parse(JSON.parse(n)))}catch(e){i?i(e):console.error(e),r.manager.itemError(t)}}),n,i)},parse:function(t){const e=this.textures;function n(t){return void 0===e[t]&&console.warn(\"THREE.MaterialLoader: Undefined texture\",t),e[t]}const i=new Ql[t.type];if(void 0!==t.uuid&&(i.uuid=t.uuid),void 0!==t.name&&(i.name=t.name),void 0!==t.color&&void 0!==i.color&&i.color.setHex(t.color),void 0!==t.roughness&&(i.roughness=t.roughness),void 0!==t.metalness&&(i.metalness=t.metalness),void 0!==t.sheen&&(i.sheen=(new yr).setHex(t.sheen)),void 0!==t.emissive&&void 0!==i.emissive&&i.emissive.setHex(t.emissive),void 0!==t.specular&&void 0!==i.specular&&i.specular.setHex(t.specular),void 0!==t.shininess&&(i.shininess=t.shininess),void 0!==t.clearcoat&&(i.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(i.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.fog&&(i.fog=t.fog),void 0!==t.flatShading&&(i.flatShading=t.flatShading),void 0!==t.blending&&(i.blending=t.blending),void 0!==t.combine&&(i.combine=t.combine),void 0!==t.side&&(i.side=t.side),void 0!==t.opacity&&(i.opacity=t.opacity),void 0!==t.transparent&&(i.transparent=t.transparent),void 0!==t.alphaTest&&(i.alphaTest=t.alphaTest),void 0!==t.depthTest&&(i.depthTest=t.depthTest),void 0!==t.depthWrite&&(i.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(i.colorWrite=t.colorWrite),void 0!==t.stencilWrite&&(i.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(i.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(i.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(i.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(i.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(i.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(i.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(i.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(i.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(i.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(i.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(i.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(i.rotation=t.rotation),1!==t.linewidth&&(i.linewidth=t.linewidth),void 0!==t.dashSize&&(i.dashSize=t.dashSize),void 0!==t.gapSize&&(i.gapSize=t.gapSize),void 0!==t.scale&&(i.scale=t.scale),void 0!==t.polygonOffset&&(i.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(i.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(i.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(i.skinning=t.skinning),void 0!==t.morphTargets&&(i.morphTargets=t.morphTargets),void 0!==t.morphNormals&&(i.morphNormals=t.morphNormals),void 0!==t.dithering&&(i.dithering=t.dithering),void 0!==t.vertexTangents&&(i.vertexTangents=t.vertexTangents),void 0!==t.visible&&(i.visible=t.visible),void 0!==t.toneMapped&&(i.toneMapped=t.toneMapped),void 0!==t.userData&&(i.userData=t.userData),void 0!==t.vertexColors&&(\"number\"==typeof t.vertexColors?i.vertexColors=t.vertexColors>0:i.vertexColors=t.vertexColors),void 0!==t.uniforms)for(const e in t.uniforms){const r=t.uniforms[e];switch(i.uniforms[e]={},r.type){case\"t\":i.uniforms[e].value=n(r.value);break;case\"c\":i.uniforms[e].value=(new yr).setHex(r.value);break;case\"v2\":i.uniforms[e].value=(new zn).fromArray(r.value);break;case\"v3\":i.uniforms[e].value=(new Zn).fromArray(r.value);break;case\"v4\":i.uniforms[e].value=(new qn).fromArray(r.value);break;case\"m3\":i.uniforms[e].value=(new Un).fromArray(r.value);break;case\"m4\":i.uniforms[e].value=(new Ei).fromArray(r.value);break;default:i.uniforms[e].value=r.value}}if(void 0!==t.defines&&(i.defines=t.defines),void 0!==t.vertexShader&&(i.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(i.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(const e in t.extensions)i.extensions[e]=t.extensions[e];if(void 0!==t.shading&&(i.flatShading=1===t.shading),void 0!==t.size&&(i.size=t.size),void 0!==t.sizeAttenuation&&(i.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(i.map=n(t.map)),void 0!==t.matcap&&(i.matcap=n(t.matcap)),void 0!==t.alphaMap&&(i.alphaMap=n(t.alphaMap)),void 0!==t.bumpMap&&(i.bumpMap=n(t.bumpMap)),void 0!==t.bumpScale&&(i.bumpScale=t.bumpScale),void 0!==t.normalMap&&(i.normalMap=n(t.normalMap)),void 0!==t.normalMapType&&(i.normalMapType=t.normalMapType),void 0!==t.normalScale){let e=t.normalScale;!1===Array.isArray(e)&&(e=[e,e]),i.normalScale=(new zn).fromArray(e)}return void 0!==t.displacementMap&&(i.displacementMap=n(t.displacementMap)),void 0!==t.displacementScale&&(i.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(i.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(i.roughnessMap=n(t.roughnessMap)),void 0!==t.metalnessMap&&(i.metalnessMap=n(t.metalnessMap)),void 0!==t.emissiveMap&&(i.emissiveMap=n(t.emissiveMap)),void 0!==t.emissiveIntensity&&(i.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(i.specularMap=n(t.specularMap)),void 0!==t.envMap&&(i.envMap=n(t.envMap)),void 0!==t.envMapIntensity&&(i.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(i.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(i.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(i.lightMap=n(t.lightMap)),void 0!==t.lightMapIntensity&&(i.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(i.aoMap=n(t.aoMap)),void 0!==t.aoMapIntensity&&(i.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(i.gradientMap=n(t.gradientMap)),void 0!==t.clearcoatMap&&(i.clearcoatMap=n(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(i.clearcoatRoughnessMap=n(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(i.clearcoatNormalMap=n(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(i.clearcoatNormalScale=(new zn).fromArray(t.clearcoatNormalScale)),void 0!==t.transmission&&(i.transmission=t.transmission),void 0!==t.transmissionMap&&(i.transmissionMap=n(t.transmissionMap)),i},setTextures:function(t){return this.textures=t,this}});const uu={decodeText:function(t){if(\"undefined\"!=typeof TextDecoder)return(new TextDecoder).decode(t);let e=\"\";for(let n=0,i=t.length;n<i;n++)e+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(e))}catch(t){return e}},extractUrlBase:function(t){const e=t.lastIndexOf(\"/\");return-1===e?\"./\":t.substr(0,e+1)}};function hu(){Wr.call(this),this.type=\"InstancedBufferGeometry\",this.instanceCount=1/0}function pu(t,e,n,i){\"number\"==typeof n&&(i=n,n=!1,console.error(\"THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.\")),Er.call(this,t,e,n),this.meshPerAttribute=i||1}function fu(t){yd.call(this,t)}hu.prototype=Object.assign(Object.create(Wr.prototype),{constructor:hu,isInstancedBufferGeometry:!0,copy:function(t){return Wr.prototype.copy.call(this,t),this.instanceCount=t.instanceCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){const t=Wr.prototype.toJSON.call(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}),pu.prototype=Object.assign(Object.create(Er.prototype),{constructor:pu,isInstancedBufferAttribute:!0,copy:function(t){return Er.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){const t=Er.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}),fu.prototype=Object.assign(Object.create(yd.prototype),{constructor:fu,load:function(t,e,n,i){const r=this,o=new _d(r.manager);o.setPath(r.path),o.setRequestHeader(r.requestHeader),o.setWithCredentials(r.withCredentials),o.load(t,(function(n){try{e(r.parse(JSON.parse(n)))}catch(e){i?i(e):console.error(e),r.manager.itemError(t)}}),n,i)},parse:function(t){const e={},n={};function i(t,i){if(void 0!==e[i])return e[i];const r=t.interleavedBuffers[i],o=function(t,e){if(void 0!==n[e])return n[e];const i=t.arrayBuffers[e],r=new Uint32Array(i).buffer;return n[e]=r,r}(t,r.buffer),a=new js(jr(r.type,o),r.stride);return a.uuid=r.uuid,e[i]=a,a}const r=t.isInstancedBufferGeometry?new hu:new Wr,o=t.data.index;if(void 0!==o){const t=jr(o.type,o.array);r.setIndex(new Er(t,1))}const a=t.data.attributes;for(const e in a){const n=a[e];let o;if(n.isInterleavedBufferAttribute){o=new zs(i(t.data,n.data),n.itemSize,n.offset,n.normalized)}else{const t=jr(n.type,n.array);o=new(n.isInstancedBufferAttribute?pu:Er)(t,n.itemSize,n.normalized)}void 0!==n.name&&(o.name=n.name),r.setAttribute(e,o)}const s=t.data.morphAttributes;if(s)for(const e in s){const n=s[e],o=[];for(let e=0,r=n.length;e<r;e++){const r=n[e];let a;if(r.isInterleavedBufferAttribute){a=new zs(i(t.data,r.data),r.itemSize,r.offset,r.normalized)}else{a=new Er(jr(r.type,r.array),r.itemSize,r.normalized)}void 0!==r.name&&(a.name=r.name),o.push(a)}r.morphAttributes[e]=o}t.data.morphTargetsRelative&&(r.morphTargetsRelative=!0);const c=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==c)for(let t=0,e=c.length;t!==e;++t){const e=c[t];r.addGroup(e.start,e.count,e.materialIndex)}const l=t.data.boundingSphere;if(void 0!==l){const t=new Zn;void 0!==l.center&&t.fromArray(l.center),r.boundingSphere=new gi(t,l.radius)}return t.name&&(r.name=t.name),t.userData&&(r.userData=t.userData),r}});class mu extends yd{constructor(t){super(t)}load(t,e,n,i){const r=this,o=\"\"===this.path?uu.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||o;const a=new _d(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(t,(function(n){let o=null;try{o=JSON.parse(n)}catch(e){return void 0!==i&&i(e),void console.error(\"THREE:ObjectLoader: Can't parse \"+t+\".\",e.message)}const a=o.metadata;void 0!==a&&void 0!==a.type&&\"geometry\"!==a.type.toLowerCase()?r.parse(o,e):console.error(\"THREE.ObjectLoader: Can't load \"+t)}),n,i)}parse(t,e){const n=this.parseAnimations(t.animations),i=this.parseShapes(t.shapes),r=this.parseGeometries(t.geometries,i),o=this.parseImages(t.images,(function(){void 0!==e&&e(c)})),a=this.parseTextures(t.textures,o),s=this.parseMaterials(t.materials,a),c=this.parseObject(t.object,r,s,n),l=this.parseSkeletons(t.skeletons,c);if(this.bindSkeletons(c,l),void 0!==e){let t=!1;for(const e in o)if(o[e]instanceof HTMLImageElement){t=!0;break}!1===t&&e(c)}return c}parseShapes(t){const e={};if(void 0!==t)for(let n=0,i=t.length;n<i;n++){const i=(new Yd).fromJSON(t[n]);e[i.uuid]=i}return e}parseSkeletons(t,e){const n={},i={};if(e.traverse((function(t){t.isBone&&(i[t.uuid]=t)})),void 0!==t)for(let e=0,r=t.length;e<r;e++){const r=(new mc).fromJSON(t[e],i);n[r.uuid]=r}return n}parseGeometries(t,e){const n={};let i;if(void 0!==t){const r=new fu;for(let o=0,a=t.length;o<a;o++){let a;const s=t[o];switch(s.type){case\"PlaneGeometry\":case\"PlaneBufferGeometry\":a=new Hl[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case\"BoxGeometry\":case\"BoxBufferGeometry\":a=new Hl[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case\"CircleGeometry\":case\"CircleBufferGeometry\":a=new Hl[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case\"CylinderGeometry\":case\"CylinderBufferGeometry\":a=new Hl[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case\"ConeGeometry\":case\"ConeBufferGeometry\":a=new Hl[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case\"SphereGeometry\":case\"SphereBufferGeometry\":a=new Hl[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case\"DodecahedronGeometry\":case\"DodecahedronBufferGeometry\":case\"IcosahedronGeometry\":case\"IcosahedronBufferGeometry\":case\"OctahedronGeometry\":case\"OctahedronBufferGeometry\":case\"TetrahedronGeometry\":case\"TetrahedronBufferGeometry\":a=new Hl[s.type](s.radius,s.detail);break;case\"RingGeometry\":case\"RingBufferGeometry\":a=new Hl[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case\"TorusGeometry\":case\"TorusBufferGeometry\":a=new Hl[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case\"TorusKnotGeometry\":case\"TorusKnotBufferGeometry\":a=new Hl[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case\"TubeGeometry\":case\"TubeBufferGeometry\":a=new Hl[s.type]((new Wd[s.path.type]).fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case\"LatheGeometry\":case\"LatheBufferGeometry\":a=new Hl[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case\"PolyhedronGeometry\":case\"PolyhedronBufferGeometry\":a=new Hl[s.type](s.vertices,s.indices,s.radius,s.details);break;case\"ShapeGeometry\":case\"ShapeBufferGeometry\":i=[];for(let t=0,n=s.shapes.length;t<n;t++){const n=e[s.shapes[t]];i.push(n)}a=new Hl[s.type](i,s.curveSegments);break;case\"ExtrudeGeometry\":case\"ExtrudeBufferGeometry\":i=[];for(let t=0,n=s.shapes.length;t<n;t++){const n=e[s.shapes[t]];i.push(n)}const t=s.options.extrudePath;void 0!==t&&(s.options.extrudePath=(new Wd[t.type]).fromJSON(t)),a=new Hl[s.type](i,s.options);break;case\"BufferGeometry\":case\"InstancedBufferGeometry\":a=r.parse(s);break;case\"Geometry\":console.error('THREE.ObjectLoader: Loading \"Geometry\" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type \"'+s.type+'\"');continue}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),!0===a.isBufferGeometry&&void 0!==s.userData&&(a.userData=s.userData),n[s.uuid]=a}}return n}parseMaterials(t,e){const n={},i={};if(void 0!==t){const r=new du;r.setTextures(e);for(let e=0,o=t.length;e<o;e++){const o=t[e];if(\"MultiMaterial\"===o.type){const t=[];for(let e=0;e<o.materials.length;e++){const i=o.materials[e];void 0===n[i.uuid]&&(n[i.uuid]=r.parse(i)),t.push(n[i.uuid])}i[o.uuid]=t}else void 0===n[o.uuid]&&(n[o.uuid]=r.parse(o)),i[o.uuid]=n[o.uuid]}}return i}parseAnimations(t){const e={};if(void 0!==t)for(let n=0;n<t.length;n++){const i=t[n],r=pd.parse(i);e[r.uuid]=r}return e}parseImages(t,e){const n=this,i={};let r;function o(t){if(\"string\"==typeof t){const e=t;return function(t){return n.manager.itemStart(t),r.load(t,(function(){n.manager.itemEnd(t)}),void 0,(function(){n.manager.itemError(t),n.manager.itemEnd(t)}))}(/^(\\/\\/)|([a-z]+:(\\/\\/)?)/i.test(e)?e:n.resourcePath+e)}return t.data?{data:jr(t.type,t.data),width:t.width,height:t.height}:null}if(void 0!==t&&t.length>0){const n=new gd(e);r=new Sd(n),r.setCrossOrigin(this.crossOrigin);for(let e=0,n=t.length;e<n;e++){const n=t[e],r=n.url;if(Array.isArray(r)){i[n.uuid]=[];for(let t=0,e=r.length;t<e;t++){const e=o(r[t]);null!==e&&(e instanceof HTMLImageElement?i[n.uuid].push(e):i[n.uuid].push(new So(e.data,e.width,e.height)))}}else{const t=o(n.url);null!==t&&(i[n.uuid]=t)}}}return i}parseTextures(t,e){function n(t,e){return\"number\"==typeof t?t:(console.warn(\"THREE.ObjectLoader.parseTexture: Constant should be in numeric form.\",t),e[t])}const i={};if(void 0!==t)for(let r=0,o=t.length;r<o;r++){const o=t[r];let a;void 0===o.image&&console.warn('THREE.ObjectLoader: No \"image\" specified for',o.uuid),void 0===e[o.image]&&console.warn(\"THREE.ObjectLoader: Undefined image\",o.image);const s=e[o.image];Array.isArray(s)?(a=new xo(s),6===s.length&&(a.needsUpdate=!0)):(a=s&&s.data?new So(s.data,s.width,s.height):new Vn(s),s&&(a.needsUpdate=!0)),a.uuid=o.uuid,void 0!==o.name&&(a.name=o.name),void 0!==o.mapping&&(a.mapping=n(o.mapping,gu)),void 0!==o.offset&&a.offset.fromArray(o.offset),void 0!==o.repeat&&a.repeat.fromArray(o.repeat),void 0!==o.center&&a.center.fromArray(o.center),void 0!==o.rotation&&(a.rotation=o.rotation),void 0!==o.wrap&&(a.wrapS=n(o.wrap[0],vu),a.wrapT=n(o.wrap[1],vu)),void 0!==o.format&&(a.format=o.format),void 0!==o.type&&(a.type=o.type),void 0!==o.encoding&&(a.encoding=o.encoding),void 0!==o.minFilter&&(a.minFilter=n(o.minFilter,yu)),void 0!==o.magFilter&&(a.magFilter=n(o.magFilter,yu)),void 0!==o.anisotropy&&(a.anisotropy=o.anisotropy),void 0!==o.flipY&&(a.flipY=o.flipY),void 0!==o.premultiplyAlpha&&(a.premultiplyAlpha=o.premultiplyAlpha),void 0!==o.unpackAlignment&&(a.unpackAlignment=o.unpackAlignment),i[o.uuid]=a}return i}parseObject(t,e,n,i){let r,o,a;function s(t){return void 0===e[t]&&console.warn(\"THREE.ObjectLoader: Undefined geometry\",t),e[t]}function c(t){if(void 0!==t){if(Array.isArray(t)){const e=[];for(let i=0,r=t.length;i<r;i++){const r=t[i];void 0===n[r]&&console.warn(\"THREE.ObjectLoader: Undefined material\",r),e.push(n[r])}return e}return void 0===n[t]&&console.warn(\"THREE.ObjectLoader: Undefined material\",t),n[t]}}switch(t.type){case\"Scene\":r=new Fs,void 0!==t.background&&Number.isInteger(t.background)&&(r.background=new yr(t.background)),void 0!==t.fog&&(\"Fog\"===t.fog.type?r.fog=new Ns(t.fog.color,t.fog.near,t.fog.far):\"FogExp2\"===t.fog.type&&(r.fog=new Ds(t.fog.color,t.fog.density)));break;case\"PerspectiveCamera\":r=new bo(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(r.focus=t.focus),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.filmGauge&&(r.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(r.filmOffset=t.filmOffset),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case\"OrthographicCamera\":r=new iu(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case\"AmbientLight\":r=new au(t.color,t.intensity);break;case\"DirectionalLight\":r=new ou(t.color,t.intensity);break;case\"PointLight\":r=new nu(t.color,t.intensity,t.distance,t.decay);break;case\"RectAreaLight\":r=new su(t.color,t.intensity,t.width,t.height);break;case\"SpotLight\":r=new tu(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case\"HemisphereLight\":r=new Zd(t.color,t.groundColor,t.intensity);break;case\"LightProbe\":r=(new lu).fromJSON(t);break;case\"SkinnedMesh\":o=s(t.geometry),a=c(t.material),r=new uc(o,a),void 0!==t.bindMode&&(r.bindMode=t.bindMode),void 0!==t.bindMatrix&&r.bindMatrix.fromArray(t.bindMatrix),void 0!==t.skeleton&&(r.skeleton=t.skeleton);break;case\"Mesh\":o=s(t.geometry),a=c(t.material),r=new uo(o,a);break;case\"InstancedMesh\":o=s(t.geometry),a=c(t.material);const e=t.count,n=t.instanceMatrix;r=new _c(o,a,e),r.instanceMatrix=new Er(new Float32Array(n.array),16);break;case\"LOD\":r=new oc;break;case\"Line\":r=new Cc(s(t.geometry),c(t.material));break;case\"LineLoop\":r=new Lc(s(t.geometry),c(t.material));break;case\"LineSegments\":r=new kc(s(t.geometry),c(t.material));break;case\"PointCloud\":case\"Points\":r=new Fc(s(t.geometry),c(t.material));break;case\"Sprite\":r=new ec(c(t.material));break;case\"Group\":r=new Os;break;case\"Bone\":r=new hc;break;default:r=new Ki}if(r.uuid=t.uuid,void 0!==t.name&&(r.name=t.name),void 0!==t.matrix?(r.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(r.matrixAutoUpdate=t.matrixAutoUpdate),r.matrixAutoUpdate&&r.matrix.decompose(r.position,r.quaternion,r.scale)):(void 0!==t.position&&r.position.fromArray(t.position),void 0!==t.rotation&&r.rotation.fromArray(t.rotation),void 0!==t.quaternion&&r.quaternion.fromArray(t.quaternion),void 0!==t.scale&&r.scale.fromArray(t.scale)),void 0!==t.castShadow&&(r.castShadow=t.castShadow),void 0!==t.receiveShadow&&(r.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(r.shadow.bias=t.shadow.bias),void 0!==t.shadow.normalBias&&(r.shadow.normalBias=t.shadow.normalBias),void 0!==t.shadow.radius&&(r.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&r.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(r.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.frustumCulled&&(r.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(r.renderOrder=t.renderOrder),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.layers&&(r.layers.mask=t.layers),void 0!==t.children){const o=t.children;for(let t=0;t<o.length;t++)r.add(this.parseObject(o[t],e,n,i))}if(void 0!==t.animations){const e=t.animations;for(let t=0;t<e.length;t++){const n=e[t];r.animations.push(i[n])}}if(\"LOD\"===t.type){void 0!==t.autoUpdate&&(r.autoUpdate=t.autoUpdate);const e=t.levels;for(let t=0;t<e.length;t++){const n=e[t],i=r.getObjectByProperty(\"uuid\",n.object);void 0!==i&&r.addLevel(i,n.distance)}}return r}bindSkeletons(t,e){0!==Object.keys(e).length&&t.traverse((function(t){if(!0===t.isSkinnedMesh&&void 0!==t.skeleton){const n=e[t.skeleton];void 0===n?console.warn(\"THREE.ObjectLoader: No skeleton found with UUID:\",t.skeleton):t.bind(n,t.bindMatrix)}}))}setTexturePath(t){return console.warn(\"THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath().\"),this.setResourcePath(t)}}const gu={UVMapping:rt,CubeReflectionMapping:ot,CubeRefractionMapping:at,EquirectangularReflectionMapping:st,EquirectangularRefractionMapping:ct,CubeUVReflectionMapping:lt,CubeUVRefractionMapping:dt},vu={RepeatWrapping:ut,ClampToEdgeWrapping:ht,MirroredRepeatWrapping:pt},yu={NearestFilter:ft,NearestMipmapNearestFilter:mt,NearestMipmapLinearFilter:vt,LinearFilter:bt,LinearMipmapNearestFilter:_t,LinearMipmapLinearFilter:wt};function bu(t){\"undefined\"==typeof createImageBitmap&&console.warn(\"THREE.ImageBitmapLoader: createImageBitmap() not supported.\"),\"undefined\"==typeof fetch&&console.warn(\"THREE.ImageBitmapLoader: fetch() not supported.\"),yd.call(this,t),this.options={premultiplyAlpha:\"none\"}}function _u(){this.type=\"ShapePath\",this.color=new yr,this.subPaths=[],this.currentPath=null}bu.prototype=Object.assign(Object.create(yd.prototype),{constructor:bu,isImageBitmapLoader:!0,setOptions:function(t){return this.options=t,this},load:function(t,e,n,i){void 0===t&&(t=\"\"),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=this,o=md.get(t);if(void 0!==o)return r.manager.itemStart(t),setTimeout((function(){e&&e(o),r.manager.itemEnd(t)}),0),o;const a={};a.credentials=\"anonymous\"===this.crossOrigin?\"same-origin\":\"include\",fetch(t,a).then((function(t){return t.blob()})).then((function(t){return createImageBitmap(t,r.options)})).then((function(n){md.add(t,n),e&&e(n),r.manager.itemEnd(t)})).catch((function(e){i&&i(e),r.manager.itemError(t),r.manager.itemEnd(t)})),r.manager.itemStart(t)}}),Object.assign(_u.prototype,{moveTo:function(t,e){return this.currentPath=new Xd,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this},lineTo:function(t,e){return this.currentPath.lineTo(t,e),this},quadraticCurveTo:function(t,e,n,i){return this.currentPath.quadraticCurveTo(t,e,n,i),this},bezierCurveTo:function(t,e,n,i,r,o){return this.currentPath.bezierCurveTo(t,e,n,i,r,o),this},splineThru:function(t){return this.currentPath.splineThru(t),this},toShapes:function(t,e){function n(t){const e=[];for(let n=0,i=t.length;n<i;n++){const i=t[n],r=new Yd;r.curves=i.curves,e.push(r)}return e}function i(t,e){const n=e.length;let i=!1;for(let r=n-1,o=0;o<n;r=o++){let n=e[r],a=e[o],s=a.x-n.x,c=a.y-n.y;if(Math.abs(c)>Number.EPSILON){if(c<0&&(n=e[o],s=-s,a=e[r],c=-c),t.y<n.y||t.y>a.y)continue;if(t.y===n.y){if(t.x===n.x)return!0}else{const e=c*(t.x-n.x)-s*(t.y-n.y);if(0===e)return!0;if(e<0)continue;i=!i}}else{if(t.y!==n.y)continue;if(a.x<=t.x&&t.x<=n.x||n.x<=t.x&&t.x<=a.x)return!0}}return i}const r=Ml.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===e)return n(o);let a,s,c;const l=[];if(1===o.length)return s=o[0],c=new Yd,c.curves=s.curves,l.push(c),l;let d=!r(o[0].getPoints());d=t?!d:d;const u=[],h=[];let p,f,m=[],g=0;h[g]=void 0,m[g]=[];for(let e=0,n=o.length;e<n;e++)s=o[e],p=s.getPoints(),a=r(p),a=t?!a:a,a?(!d&&h[g]&&g++,h[g]={s:new Yd,p:p},h[g].s.curves=s.curves,d&&g++,m[g]=[]):m[g].push({h:s,p:p[0]});if(!h[0])return n(o);if(h.length>1){let t=!1;const e=[];for(let t=0,e=h.length;t<e;t++)u[t]=[];for(let n=0,r=h.length;n<r;n++){const r=m[n];for(let o=0;o<r.length;o++){const a=r[o];let s=!0;for(let r=0;r<h.length;r++)i(a.p,h[r].p)&&(n!==r&&e.push({froms:n,tos:r,hole:o}),s?(s=!1,u[r].push(a)):t=!0);s&&u[n].push(a)}}e.length>0&&(t||(m=u))}for(let t=0,e=h.length;t<e;t++){c=h[t].s,l.push(c),f=m[t];for(let t=0,e=f.length;t<e;t++)c.holes.push(f[t].h)}return l}});class xu{constructor(t){Object.defineProperty(this,\"isFont\",{value:!0}),this.type=\"Font\",this.data=t}generateShapes(t,e=100){const n=[],i=function(t,e,n){const i=Array.from?Array.from(t):String(t).split(\"\"),r=e/n.resolution,o=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*r,a=[];let s=0,c=0;for(let t=0;t<i.length;t++){const e=i[t];if(\"\\n\"===e)s=0,c-=o;else{const t=wu(e,r,s,c,n);s+=t.offsetX,a.push(t.path)}}return a}(t,e,this.data);for(let t=0,e=i.length;t<e;t++)Array.prototype.push.apply(n,i[t].toShapes());return n}}function wu(t,e,n,i,r){const o=r.glyphs[t]||r.glyphs[\"?\"];if(!o)return void console.error('THREE.Font: character \"'+t+'\" does not exists in font family '+r.familyName+\".\");const a=new _u;let s,c,l,d,u,h,p,f;if(o.o){const t=o._cachedOutline||(o._cachedOutline=o.o.split(\" \"));for(let r=0,o=t.length;r<o;){switch(t[r++]){case\"m\":s=t[r++]*e+n,c=t[r++]*e+i,a.moveTo(s,c);break;case\"l\":s=t[r++]*e+n,c=t[r++]*e+i,a.lineTo(s,c);break;case\"q\":l=t[r++]*e+n,d=t[r++]*e+i,u=t[r++]*e+n,h=t[r++]*e+i,a.quadraticCurveTo(u,h,l,d);break;case\"b\":l=t[r++]*e+n,d=t[r++]*e+i,u=t[r++]*e+n,h=t[r++]*e+i,p=t[r++]*e+n,f=t[r++]*e+i,a.bezierCurveTo(u,h,p,f,l,d)}}}return{offsetX:o.ha*e,path:a}}function Su(t){yd.call(this,t)}let Mu;Su.prototype=Object.assign(Object.create(yd.prototype),{constructor:Su,load:function(t,e,n,i){const r=this,o=new _d(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(r.withCredentials),o.load(t,(function(t){let n;try{n=JSON.parse(t)}catch(e){console.warn(\"THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead.\"),n=JSON.parse(t.substring(65,t.length-2))}const i=r.parse(n);e&&e(i)}),n,i)},parse:function(t){return new xu(t)}});const Eu={getContext:function(){return void 0===Mu&&(Mu=new(window.AudioContext||window.webkitAudioContext)),Mu},setContext:function(t){Mu=t}};function Tu(t){yd.call(this,t)}function Cu(t,e,n){lu.call(this,void 0,n);const i=(new yr).set(t),r=(new yr).set(e),o=new Zn(i.r,i.g,i.b),a=new Zn(r.r,r.g,r.b),s=Math.sqrt(Math.PI),c=s*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(s),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(c)}function Au(t,e){lu.call(this,void 0,e);const n=(new yr).set(t);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}Tu.prototype=Object.assign(Object.create(yd.prototype),{constructor:Tu,load:function(t,e,n,i){const r=this,o=new _d(r.manager);o.setResponseType(\"arraybuffer\"),o.setPath(r.path),o.setRequestHeader(r.requestHeader),o.setWithCredentials(r.withCredentials),o.load(t,(function(n){try{const t=n.slice(0);Eu.getContext().decodeAudioData(t,(function(t){e(t)}))}catch(e){i?i(e):console.error(e),r.manager.itemError(t)}}),n,i)}}),Cu.prototype=Object.assign(Object.create(lu.prototype),{constructor:Cu,isHemisphereLightProbe:!0,copy:function(t){return lu.prototype.copy.call(this,t),this},toJSON:function(t){return lu.prototype.toJSON.call(this,t)}}),Au.prototype=Object.assign(Object.create(lu.prototype),{constructor:Au,isAmbientLightProbe:!0,copy:function(t){return lu.prototype.copy.call(this,t),this},toJSON:function(t){return lu.prototype.toJSON.call(this,t)}});const Ou=new Ei,ku=new Ei;function Lu(){this.type=\"StereoCamera\",this.aspect=1,this.eyeSep=.064,this.cameraL=new bo,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new bo,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}Object.assign(Lu.prototype,{update:function(t){const e=this._cache;if(e.focus!==t.focus||e.fov!==t.fov||e.aspect!==t.aspect*this.aspect||e.near!==t.near||e.far!==t.far||e.zoom!==t.zoom||e.eyeSep!==this.eyeSep){e.focus=t.focus,e.fov=t.fov,e.aspect=t.aspect*this.aspect,e.near=t.near,e.far=t.far,e.zoom=t.zoom,e.eyeSep=this.eyeSep;const n=t.projectionMatrix.clone(),i=e.eyeSep/2,r=i*e.near/e.focus,o=e.near*Math.tan(Bn.DEG2RAD*e.fov*.5)/e.zoom;let a,s;ku.elements[12]=-i,Ou.elements[12]=i,a=-o*e.aspect+r,s=o*e.aspect+r,n.elements[0]=2*e.near/(s-a),n.elements[8]=(s+a)/(s-a),this.cameraL.projectionMatrix.copy(n),a=-o*e.aspect-r,s=o*e.aspect-r,n.elements[0]=2*e.near/(s-a),n.elements[8]=(s+a)/(s-a),this.cameraR.projectionMatrix.copy(n)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(ku),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(Ou)}});class Iu{constructor(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Ru(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const e=Ru();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}}function Ru(){return(\"undefined\"==typeof performance?Date:performance).now()}const Pu=new Zn,Du=new Kn,Nu=new Zn,Fu=new Zn;class ju extends Ki{constructor(){super(),this.type=\"AudioListener\",this.context=Eu.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Iu}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}updateMatrixWorld(t){super.updateMatrixWorld(t);const e=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Pu,Du,Nu),Fu.set(0,0,-1).applyQuaternion(Du),e.positionX){const t=this.context.currentTime+this.timeDelta;e.positionX.linearRampToValueAtTime(Pu.x,t),e.positionY.linearRampToValueAtTime(Pu.y,t),e.positionZ.linearRampToValueAtTime(Pu.z,t),e.forwardX.linearRampToValueAtTime(Fu.x,t),e.forwardY.linearRampToValueAtTime(Fu.y,t),e.forwardZ.linearRampToValueAtTime(Fu.z,t),e.upX.linearRampToValueAtTime(n.x,t),e.upY.linearRampToValueAtTime(n.y,t),e.upZ.linearRampToValueAtTime(n.z,t)}else e.setPosition(Pu.x,Pu.y,Pu.z),e.setOrientation(Fu.x,Fu.y,Fu.z,n.x,n.y,n.z)}}class Bu extends Ki{constructor(t){super(),this.type=\"Audio\",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType=\"empty\",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(t){return this.hasPlaybackControl=!1,this.sourceType=\"audioNode\",this.source=t,this.connect(),this}setMediaElementSource(t){return this.hasPlaybackControl=!1,this.sourceType=\"mediaNode\",this.source=this.context.createMediaElementSource(t),this.connect(),this}setMediaStreamSource(t){return this.hasPlaybackControl=!1,this.sourceType=\"mediaStreamNode\",this.source=this.context.createMediaStreamSource(t),this.connect(),this}setBuffer(t){return this.buffer=t,this.sourceType=\"buffer\",this.autoplay&&this.play(),this}play(t=0){if(!0===this.isPlaying)return void console.warn(\"THREE.Audio: Audio is already playing.\");if(!1===this.hasPlaybackControl)return void console.warn(\"THREE.Audio: this Audio has no playback control.\");this._startedAt=this.context.currentTime+t;const e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn(\"THREE.Audio: this Audio has no playback control.\")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn(\"THREE.Audio: this Audio has no playback control.\")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(t){return t||(t=[]),!0===this._connected?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this}setDetune(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(t){return this.setFilters(t?[t]:[])}setPlaybackRate(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn(\"THREE.Audio: this Audio has no playback control.\")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn(\"THREE.Audio: this Audio has no playback control.\"),!1):this.loop}setLoop(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn(\"THREE.Audio: this Audio has no playback control.\")}setLoopStart(t){return this.loopStart=t,this}setLoopEnd(t){return this.loopEnd=t,this}getVolume(){return this.gain.gain.value}setVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}const zu=new Zn,Uu=new Kn,Hu=new Zn,$u=new Zn;class Gu extends Bu{constructor(t){super(t),this.panner=this.context.createPanner(),this.panner.panningModel=\"HRTF\",this.panner.connect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(t){return this.panner.refDistance=t,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(t){return this.panner.rolloffFactor=t,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(t){return this.panner.distanceModel=t,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(t){return this.panner.maxDistance=t,this}setDirectionalCone(t,e,n){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=e,this.panner.coneOuterGain=n,this}updateMatrixWorld(t){if(super.updateMatrixWorld(t),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(zu,Uu,Hu),$u.set(0,0,1).applyQuaternion(Uu);const e=this.panner;if(e.positionX){const t=this.context.currentTime+this.listener.timeDelta;e.positionX.linearRampToValueAtTime(zu.x,t),e.positionY.linearRampToValueAtTime(zu.y,t),e.positionZ.linearRampToValueAtTime(zu.z,t),e.orientationX.linearRampToValueAtTime($u.x,t),e.orientationY.linearRampToValueAtTime($u.y,t),e.orientationZ.linearRampToValueAtTime($u.z,t)}else e.setPosition(zu.x,zu.y,zu.z),e.setOrientation($u.x,$u.y,$u.z)}}class Vu{constructor(t,e=2048){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=e,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let t=0;const e=this.getFrequencyData();for(let n=0;n<e.length;n++)t+=e[n];return t/e.length}}function Wu(t,e,n){let i,r,o;switch(this.binding=t,this.valueSize=n,e){case\"quaternion\":i=this._slerp,r=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case\"string\":case\"bool\":i=this._select,r=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:i=this._lerp,r=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=r,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}Object.assign(Wu.prototype,{accumulate:function(t,e){const n=this.buffer,i=this.valueSize,r=t*i+i;let o=this.cumulativeWeight;if(0===o){for(let t=0;t!==i;++t)n[r+t]=n[t];o=e}else{o+=e;const t=e/o;this._mixBufferRegion(n,r,0,t,i)}this.cumulativeWeight=o},accumulateAdditive:function(t){const e=this.buffer,n=this.valueSize,i=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(e,i,0,t,n),this.cumulativeWeightAdditive+=t},apply:function(t){const e=this.valueSize,n=this.buffer,i=t*e+e,r=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){const t=e*this._origIndex;this._mixBufferRegion(n,i,t,1-r,e)}o>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*e,1,e);for(let t=e,r=e+e;t!==r;++t)if(n[t]!==n[t+e]){a.setValue(n,i);break}},saveOriginalState:function(){const t=this.binding,e=this.buffer,n=this.valueSize,i=n*this._origIndex;t.getValue(e,i);for(let t=n,r=i;t!==r;++t)e[t]=e[i+t%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){const t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_setAdditiveIdentityNumeric:function(){const t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let n=t;n<e;n++)this.buffer[n]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1},_setAdditiveIdentityOther:function(){const t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[e+n]=this.buffer[t+n]},_select:function(t,e,n,i,r){if(i>=.5)for(let i=0;i!==r;++i)t[e+i]=t[n+i]},_slerp:function(t,e,n,i){Kn.slerpFlat(t,e,t,e,t,n,i)},_slerpAdditive:function(t,e,n,i,r){const o=this._workIndex*r;Kn.multiplyQuaternionsFlat(t,o,t,e,t,n),Kn.slerpFlat(t,e,t,e,t,o,i)},_lerp:function(t,e,n,i,r){const o=1-i;for(let a=0;a!==r;++a){const r=e+a;t[r]=t[r]*o+t[n+a]*i}},_lerpAdditive:function(t,e,n,i,r){for(let o=0;o!==r;++o){const r=e+o;t[r]=t[r]+t[n+o]*i}}});const qu=new RegExp(\"[\\\\[\\\\]\\\\.:\\\\/]\",\"g\"),Xu=\"[^\"+\"\\\\[\\\\]\\\\.:\\\\/\".replace(\"\\\\.\",\"\")+\"]\",Yu=/((?:WC+[\\/:])*)/.source.replace(\"WC\",\"[^\\\\[\\\\]\\\\.:\\\\/]\"),Ku=/(WCOD+)?/.source.replace(\"WCOD\",Xu),Zu=/(?:\\.(WC+)(?:\\[(.+)\\])?)?/.source.replace(\"WC\",\"[^\\\\[\\\\]\\\\.:\\\\/]\"),Ju=/\\.(WC+)(?:\\[(.+)\\])?/.source.replace(\"WC\",\"[^\\\\[\\\\]\\\\.:\\\\/]\"),Qu=new RegExp(\"^\"+Yu+Ku+Zu+Ju+\"$\"),th=[\"material\",\"materials\",\"bones\"];function eh(t,e,n){const i=n||nh.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,i)}function nh(t,e,n){this.path=e,this.parsedPath=n||nh.parseTrackName(e),this.node=nh.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function ih(){this.uuid=Bn.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const t={};this._indicesByUUID=t;for(let e=0,n=arguments.length;e!==n;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const e=this;this.stats={objects:{get total(){return e._objects.length},get inUse(){return this.total-e.nCachedObjects_}},get bindingsPerObject(){return e._bindings.length}}}Object.assign(eh.prototype,{getValue:function(t,e){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(t,e)},setValue:function(t,e){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(t,e)},bind:function(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}),Object.assign(nh,{Composite:eh,create:function(t,e,n){return t&&t.isAnimationObjectGroup?new nh.Composite(t,e,n):new nh(t,e,n)},sanitizeNodeName:function(t){return t.replace(/\\s/g,\"_\").replace(qu,\"\")},parseTrackName:function(t){const e=Qu.exec(t);if(!e)throw new Error(\"PropertyBinding: Cannot parse trackName: \"+t);const n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},i=n.nodeName&&n.nodeName.lastIndexOf(\".\");if(void 0!==i&&-1!==i){const t=n.nodeName.substring(i+1);-1!==th.indexOf(t)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=t)}if(null===n.propertyName||0===n.propertyName.length)throw new Error(\"PropertyBinding: can not parse propertyName from trackName: \"+t);return n},findNode:function(t,e){if(!e||\"\"===e||\".\"===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){const n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){const n=function(t){for(let i=0;i<t.length;i++){const r=t[i];if(r.name===e||r.uuid===e)return r;const o=n(r.children);if(o)return o}return null},i=n(t.children);if(i)return i}return null}}),Object.assign(nh.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)t[e++]=n[i]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++]},function(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){let t=this.node;const e=this.parsedPath,n=e.objectName,i=e.propertyName;let r=e.propertyIndex;if(t||(t=nh.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error(\"THREE.PropertyBinding: Trying to update node for track: \"+this.path+\" but it wasn't found.\");if(n){let i=e.objectIndex;switch(n){case\"materials\":if(!t.material)return void console.error(\"THREE.PropertyBinding: Can not bind to material as node does not have a material.\",this);if(!t.material.materials)return void console.error(\"THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.\",this);t=t.material.materials;break;case\"bones\":if(!t.skeleton)return void console.error(\"THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.\",this);t=t.skeleton.bones;for(let e=0;e<t.length;e++)if(t[e].name===i){i=e;break}break;default:if(void 0===t[n])return void console.error(\"THREE.PropertyBinding: Can not bind to objectName of node undefined.\",this);t=t[n]}if(void 0!==i){if(void 0===t[i])return void console.error(\"THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.\",this,t);t=t[i]}}const o=t[i];if(void 0===o){const n=e.nodeName;return void console.error(\"THREE.PropertyBinding: Trying to update property for track: \"+n+\".\"+i+\" but it wasn't found.\",t)}let a=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?a=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(a=this.Versioning.MatrixWorldNeedsUpdate);let s=this.BindingType.Direct;if(void 0!==r){if(\"morphTargetInfluences\"===i){if(!t.geometry)return void console.error(\"THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.\",this);if(!t.geometry.isBufferGeometry)return void console.error(\"THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.\",this);if(!t.geometry.morphAttributes)return void console.error(\"THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.\",this);void 0!==t.morphTargetDictionary[r]&&(r=t.morphTargetDictionary[r])}s=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=r}else void 0!==o.fromArray&&void 0!==o.toArray?(s=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(s=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=i;this.getValue=this.GetterByBindingType[s],this.setValue=this.SetterByBindingTypeAndVersioning[s][a]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(nh.prototype,{_getValue_unbound:nh.prototype.getValue,_setValue_unbound:nh.prototype.setValue}),Object.assign(ih.prototype,{isAnimationObjectGroup:!0,add:function(){const t=this._objects,e=this._indicesByUUID,n=this._paths,i=this._parsedPaths,r=this._bindings,o=r.length;let a=void 0,s=t.length,c=this.nCachedObjects_;for(let l=0,d=arguments.length;l!==d;++l){const d=arguments[l],u=d.uuid;let h=e[u];if(void 0===h){h=s++,e[u]=h,t.push(d);for(let t=0,e=o;t!==e;++t)r[t].push(new nh(d,n[t],i[t]))}else if(h<c){a=t[h];const s=--c,l=t[s];e[l.uuid]=h,t[h]=l,e[u]=s,t[s]=d;for(let t=0,e=o;t!==e;++t){const e=r[t],o=e[s];let a=e[h];e[h]=o,void 0===a&&(a=new nh(d,n[t],i[t])),e[s]=a}}else t[h]!==a&&console.error(\"THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.\")}this.nCachedObjects_=c},remove:function(){const t=this._objects,e=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const a=arguments[o],s=a.uuid,c=e[s];if(void 0!==c&&c>=r){const o=r++,l=t[o];e[l.uuid]=c,t[c]=l,e[s]=o,t[o]=a;for(let t=0,e=i;t!==e;++t){const e=n[t],i=e[o],r=e[c];e[c]=i,e[o]=r}}}this.nCachedObjects_=r},uncache:function(){const t=this._objects,e=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_,o=t.length;for(let a=0,s=arguments.length;a!==s;++a){const s=arguments[a].uuid,c=e[s];if(void 0!==c)if(delete e[s],c<r){const a=--r,s=t[a],l=--o,d=t[l];e[s.uuid]=c,t[c]=s,e[d.uuid]=a,t[a]=d,t.pop();for(let t=0,e=i;t!==e;++t){const e=n[t],i=e[a],r=e[l];e[c]=i,e[a]=r,e.pop()}}else{const r=--o,a=t[r];r>0&&(e[a.uuid]=c),t[c]=a,t.pop();for(let t=0,e=i;t!==e;++t){const e=n[t];e[c]=e[r],e.pop()}}}this.nCachedObjects_=r},subscribe_:function(t,e){const n=this._bindingsIndicesByPath;let i=n[t];const r=this._bindings;if(void 0!==i)return r[i];const o=this._paths,a=this._parsedPaths,s=this._objects,c=s.length,l=this.nCachedObjects_,d=new Array(c);i=r.length,n[t]=i,o.push(t),a.push(e),r.push(d);for(let n=l,i=s.length;n!==i;++n){const i=s[n];d[n]=new nh(i,t,e)}return d},unsubscribe_:function(t){const e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){const i=this._paths,r=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];e[t[a]]=n,o[n]=s,o.pop(),r[n]=r[a],r.pop(),i[n]=i[a],i.pop()}}});class rh{constructor(t,e,n=null,i=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=n,this.blendMode=i;const r=e.tracks,o=r.length,a=new Array(o),s={endingStart:He,endingEnd:He};for(let t=0;t!==o;++t){const e=r[t].createInterpolant(null);a[t]=e,e.settings=s}this._interpolantSettings=s,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Fe,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){const n=this._clip.duration,i=t._clip.duration,r=i/n,o=n/i;t.warp(1,r,e),this.warp(o,1,e)}return this}crossFadeTo(t,e,n){return t.crossFadeFrom(this,e,n)}stopFading(){const t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,n){const i=this._mixer,r=i.time,o=this.timeScale;let a=this._timeScaleInterpolant;null===a&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);const s=a.parameterPositions,c=a.sampleValues;return s[0]=r,s[1]=r+n,c[0]=t/o,c[1]=e/o,this}stopWarping(){const t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,n,i){if(!this.enabled)return void this._updateWeight(t);const r=this._startTime;if(null!==r){const i=(t-r)*n;if(i<0||0===n)return;this._startTime=null,e=n*i}e*=this._updateTimeScale(t);const o=this._updateTime(e),a=this._updateWeight(t);if(a>0){const t=this._interpolants,e=this._propertyBindings;switch(this.blendMode){case We:for(let n=0,i=t.length;n!==i;++n)t[n].evaluate(o),e[n].accumulateAdditive(a);break;case Ve:default:for(let n=0,r=t.length;n!==r;++n)t[n].evaluate(o),e[n].accumulate(i,a)}}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;const n=this._weightInterpolant;if(null!==n){const i=n.evaluate(t)[0];e*=i,t>n.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;const n=this._timeScaleInterpolant;if(null!==n){e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e,e}_updateTime(t){const e=this._clip.duration,n=this.loop;let i=this.time+t,r=this._loopCount;const o=n===je;if(0===t)return-1===r?i:o&&1==(1&r)?e-i:i;if(n===Ne){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(i>=e)i=e;else{if(!(i<0)){this.time=i;break t}i=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:\"finished\",action:this,direction:t<0?-1:1})}}else{if(-1===r&&(t>=0?(r=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),i>=e||i<0){const n=Math.floor(i/e);i-=e*n,r+=Math.abs(n);const a=this.repetitions-r;if(a<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=t>0?e:0,this.time=i,this._mixer.dispatchEvent({type:\"finished\",action:this,direction:t>0?1:-1});else{if(1===a){const e=t<0;this._setEndings(e,!e,o)}else this._setEndings(!1,!1,o);this._loopCount=r,this.time=i,this._mixer.dispatchEvent({type:\"loop\",action:this,loopDelta:n})}}else this.time=i;if(o&&1==(1&r))return e-i}return i}_setEndings(t,e,n){const i=this._interpolantSettings;n?(i.endingStart=$e,i.endingEnd=$e):(i.endingStart=t?this.zeroSlopeAtStart?$e:He:Ge,i.endingEnd=e?this.zeroSlopeAtEnd?$e:He:Ge)}_scheduleFading(t,e,n){const i=this._mixer,r=i.time;let o=this._weightInterpolant;null===o&&(o=i._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,s=o.sampleValues;return a[0]=r,s[0]=e,a[1]=r+t,s[1]=n,this}}function oh(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}oh.prototype=Object.assign(Object.create(Nn.prototype),{constructor:oh,_bindAction:function(t,e){const n=t._localRoot||this._root,i=t._clip.tracks,r=i.length,o=t._propertyBindings,a=t._interpolants,s=n.uuid,c=this._bindingsByRootAndName;let l=c[s];void 0===l&&(l={},c[s]=l);for(let t=0;t!==r;++t){const r=i[t],c=r.name;let d=l[c];if(void 0!==d)o[t]=d;else{if(d=o[t],void 0!==d){null===d._cacheIndex&&(++d.referenceCount,this._addInactiveBinding(d,s,c));continue}const i=e&&e._propertyBindings[t].binding.parsedPath;d=new Wu(nh.create(n,c,i),r.ValueTypeName,r.getValueSize()),++d.referenceCount,this._addInactiveBinding(d,s,c),o[t]=d}a[t].resultBuffer=d.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){const e=(t._localRoot||this._root).uuid,n=t._clip.uuid,i=this._actionsByClip[n];this._bindAction(t,i&&i.knownActions[0]),this._addInactiveAction(t,n,e)}const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){const e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,n){const i=this._actions,r=this._actionsByClip;let o=r[e];if(void 0===o)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,r[e]=o;else{const e=o.knownActions;t._byClipCacheIndex=e.length,e.push(t)}t._cacheIndex=i.length,i.push(t),o.actionByRoot[n]=t},_removeInactiveAction:function(t){const e=this._actions,n=e[e.length-1],i=t._cacheIndex;n._cacheIndex=i,e[i]=n,e.pop(),t._cacheIndex=null;const r=t._clip.uuid,o=this._actionsByClip,a=o[r],s=a.knownActions,c=s[s.length-1],l=t._byClipCacheIndex;c._byClipCacheIndex=l,s[l]=c,s.pop(),t._byClipCacheIndex=null;delete a.actionByRoot[(t._localRoot||this._root).uuid],0===s.length&&delete o[r],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==--n.referenceCount&&this._removeInactiveBinding(n)}},_lendAction:function(t){const e=this._actions,n=t._cacheIndex,i=this._nActiveActions++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_takeBackAction:function(t){const e=this._actions,n=t._cacheIndex,i=--this._nActiveActions,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_addInactiveBinding:function(t,e,n){const i=this._bindingsByRootAndName,r=this._bindings;let o=i[e];void 0===o&&(o={},i[e]=o),o[n]=t,t._cacheIndex=r.length,r.push(t)},_removeInactiveBinding:function(t){const e=this._bindings,n=t.binding,i=n.rootNode.uuid,r=n.path,o=this._bindingsByRootAndName,a=o[i],s=e[e.length-1],c=t._cacheIndex;s._cacheIndex=c,e[c]=s,e.pop(),delete a[r],0===Object.keys(a).length&&delete o[i]},_lendBinding:function(t){const e=this._bindings,n=t._cacheIndex,i=this._nActiveBindings++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_takeBackBinding:function(t){const e=this._bindings,n=t._cacheIndex,i=--this._nActiveBindings,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_lendControlInterpolant:function(){const t=this._controlInterpolants,e=this._nActiveControlInterpolants++;let n=t[e];return void 0===n&&(n=new id(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=e,t[e]=n),n},_takeBackControlInterpolant:function(t){const e=this._controlInterpolants,n=t.__cacheIndex,i=--this._nActiveControlInterpolants,r=e[i];t.__cacheIndex=i,e[i]=t,r.__cacheIndex=n,e[n]=r},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e,n){const i=e||this._root,r=i.uuid;let o=\"string\"==typeof t?pd.findByName(i,t):t;const a=null!==o?o.uuid:t,s=this._actionsByClip[a];let c=null;if(void 0===n&&(n=null!==o?o.blendMode:Ve),void 0!==s){const t=s.actionByRoot[r];if(void 0!==t&&t.blendMode===n)return t;c=s.knownActions[0],null===o&&(o=c._clip)}if(null===o)return null;const l=new rh(this,o,e,n);return this._bindAction(l,c),this._addInactiveAction(l,a,r),l},existingAction:function(t,e){const n=e||this._root,i=n.uuid,r=\"string\"==typeof t?pd.findByName(n,t):t,o=r?r.uuid:t,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[i]||null},stopAllAction:function(){const t=this._actions;for(let e=this._nActiveActions-1;e>=0;--e)t[e].stop();return this},update:function(t){t*=this.timeScale;const e=this._actions,n=this._nActiveActions,i=this.time+=t,r=Math.sign(t),o=this._accuIndex^=1;for(let a=0;a!==n;++a){e[a]._update(i,t,r,o)}const a=this._bindings,s=this._nActiveBindings;for(let t=0;t!==s;++t)a[t].apply(o);return this},setTime:function(t){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){const e=this._actions,n=t.uuid,i=this._actionsByClip,r=i[n];if(void 0!==r){const t=r.knownActions;for(let n=0,i=t.length;n!==i;++n){const i=t[n];this._deactivateAction(i);const r=i._cacheIndex,o=e[e.length-1];i._cacheIndex=null,i._byClipCacheIndex=null,o._cacheIndex=r,e[r]=o,e.pop(),this._removeInactiveBindingsForAction(i)}delete i[n]}},uncacheRoot:function(t){const e=t.uuid,n=this._actionsByClip;for(const t in n){const i=n[t].actionByRoot[e];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}const i=this._bindingsByRootAndName[e];if(void 0!==i)for(const t in i){const e=i[t];e.restoreOriginalState(),this._removeInactiveBinding(e)}},uncacheAction:function(t,e){const n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}});class ah{constructor(t){\"string\"==typeof t&&(console.warn(\"THREE.Uniform: Type parameter is no longer needed.\"),t=arguments[1]),this.value=t}clone(){return new ah(void 0===this.value.clone?this.value:this.value.clone())}}function sh(t,e,n){js.call(this,t,e),this.meshPerAttribute=n||1}function ch(t,e,n,i,r){this.buffer=t,this.type=e,this.itemSize=n,this.elementSize=i,this.count=r,this.version=0}function lh(t,e,n,i){this.ray=new Mi(t,e),this.near=n||0,this.far=i||1/0,this.camera=null,this.layers=new Ni,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn(\"THREE.Raycaster: params.PointCloud has been renamed to params.Points.\"),this.Points}}})}function dh(t,e){return t.distance-e.distance}function uh(t,e,n,i){if(t.layers.test(e.layers)&&t.raycast(e,n),!0===i){const i=t.children;for(let t=0,r=i.length;t<r;t++)uh(i[t],e,n,!0)}}sh.prototype=Object.assign(Object.create(js.prototype),{constructor:sh,isInstancedInterleavedBuffer:!0,copy:function(t){return js.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},clone:function(t){const e=js.prototype.clone.call(this,t);return e.meshPerAttribute=this.meshPerAttribute,e},toJSON:function(t){const e=js.prototype.toJSON.call(this,t);return e.isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}}),Object.defineProperty(ch.prototype,\"needsUpdate\",{set:function(t){!0===t&&this.version++}}),Object.assign(ch.prototype,{isGLBufferAttribute:!0,setBuffer:function(t){return this.buffer=t,this},setType:function(t,e){return this.type=t,this.elementSize=e,this},setItemSize:function(t){return this.itemSize=t,this},setCount:function(t){return this.count=t,this}}),Object.assign(lh.prototype,{set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error(\"THREE.Raycaster: Unsupported camera type: \"+e.type)},intersectObject:function(t,e,n){const i=n||[];return uh(t,this,i,e),i.sort(dh),i},intersectObjects:function(t,e,n){const i=n||[];if(!1===Array.isArray(t))return console.warn(\"THREE.Raycaster.intersectObjects: objects is not an Array.\"),i;for(let n=0,r=t.length;n<r;n++)uh(t[n],this,i,e);return i.sort(dh),i}});class hh{constructor(t=1,e=0,n=0){return this.radius=t,this.phi=e,this.theta=n,this}set(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this}clone(){return(new this.constructor).copy(this)}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(Bn.clamp(e/this.radius,-1,1))),this}}class ph{constructor(t,e,n){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==n?n:0,this}set(t,e,n){return this.radius=t,this.theta=e,this.y=n,this}clone(){return(new this.constructor).copy(this)}copy(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,n){return this.radius=Math.sqrt(t*t+n*n),this.theta=Math.atan2(t,n),this.y=e,this}}const fh=new zn;class mh{constructor(t,e){Object.defineProperty(this,\"isBox2\",{value:!0}),this.min=void 0!==t?t:new zn(1/0,1/0),this.max=void 0!==e?e:new zn(-1/0,-1/0)}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=fh.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return void 0===t&&(console.warn(\"THREE.Box2: .getCenter() target is now required\"),t=new zn),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return void 0===t&&(console.warn(\"THREE.Box2: .getSize() target is now required\"),t=new zn),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return void 0===e&&(console.warn(\"THREE.Box2: .getParameter() target is now required\"),e=new zn),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,e){return void 0===e&&(console.warn(\"THREE.Box2: .clampPoint() target is now required\"),e=new zn),e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return fh.copy(t).clamp(this.min,this.max).sub(t).length()}intersect(t){return this.min.max(t.min),this.max.min(t.max),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const gh=new Zn,vh=new Zn;class yh{constructor(t,e){this.start=void 0!==t?t:new Zn,this.end=void 0!==e?e:new Zn}set(t,e){return this.start.copy(t),this.end.copy(e),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.start.copy(t.start),this.end.copy(t.end),this}getCenter(t){return void 0===t&&(console.warn(\"THREE.Line3: .getCenter() target is now required\"),t=new Zn),t.addVectors(this.start,this.end).multiplyScalar(.5)}delta(t){return void 0===t&&(console.warn(\"THREE.Line3: .delta() target is now required\"),t=new Zn),t.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(t,e){return void 0===e&&(console.warn(\"THREE.Line3: .at() target is now required\"),e=new Zn),this.delta(e).multiplyScalar(t).add(this.start)}closestPointToPointParameter(t,e){gh.subVectors(t,this.start),vh.subVectors(this.end,this.start);const n=vh.dot(vh);let i=vh.dot(gh)/n;return e&&(i=Bn.clamp(i,0,1)),i}closestPointToPoint(t,e,n){const i=this.closestPointToPointParameter(t,e);return void 0===n&&(console.warn(\"THREE.Line3: .closestPointToPoint() target is now required\"),n=new Zn),this.delta(n).multiplyScalar(i).add(this.start)}applyMatrix4(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this}equals(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}function bh(t){Ki.call(this),this.material=t,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}bh.prototype=Object.create(Ki.prototype),bh.prototype.constructor=bh,bh.prototype.isImmediateRenderObject=!0;const _h=new Zn;class xh extends Ki{constructor(t,e){super(),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;const n=new Wr,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let t=0,e=1,n=32;t<n;t++,e++){const r=t/n*Math.PI*2,o=e/n*Math.PI*2;i.push(Math.cos(r),Math.sin(r),1,Math.cos(o),Math.sin(o),1)}n.setAttribute(\"position\",new Pr(i,3));const r=new xc({fog:!1,toneMapped:!1});this.cone=new kc(n,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),_h.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(_h),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const wh=new Zn,Sh=new Ei,Mh=new Ei;class Eh extends kc{constructor(t){const e=function t(e){const n=[];e&&e.isBone&&n.push(e);for(let i=0;i<e.children.length;i++)n.push.apply(n,t(e.children[i]));return n}(t),n=new Wr,i=[],r=[],o=new yr(0,0,1),a=new yr(0,1,0);for(let t=0;t<e.length;t++){const n=e[t];n.parent&&n.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),r.push(o.r,o.g,o.b),r.push(a.r,a.g,a.b))}n.setAttribute(\"position\",new Pr(i,3)),n.setAttribute(\"color\",new Pr(r,3));super(n,new xc({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type=\"SkeletonHelper\",this.isSkeletonHelper=!0,this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(t){const e=this.bones,n=this.geometry,i=n.getAttribute(\"position\");Mh.copy(this.root.matrixWorld).invert();for(let t=0,n=0;t<e.length;t++){const r=e[t];r.parent&&r.parent.isBone&&(Sh.multiplyMatrices(Mh,r.matrixWorld),wh.setFromMatrixPosition(Sh),i.setXYZ(n,wh.x,wh.y,wh.z),Sh.multiplyMatrices(Mh,r.parent.matrixWorld),wh.setFromMatrixPosition(Sh),i.setXYZ(n+1,wh.x,wh.y,wh.z),n+=2)}n.getAttribute(\"position\").needsUpdate=!0,super.updateMatrixWorld(t)}}class Th extends uo{constructor(t,e,n){super(new Dl(e,4,2),new wr({wireframe:!0,fog:!1,toneMapped:!1})),this.light=t,this.light.updateMatrixWorld(),this.color=n,this.type=\"PointLightHelper\",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Ch=new Zn,Ah=new yr,Oh=new yr;class kh extends Ki{constructor(t,e,n){super(),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;const i=new Ll(e);i.rotateY(.5*Math.PI),this.material=new wr({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const r=i.getAttribute(\"position\"),o=new Float32Array(3*r.count);i.setAttribute(\"color\",new Er(o,3)),this.add(new uo(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const e=t.geometry.getAttribute(\"color\");Ah.copy(this.light.color),Oh.copy(this.light.groundColor);for(let t=0,n=e.count;t<n;t++){const i=t<n/2?Ah:Oh;e.setXYZ(t,i.r,i.g,i.b)}e.needsUpdate=!0}t.lookAt(Ch.setFromMatrixPosition(this.light.matrixWorld).negate())}}class Lh extends kc{constructor(t=10,e=10,n=4473924,i=8947848){n=new yr(n),i=new yr(i);const r=e/2,o=t/e,a=t/2,s=[],c=[];for(let t=0,l=0,d=-a;t<=e;t++,d+=o){s.push(-a,0,d,a,0,d),s.push(d,0,-a,d,0,a);const e=t===r?n:i;e.toArray(c,l),l+=3,e.toArray(c,l),l+=3,e.toArray(c,l),l+=3,e.toArray(c,l),l+=3}const l=new Wr;l.setAttribute(\"position\",new Pr(s,3)),l.setAttribute(\"color\",new Pr(c,3));super(l,new xc({vertexColors:!0,toneMapped:!1})),this.type=\"GridHelper\"}}class Ih extends kc{constructor(t=10,e=16,n=8,i=64,r=4473924,o=8947848){r=new yr(r),o=new yr(o);const a=[],s=[];for(let n=0;n<=e;n++){const i=n/e*(2*Math.PI),c=Math.sin(i)*t,l=Math.cos(i)*t;a.push(0,0,0),a.push(c,0,l);const d=1&n?r:o;s.push(d.r,d.g,d.b),s.push(d.r,d.g,d.b)}for(let e=0;e<=n;e++){const c=1&e?r:o,l=t-t/n*e;for(let t=0;t<i;t++){let e=t/i*(2*Math.PI),n=Math.sin(e)*l,r=Math.cos(e)*l;a.push(n,0,r),s.push(c.r,c.g,c.b),e=(t+1)/i*(2*Math.PI),n=Math.sin(e)*l,r=Math.cos(e)*l,a.push(n,0,r),s.push(c.r,c.g,c.b)}}const c=new Wr;c.setAttribute(\"position\",new Pr(a,3)),c.setAttribute(\"color\",new Pr(s,3));super(c,new xc({vertexColors:!0,toneMapped:!1})),this.type=\"PolarGridHelper\"}}const Rh=new Zn,Ph=new Zn,Dh=new Zn;class Nh extends Ki{constructor(t,e,n){super(),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===e&&(e=1);let i=new Wr;i.setAttribute(\"position\",new Pr([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));const r=new xc({fog:!1,toneMapped:!1});this.lightPlane=new Cc(i,r),this.add(this.lightPlane),i=new Wr,i.setAttribute(\"position\",new Pr([0,0,0,0,0,1],3)),this.targetLine=new Cc(i,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){Rh.setFromMatrixPosition(this.light.matrixWorld),Ph.setFromMatrixPosition(this.light.target.matrixWorld),Dh.subVectors(Ph,Rh),this.lightPlane.lookAt(Ph),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Ph),this.targetLine.scale.z=Dh.length()}}const Fh=new Zn,jh=new yo;class Bh extends kc{constructor(t){const e=new Wr,n=new xc({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],r=[],o={},a=new yr(16755200),s=new yr(16711680),c=new yr(43775),l=new yr(16777215),d=new yr(3355443);function u(t,e,n){h(t,n),h(e,n)}function h(t,e){i.push(0,0,0),r.push(e.r,e.g,e.b),void 0===o[t]&&(o[t]=[]),o[t].push(i.length/3-1)}u(\"n1\",\"n2\",a),u(\"n2\",\"n4\",a),u(\"n4\",\"n3\",a),u(\"n3\",\"n1\",a),u(\"f1\",\"f2\",a),u(\"f2\",\"f4\",a),u(\"f4\",\"f3\",a),u(\"f3\",\"f1\",a),u(\"n1\",\"f1\",a),u(\"n2\",\"f2\",a),u(\"n3\",\"f3\",a),u(\"n4\",\"f4\",a),u(\"p\",\"n1\",s),u(\"p\",\"n2\",s),u(\"p\",\"n3\",s),u(\"p\",\"n4\",s),u(\"u1\",\"u2\",c),u(\"u2\",\"u3\",c),u(\"u3\",\"u1\",c),u(\"c\",\"t\",l),u(\"p\",\"c\",d),u(\"cn1\",\"cn2\",d),u(\"cn3\",\"cn4\",d),u(\"cf1\",\"cf2\",d),u(\"cf3\",\"cf4\",d),e.setAttribute(\"position\",new Pr(i,3)),e.setAttribute(\"color\",new Pr(r,3)),super(e,n),this.type=\"CameraHelper\",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}update(){const t=this.geometry,e=this.pointMap;jh.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),zh(\"c\",e,t,jh,0,0,-1),zh(\"t\",e,t,jh,0,0,1),zh(\"n1\",e,t,jh,-1,-1,-1),zh(\"n2\",e,t,jh,1,-1,-1),zh(\"n3\",e,t,jh,-1,1,-1),zh(\"n4\",e,t,jh,1,1,-1),zh(\"f1\",e,t,jh,-1,-1,1),zh(\"f2\",e,t,jh,1,-1,1),zh(\"f3\",e,t,jh,-1,1,1),zh(\"f4\",e,t,jh,1,1,1),zh(\"u1\",e,t,jh,.7,1.1,-1),zh(\"u2\",e,t,jh,-.7,1.1,-1),zh(\"u3\",e,t,jh,0,2,-1),zh(\"cf1\",e,t,jh,-1,0,1),zh(\"cf2\",e,t,jh,1,0,1),zh(\"cf3\",e,t,jh,0,-1,1),zh(\"cf4\",e,t,jh,0,1,1),zh(\"cn1\",e,t,jh,-1,0,-1),zh(\"cn2\",e,t,jh,1,0,-1),zh(\"cn3\",e,t,jh,0,-1,-1),zh(\"cn4\",e,t,jh,0,1,-1),t.getAttribute(\"position\").needsUpdate=!0}}function zh(t,e,n,i,r,o,a){Fh.set(r,o,a).unproject(i);const s=e[t];if(void 0!==s){const t=n.getAttribute(\"position\");for(let e=0,n=s.length;e<n;e++)t.setXYZ(s[e],Fh.x,Fh.y,Fh.z)}}const Uh=new ti;class Hh extends kc{constructor(t,e=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),r=new Wr;r.setIndex(new Er(n,1)),r.setAttribute(\"position\",new Er(i,3)),super(r,new xc({color:e,toneMapped:!1})),this.object=t,this.type=\"BoxHelper\",this.matrixAutoUpdate=!1,this.update()}update(t){if(void 0!==t&&console.warn(\"THREE.BoxHelper: .update() has no longer arguments.\"),void 0!==this.object&&Uh.setFromObject(this.object),Uh.isEmpty())return;const e=Uh.min,n=Uh.max,i=this.geometry.attributes.position,r=i.array;r[0]=n.x,r[1]=n.y,r[2]=n.z,r[3]=e.x,r[4]=n.y,r[5]=n.z,r[6]=e.x,r[7]=e.y,r[8]=n.z,r[9]=n.x,r[10]=e.y,r[11]=n.z,r[12]=n.x,r[13]=n.y,r[14]=e.z,r[15]=e.x,r[16]=n.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=n.x,r[22]=e.y,r[23]=e.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(t){return this.object=t,this.update(),this}copy(t){return kc.prototype.copy.call(this,t),this.object=t.object,this}}class $h extends kc{constructor(t,e=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Wr;i.setIndex(new Er(n,1)),i.setAttribute(\"position\",new Pr([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(i,new xc({color:e,toneMapped:!1})),this.box=t,this.type=\"Box3Helper\",this.geometry.computeBoundingSphere()}updateMatrixWorld(t){const e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(t))}}class Gh extends Cc{constructor(t,e=1,n=16776960){const i=n,r=new Wr;r.setAttribute(\"position\",new Pr([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),r.computeBoundingSphere(),super(r,new xc({color:i,toneMapped:!1})),this.type=\"PlaneHelper\",this.plane=t,this.size=e;const o=new Wr;o.setAttribute(\"position\",new Pr([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),o.computeBoundingSphere(),this.add(new uo(o,new wr({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(t){let e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.children[0].material.side=e<0?m:f,this.lookAt(this.plane.normal),super.updateMatrixWorld(t)}}const Vh=new Zn;let Wh,qh;class Xh extends Ki{constructor(t,e,n,i,r,o){super(),this.type=\"ArrowHelper\",void 0===t&&(t=new Zn(0,0,1)),void 0===e&&(e=new Zn(0,0,0)),void 0===n&&(n=1),void 0===i&&(i=16776960),void 0===r&&(r=.2*n),void 0===o&&(o=.2*r),void 0===Wh&&(Wh=new Wr,Wh.setAttribute(\"position\",new Pr([0,0,0,0,1,0],3)),qh=new Gc(0,.5,1,5,1),qh.translate(0,-.5,0)),this.position.copy(e),this.line=new Cc(Wh,new xc({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new uo(qh,new wr({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,r,o)}setDirection(t){if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{Vh.set(t.z,0,-t.x).normalize();const e=Math.acos(t.y);this.quaternion.setFromAxisAngle(Vh,e)}}setLength(t,e,n){void 0===e&&(e=.2*t),void 0===n&&(n=.2*e),this.line.scale.set(1,Math.max(1e-4,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()}setColor(t){this.line.material.color.set(t),this.cone.material.color.set(t)}copy(t){return super.copy(t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this}}class Yh extends kc{constructor(t=1){const e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=new Wr;n.setAttribute(\"position\",new Pr(e,3)),n.setAttribute(\"color\",new Pr([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));super(n,new xc({vertexColors:!0,toneMapped:!1})),this.type=\"AxesHelper\"}}const Kh=new Float32Array(1),Zh=new Int32Array(Kh.buffer),Jh={toHalfFloat:function(t){Kh[0]=t;const e=Zh[0];let n=e>>16&32768,i=e>>12&2047;const r=e>>23&255;return r<103?n:r>142?(n|=31744,n|=(255==r?0:1)&&8388607&e,n):r<113?(i|=2048,n|=(i>>114-r)+(i>>113-r&1),n):(n|=r-112<<10|i>>1,n+=1&i,n)}},Qh=Math.pow(2,8),tp=[.125,.215,.35,.446,.526,.582],ep=5+tp.length,np={[Ke]:0,[Ze]:1,[Qe]:2,[en]:3,[nn]:4,[rn]:5,[Je]:6},ip=new wr({side:m,depthWrite:!1,depthTest:!1}),rp=new uo(new po,ip),op=new iu,{_lodPlanes:ap,_sizeLods:sp,_sigmas:cp}=vp(),lp=new yr;let dp=null;const up=(1+Math.sqrt(5))/2,hp=1/up,pp=[new Zn(1,1,1),new Zn(-1,1,1),new Zn(1,1,-1),new Zn(-1,1,-1),new Zn(0,up,hp),new Zn(0,up,-hp),new Zn(hp,0,up),new Zn(-hp,0,up),new Zn(up,hp,0),new Zn(-up,hp,0)];function fp(t){const e=Math.max(t.r,t.g,t.b),n=Math.min(Math.max(Math.ceil(Math.log2(e)),-128),127);t.multiplyScalar(Math.pow(2,-n));return(n+128)/255}class mp{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=function(t){const e=new Float32Array(t),n=new Zn(0,1,0);return new Gl({name:\"SphericalGaussianBlur\",defines:{n:t},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:e},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n},inputEncoding:{value:np[Ke]},outputEncoding:{value:np[Ke]}},vertexShader:wp(),fragmentShader:`\\n\\n\\t\\t\\tprecision mediump float;\\n\\t\\t\\tprecision mediump int;\\n\\n\\t\\t\\tvarying vec3 vOutputDirection;\\n\\n\\t\\t\\tuniform sampler2D envMap;\\n\\t\\t\\tuniform int samples;\\n\\t\\t\\tuniform float weights[ n ];\\n\\t\\t\\tuniform bool latitudinal;\\n\\t\\t\\tuniform float dTheta;\\n\\t\\t\\tuniform float mipInt;\\n\\t\\t\\tuniform vec3 poleAxis;\\n\\n\\t\\t\\t${Sp()}\\n\\n\\t\\t\\t#define ENVMAP_TYPE_CUBE_UV\\n\\t\\t\\t#include <cube_uv_reflection_fragment>\\n\\n\\t\\t\\tvec3 getSample( float theta, vec3 axis ) {\\n\\n\\t\\t\\t\\tfloat cosTheta = cos( theta );\\n\\t\\t\\t\\t// Rodrigues' axis-angle rotation\\n\\t\\t\\t\\tvec3 sampleDirection = vOutputDirection * cosTheta\\n\\t\\t\\t\\t\\t+ cross( axis, vOutputDirection ) * sin( theta )\\n\\t\\t\\t\\t\\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\\n\\n\\t\\t\\t\\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\\n\\n\\t\\t\\t}\\n\\n\\t\\t\\tvoid main() {\\n\\n\\t\\t\\t\\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\\n\\n\\t\\t\\t\\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\\n\\n\\t\\t\\t\\t\\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\\n\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\taxis = normalize( axis );\\n\\n\\t\\t\\t\\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\\n\\t\\t\\t\\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\\n\\n\\t\\t\\t\\tfor ( int i = 1; i < n; i++ ) {\\n\\n\\t\\t\\t\\t\\tif ( i >= samples ) {\\n\\n\\t\\t\\t\\t\\t\\tbreak;\\n\\n\\t\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t\\tfloat theta = dTheta * float( i );\\n\\t\\t\\t\\t\\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\\n\\t\\t\\t\\t\\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\\n\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\tgl_FragColor = linearToOutputTexel( gl_FragColor );\\n\\n\\t\\t\\t}\\n\\t\\t`,blending:b,depthTest:!1,depthWrite:!1})}(20),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(t,e=0,n=.1,i=100){dp=this._renderer.getRenderTarget();const r=this._allocateTargets();return this._sceneToCubeUV(t,n,i,r),e>0&&this._blur(r,0,0,e),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(t){return this._fromTexture(t)}fromCubemap(t){return this._fromTexture(t)}compileCubemapShader(){null===this._cubemapShader&&(this._cubemapShader=xp(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){null===this._equirectShader&&(this._equirectShader=_p(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let t=0;t<ap.length;t++)ap[t].dispose()}_cleanup(t){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(dp),t.scissorTest=!1,bp(t,0,0,t.width,t.height)}_fromTexture(t){dp=this._renderer.getRenderTarget();const e=this._allocateTargets(t);return this._textureToCubeUV(t,e),this._applyPMREM(e),this._cleanup(e),e}_allocateTargets(t){const e={magFilter:ft,minFilter:ft,generateMipmaps:!1,type:Mt,format:Ut,encoding:gp(t)?t.encoding:Qe,depthBuffer:!1},n=yp(e);return n.depthBuffer=!t,this._pingPongRenderTarget=yp(e),n}_compileMaterial(t){const e=new uo(ap[0],t);this._renderer.compile(e,op)}_sceneToCubeUV(t,e,n,i){const r=new bo(90,1,e,n),o=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],s=this._renderer,c=s.autoClear,l=s.outputEncoding,d=s.toneMapping;s.getClearColor(lp),s.toneMapping=J,s.outputEncoding=Ke,s.autoClear=!1;let u=!1;const h=t.background;if(h){if(h.isColor){ip.color.copy(h).convertSRGBToLinear(),t.background=null;const e=fp(ip.color);ip.opacity=e,u=!0}}else{ip.color.copy(lp).convertSRGBToLinear();const t=fp(ip.color);ip.opacity=t,u=!0}for(let e=0;e<6;e++){const n=e%3;0==n?(r.up.set(0,o[e],0),r.lookAt(a[e],0,0)):1==n?(r.up.set(0,0,o[e]),r.lookAt(0,a[e],0)):(r.up.set(0,o[e],0),r.lookAt(0,0,a[e])),bp(i,n*Qh,e>2?Qh:0,Qh,Qh),s.setRenderTarget(i),u&&s.render(rp,r),s.render(t,r)}s.toneMapping=d,s.outputEncoding=l,s.autoClear=c}_textureToCubeUV(t,e){const n=this._renderer;t.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=xp()):null==this._equirectShader&&(this._equirectShader=_p());const i=t.isCubeTexture?this._cubemapShader:this._equirectShader,r=new uo(ap[0],i),o=i.uniforms;o.envMap.value=t,t.isCubeTexture||o.texelSize.value.set(1/t.image.width,1/t.image.height),o.inputEncoding.value=np[t.encoding],o.outputEncoding.value=np[e.texture.encoding],bp(e,0,0,3*Qh,2*Qh),n.setRenderTarget(e),n.render(r,op)}_applyPMREM(t){const e=this._renderer,n=e.autoClear;e.autoClear=!1;for(let e=1;e<ep;e++){const n=Math.sqrt(cp[e]*cp[e]-cp[e-1]*cp[e-1]),i=pp[(e-1)%pp.length];this._blur(t,e-1,e,n,i)}e.autoClear=n}_blur(t,e,n,i,r){const o=this._pingPongRenderTarget;this._halfBlur(t,o,e,n,i,\"latitudinal\",r),this._halfBlur(o,t,n,n,i,\"longitudinal\",r)}_halfBlur(t,e,n,i,r,o,a){const s=this._renderer,c=this._blurMaterial;\"latitudinal\"!==o&&\"longitudinal\"!==o&&console.error(\"blur direction must be either latitudinal or longitudinal!\");const l=new uo(ap[i],c),d=c.uniforms,u=sp[n]-1,h=isFinite(r)?Math.PI/(2*u):2*Math.PI/39,p=r/h,f=isFinite(r)?1+Math.floor(3*p):20;f>20&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${f} samples when the maximum is set to 20`);const m=[];let g=0;for(let t=0;t<20;++t){const e=t/p,n=Math.exp(-e*e/2);m.push(n),0==t?g+=n:t<f&&(g+=2*n)}for(let t=0;t<m.length;t++)m[t]=m[t]/g;d.envMap.value=t.texture,d.samples.value=f,d.weights.value=m,d.latitudinal.value=\"latitudinal\"===o,a&&(d.poleAxis.value=a),d.dTheta.value=h,d.mipInt.value=8-n,d.inputEncoding.value=np[t.texture.encoding],d.outputEncoding.value=np[t.texture.encoding];const v=sp[i];bp(e,3*Math.max(0,Qh-2*v),(0===i?0:2*Qh)+2*v*(i>4?i-8+4:0),3*v,2*v),s.setRenderTarget(e),s.render(l,op)}}function gp(t){return void 0!==t&&t.type===Mt&&(t.encoding===Ke||t.encoding===Ze||t.encoding===Je)}function vp(){const t=[],e=[],n=[];let i=8;for(let r=0;r<ep;r++){const o=Math.pow(2,i);e.push(o);let a=1/o;r>4?a=tp[r-8+4-1]:0==r&&(a=0),n.push(a);const s=1/(o-1),c=-s/2,l=1+s/2,d=[c,c,l,c,l,l,c,c,l,l,c,l],u=6,h=6,p=3,f=2,m=1,g=new Float32Array(p*h*u),v=new Float32Array(f*h*u),y=new Float32Array(m*h*u);for(let t=0;t<u;t++){const e=t%3*2/3-1,n=t>2?0:-1,i=[e,n,0,e+2/3,n,0,e+2/3,n+1,0,e,n,0,e+2/3,n+1,0,e,n+1,0];g.set(i,p*h*t),v.set(d,f*h*t);const r=[t,t,t,t,t,t];y.set(r,m*h*t)}const b=new Wr;b.setAttribute(\"position\",new Er(g,p)),b.setAttribute(\"uv\",new Er(v,f)),b.setAttribute(\"faceIndex\",new Er(y,m)),t.push(b),i>4&&i--}return{_lodPlanes:t,_sizeLods:e,_sigmas:n}}function yp(t){const e=new Xn(3*Qh,3*Qh,t);return e.texture.mapping=lt,e.texture.name=\"PMREM.cubeUv\",e.scissorTest=!0,e}function bp(t,e,n,i,r){t.viewport.set(e,n,i,r),t.scissor.set(e,n,i,r)}function _p(){return new Gl({name:\"EquirectangularToCubeUV\",uniforms:{envMap:{value:null},texelSize:{value:new zn(1,1)},inputEncoding:{value:np[Ke]},outputEncoding:{value:np[Ke]}},vertexShader:wp(),fragmentShader:`\\n\\n\\t\\t\\tprecision mediump float;\\n\\t\\t\\tprecision mediump int;\\n\\n\\t\\t\\tvarying vec3 vOutputDirection;\\n\\n\\t\\t\\tuniform sampler2D envMap;\\n\\t\\t\\tuniform vec2 texelSize;\\n\\n\\t\\t\\t${Sp()}\\n\\n\\t\\t\\t#include <common>\\n\\n\\t\\t\\tvoid main() {\\n\\n\\t\\t\\t\\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\\n\\n\\t\\t\\t\\tvec3 outputDirection = normalize( vOutputDirection );\\n\\t\\t\\t\\tvec2 uv = equirectUv( outputDirection );\\n\\n\\t\\t\\t\\tvec2 f = fract( uv / texelSize - 0.5 );\\n\\t\\t\\t\\tuv -= f * texelSize;\\n\\t\\t\\t\\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\\n\\t\\t\\t\\tuv.x += texelSize.x;\\n\\t\\t\\t\\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\\n\\t\\t\\t\\tuv.y += texelSize.y;\\n\\t\\t\\t\\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\\n\\t\\t\\t\\tuv.x -= texelSize.x;\\n\\t\\t\\t\\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\\n\\n\\t\\t\\t\\tvec3 tm = mix( tl, tr, f.x );\\n\\t\\t\\t\\tvec3 bm = mix( bl, br, f.x );\\n\\t\\t\\t\\tgl_FragColor.rgb = mix( tm, bm, f.y );\\n\\n\\t\\t\\t\\tgl_FragColor = linearToOutputTexel( gl_FragColor );\\n\\n\\t\\t\\t}\\n\\t\\t`,blending:b,depthTest:!1,depthWrite:!1})}function xp(){return new Gl({name:\"CubemapToCubeUV\",uniforms:{envMap:{value:null},inputEncoding:{value:np[Ke]},outputEncoding:{value:np[Ke]}},vertexShader:wp(),fragmentShader:`\\n\\n\\t\\t\\tprecision mediump float;\\n\\t\\t\\tprecision mediump int;\\n\\n\\t\\t\\tvarying vec3 vOutputDirection;\\n\\n\\t\\t\\tuniform samplerCube envMap;\\n\\n\\t\\t\\t${Sp()}\\n\\n\\t\\t\\tvoid main() {\\n\\n\\t\\t\\t\\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\\n\\t\\t\\t\\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\\n\\t\\t\\t\\tgl_FragColor = linearToOutputTexel( gl_FragColor );\\n\\n\\t\\t\\t}\\n\\t\\t`,blending:b,depthTest:!1,depthWrite:!1})}function wp(){return\"\\n\\n\\t\\tprecision mediump float;\\n\\t\\tprecision mediump int;\\n\\n\\t\\tattribute vec3 position;\\n\\t\\tattribute vec2 uv;\\n\\t\\tattribute float faceIndex;\\n\\n\\t\\tvarying vec3 vOutputDirection;\\n\\n\\t\\t// RH coordinate system; PMREM face-indexing convention\\n\\t\\tvec3 getDirection( vec2 uv, float face ) {\\n\\n\\t\\t\\tuv = 2.0 * uv - 1.0;\\n\\n\\t\\t\\tvec3 direction = vec3( uv, 1.0 );\\n\\n\\t\\t\\tif ( face == 0.0 ) {\\n\\n\\t\\t\\t\\tdirection = direction.zyx; // ( 1, v, u ) pos x\\n\\n\\t\\t\\t} else if ( face == 1.0 ) {\\n\\n\\t\\t\\t\\tdirection = direction.xzy;\\n\\t\\t\\t\\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\\n\\n\\t\\t\\t} else if ( face == 2.0 ) {\\n\\n\\t\\t\\t\\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\\n\\n\\t\\t\\t} else if ( face == 3.0 ) {\\n\\n\\t\\t\\t\\tdirection = direction.zyx;\\n\\t\\t\\t\\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\\n\\n\\t\\t\\t} else if ( face == 4.0 ) {\\n\\n\\t\\t\\t\\tdirection = direction.xzy;\\n\\t\\t\\t\\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\\n\\n\\t\\t\\t} else if ( face == 5.0 ) {\\n\\n\\t\\t\\t\\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\\n\\n\\t\\t\\t}\\n\\n\\t\\t\\treturn direction;\\n\\n\\t\\t}\\n\\n\\t\\tvoid main() {\\n\\n\\t\\t\\tvOutputDirection = getDirection( uv, faceIndex );\\n\\t\\t\\tgl_Position = vec4( position, 1.0 );\\n\\n\\t\\t}\\n\\t\"}function Sp(){return\"\\n\\n\\t\\tuniform int inputEncoding;\\n\\t\\tuniform int outputEncoding;\\n\\n\\t\\t#include <encodings_pars_fragment>\\n\\n\\t\\tvec4 inputTexelToLinear( vec4 value ) {\\n\\n\\t\\t\\tif ( inputEncoding == 0 ) {\\n\\n\\t\\t\\t\\treturn value;\\n\\n\\t\\t\\t} else if ( inputEncoding == 1 ) {\\n\\n\\t\\t\\t\\treturn sRGBToLinear( value );\\n\\n\\t\\t\\t} else if ( inputEncoding == 2 ) {\\n\\n\\t\\t\\t\\treturn RGBEToLinear( value );\\n\\n\\t\\t\\t} else if ( inputEncoding == 3 ) {\\n\\n\\t\\t\\t\\treturn RGBMToLinear( value, 7.0 );\\n\\n\\t\\t\\t} else if ( inputEncoding == 4 ) {\\n\\n\\t\\t\\t\\treturn RGBMToLinear( value, 16.0 );\\n\\n\\t\\t\\t} else if ( inputEncoding == 5 ) {\\n\\n\\t\\t\\t\\treturn RGBDToLinear( value, 256.0 );\\n\\n\\t\\t\\t} else {\\n\\n\\t\\t\\t\\treturn GammaToLinear( value, 2.2 );\\n\\n\\t\\t\\t}\\n\\n\\t\\t}\\n\\n\\t\\tvec4 linearToOutputTexel( vec4 value ) {\\n\\n\\t\\t\\tif ( outputEncoding == 0 ) {\\n\\n\\t\\t\\t\\treturn value;\\n\\n\\t\\t\\t} else if ( outputEncoding == 1 ) {\\n\\n\\t\\t\\t\\treturn LinearTosRGB( value );\\n\\n\\t\\t\\t} else if ( outputEncoding == 2 ) {\\n\\n\\t\\t\\t\\treturn LinearToRGBE( value );\\n\\n\\t\\t\\t} else if ( outputEncoding == 3 ) {\\n\\n\\t\\t\\t\\treturn LinearToRGBM( value, 7.0 );\\n\\n\\t\\t\\t} else if ( outputEncoding == 4 ) {\\n\\n\\t\\t\\t\\treturn LinearToRGBM( value, 16.0 );\\n\\n\\t\\t\\t} else if ( outputEncoding == 5 ) {\\n\\n\\t\\t\\t\\treturn LinearToRGBD( value, 256.0 );\\n\\n\\t\\t\\t} else {\\n\\n\\t\\t\\t\\treturn LinearToGamma( value, 2.2 );\\n\\n\\t\\t\\t}\\n\\n\\t\\t}\\n\\n\\t\\tvec4 envMapTexelToLinear( vec4 color ) {\\n\\n\\t\\t\\treturn inputTexelToLinear( color );\\n\\n\\t\\t}\\n\\t\"}function Mp(t,e,n,i,r,o,a){return console.warn(\"THREE.Face4 has been removed. A THREE.Face3 will be created instead.\"),new br(t,e,n,r,o,a)}const Ep=0,Tp=1,Cp=0,Ap=1,Op=2;function kp(t){return console.warn(\"THREE.MeshFaceMaterial has been removed. Use an Array instead.\"),t}function Lp(t=[]){return console.warn(\"THREE.MultiMaterial has been removed. Use an Array instead.\"),t.isMultiMaterial=!0,t.materials=t,t.clone=function(){return t.slice()},t}function Ip(t,e){return console.warn(\"THREE.PointCloud has been renamed to THREE.Points.\"),new Fc(t,e)}function Rp(t){return console.warn(\"THREE.Particle has been renamed to THREE.Sprite.\"),new ec(t)}function Pp(t,e){return console.warn(\"THREE.ParticleSystem has been renamed to THREE.Points.\"),new Fc(t,e)}function Dp(t){return console.warn(\"THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial.\"),new Ic(t)}function Np(t){return console.warn(\"THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial.\"),new Ic(t)}function Fp(t){return console.warn(\"THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial.\"),new Ic(t)}function jp(t,e,n){return console.warn(\"THREE.Vertex has been removed. Use THREE.Vector3 instead.\"),new Zn(t,e,n)}function Bp(t,e){return console.warn(\"THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead.\"),new Er(t,e).setUsage(Tn)}function zp(t,e){return console.warn(\"THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead.\"),new Tr(t,e)}function Up(t,e){return console.warn(\"THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead.\"),new Cr(t,e)}function Hp(t,e){return console.warn(\"THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead.\"),new Ar(t,e)}function $p(t,e){return console.warn(\"THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead.\"),new Or(t,e)}function Gp(t,e){return console.warn(\"THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead.\"),new kr(t,e)}function Vp(t,e){return console.warn(\"THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead.\"),new Lr(t,e)}function Wp(t,e){return console.warn(\"THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead.\"),new Ir(t,e)}function qp(t,e){return console.warn(\"THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead.\"),new Pr(t,e)}function Xp(t,e){return console.warn(\"THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead.\"),new Dr(t,e)}function Yp(t){console.warn(\"THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead.\"),Dd.call(this,t),this.type=\"catmullrom\",this.closed=!0}function Kp(t){console.warn(\"THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead.\"),Dd.call(this,t),this.type=\"catmullrom\"}function Zp(t){console.warn(\"THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead.\"),Dd.call(this,t),this.type=\"catmullrom\"}function Jp(t){return console.warn(\"THREE.AxisHelper has been renamed to THREE.AxesHelper.\"),new Yh(t)}function Qp(t,e){return console.warn(\"THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead.\"),new Hh(t,e)}function tf(t,e){return console.warn(\"THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead.\"),new kc(new Jc(t.geometry),new xc({color:void 0!==e?e:16777215}))}function ef(t,e){return console.warn(\"THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead.\"),new kc(new Ul(t.geometry),new xc({color:void 0!==e?e:16777215}))}function nf(t){return console.warn(\"THREE.XHRLoader has been renamed to THREE.FileLoader.\"),new _d(t)}function rf(t){return console.warn(\"THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader.\"),new Ed(t)}function of(t,e,n){return console.warn(\"THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options ).\"),new wo(t,n)}Cd.create=function(t,e){return console.log(\"THREE.Curve.create() has been deprecated\"),t.prototype=Object.create(Cd.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Object.assign(Xd.prototype,{fromPoints:function(t){return console.warn(\"THREE.Path: .fromPoints() has been renamed to .setFromPoints().\"),this.setFromPoints(t)}}),Yp.prototype=Object.create(Dd.prototype),Kp.prototype=Object.create(Dd.prototype),Zp.prototype=Object.create(Dd.prototype),Object.assign(Zp.prototype,{initFromArray:function(){console.error(\"THREE.Spline: .initFromArray() has been removed.\")},getControlPointsArray:function(){console.error(\"THREE.Spline: .getControlPointsArray() has been removed.\")},reparametrizeByArcLength:function(){console.error(\"THREE.Spline: .reparametrizeByArcLength() has been removed.\")}}),Lh.prototype.setColors=function(){console.error(\"THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.\")},Eh.prototype.update=function(){console.error(\"THREE.SkeletonHelper: update() no longer needs to be called.\")},Object.assign(yd.prototype,{extractUrlBase:function(t){return console.warn(\"THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead.\"),uu.extractUrlBase(t)}}),yd.Handlers={add:function(){console.error(\"THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.\")},get:function(){console.error(\"THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.\")}},Object.assign(mh.prototype,{center:function(t){return console.warn(\"THREE.Box2: .center() has been renamed to .getCenter().\"),this.getCenter(t)},empty:function(){return console.warn(\"THREE.Box2: .empty() has been renamed to .isEmpty().\"),this.isEmpty()},isIntersectionBox:function(t){return console.warn(\"THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox().\"),this.intersectsBox(t)},size:function(t){return console.warn(\"THREE.Box2: .size() has been renamed to .getSize().\"),this.getSize(t)}}),Object.assign(ti.prototype,{center:function(t){return console.warn(\"THREE.Box3: .center() has been renamed to .getCenter().\"),this.getCenter(t)},empty:function(){return console.warn(\"THREE.Box3: .empty() has been renamed to .isEmpty().\"),this.isEmpty()},isIntersectionBox:function(t){return console.warn(\"THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox().\"),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn(\"THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere().\"),this.intersectsSphere(t)},size:function(t){return console.warn(\"THREE.Box3: .size() has been renamed to .getSize().\"),this.getSize(t)}}),Object.assign(gi.prototype,{empty:function(){return console.warn(\"THREE.Sphere: .empty() has been renamed to .isEmpty().\"),this.isEmpty()}}),To.prototype.setFromMatrix=function(t){return console.warn(\"THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix().\"),this.setFromProjectionMatrix(t)},yh.prototype.center=function(t){return console.warn(\"THREE.Line3: .center() has been renamed to .getCenter().\"),this.getCenter(t)},Object.assign(Bn,{random16:function(){return console.warn(\"THREE.Math: .random16() has been deprecated. Use Math.random() instead.\"),Math.random()},nearestPowerOfTwo:function(t){return console.warn(\"THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo().\"),Bn.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn(\"THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo().\"),Bn.ceilPowerOfTwo(t)}}),Object.assign(Un.prototype,{flattenToArrayOffset:function(t,e){return console.warn(\"THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.\"),this.toArray(t,e)},multiplyVector3:function(t){return console.warn(\"THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.\"),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error(\"THREE.Matrix3: .multiplyVector3Array() has been removed.\")},applyToBufferAttribute:function(t){return console.warn(\"THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead.\"),t.applyMatrix3(this)},applyToVector3Array:function(){console.error(\"THREE.Matrix3: .applyToVector3Array() has been removed.\")},getInverse:function(t){return console.warn(\"THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead.\"),this.copy(t).invert()}}),Object.assign(Ei.prototype,{extractPosition:function(t){return console.warn(\"THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().\"),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn(\"THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.\"),this.toArray(t,e)},getPosition:function(){return console.warn(\"THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.\"),(new Zn).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn(\"THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().\"),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn(\"THREE.Matrix4: .multiplyToArray() has been removed.\")},multiplyVector3:function(t){return console.warn(\"THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead.\"),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn(\"THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.\"),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error(\"THREE.Matrix4: .multiplyVector3Array() has been removed.\")},rotateAxis:function(t){console.warn(\"THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.\"),t.transformDirection(this)},crossVector:function(t){return console.warn(\"THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.\"),t.applyMatrix4(this)},translate:function(){console.error(\"THREE.Matrix4: .translate() has been removed.\")},rotateX:function(){console.error(\"THREE.Matrix4: .rotateX() has been removed.\")},rotateY:function(){console.error(\"THREE.Matrix4: .rotateY() has been removed.\")},rotateZ:function(){console.error(\"THREE.Matrix4: .rotateZ() has been removed.\")},rotateByAxis:function(){console.error(\"THREE.Matrix4: .rotateByAxis() has been removed.\")},applyToBufferAttribute:function(t){return console.warn(\"THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead.\"),t.applyMatrix4(this)},applyToVector3Array:function(){console.error(\"THREE.Matrix4: .applyToVector3Array() has been removed.\")},makeFrustum:function(t,e,n,i,r,o){return console.warn(\"THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead.\"),this.makePerspective(t,e,i,n,r,o)},getInverse:function(t){return console.warn(\"THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead.\"),this.copy(t).invert()}}),tr.prototype.isIntersectionLine=function(t){return console.warn(\"THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine().\"),this.intersectsLine(t)},Object.assign(Kn.prototype,{multiplyVector3:function(t){return console.warn(\"THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.\"),t.applyQuaternion(this)},inverse:function(){return console.warn(\"THREE.Quaternion: .inverse() has been renamed to invert().\"),this.invert()}}),Object.assign(Mi.prototype,{isIntersectionBox:function(t){return console.warn(\"THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox().\"),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn(\"THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane().\"),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn(\"THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere().\"),this.intersectsSphere(t)}}),Object.assign(ur.prototype,{area:function(){return console.warn(\"THREE.Triangle: .area() has been renamed to .getArea().\"),this.getArea()},barycoordFromPoint:function(t,e){return console.warn(\"THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord().\"),this.getBarycoord(t,e)},midpoint:function(t){return console.warn(\"THREE.Triangle: .midpoint() has been renamed to .getMidpoint().\"),this.getMidpoint(t)},normal:function(t){return console.warn(\"THREE.Triangle: .normal() has been renamed to .getNormal().\"),this.getNormal(t)},plane:function(t){return console.warn(\"THREE.Triangle: .plane() has been renamed to .getPlane().\"),this.getPlane(t)}}),Object.assign(ur,{barycoordFromPoint:function(t,e,n,i,r){return console.warn(\"THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord().\"),ur.getBarycoord(t,e,n,i,r)},normal:function(t,e,n,i){return console.warn(\"THREE.Triangle: .normal() has been renamed to .getNormal().\"),ur.getNormal(t,e,n,i)}}),Object.assign(Yd.prototype,{extractAllPoints:function(t){return console.warn(\"THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead.\"),this.extractPoints(t)},extrude:function(t){return console.warn(\"THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead.\"),new Cl(this,t)},makeGeometry:function(t){return console.warn(\"THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead.\"),new Pl(this,t)}}),Object.assign(zn.prototype,{fromAttribute:function(t,e,n){return console.warn(\"THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute().\"),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn(\"THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo().\"),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn(\"THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength().\"),this.manhattanLength()}}),Object.assign(Zn.prototype,{setEulerFromRotationMatrix:function(){console.error(\"THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.\")},setEulerFromQuaternion:function(){console.error(\"THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.\")},getPositionFromMatrix:function(t){return console.warn(\"THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().\"),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn(\"THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().\"),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn(\"THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().\"),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn(\"THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead.\"),this.applyMatrix4(t)},fromAttribute:function(t,e,n){return console.warn(\"THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute().\"),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn(\"THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo().\"),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn(\"THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength().\"),this.manhattanLength()}}),Object.assign(qn.prototype,{fromAttribute:function(t,e,n){return console.warn(\"THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute().\"),this.fromBufferAttribute(t,e,n)},lengthManhattan:function(){return console.warn(\"THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength().\"),this.manhattanLength()}}),Object.assign(Ki.prototype,{getChildByName:function(t){return console.warn(\"THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().\"),this.getObjectByName(t)},renderDepth:function(){console.warn(\"THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.\")},translate:function(t,e){return console.warn(\"THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.\"),this.translateOnAxis(e,t)},getWorldRotation:function(){console.error(\"THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.\")},applyMatrix:function(t){return console.warn(\"THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4().\"),this.applyMatrix4(t)}}),Object.defineProperties(Ki.prototype,{eulerOrder:{get:function(){return console.warn(\"THREE.Object3D: .eulerOrder is now .rotation.order.\"),this.rotation.order},set:function(t){console.warn(\"THREE.Object3D: .eulerOrder is now .rotation.order.\"),this.rotation.order=t}},useQuaternion:{get:function(){console.warn(\"THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.\")},set:function(){console.warn(\"THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.\")}}}),Object.assign(uo.prototype,{setDrawMode:function(){console.error(\"THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.\")}}),Object.defineProperties(uo.prototype,{drawMode:{get:function(){return console.error(\"THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode.\"),qe},set:function(){console.error(\"THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.\")}}}),Object.defineProperties(oc.prototype,{objects:{get:function(){return console.warn(\"THREE.LOD: .objects has been renamed to .levels.\"),this.levels}}}),Object.defineProperty(mc.prototype,\"useVertexTexture\",{get:function(){console.warn(\"THREE.Skeleton: useVertexTexture has been removed.\")},set:function(){console.warn(\"THREE.Skeleton: useVertexTexture has been removed.\")}}),uc.prototype.initBones=function(){console.error(\"THREE.SkinnedMesh: initBones() has been removed.\")},Object.defineProperty(Cd.prototype,\"__arcLengthDivisions\",{get:function(){return console.warn(\"THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.\"),this.arcLengthDivisions},set:function(t){console.warn(\"THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.\"),this.arcLengthDivisions=t}}),bo.prototype.setLens=function(t,e){console.warn(\"THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup.\"),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(Kd.prototype,{onlyShadow:{set:function(){console.warn(\"THREE.Light: .onlyShadow has been removed.\")}},shadowCameraFov:{set:function(t){console.warn(\"THREE.Light: .shadowCameraFov is now .shadow.camera.fov.\"),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn(\"THREE.Light: .shadowCameraLeft is now .shadow.camera.left.\"),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn(\"THREE.Light: .shadowCameraRight is now .shadow.camera.right.\"),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn(\"THREE.Light: .shadowCameraTop is now .shadow.camera.top.\"),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn(\"THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom.\"),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn(\"THREE.Light: .shadowCameraNear is now .shadow.camera.near.\"),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn(\"THREE.Light: .shadowCameraFar is now .shadow.camera.far.\"),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn(\"THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.\")}},shadowBias:{set:function(t){console.warn(\"THREE.Light: .shadowBias is now .shadow.bias.\"),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn(\"THREE.Light: .shadowDarkness has been removed.\")}},shadowMapWidth:{set:function(t){console.warn(\"THREE.Light: .shadowMapWidth is now .shadow.mapSize.width.\"),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn(\"THREE.Light: .shadowMapHeight is now .shadow.mapSize.height.\"),this.shadow.mapSize.height=t}}}),Object.defineProperties(Er.prototype,{length:{get:function(){return console.warn(\"THREE.BufferAttribute: .length has been deprecated. Use .count instead.\"),this.array.length}},dynamic:{get:function(){return console.warn(\"THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead.\"),this.usage===Tn},set:function(){console.warn(\"THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead.\"),this.setUsage(Tn)}}}),Object.assign(Er.prototype,{setDynamic:function(t){return console.warn(\"THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead.\"),this.setUsage(!0===t?Tn:En),this},copyIndicesArray:function(){console.error(\"THREE.BufferAttribute: .copyIndicesArray() has been removed.\")},setArray:function(){console.error(\"THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers\")}}),Object.assign(Wr.prototype,{addIndex:function(t){console.warn(\"THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().\"),this.setIndex(t)},addAttribute:function(t,e){return console.warn(\"THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute().\"),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?\"index\"===t?(console.warn(\"THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute.\"),this.setIndex(e),this):this.setAttribute(t,e):(console.warn(\"THREE.BufferGeometry: .addAttribute() now expects ( name, attribute ).\"),this.setAttribute(t,new Er(arguments[1],arguments[2])))},addDrawCall:function(t,e,n){void 0!==n&&console.warn(\"THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.\"),console.warn(\"THREE.BufferGeometry: .addDrawCall() is now .addGroup().\"),this.addGroup(t,e)},clearDrawCalls:function(){console.warn(\"THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().\"),this.clearGroups()},computeOffsets:function(){console.warn(\"THREE.BufferGeometry: .computeOffsets() has been removed.\")},removeAttribute:function(t){return console.warn(\"THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute().\"),this.deleteAttribute(t)},applyMatrix:function(t){return console.warn(\"THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4().\"),this.applyMatrix4(t)}}),Object.defineProperties(Wr.prototype,{drawcalls:{get:function(){return console.error(\"THREE.BufferGeometry: .drawcalls has been renamed to .groups.\"),this.groups}},offsets:{get:function(){return console.warn(\"THREE.BufferGeometry: .offsets has been renamed to .groups.\"),this.groups}}}),Object.defineProperties(hu.prototype,{maxInstancedCount:{get:function(){return console.warn(\"THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount.\"),this.instanceCount},set:function(t){console.warn(\"THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount.\"),this.instanceCount=t}}}),Object.defineProperties(lh.prototype,{linePrecision:{get:function(){return console.warn(\"THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead.\"),this.params.Line.threshold},set:function(t){console.warn(\"THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead.\"),this.params.Line.threshold=t}}}),Object.defineProperties(js.prototype,{dynamic:{get:function(){return console.warn(\"THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead.\"),this.usage===Tn},set:function(t){console.warn(\"THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead.\"),this.setUsage(t)}}}),Object.assign(js.prototype,{setDynamic:function(t){return console.warn(\"THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead.\"),this.setUsage(!0===t?Tn:En),this},setArray:function(){console.error(\"THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers\")}}),Object.assign(Cl.prototype,{getArrays:function(){console.error(\"THREE.ExtrudeGeometry: .getArrays() has been removed.\")},addShapeList:function(){console.error(\"THREE.ExtrudeGeometry: .addShapeList() has been removed.\")},addShape:function(){console.error(\"THREE.ExtrudeGeometry: .addShape() has been removed.\")}}),Object.assign(Fs.prototype,{dispose:function(){console.error(\"THREE.Scene: .dispose() has been removed.\")}}),Object.defineProperties(ah.prototype,{dynamic:{set:function(){console.warn(\"THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.\")}},onUpdate:{value:function(){return console.warn(\"THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead.\"),this}}}),Object.defineProperties(xr.prototype,{wrapAround:{get:function(){console.warn(\"THREE.Material: .wrapAround has been removed.\")},set:function(){console.warn(\"THREE.Material: .wrapAround has been removed.\")}},overdraw:{get:function(){console.warn(\"THREE.Material: .overdraw has been removed.\")},set:function(){console.warn(\"THREE.Material: .overdraw has been removed.\")}},wrapRGB:{get:function(){return console.warn(\"THREE.Material: .wrapRGB has been removed.\"),new yr}},shading:{get:function(){console.error(\"THREE.\"+this.type+\": .shading has been removed. Use the boolean .flatShading instead.\")},set:function(t){console.warn(\"THREE.\"+this.type+\": .shading has been removed. Use the boolean .flatShading instead.\"),this.flatShading=t===v}},stencilMask:{get:function(){return console.warn(\"THREE.\"+this.type+\": .stencilMask has been removed. Use .stencilFuncMask instead.\"),this.stencilFuncMask},set:function(t){console.warn(\"THREE.\"+this.type+\": .stencilMask has been removed. Use .stencilFuncMask instead.\"),this.stencilFuncMask=t}}}),Object.defineProperties(ql.prototype,{metal:{get:function(){return console.warn(\"THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead.\"),!1},set:function(){console.warn(\"THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead\")}}}),Object.defineProperties(Wl.prototype,{transparency:{get:function(){return console.warn(\"THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission.\"),this.transmission},set:function(t){console.warn(\"THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission.\"),this.transmission=t}}}),Object.defineProperties(vo.prototype,{derivatives:{get:function(){return console.warn(\"THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives.\"),this.extensions.derivatives},set:function(t){console.warn(\"THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives.\"),this.extensions.derivatives=t}}}),Object.assign(Rs.prototype,{clearTarget:function(t,e,n,i){console.warn(\"THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead.\"),this.setRenderTarget(t),this.clear(e,n,i)},animate:function(t){console.warn(\"THREE.WebGLRenderer: .animate() is now .setAnimationLoop().\"),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn(\"THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget().\"),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn(\"THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy().\"),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn(\"THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision.\"),this.capabilities.precision},resetGLState:function(){return console.warn(\"THREE.WebGLRenderer: .resetGLState() is now .state.reset().\"),this.state.reset()},supportsFloatTextures:function(){return console.warn(\"THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' ).\"),this.extensions.get(\"OES_texture_float\")},supportsHalfFloatTextures:function(){return console.warn(\"THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' ).\"),this.extensions.get(\"OES_texture_half_float\")},supportsStandardDerivatives:function(){return console.warn(\"THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' ).\"),this.extensions.get(\"OES_standard_derivatives\")},supportsCompressedTextureS3TC:function(){return console.warn(\"THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' ).\"),this.extensions.get(\"WEBGL_compressed_texture_s3tc\")},supportsCompressedTexturePVRTC:function(){return console.warn(\"THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' ).\"),this.extensions.get(\"WEBGL_compressed_texture_pvrtc\")},supportsBlendMinMax:function(){return console.warn(\"THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' ).\"),this.extensions.get(\"EXT_blend_minmax\")},supportsVertexTextures:function(){return console.warn(\"THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures.\"),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn(\"THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' ).\"),this.extensions.get(\"ANGLE_instanced_arrays\")},enableScissorTest:function(t){console.warn(\"THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest().\"),this.setScissorTest(t)},initMaterial:function(){console.warn(\"THREE.WebGLRenderer: .initMaterial() has been removed.\")},addPrePlugin:function(){console.warn(\"THREE.WebGLRenderer: .addPrePlugin() has been removed.\")},addPostPlugin:function(){console.warn(\"THREE.WebGLRenderer: .addPostPlugin() has been removed.\")},updateShadowMap:function(){console.warn(\"THREE.WebGLRenderer: .updateShadowMap() has been removed.\")},setFaceCulling:function(){console.warn(\"THREE.WebGLRenderer: .setFaceCulling() has been removed.\")},allocTextureUnit:function(){console.warn(\"THREE.WebGLRenderer: .allocTextureUnit() has been removed.\")},setTexture:function(){console.warn(\"THREE.WebGLRenderer: .setTexture() has been removed.\")},setTexture2D:function(){console.warn(\"THREE.WebGLRenderer: .setTexture2D() has been removed.\")},setTextureCube:function(){console.warn(\"THREE.WebGLRenderer: .setTextureCube() has been removed.\")},getActiveMipMapLevel:function(){return console.warn(\"THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel().\"),this.getActiveMipmapLevel()}}),Object.defineProperties(Rs.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn(\"THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.\"),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn(\"THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.\"),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn(\"THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.\")},set:function(){console.warn(\"THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.\")}},context:{get:function(){return console.warn(\"THREE.WebGLRenderer: .context has been removed. Use .getContext() instead.\"),this.getContext()}},vr:{get:function(){return console.warn(\"THREE.WebGLRenderer: .vr has been renamed to .xr\"),this.xr}},gammaInput:{get:function(){return console.warn(\"THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.\"),!1},set:function(){console.warn(\"THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.\")}},gammaOutput:{get:function(){return console.warn(\"THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead.\"),!1},set:function(t){console.warn(\"THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead.\"),this.outputEncoding=!0===t?Ze:Ke}},toneMappingWhitePoint:{get:function(){return console.warn(\"THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.\"),1},set:function(){console.warn(\"THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.\")}}}),Object.defineProperties(Ms.prototype,{cullFace:{get:function(){console.warn(\"THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.\")},set:function(){console.warn(\"THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.\")}},renderReverseSided:{get:function(){console.warn(\"THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.\")},set:function(){console.warn(\"THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.\")}},renderSingleSided:{get:function(){console.warn(\"THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.\")},set:function(){console.warn(\"THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.\")}}}),Object.defineProperties(Xn.prototype,{wrapS:{get:function(){return console.warn(\"THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.\"),this.texture.wrapS},set:function(t){console.warn(\"THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.\"),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn(\"THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.\"),this.texture.wrapT},set:function(t){console.warn(\"THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.\"),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn(\"THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.\"),this.texture.magFilter},set:function(t){console.warn(\"THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.\"),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn(\"THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.\"),this.texture.minFilter},set:function(t){console.warn(\"THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.\"),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn(\"THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.\"),this.texture.anisotropy},set:function(t){console.warn(\"THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.\"),this.texture.anisotropy=t}},offset:{get:function(){return console.warn(\"THREE.WebGLRenderTarget: .offset is now .texture.offset.\"),this.texture.offset},set:function(t){console.warn(\"THREE.WebGLRenderTarget: .offset is now .texture.offset.\"),this.texture.offset=t}},repeat:{get:function(){return console.warn(\"THREE.WebGLRenderTarget: .repeat is now .texture.repeat.\"),this.texture.repeat},set:function(t){console.warn(\"THREE.WebGLRenderTarget: .repeat is now .texture.repeat.\"),this.texture.repeat=t}},format:{get:function(){return console.warn(\"THREE.WebGLRenderTarget: .format is now .texture.format.\"),this.texture.format},set:function(t){console.warn(\"THREE.WebGLRenderTarget: .format is now .texture.format.\"),this.texture.format=t}},type:{get:function(){return console.warn(\"THREE.WebGLRenderTarget: .type is now .texture.type.\"),this.texture.type},set:function(t){console.warn(\"THREE.WebGLRenderTarget: .type is now .texture.type.\"),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn(\"THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.\"),this.texture.generateMipmaps},set:function(t){console.warn(\"THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.\"),this.texture.generateMipmaps=t}}}),Object.defineProperties(Bu.prototype,{load:{value:function(t){console.warn(\"THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.\");const e=this;return(new Tu).load(t,(function(t){e.setBuffer(t)})),this}},startTime:{set:function(){console.warn(\"THREE.Audio: .startTime is now .play( delay ).\")}}}),Vu.prototype.getData=function(){return console.warn(\"THREE.AudioAnalyser: .getData() is now .getFrequencyData().\"),this.getFrequencyData()},_o.prototype.updateCubeMap=function(t,e){return console.warn(\"THREE.CubeCamera: .updateCubeMap() is now .update().\"),this.update(t,e)},_o.prototype.clear=function(t,e,n,i){return console.warn(\"THREE.CubeCamera: .clear() is now .renderTarget.clear().\"),this.renderTarget.clear(t,e,n,i)};const af={merge:function(t,e,n){let i;console.warn(\"THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.\"),e.isMesh&&(e.matrixAutoUpdate&&e.updateMatrix(),i=e.matrix,e=e.geometry),t.merge(e,i,n)},center:function(t){return console.warn(\"THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.\"),t.center()}};function sf(){console.error(\"THREE.CanvasRenderer has been removed\")}function cf(){console.error(\"THREE.JSONLoader has been removed.\")}$n.crossOrigin=void 0,$n.loadTexture=function(t,e,n,i){console.warn(\"THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.\");const r=new Td;r.setCrossOrigin(this.crossOrigin);const o=r.load(t,n,void 0,i);return e&&(o.mapping=e),o},$n.loadTextureCube=function(t,e,n,i){console.warn(\"THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.\");const r=new Md;r.setCrossOrigin(this.crossOrigin);const o=r.load(t,n,void 0,i);return e&&(o.mapping=e),o},$n.loadCompressedTexture=function(){console.error(\"THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.\")},$n.loadCompressedTextureCube=function(){console.error(\"THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.\")};const lf={createMultiMaterialObject:function(){console.error(\"THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js\")},detach:function(){console.error(\"THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js\")},attach:function(){console.error(\"THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js\")}};function df(){console.error(\"THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js\")}\"undefined\"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent(\"register\",{detail:{revision:i}})),\"undefined\"!=typeof window&&(window.__THREE__?console.warn(\"WARNING: Multiple instances of Three.js being imported.\"):window.__THREE__=i)},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`/**\n * Shared styles for all modules.\n */\n:host {\n  /* LIT Brand Palettes */\n  --lit-cyea-50:  #EDFFFA;\n  --lit-cyea-100: #CDF2FA;\n  --lit-cyea-200: #AFE6DE;\n  --lit-cyea-300: #7BCCCC;\n  --lit-cyea-400: #52A6B3;\n  --lit-cyea-500: #348199;\n  --lit-cyea-600: #1F6180;\n  --lit-cyea-700: #114566;\n  --lit-cyea-800: #092F4D;\n  --lit-cyea-900: #041D33;\n\n  --lit-mage-50:  #FFF5F7;\n  --lit-mage-100: #FEEAEF;\n  --lit-mage-200: #FED5E0;\n  --lit-mage-300: #F9A9C0;\n  --lit-mage-400: #EF7CA1;\n  --lit-mage-500: #E25287;\n  --lit-mage-600: #CE2F75;\n  --lit-mage-700: #B7166A;\n  --lit-mage-800: #800060;\n  --lit-mage-900: #470046;\n\n  --lit-bric-50:  #FDF8EA;\n  --lit-bric-100: #F9F1DC;\n  --lit-bric-200: #EFD9AB;\n  --lit-bric-300: #E4BC78;\n  --lit-bric-400: #D59441;\n  --lit-bric-500: #C26412;\n  --lit-bric-600: #A93D00;\n  --lit-bric-700: #8B2100;\n  --lit-bric-800: #6A0C00;\n  --lit-bric-900: #470000;\n\n  --lit-neutral-50:  #F8F9FA;\n  --lit-neutral-100: #F1F3F4;\n  --lit-neutral-200: #E8EAED;\n  --lit-neutral-300: #DADCE0;\n  --lit-neutral-400: #BDC1C6;\n  --lit-neutral-500: #9AA0A6;\n  --lit-neutral-600: #80868B;\n  --lit-neutral-700: #5F6368;\n  --lit-neutral-800: #3C4043;\n  --lit-neutral-900: #202124;\n\n  /* LIT Major Tonal Palettes */\n  --lit-majtonal-p-50:  #EEFBF8;\n  --lit-majtonal-p-100: #D8F2ED;\n  --lit-majtonal-p-200: #C0E7E3;\n  --lit-majtonal-p-300: #A1D2D4;\n  --lit-majtonal-p-400: #72AEB9;\n  --lit-majtonal-p-500: #48879C;\n  --lit-majtonal-p-600: #326882;\n  --lit-majtonal-p-700: #284E67;\n  --lit-majtonal-p-800: #1D3649;\n  --lit-majtonal-p-900: #142838;\n\n  --lit-majtonal-s-50:  #FFF5F7;\n  --lit-majtonal-s-100: #FAEDF0;\n  --lit-majtonal-s-200: #F7DBE4;\n  --lit-majtonal-s-300: #EDBDCD;\n  --lit-majtonal-s-400: #E091AC;\n  --lit-majtonal-s-500: #CC6990;\n  --lit-majtonal-s-600: #BE4079;\n  --lit-majtonal-s-700: #9D2D69;\n  --lit-majtonal-s-800: #651A54;\n  --lit-majtonal-s-900: #3B0A3C;\n\n  --lit-majtonal-t-50:  #FCF8EF;\n  --lit-majtonal-t-100: #F9F7ED;\n  --lit-majtonal-t-200: #EDDEBF;\n  --lit-majtonal-t-300: #E0C9A2;\n  --lit-majtonal-t-400: #CEA269;\n  --lit-majtonal-t-500: #B6763E;\n  --lit-majtonal-t-600: #A14C1C;\n  --lit-majtonal-t-700: #7E351F;\n  --lit-majtonal-t-800: #58211B;\n  --lit-majtonal-t-900: #3B0A0B;\n\n  --lit-majtonal-nv-50:  #F0F7F7;\n  --lit-majtonal-nv-100: #EBF3F2;\n  --lit-majtonal-nv-200: #E3ECED;\n  --lit-majtonal-nv-300: #CCD9DD;\n  --lit-majtonal-nv-400: #B5C6CA;\n  --lit-majtonal-nv-500: #9CAFB4;\n  --lit-majtonal-nv-600: #72868F;\n  --lit-majtonal-nv-700: #596C75;\n  --lit-majtonal-nv-800: #3F5259;\n  --lit-majtonal-nv-900: #222C35;\n\n  /* LIT Minor Tonal Palettes */\n  --lit-mintonal-p-1: #F5F9FA;\n  --lit-mintonal-p-2: #EFF5F7;\n  --lit-mintonal-p-3: #E9F1F4;\n  --lit-mintonal-p-4: #E7F0F3;\n  --lit-mintonal-p-5: #E3EDF1;\n\n  --lit-mintonal-s-1: #F9F2F7;\n  --lit-mintonal-s-2: #F5EBF2;\n  --lit-mintonal-s-3: #F1E3EE;\n  --lit-mintonal-s-4: #F0E0EC;\n  --lit-mintonal-s-5: #EDDBE9;\n\n  --lit-mintonal-t-1: #FAF4F3;\n  --lit-mintonal-t-2: #F6EDEB;\n  --lit-mintonal-t-3: #F2E7E3;\n  --lit-mintonal-t-4: #F3E4E1;\n  --lit-mintonal-t-5: #EFE0DB;\n\n  /* Google Red, Exclusively for Errors */\n  --google-red-50: #FCE8E6;\n  --google-red-500: #EA4335;\n  --google-red-600: #D93025;\n  --google-red-700: #C5221F;\n\n  /* Viz Colors */\n  --viz-color-orange-1: #FFD8C3;\n  --viz-color-orange-2: #F0BD80;\n  --viz-color-orange-3: #FF9230;\n  --viz-color-orange-4: #BA4A0D;\n\n  --viz-color-blue-1: #87CDF9;\n  --viz-color-blue-2: #61AFF7;\n  --viz-color-blue-3: #3C7DBF;\n  --viz-color-blue-4: #184889;\n\n  --viz-color-yellow-1: #FAF49F;\n  --viz-color-yellow-2: #FFE839;\n  --viz-color-yellow-3: #FFC700;\n  --viz-color-yellow-4: #848014;\n\n  --viz-color-purple-1: #CDC5FF;\n  --viz-color-purple-2: #9B86EF;\n  --viz-color-purple-3: #7647EA;\n  --viz-color-purple-4: #270085;\n\n  --viz-color-coral-1: #F6AEA9;\n  --viz-color-coral-2: #FF777B;\n  --viz-color-coral-3: #FC4F61;\n  --viz-color-coral-4: #B12D33;\n\n  --viz-color-teal-1: #BDF4E7;\n  --viz-color-teal-2: #7DDAD3;\n  --viz-color-teal-3: #1F978A;\n  --viz-color-teal-4: #006067;\n\n  --viz-color-magenta-1: #EDC4E6;\n  --viz-color-magenta-2: #EF96CD;\n  --viz-color-magenta-3: #B22A72;\n  --viz-color-magenta-4: #632440;\n\n  --viz-color-grey-1: #DADCE0;\n  --viz-color-grey-2: #B5BCC3;\n  --viz-color-grey-3: #879695;\n  --viz-color-grey-4: #515050;\n\n  /* Compatibility Aliases */\n  --lit-gray-700: var(--lit-neutral-700);\n  --lit-gray-800: var(--lit-neutral-700);\n  /* For field names, etc. like preds (MulticlassPreds) */\n  --lit-bold-label-color: var(--lit-majtonal-nv-800);\n  --lit-light-label-color: var(--lit-majtonal-nv-600);\n}\n\nbutton {\n  width: fit-content;\n  max-height: 100%;\n  background: white;\n  pointer-events: auto;\n  cursor: pointer;\n  border: 1px solid darkgrey;\n  margin: 5px;\n  text-align: center;\n  padding: 5px 10px;\n  font-size: 10pt;\n  border-radius: 3px;\n  justify-content: center;\n  align-items: center;\n  display: flex;\n}\n\nbutton.accent {\n  background: rgb(47, 140, 155);\n  border: none;\n  color: white;\n}\n\nbutton.accent:hover {\n  background: rgb(33, 98, 108);\n}\n\n\nbutton:hover {\n  background: #faf49f;\n}\n\nbutton:disabled {\n  background: darkgrey;\n  color: lightgrey;\n  pointer-events: none;\n  cursor: auto;\n}\n\n.dropdown-label {\n  font-family: Roboto;\n  font-style: normal;\n  font-weight: 500;\n  font-size: 13px;\n  line-height: 20px;\n  letter-spacing: 0.3px;\n  color: var(--lit-neutral-800);\n}\n\n.dropdown {\n  outline: none;\n  border: none;\n  border-bottom: 1px solid var(--lit-neutral-400);\n  appearance: none;\n  -webkit-appearance: none;\n  padding: 4px 18px 3px 4px;\n  margin:  2px  8px 2px 0;\n  max-width: 80%;\n  color: var(--lit-neutral-800);\n  background-color: transparent;\n  /* SVG background-image sets fill: var(--lit-neutral-800) as HEX value */\n  background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%233C4043%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');\n  background-size: .65em auto, 100%;\n  background-position: top 50% right 5.5px;\n  background-repeat: no-repeat;\n}\n\n.dropdown:hover {\n  background-color: var(--lit-mintonal-p-3);\n  cursor: pointer;\n}\n\n.dropdown:active {\n  color: var(--lit-cyea-600);\n  /* SVG background-image sets fill: var(--lit-cyea-600) as HEX value */\n  background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%231F6180%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');\n  background-color: var(--lit-mintonal-p-1);\n}\n\n.dropdown:disabled {\n  color: var(--lit-neutral-400);\n  /* SVG background-image sets fill: var(--lit-neutral-200) as HEX value */\n  background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23E8EAED%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');\n}\n\n.dropdown.borderless { /* Not currently in use but available */\n  border: none;\n}\n\n.dropdown.hairline { /* Not currently in use but likely will be in AppToolbar */\n  border: 1px solid var(--lit-neutral-400);\n  border-radius: 4px;\n  padding: 3pt 12pt 3pt 4pt;\n}\n\n.dropdown.hairline:disabled {\n  border: 1px solid var(--lit-neutral-200);\n  border-radius: 4px;\n}\n\n.monospace {\n  font-family: 'Share Tech Mono', monospace;\n}\n\n/* Field name headings, for use in module content. */\n.field-title {\n  font-size: 14px;\n}\n\n/* Smaller field name headings, as in the data table. */\n.field-name {\n  font-weight: bold;\n  color: var(--lit-bold-label-color);\n}\n\nmwc-textfield {\n  --mdc-theme-primary: #2f8c9b;\n}\n\n.lit-img{\n  height: 15pt;\n  width: 15pt;\n  padding: 2pt;\n}\n\n/* For in-line icons in a <span> */\n.material-icon {\n  font-family: 'Material Icons';\n  vertical-align: middle;\n  margin: 0;\n}\n\n.material-icon-outlined {\n  font-family: 'Material Icons Outlined';\n  vertical-align: middle;\n  margin: 0;\n}\n\n/* Token chips */\n.token-chip-function {\n  color: #5f6368;\n  font-family: 'Roboto';\n  background: #f8f9fa;\n  border-radius: 2px;\n  border: 1px solid transparent; /* for spacing */\n  padding: 2px;\n  width: fit-content;\n}\n\n.token-chip-function.selected {\n  border: 1px solid #80868b;\n}\n\n.token-chip-function:hover {\n  background: #e8eaed;\n}\n\n.token-chip-label {\n  color: #3c4043;\n  font-family: 'Roboto Mono', monospace;\n  border: 1px solid transparent; /* for spacing */\n  border-radius: 2px;\n  padding: 2px;\n  width: fit-content;\n}\n\n.token-chip-label.selected {\n  color: #098591;\n  border-color: #098591;\n}\n\n.token-chip-label:hover {\n  background: #e4f7fb;\n}\n\n.token-chip-generated {\n  color: #8430ce;\n  font-family: 'Roboto';\n  background: #f3e8fd;\n  border: 1px solid transparent; /* for spacing */\n  border-radius: 2px;\n  padding: 2px;\n  width: fit-content;\n}\n\n.token-chip-generated.selected {\n  border-color: #a142f4;\n}\n\n.token-chip-generated:hover {\n  background: #e9d2fd;\n}\n\n.filled-button,\n.hairline-button {\n  font-family: Roboto;\n  font-style: normal;\n  font-weight: normal;\n  font-size: 13px;\n  line-height: 20px;\n  letter-spacing: 0.3px;\n  padding: 0 12px;\n  margin: 0 4px;\n  border-radius: 4px;\n}\n\n.filled-button.xl,\n.hairline-button.xl {\n  font-size: 14px;\n  line-height: 24px;\n}\n\n/**\n * Design Spec Deviation -- No button:focus states\n *\n * A decision was made to remove the :focus style from LIT buttons until a\n * complete accessibility audit is completed.\n */\n\n.filled-button {\n  background: var(--lit-majtonal-p-500);\n  border: 1px solid var(--lit-majtonal-p-500);\n  color: white;\n}\n\n.filled-button:active {\n  background: var(--lit-majtonal-p-700);\n  border: 1px solid var(--lit-majtonal-p-700);\n}\n\n.filled-button:hover {\n  background: var(--lit-majtonal-p-600);\n  border: 1px solid var(--lit-majtonal-p-600);\n}\n\n.filled-button:disabled {\n  background: var(--lit-neutral-100);\n  border: 1px solid var(--lit-neutral-100);\n  color: var(--lit-neutral-400);\n}\n\n.hairline-button {\n  background: transparent;\n  border: 1px solid var(--lit-neutral-400);\n  color: var(--lit-cyea-600);\n}\n\n.hairline-button:hover {\n  background-color: var(--lit-mintonal-p-3);\n  border: 1px solid var(--lit-neutral-400);\n  color: var(--lit-cyea-600);\n}\n\n.hairline-button:disabled {\n  color: var(--lit-neutral-400);\n  background: rgba(255, 255, 255, 0.8);\n  border: 1px solid var(--lit-neutral-200);\n}\n\n.hairline-button:active {\n  background-color: var(--lit-mintonal-p-4);\n  border: 1px solid var(--lit-cyea-500);\n  color: var(--lit-cyea-500);\n}\n\n/**\n * For standalone MWC icons as buttons. We don't use mwc-icon-button because it\n * adds a large backdrop and extra whitespace.\n */\n.icon-button {\n  height: 16px;\n  width: 16px;\n  min-width: 16px;\n  --mdc-icon-size: 16px;\n  cursor: pointer;\n  user-select: none;\n  color: var(--lit-neutral-700);\n}\n\n.icon-button:hover {\n  color: var(--lit-neutral-500);\n}\n\n.icon-button:disabled,\nmwc-icon.disabled{\n  cursor: default;\n  color: var(--lit-neutral-300);\n}\n\n.icon-button:active {\n  color: var(--lit-neutral-900);\n}\n\nmwc-icon.mdi-outlined {\n  --mdc-icon-font: \"Material Icons Outlined\";\n}\n\n/**\n * Main container to use inside modules.\n * If this contains a .module-toolbar and a .module-results-area,\n * the results area will scroll while the toolbar remains at the top.\n */\n.module-container {\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n\n/* Toolbar container for module controls. */\n.module-toolbar {\n  align-items: center;\n  display: flex;\n  flex-flow: row wrap;\n  min-height: 36px;\n  box-sizing: border-box;\n  padding: 0 4px;\n}\n\n.module-toolbar > * {\n  margin: 0px 4px;\n}\n\n.module-results-area {\n  flex: 1;\n  overflow-y: auto;\n}\n\n.module-content {\n  box-sizing: border-box;\n  flex-grow: 1;\n  flex-shrink: 1;\n}\n\n.module-footer {\n  align-items: center;\n  border-top: 1px solid #dadce0;\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: row;\n  flex-grow: 0;\n  flex-shrink: 0;\n  justify-content: space-between;\n  min-height: 36px;\n  padding: 0 4px;\n}\n\n/** Status text in a module footer. **/\n.module-status {\n  color: #3c4043;\n  font-style: italic;\n  font-weight: normal;\n  margin: 0 0.5em;\n}\n\n/**\n * Spacer div: insert this before content if you want a module without a\n * subtitle to align horizontally to one that does have one.\n * Used in span graph and annotated text modules, where the gold preds don't\n * have a subtitle for the model name.\n */\n.offset-for-module-header {\n  height: 0;\n  margin-top: 24px; /* match .header height from widget.css */\n}\n\n\n/* Disable Material ripple */\n.switch-container {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  min-height: 32px; /* make the actual switch visible */\n  overflow-y: clip; /* keep mwc-switch overdraw from messing up layout */\n}\n\n.switch-container > mwc-switch {\n  margin-left: 4px;\n  margin-right: 4px;\n}\n\nmwc-switch {\n  --mdc-ripple-hover-opacity: 0;\n  --mdc-ripple-press-opacity: 0;\n  --mdc-ripple-focus-opacity: 0;\n}\n\nmwc-icon.outlined {\n  --mdc-icon-font: \"Material Icons Outlined\";\n}\n`},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.hashCode=e.getTokOffsets=e.getTextWidth=e.linkifyUrls=e.chunkWords=e.copyToClipboard=e.roundToDecimalPlaces=e.facetMapToDictKey=e.isBinaryClassification=e.doesInputSpecContain=e.doesOutputSpecContain=e.compareArrays=e.cumSumArray=e.sumArray=e.range=e.isNumber=e.shortenId=e.getMarginFromThreshold=e.getThresholdFromMargin=e.handleEnterKey=e.permute=e.flatten=e.filterToKeys=e.findSpecKeys=e.isLitSubtype=e.arrayContainsSame=e.setEquals=e.randInt=void 0;const i=n(1).__importStar(n(21)),r=n(3);function o(t,e){if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}function a(t,e){if(null==t)return!1;\"string\"==typeof e&&(e=[e]);for(const n of e)if(t.__mro__.includes(n))return!0;return!1}function s(t,e){return\"string\"==typeof e&&(e=[e]),Object.keys(t).filter(n=>a(t[n],e))}n(5),e.randInt=function(t,e){return Math.floor(t+Math.random()*(e-t))},e.setEquals=o,e.arrayContainsSame=function(t,e){return o(new Set(t),new Set(e))},e.isLitSubtype=a,e.findSpecKeys=s,e.filterToKeys=function(t,e){const n={};for(const i of e)n[i]=t[i];return n},e.flatten=function(t){return i.merge(t)},e.permute=function(t,e){const n=[];for(let i=0;i<t.length;i++)n.push(t[e[i]]);return n},e.handleEnterKey=function(t,e){\"Enter\"===t.key&&e()},e.getThresholdFromMargin=function(t){return null==t||0===t?.5:1/(1+Math.exp(-t))},e.getMarginFromThreshold=function(t){return 1!==t?0!==t?Math.log(t/(1-t)):-5:5},e.shortenId=function(t){if(null!=t)return t.substring(0,6)},e.isNumber=function(t){return\"number\"==typeof t?t-t==0:\"string\"==typeof t&&\"\"!==t.trim()&&Number.isFinite(+t)},e.range=function(t){return[...Array.from({length:t}).keys()]},e.sumArray=function(t){return t.reduce((t,e)=>t+e,0)},e.cumSumArray=function(t){const e=[];return t.reduce((t,n,i)=>e[i]=t+n,0),e},e.compareArrays=function t(e,n){if(0===e.length||0===n.length)return i.ascending(e.length,n.length);const r=i.ascending(e[0],n[0]);return 0!==r?r:t(e.slice(1),n.slice(1))},e.doesOutputSpecContain=function(t,e,n){const i=Object.keys(t);for(let r=0;r<i.length;r++){const o=t[i[r]].spec.output,a=s(o,e);if(a.length){if(null==n)return!0;for(const t of a)if(n(o[t]))return!0}}return!1},e.doesInputSpecContain=function(t,e,n){const i=Object.keys(t);for(let r=0;r<i.length;r++){const o=t[i[r]].spec.input;let a=s(o,e);if(n&&(a=a.filter(t=>o[t].required)),a.length)return!0}return!1},e.isBinaryClassification=function(t){const e=t.vocab,n=t.null_idx;return 2===e.length&&null!=n},e.facetMapToDictKey=function(t){return Object.keys(t).sort().map(e=>`${e}:${t[e].displayVal}`).join(\" \")},e.roundToDecimalPlaces=function(t,e){if(e<0)return t;const n=Math.pow(10,e);return Math.round((t+Number.EPSILON)*n)/n},e.copyToClipboard=function(t){const e=document.createElement(\"input\");e.value=t,document.body.appendChild(e),e.select(),document.execCommand(\"copy\"),document.body.removeChild(e)},e.chunkWords=function(t){return t.split(\" \").map(t=>(t=>{const e=[];for(let n=0;n<t.length;n+=15)e.push(t.slice(n,n+15));return e.join(\"\")})(t)).join(\" \")},e.linkifyUrls=function(t,e=\"_self\"){const n=[];let i=0;const o=/https?:\\/\\/[^\\s]+[^.?!\\s]/g;for(const s of t.matchAll(o))n.push(t.slice(i,s.index)),i=s.index+s[0].length,n.push((a=t.slice(s.index,i),r.html`<a href=${a} target=${e}>${a}</a>`));var a;return n.push(t.slice(i,t.length)),r.html`${n}`};const c=document.createElement(\"canvas\");e.getTextWidth=function(t,e,n){const i=null==c.getContext?null:c.getContext(\"2d\");return null==i?t.length*n:(i.font=e,i.measureText(t).width)},e.getTokOffsets=function(t,e){const n=[];let i=0;for(let r=0;r<t.length;r++)n.push(i),i+=t[r]+e;return n},e.hashCode=function(t){let e=0;for(let n=0;n<t.length;n++){e=(e<<5)-e+t.charCodeAt(n),e|=0}return e}},function(t,e,n){\"use strict\";n.d(e,\"f\",(function(){return a.a})),n.d(e,\"h\",(function(){return s.a})),n.d(e,\"a\",(function(){return i.b})),n.d(e,\"b\",(function(){return i.c})),n.d(e,\"c\",(function(){return i.d})),n.d(e,\"d\",(function(){return i.e})),n.d(e,\"e\",(function(){return i.g})),n.d(e,\"i\",(function(){return c.b})),n.d(e,\"g\",(function(){return l}));var i=n(19);\n/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */const r=new class{handleAttributeExpressions(t,e,n,r){const o=e[0];if(\".\"===o){return new i.f(t,e.slice(1),n).parts}if(\"@\"===o)return[new i.d(t,e.slice(1),r.eventContext)];if(\"?\"===o)return[new i.c(t,e.slice(1),n)];return new i.a(t,e,n).parts}handleTextExpression(t){return new i.e(t)}};var o=n(41),a=n(38),s=(n(26),n(20)),c=(n(37),n(36));n(43),n(14);\n/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\"undefined\"!=typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push(\"1.4.1\");const l=(t,...e)=>new o.b(t,e,\"html\",r)},function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return i}));const i=t=>(e,n)=>{if(e.constructor._observers){if(!e.constructor.hasOwnProperty(\"_observers\")){const t=e.constructor._observers;e.constructor._observers=new Map,t.forEach((t,n)=>e.constructor._observers.set(n,t))}}else{e.constructor._observers=new Map;const t=e.updated;e.updated=function(e){t.call(this,e),e.forEach((t,e)=>{const n=this.constructor._observers.get(e);void 0!==n&&n.call(this,this[e],t)})}}e.constructor._observers.set(n,t)}},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.UrlService=e.StatusService=e.AppState=e.SliceService=e.SettingsService=e.SelectionService=e.RegressionService=e.ModulesService=e.GroupService=e.FocusService=e.ColorService=e.ClassificationService=e.ApiService=void 0;var i=n(66);Object.defineProperty(e,\"ApiService\",{enumerable:!0,get:function(){return i.ApiService}});var r=n(44);Object.defineProperty(e,\"ClassificationService\",{enumerable:!0,get:function(){return r.ClassificationService}});var o=n(52);Object.defineProperty(e,\"ColorService\",{enumerable:!0,get:function(){return o.ColorService}});var a=n(56);Object.defineProperty(e,\"FocusService\",{enumerable:!0,get:function(){return a.FocusService}});var s=n(32);Object.defineProperty(e,\"GroupService\",{enumerable:!0,get:function(){return s.GroupService}});var c=n(50);Object.defineProperty(e,\"ModulesService\",{enumerable:!0,get:function(){return c.ModulesService}});var l=n(55);Object.defineProperty(e,\"RegressionService\",{enumerable:!0,get:function(){return l.RegressionService}});var d=n(57);Object.defineProperty(e,\"SelectionService\",{enumerable:!0,get:function(){return d.SelectionService}});var u=n(70);Object.defineProperty(e,\"SettingsService\",{enumerable:!0,get:function(){return u.SettingsService}});var h=n(53);Object.defineProperty(e,\"SliceService\",{enumerable:!0,get:function(){return h.SliceService}});var p=n(54);Object.defineProperty(e,\"AppState\",{enumerable:!0,get:function(){return p.AppState}});var f=n(67);Object.defineProperty(e,\"StatusService\",{enumerable:!0,get:function(){return f.StatusService}});var m=n(51);Object.defineProperty(e,\"UrlService\",{enumerable:!0,get:function(){return m.UrlService}})},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.LitModule=void 0;const i=n(1),r=n(3),o=n(2),a=n(4),s=n(34),c=n(5),l=n(11),d=n(15);class u extends s.ReactiveElement{constructor(){super(...arguments),this.setIsLoading=t=>{},this.onSyncScroll=null,this.model=\"\",this.selectionServiceIndex=0,this.latestLoadPromises=new Map,this.apiService=d.app.getService(l.ApiService),this.appState=d.app.getService(l.AppState)}get selectionService(){return d.app.getServiceArray(l.SelectionService)[this.selectionServiceIndex]}updated(){this.shadowRoot.querySelectorAll(\".\"+c.SCROLL_SYNC_CSS_CLASS).forEach(t=>{t.onscroll=this.onSyncScroll})}loadLatest(t,e){return i.__awaiter(this,void 0,void 0,(function*(){this.latestLoadPromises.set(t,e),this.setIsLoading(!0);const n=yield e;return this.latestLoadPromises.get(t)===e?(this.setIsLoading(!1),this.latestLoadPromises.delete(t),n):null}))}static shouldDisplayModule(t,e){return!0}}u.title=\"\",u.numCols=4,u.collapseByDefault=!1,u.duplicateForExampleComparison=!1,u.duplicateForModelComparison=!0,u.duplicateAsRow=!1,u.template=()=>r.html``,i.__decorate([(0,o.property)({type:Object}),i.__metadata(\"design:type\",Function)],u.prototype,\"setIsLoading\",void 0),i.__decorate([a.observable,(0,o.property)({type:Object}),i.__metadata(\"design:type\",Object)],u.prototype,\"onSyncScroll\",void 0),i.__decorate([(0,o.property)({type:String}),i.__metadata(\"design:type\",Object)],u.prototype,\"model\",void 0),i.__decorate([a.observable,(0,o.property)({type:Number}),i.__metadata(\"design:type\",Object)],u.prototype,\"selectionServiceIndex\",void 0),i.__decorate([a.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],u.prototype,\"selectionService\",null),e.LitModule=u},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"classMap\",(function(){return o}));var i=n(22),r=n(23);\n/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst o=Object(r.c)(class extends r.a{constructor(t){var e;if(super(t),t.type!==r.b.ATTRIBUTE||\"class\"!==t.name||(null===(e=t.strings)||void 0===e?void 0:e.length)>2)throw Error(\"`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.\")}render(t){return\" \"+Object.keys(t).filter(e=>t[e]).join(\" \")+\" \"}update(t,[e]){var n,r;if(void 0===this.nt){this.nt=new Set,void 0!==t.strings&&(this.st=new Set(t.strings.join(\" \").split(/\\s/).filter(t=>\"\"!==t)));for(const t in e)e[t]&&!(null===(n=this.st)||void 0===n?void 0:n.has(t))&&this.nt.add(t);return this.render(e)}const o=t.element.classList;this.nt.forEach(t=>{t in e||(o.remove(t),this.nt.delete(t))});for(const t in e){const n=!!e[t];n===this.nt.has(t)||(null===(r=this.st)||void 0===r?void 0:r.has(t))||(n?(o.add(t),this.nt.add(t)):(o.remove(t),this.nt.delete(t)))}return i.c}})},function(t,e,n){\"use strict\";n.d(e,\"f\",(function(){return i})),n.d(e,\"g\",(function(){return r})),n.d(e,\"b\",(function(){return a})),n.d(e,\"a\",(function(){return s})),n.d(e,\"d\",(function(){return l})),n.d(e,\"c\",(function(){return d})),n.d(e,\"e\",(function(){return u}));\n/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nconst i=`{{lit-${String(Math.random()).slice(2)}}}`,r=`\\x3c!--${i}--\\x3e`,o=new RegExp(`${i}|${r}`),a=\"$lit$\";class s{constructor(t,e){this.parts=[],this.element=e;const n=[],r=[],s=document.createTreeWalker(e.content,133,null,!1);let l=0,h=-1,p=0;const{strings:f,values:{length:m}}=t;for(;p<m;){const t=s.nextNode();if(null!==t){if(h++,1===t.nodeType){if(t.hasAttributes()){const e=t.attributes,{length:n}=e;let i=0;for(let t=0;t<n;t++)c(e[t].name,a)&&i++;for(;i-- >0;){const e=f[p],n=u.exec(e)[2],i=n.toLowerCase()+a,r=t.getAttribute(i);t.removeAttribute(i);const s=r.split(o);this.parts.push({type:\"attribute\",index:h,name:n,strings:s}),p+=s.length-1}}\"TEMPLATE\"===t.tagName&&(r.push(t),s.currentNode=t.content)}else if(3===t.nodeType){const e=t.data;if(e.indexOf(i)>=0){const i=t.parentNode,r=e.split(o),s=r.length-1;for(let e=0;e<s;e++){let n,o=r[e];if(\"\"===o)n=d();else{const t=u.exec(o);null!==t&&c(t[2],a)&&(o=o.slice(0,t.index)+t[1]+t[2].slice(0,-a.length)+t[3]),n=document.createTextNode(o)}i.insertBefore(n,t),this.parts.push({type:\"node\",index:++h})}\"\"===r[s]?(i.insertBefore(d(),t),n.push(t)):t.data=r[s],p+=s}}else if(8===t.nodeType)if(t.data===i){const e=t.parentNode;null!==t.previousSibling&&h!==l||(h++,e.insertBefore(d(),t)),l=h,this.parts.push({type:\"node\",index:h}),null===t.nextSibling?t.data=\"\":(n.push(t),h--),p++}else{let e=-1;for(;-1!==(e=t.data.indexOf(i,e+1));)this.parts.push({type:\"node\",index:-1}),p++}}else s.currentNode=r.pop()}for(const t of n)t.parentNode.removeChild(t)}}const c=(t,e)=>{const n=t.length-e.length;return n>=0&&t.slice(n)===e},l=t=>-1!==t.index,d=()=>document.createComment(\"\"),u=/([ \\x09\\x0a\\x0c\\x0d])([^\\0-\\x1F\\x7F-\\x9F \"'>=/]+)([ \\x09\\x0a\\x0c\\x0d]*=[ \\x09\\x0a\\x0c\\x0d]*(?:[^ \\x09\\x0a\\x0c\\x0d\"'`<>=]*|\"[^\"]*|'[^']*))$/},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.app=e.LitApp=void 0;const i=n(1),r=n(4);n(5);const o=n(66),a=n(44),s=n(52),c=n(56),l=n(32);n(25);const d=n(50),u=n(55),h=n(57),p=n(70),f=n(53),m=n(54),g=n(67),v=n(51);class y{constructor(){this.services=new Map,this.buildServices()}initialize(t){return i.__awaiter(this,void 0,void 0,(function*(){const e=this.getService(m.AppState),n=this.getService(d.ModulesService);e.addLayouts(t),yield e.initialize(),e.metadata.pageTitle&&(document.querySelector(\"html head title\").textContent=e.metadata.pageTitle),n.initializeLayout(e.layout,e.currentModelSpecs,e.currentDatasetSpec,e.compareExamplesEnabled);const i=this.getServiceArray(h.SelectionService);yield this.getService(v.UrlService).syncSelectedDatapointToUrl(e,i[0]),(0,r.reaction)(()=>e.compareExamplesEnabled,t=>{this.syncSelectionServices()},{fireImmediately:!0})}))}syncSelectionServices(){const t=this.getServiceArray(h.SelectionService);t[1].syncFrom(t[0])}getService(t){let e=this.services.get(t);if(Array.isArray(e)&&(e=e[0]),void 0===e)throw new Error(\"Service is undefined: \"+t.name);return e}getServiceArray(t){const e=this.services.get(t);if(void 0===e)throw new Error(\"Service is undefined: \"+t.name);return e}buildServices(){const t=new g.StatusService,e=new o.ApiService(t),n=new d.ModulesService,i=new v.UrlService,r=new m.AppState(e,t),y=new h.SelectionService(r),b=new h.SelectionService(r),_=new f.SliceService(y,r),x=new u.RegressionService(e,r),w=new p.SettingsService(r,n,y),S=new l.GroupService(r),M=new a.ClassificationService(e,r,S),E=new s.ColorService(r,S,M,x),T=new c.FocusService(y);i.syncStateToUrl(r,y,n),this.services.set(o.ApiService,e),this.services.set(m.AppState,r),this.services.set(a.ClassificationService,M),this.services.set(s.ColorService,E),this.services.set(c.FocusService,T),this.services.set(l.GroupService,S),this.services.set(d.ModulesService,n),this.services.set(u.RegressionService,x),this.services.set(h.SelectionService,[y,b]),this.services.set(p.SettingsService,w),this.services.set(f.SliceService,_),this.services.set(g.StatusService,t),this.services.set(v.UrlService,i)}}e.LitApp=y,e.app=new y},function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return i}));\n/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nvar i=function(){function t(t){void 0===t&&(t={}),this.adapter_=t}return Object.defineProperty(t,\"cssClasses\",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(t,\"strings\",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(t,\"numbers\",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(t,\"defaultAdapter\",{get:function(){return{}},enumerable:!0,configurable:!0}),t.prototype.init=function(){},t.prototype.destroy=function(){},t}()},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styleMap\",(function(){return o}));var i=n(22),r=n(23);\n/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst o=Object(r.c)(class extends r.a{constructor(t){var e;if(super(t),t.type!==r.b.ATTRIBUTE||\"style\"!==t.name||(null===(e=t.strings)||void 0===e?void 0:e.length)>2)throw Error(\"The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.\")}render(t){return Object.keys(t).reduce((e,n)=>{const i=t[n];return null==i?e:e+`${n=n.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,\"-$&\").toLowerCase()}:${i};`},\"\")}update(t,[e]){const{style:n}=t.element;if(void 0===this.vt){this.vt=new Set;for(const t in e)this.vt.add(t);return this.render(e)}this.vt.forEach(t=>{null==e[t]&&(this.vt.delete(t),t.includes(\"-\")?n.removeProperty(t):n[t]=\"\")});for(const t in e){const i=e[t];null!=i&&(this.vt.add(t),t.includes(\"-\")?n.setProperty(t,i):n[t]=i)}return i.c}})},function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return o}));var i=n(0),r=n(28);n.d(e,\"b\",(function(){return r.a}));\n/**\n@license\nCopyright 2018 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\nclass o extends i.a{createFoundation(){void 0!==this.mdcFoundation&&this.mdcFoundation.destroy(),this.mdcFoundationClass&&(this.mdcFoundation=new this.mdcFoundationClass(this.createAdapter()),this.mdcFoundation.init())}firstUpdated(){this.createFoundation()}}},function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return u})),n.d(e,\"b\",(function(){return h})),n.d(e,\"e\",(function(){return p})),n.d(e,\"c\",(function(){return f})),n.d(e,\"f\",(function(){return m})),n.d(e,\"g\",(function(){return g})),n.d(e,\"d\",(function(){return y}));var i=n(38),r=n(26),o=n(20),a=n(43),s=n(41),c=n(14);\n/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nconst l=t=>null===t||!(\"object\"==typeof t||\"function\"==typeof t),d=t=>Array.isArray(t)||!(!t||!t[Symbol.iterator]);class u{constructor(t,e,n){this.dirty=!0,this.element=t,this.name=e,this.strings=n,this.parts=[];for(let t=0;t<n.length-1;t++)this.parts[t]=this._createPart()}_createPart(){return new h(this)}_getValue(){const t=this.strings,e=t.length-1,n=this.parts;if(1===e&&\"\"===t[0]&&\"\"===t[1]){const t=n[0].value;if(\"symbol\"==typeof t)return String(t);if(\"string\"==typeof t||!d(t))return t}let i=\"\";for(let r=0;r<e;r++){i+=t[r];const e=n[r];if(void 0!==e){const t=e.value;if(l(t)||!d(t))i+=\"string\"==typeof t?t:String(t);else for(const e of t)i+=\"string\"==typeof e?e:String(e)}}return i+=t[e],i}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class h{constructor(t){this.value=void 0,this.committer=t}setValue(t){t===o.a||l(t)&&t===this.value||(this.value=t,Object(i.b)(t)||(this.committer.dirty=!0))}commit(){for(;Object(i.b)(this.value);){const t=this.value;this.value=o.a,t(this)}this.value!==o.a&&this.committer.commit()}}class p{constructor(t){this.value=void 0,this.__pendingValue=void 0,this.options=t}appendInto(t){this.startNode=t.appendChild(Object(c.c)()),this.endNode=t.appendChild(Object(c.c)())}insertAfterNode(t){this.startNode=t,this.endNode=t.nextSibling}appendIntoPart(t){t.__insert(this.startNode=Object(c.c)()),t.__insert(this.endNode=Object(c.c)())}insertAfterPart(t){t.__insert(this.startNode=Object(c.c)()),this.endNode=t.endNode,t.endNode=this.startNode}setValue(t){this.__pendingValue=t}commit(){if(null===this.startNode.parentNode)return;for(;Object(i.b)(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=o.a,t(this)}const t=this.__pendingValue;t!==o.a&&(l(t)?t!==this.value&&this.__commitText(t):t instanceof s.b?this.__commitTemplateResult(t):t instanceof Node?this.__commitNode(t):d(t)?this.__commitIterable(t):t===o.b?(this.value=o.b,this.clear()):this.__commitText(t))}__insert(t){this.endNode.parentNode.insertBefore(t,this.endNode)}__commitNode(t){this.value!==t&&(this.clear(),this.__insert(t),this.value=t)}__commitText(t){const e=this.startNode.nextSibling,n=\"string\"==typeof(t=null==t?\"\":t)?t:String(t);e===this.endNode.previousSibling&&3===e.nodeType?e.data=n:this.__commitNode(document.createTextNode(n)),this.value=t}__commitTemplateResult(t){const e=this.options.templateFactory(t);if(this.value instanceof a.a&&this.value.template===e)this.value.update(t.values);else{const n=new a.a(e,t.processor,this.options),i=n._clone();n.update(t.values),this.__commitNode(i),this.value=n}}__commitIterable(t){Array.isArray(this.value)||(this.value=[],this.clear());const e=this.value;let n,i=0;for(const r of t)n=e[i],void 0===n&&(n=new p(this.options),e.push(n),0===i?n.appendIntoPart(this):n.insertAfterPart(e[i-1])),n.setValue(r),n.commit(),i++;i<e.length&&(e.length=i,this.clear(n&&n.endNode))}clear(t=this.startNode){Object(r.b)(this.startNode.parentNode,t.nextSibling,this.endNode)}}class f{constructor(t,e,n){if(this.value=void 0,this.__pendingValue=void 0,2!==n.length||\"\"!==n[0]||\"\"!==n[1])throw new Error(\"Boolean attributes can only contain a single expression\");this.element=t,this.name=e,this.strings=n}setValue(t){this.__pendingValue=t}commit(){for(;Object(i.b)(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=o.a,t(this)}if(this.__pendingValue===o.a)return;const t=!!this.__pendingValue;this.value!==t&&(t?this.element.setAttribute(this.name,\"\"):this.element.removeAttribute(this.name),this.value=t),this.__pendingValue=o.a}}class m extends u{constructor(t,e,n){super(t,e,n),this.single=2===n.length&&\"\"===n[0]&&\"\"===n[1]}_createPart(){return new g(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class g extends h{}let v=!1;(()=>{try{const t={get capture(){return v=!0,!1}};window.addEventListener(\"test\",t,t),window.removeEventListener(\"test\",t,t)}catch(t){}})();class y{constructor(t,e,n){this.value=void 0,this.__pendingValue=void 0,this.element=t,this.eventName=e,this.eventContext=n,this.__boundHandleEvent=t=>this.handleEvent(t)}setValue(t){this.__pendingValue=t}commit(){for(;Object(i.b)(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=o.a,t(this)}if(this.__pendingValue===o.a)return;const t=this.__pendingValue,e=this.value,n=null==t||null!=e&&(t.capture!==e.capture||t.once!==e.once||t.passive!==e.passive),r=null!=t&&(null==e||n);n&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),r&&(this.__options=b(t),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=t,this.__pendingValue=o.a}handleEvent(t){\"function\"==typeof this.value?this.value.call(this.eventContext||this.element,t):this.value.handleEvent(t)}}const b=t=>t&&(v?{capture:t.capture,passive:t.passive,once:t.once}:t.capture)},function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return i})),n.d(e,\"b\",(function(){return r}));\n/**\n * @license\n * Copyright (c) 2018 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nconst i={},r={}},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"version\",(function(){return i})),n.d(e,\"bisect\",(function(){return l})),n.d(e,\"bisectRight\",(function(){return s})),n.d(e,\"bisectLeft\",(function(){return c})),n.d(e,\"ascending\",(function(){return r})),n.d(e,\"bisector\",(function(){return o})),n.d(e,\"cross\",(function(){return h})),n.d(e,\"descending\",(function(){return p})),n.d(e,\"deviation\",(function(){return g})),n.d(e,\"extent\",(function(){return v})),n.d(e,\"histogram\",(function(){return L})),n.d(e,\"thresholdFreedmanDiaconis\",(function(){return R})),n.d(e,\"thresholdScott\",(function(){return P})),n.d(e,\"thresholdSturges\",(function(){return k})),n.d(e,\"max\",(function(){return D})),n.d(e,\"mean\",(function(){return N})),n.d(e,\"median\",(function(){return F})),n.d(e,\"merge\",(function(){return j})),n.d(e,\"min\",(function(){return B})),n.d(e,\"pairs\",(function(){return d})),n.d(e,\"permute\",(function(){return z})),n.d(e,\"quantile\",(function(){return I})),n.d(e,\"range\",(function(){return S})),n.d(e,\"scan\",(function(){return U})),n.d(e,\"shuffle\",(function(){return H})),n.d(e,\"sum\",(function(){return $})),n.d(e,\"ticks\",(function(){return C})),n.d(e,\"tickIncrement\",(function(){return A})),n.d(e,\"tickStep\",(function(){return O})),n.d(e,\"transpose\",(function(){return G})),n.d(e,\"variance\",(function(){return m})),n.d(e,\"zip\",(function(){return W})),n.d(e,\"axisTop\",(function(){return et})),n.d(e,\"axisRight\",(function(){return nt})),n.d(e,\"axisBottom\",(function(){return it})),n.d(e,\"axisLeft\",(function(){return rt})),n.d(e,\"brush\",(function(){return Tr})),n.d(e,\"brushX\",(function(){return Mr})),n.d(e,\"brushY\",(function(){return Er})),n.d(e,\"brushSelection\",(function(){return Sr})),n.d(e,\"chord\",(function(){return Dr})),n.d(e,\"ribbon\",(function(){return Yr})),n.d(e,\"nest\",(function(){return Qr})),n.d(e,\"set\",(function(){return so})),n.d(e,\"map\",(function(){return Jr})),n.d(e,\"keys\",(function(){return co})),n.d(e,\"values\",(function(){return lo})),n.d(e,\"entries\",(function(){return uo})),n.d(e,\"color\",(function(){return Ge})),n.d(e,\"rgb\",(function(){return Xe})),n.d(e,\"hsl\",(function(){return en})),n.d(e,\"lab\",(function(){return go})),n.d(e,\"hcl\",(function(){return Mo})),n.d(e,\"lch\",(function(){return So})),n.d(e,\"gray\",(function(){return mo})),n.d(e,\"cubehelix\",(function(){return Io})),n.d(e,\"contours\",(function(){return Ho})),n.d(e,\"contourDensity\",(function(){return Xo})),n.d(e,\"dispatch\",(function(){return ut})),n.d(e,\"drag\",(function(){return ea})),n.d(e,\"dragDisable\",(function(){return Te})),n.d(e,\"dragEnable\",(function(){return Ce})),n.d(e,\"dsvFormat\",(function(){return ca})),n.d(e,\"csvParse\",(function(){return da})),n.d(e,\"csvParseRows\",(function(){return ua})),n.d(e,\"csvFormat\",(function(){return ha})),n.d(e,\"csvFormatBody\",(function(){return pa})),n.d(e,\"csvFormatRows\",(function(){return fa})),n.d(e,\"csvFormatRow\",(function(){return ma})),n.d(e,\"csvFormatValue\",(function(){return ga})),n.d(e,\"tsvParse\",(function(){return ya})),n.d(e,\"tsvParseRows\",(function(){return ba})),n.d(e,\"tsvFormat\",(function(){return _a})),n.d(e,\"tsvFormatBody\",(function(){return xa})),n.d(e,\"tsvFormatRows\",(function(){return wa})),n.d(e,\"tsvFormatRow\",(function(){return Sa})),n.d(e,\"tsvFormatValue\",(function(){return Ma})),n.d(e,\"autoType\",(function(){return Ea})),n.d(e,\"easeLinear\",(function(){return Ca})),n.d(e,\"easeQuad\",(function(){return ka})),n.d(e,\"easeQuadIn\",(function(){return Aa})),n.d(e,\"easeQuadOut\",(function(){return Oa})),n.d(e,\"easeQuadInOut\",(function(){return ka})),n.d(e,\"easeCubic\",(function(){return qi})),n.d(e,\"easeCubicIn\",(function(){return Vi})),n.d(e,\"easeCubicOut\",(function(){return Wi})),n.d(e,\"easeCubicInOut\",(function(){return qi})),n.d(e,\"easePoly\",(function(){return Ra})),n.d(e,\"easePolyIn\",(function(){return La})),n.d(e,\"easePolyOut\",(function(){return Ia})),n.d(e,\"easePolyInOut\",(function(){return Ra})),n.d(e,\"easeSin\",(function(){return ja})),n.d(e,\"easeSinIn\",(function(){return Na})),n.d(e,\"easeSinOut\",(function(){return Fa})),n.d(e,\"easeSinInOut\",(function(){return ja})),n.d(e,\"easeExp\",(function(){return Ua})),n.d(e,\"easeExpIn\",(function(){return Ba})),n.d(e,\"easeExpOut\",(function(){return za})),n.d(e,\"easeExpInOut\",(function(){return Ua})),n.d(e,\"easeCircle\",(function(){return Ga})),n.d(e,\"easeCircleIn\",(function(){return Ha})),n.d(e,\"easeCircleOut\",(function(){return $a})),n.d(e,\"easeCircleInOut\",(function(){return Ga})),n.d(e,\"easeBounce\",(function(){return Wa})),n.d(e,\"easeBounceIn\",(function(){return Va})),n.d(e,\"easeBounceOut\",(function(){return Wa})),n.d(e,\"easeBounceInOut\",(function(){return qa})),n.d(e,\"easeBack\",(function(){return Ka})),n.d(e,\"easeBackIn\",(function(){return Xa})),n.d(e,\"easeBackOut\",(function(){return Ya})),n.d(e,\"easeBackInOut\",(function(){return Ka})),n.d(e,\"easeElastic\",(function(){return Qa})),n.d(e,\"easeElasticIn\",(function(){return Ja})),n.d(e,\"easeElasticOut\",(function(){return Qa})),n.d(e,\"easeElasticInOut\",(function(){return ts})),n.d(e,\"blob\",(function(){return ns})),n.d(e,\"buffer\",(function(){return rs})),n.d(e,\"dsv\",(function(){return cs})),n.d(e,\"csv\",(function(){return ls})),n.d(e,\"tsv\",(function(){return ds})),n.d(e,\"image\",(function(){return us})),n.d(e,\"json\",(function(){return ps})),n.d(e,\"text\",(function(){return as})),n.d(e,\"xml\",(function(){return ms})),n.d(e,\"html\",(function(){return gs})),n.d(e,\"svg\",(function(){return vs})),n.d(e,\"forceCenter\",(function(){return ys})),n.d(e,\"forceCollide\",(function(){return Ls})),n.d(e,\"forceLink\",(function(){return Ps})),n.d(e,\"forceManyBody\",(function(){return Bs})),n.d(e,\"forceRadial\",(function(){return zs})),n.d(e,\"forceSimulation\",(function(){return js})),n.d(e,\"forceX\",(function(){return Us})),n.d(e,\"forceY\",(function(){return Hs})),n.d(e,\"formatDefaultLocale\",(function(){return rc})),n.d(e,\"format\",(function(){return Ks})),n.d(e,\"formatPrefix\",(function(){return Zs})),n.d(e,\"formatLocale\",(function(){return ic})),n.d(e,\"formatSpecifier\",(function(){return Ws})),n.d(e,\"FormatSpecifier\",(function(){return qs})),n.d(e,\"precisionFixed\",(function(){return oc})),n.d(e,\"precisionPrefix\",(function(){return ac})),n.d(e,\"precisionRound\",(function(){return sc})),n.d(e,\"geoArea\",(function(){return Jc})),n.d(e,\"geoBounds\",(function(){return Gl})),n.d(e,\"geoCentroid\",(function(){return nd})),n.d(e,\"geoCircle\",(function(){return pd})),n.d(e,\"geoClipAntimeridian\",(function(){return Ed})),n.d(e,\"geoClipCircle\",(function(){return Td})),n.d(e,\"geoClipExtent\",(function(){return Ld})),n.d(e,\"geoClipRectangle\",(function(){return Cd})),n.d(e,\"geoContains\",(function(){return Yd})),n.d(e,\"geoDistance\",(function(){return zd})),n.d(e,\"geoGraticule\",(function(){return Jd})),n.d(e,\"geoGraticule10\",(function(){return Qd})),n.d(e,\"geoInterpolate\",(function(){return ru})),n.d(e,\"geoLength\",(function(){return Fd})),n.d(e,\"geoPath\",(function(){return nh})),n.d(e,\"geoAlbers\",(function(){return xh})),n.d(e,\"geoAlbersUsa\",(function(){return wh})),n.d(e,\"geoAzimuthalEqualArea\",(function(){return Th})),n.d(e,\"geoAzimuthalEqualAreaRaw\",(function(){return Eh})),n.d(e,\"geoAzimuthalEquidistant\",(function(){return Ah})),n.d(e,\"geoAzimuthalEquidistantRaw\",(function(){return Ch})),n.d(e,\"geoConicConformal\",(function(){return Ph})),n.d(e,\"geoConicConformalRaw\",(function(){return Rh})),n.d(e,\"geoConicEqualArea\",(function(){return _h})),n.d(e,\"geoConicEqualAreaRaw\",(function(){return bh})),n.d(e,\"geoConicEquidistant\",(function(){return jh})),n.d(e,\"geoConicEquidistantRaw\",(function(){return Fh})),n.d(e,\"geoEqualEarth\",(function(){return Vh})),n.d(e,\"geoEqualEarthRaw\",(function(){return Gh})),n.d(e,\"geoEquirectangular\",(function(){return Nh})),n.d(e,\"geoEquirectangularRaw\",(function(){return Dh})),n.d(e,\"geoGnomonic\",(function(){return qh})),n.d(e,\"geoGnomonicRaw\",(function(){return Wh})),n.d(e,\"geoIdentity\",(function(){return Xh})),n.d(e,\"geoProjection\",(function(){return gh})),n.d(e,\"geoProjectionMutator\",(function(){return vh})),n.d(e,\"geoMercator\",(function(){return kh})),n.d(e,\"geoMercatorRaw\",(function(){return Oh})),n.d(e,\"geoNaturalEarth1\",(function(){return Kh})),n.d(e,\"geoNaturalEarth1Raw\",(function(){return Yh})),n.d(e,\"geoOrthographic\",(function(){return Jh})),n.d(e,\"geoOrthographicRaw\",(function(){return Zh})),n.d(e,\"geoStereographic\",(function(){return tp})),n.d(e,\"geoStereographicRaw\",(function(){return Qh})),n.d(e,\"geoTransverseMercator\",(function(){return np})),n.d(e,\"geoTransverseMercatorRaw\",(function(){return ep})),n.d(e,\"geoRotation\",(function(){return dd})),n.d(e,\"geoStream\",(function(){return Gc})),n.d(e,\"geoTransform\",(function(){return ih})),n.d(e,\"cluster\",(function(){return ap})),n.d(e,\"hierarchy\",(function(){return cp})),n.d(e,\"pack\",(function(){return Rp})),n.d(e,\"packSiblings\",(function(){return Cp})),n.d(e,\"packEnclose\",(function(){return fp})),n.d(e,\"partition\",(function(){return Bp})),n.d(e,\"stratify\",(function(){return Gp})),n.d(e,\"tree\",(function(){return Zp})),n.d(e,\"treemap\",(function(){return nf})),n.d(e,\"treemapBinary\",(function(){return rf})),n.d(e,\"treemapDice\",(function(){return jp})),n.d(e,\"treemapSlice\",(function(){return Jp})),n.d(e,\"treemapSliceDice\",(function(){return of})),n.d(e,\"treemapSquarify\",(function(){return ef})),n.d(e,\"treemapResquarify\",(function(){return af})),n.d(e,\"interpolate\",(function(){return On})),n.d(e,\"interpolateArray\",(function(){return bn})),n.d(e,\"interpolateBasis\",(function(){return an})),n.d(e,\"interpolateBasisClosed\",(function(){return sn})),n.d(e,\"interpolateDate\",(function(){return xn})),n.d(e,\"interpolateDiscrete\",(function(){return sf})),n.d(e,\"interpolateHue\",(function(){return cf})),n.d(e,\"interpolateNumber\",(function(){return wn})),n.d(e,\"interpolateNumberArray\",(function(){return vn})),n.d(e,\"interpolateObject\",(function(){return Sn})),n.d(e,\"interpolateRound\",(function(){return lf})),n.d(e,\"interpolateString\",(function(){return An})),n.d(e,\"interpolateTransformCss\",(function(){return hi})),n.d(e,\"interpolateTransformSvg\",(function(){return pi})),n.d(e,\"interpolateZoom\",(function(){return hf})),n.d(e,\"interpolateRgb\",(function(){return pn})),n.d(e,\"interpolateRgbBasis\",(function(){return mn})),n.d(e,\"interpolateRgbBasisClosed\",(function(){return gn})),n.d(e,\"interpolateHsl\",(function(){return ff})),n.d(e,\"interpolateHslLong\",(function(){return mf})),n.d(e,\"interpolateLab\",(function(){return gf})),n.d(e,\"interpolateHcl\",(function(){return yf})),n.d(e,\"interpolateHclLong\",(function(){return bf})),n.d(e,\"interpolateCubehelix\",(function(){return xf})),n.d(e,\"interpolateCubehelixLong\",(function(){return wf})),n.d(e,\"piecewise\",(function(){return Sf})),n.d(e,\"quantize\",(function(){return Mf})),n.d(e,\"path\",(function(){return $r})),n.d(e,\"polygonArea\",(function(){return Ef})),n.d(e,\"polygonCentroid\",(function(){return Tf})),n.d(e,\"polygonHull\",(function(){return Of})),n.d(e,\"polygonContains\",(function(){return kf})),n.d(e,\"polygonLength\",(function(){return Lf})),n.d(e,\"quadtree\",(function(){return Es})),n.d(e,\"randomUniform\",(function(){return Rf})),n.d(e,\"randomNormal\",(function(){return Pf})),n.d(e,\"randomLogNormal\",(function(){return Df})),n.d(e,\"randomBates\",(function(){return Ff})),n.d(e,\"randomIrwinHall\",(function(){return Nf})),n.d(e,\"randomExponential\",(function(){return jf})),n.d(e,\"scaleBand\",(function(){return Wf})),n.d(e,\"scalePoint\",(function(){return Xf})),n.d(e,\"scaleIdentity\",(function(){return cm})),n.d(e,\"scaleLinear\",(function(){return sm})),n.d(e,\"scaleLog\",(function(){return vm})),n.d(e,\"scaleSymlog\",(function(){return xm})),n.d(e,\"scaleOrdinal\",(function(){return Vf})),n.d(e,\"scaleImplicit\",(function(){return Gf})),n.d(e,\"scalePow\",(function(){return Tm})),n.d(e,\"scaleSqrt\",(function(){return Cm})),n.d(e,\"scaleQuantile\",(function(){return Am})),n.d(e,\"scaleQuantize\",(function(){return Om})),n.d(e,\"scaleThreshold\",(function(){return km})),n.d(e,\"scaleTime\",(function(){return sy})),n.d(e,\"scaleUtc\",(function(){return vy})),n.d(e,\"scaleSequential\",(function(){return _y})),n.d(e,\"scaleSequentialLog\",(function(){return xy})),n.d(e,\"scaleSequentialPow\",(function(){return Sy})),n.d(e,\"scaleSequentialSqrt\",(function(){return My})),n.d(e,\"scaleSequentialSymlog\",(function(){return wy})),n.d(e,\"scaleSequentialQuantile\",(function(){return Ey})),n.d(e,\"scaleDiverging\",(function(){return Cy})),n.d(e,\"scaleDivergingLog\",(function(){return Ay})),n.d(e,\"scaleDivergingPow\",(function(){return ky})),n.d(e,\"scaleDivergingSqrt\",(function(){return Ly})),n.d(e,\"scaleDivergingSymlog\",(function(){return Oy})),n.d(e,\"tickFormat\",(function(){return om})),n.d(e,\"schemeCategory10\",(function(){return Ry})),n.d(e,\"schemeAccent\",(function(){return Py})),n.d(e,\"schemeDark2\",(function(){return Dy})),n.d(e,\"schemePaired\",(function(){return Ny})),n.d(e,\"schemePastel1\",(function(){return Fy})),n.d(e,\"schemePastel2\",(function(){return jy})),n.d(e,\"schemeSet1\",(function(){return By})),n.d(e,\"schemeSet2\",(function(){return zy})),n.d(e,\"schemeSet3\",(function(){return Uy})),n.d(e,\"schemeTableau10\",(function(){return Hy})),n.d(e,\"interpolateBrBG\",(function(){return Vy})),n.d(e,\"schemeBrBG\",(function(){return Gy})),n.d(e,\"interpolatePRGn\",(function(){return qy})),n.d(e,\"schemePRGn\",(function(){return Wy})),n.d(e,\"interpolatePiYG\",(function(){return Yy})),n.d(e,\"schemePiYG\",(function(){return Xy})),n.d(e,\"interpolatePuOr\",(function(){return Zy})),n.d(e,\"schemePuOr\",(function(){return Ky})),n.d(e,\"interpolateRdBu\",(function(){return Qy})),n.d(e,\"schemeRdBu\",(function(){return Jy})),n.d(e,\"interpolateRdGy\",(function(){return eb})),n.d(e,\"schemeRdGy\",(function(){return tb})),n.d(e,\"interpolateRdYlBu\",(function(){return ib})),n.d(e,\"schemeRdYlBu\",(function(){return nb})),n.d(e,\"interpolateRdYlGn\",(function(){return ob})),n.d(e,\"schemeRdYlGn\",(function(){return rb})),n.d(e,\"interpolateSpectral\",(function(){return sb})),n.d(e,\"schemeSpectral\",(function(){return ab})),n.d(e,\"interpolateBuGn\",(function(){return lb})),n.d(e,\"schemeBuGn\",(function(){return cb})),n.d(e,\"interpolateBuPu\",(function(){return ub})),n.d(e,\"schemeBuPu\",(function(){return db})),n.d(e,\"interpolateGnBu\",(function(){return pb})),n.d(e,\"schemeGnBu\",(function(){return hb})),n.d(e,\"interpolateOrRd\",(function(){return mb})),n.d(e,\"schemeOrRd\",(function(){return fb})),n.d(e,\"interpolatePuBuGn\",(function(){return vb})),n.d(e,\"schemePuBuGn\",(function(){return gb})),n.d(e,\"interpolatePuBu\",(function(){return bb})),n.d(e,\"schemePuBu\",(function(){return yb})),n.d(e,\"interpolatePuRd\",(function(){return xb})),n.d(e,\"schemePuRd\",(function(){return _b})),n.d(e,\"interpolateRdPu\",(function(){return Sb})),n.d(e,\"schemeRdPu\",(function(){return wb})),n.d(e,\"interpolateYlGnBu\",(function(){return Eb})),n.d(e,\"schemeYlGnBu\",(function(){return Mb})),n.d(e,\"interpolateYlGn\",(function(){return Cb})),n.d(e,\"schemeYlGn\",(function(){return Tb})),n.d(e,\"interpolateYlOrBr\",(function(){return Ob})),n.d(e,\"schemeYlOrBr\",(function(){return Ab})),n.d(e,\"interpolateYlOrRd\",(function(){return Lb})),n.d(e,\"schemeYlOrRd\",(function(){return kb})),n.d(e,\"interpolateBlues\",(function(){return Rb})),n.d(e,\"schemeBlues\",(function(){return Ib})),n.d(e,\"interpolateGreens\",(function(){return Db})),n.d(e,\"schemeGreens\",(function(){return Pb})),n.d(e,\"interpolateGreys\",(function(){return Fb})),n.d(e,\"schemeGreys\",(function(){return Nb})),n.d(e,\"interpolatePurples\",(function(){return Bb})),n.d(e,\"schemePurples\",(function(){return jb})),n.d(e,\"interpolateReds\",(function(){return Ub})),n.d(e,\"schemeReds\",(function(){return zb})),n.d(e,\"interpolateOranges\",(function(){return $b})),n.d(e,\"schemeOranges\",(function(){return Hb})),n.d(e,\"interpolateCividis\",(function(){return Gb})),n.d(e,\"interpolateCubehelixDefault\",(function(){return Vb})),n.d(e,\"interpolateRainbow\",(function(){return Yb})),n.d(e,\"interpolateWarm\",(function(){return Wb})),n.d(e,\"interpolateCool\",(function(){return qb})),n.d(e,\"interpolateSinebow\",(function(){return Qb})),n.d(e,\"interpolateTurbo\",(function(){return t_})),n.d(e,\"interpolateViridis\",(function(){return n_})),n.d(e,\"interpolateMagma\",(function(){return i_})),n.d(e,\"interpolateInferno\",(function(){return r_})),n.d(e,\"interpolatePlasma\",(function(){return o_})),n.d(e,\"create\",(function(){return a_})),n.d(e,\"creator\",(function(){return ie})),n.d(e,\"local\",(function(){return c_})),n.d(e,\"matcher\",(function(){return gt})),n.d(e,\"mouse\",(function(){return Rn})),n.d(e,\"namespace\",(function(){return Mt})),n.d(e,\"namespaces\",(function(){return St})),n.d(e,\"clientPoint\",(function(){return Ln})),n.d(e,\"select\",(function(){return Se})),n.d(e,\"selectAll\",(function(){return d_})),n.d(e,\"selection\",(function(){return we})),n.d(e,\"selector\",(function(){return pt})),n.d(e,\"selectorAll\",(function(){return mt})),n.d(e,\"style\",(function(){return Dt})),n.d(e,\"touch\",(function(){return In})),n.d(e,\"touches\",(function(){return u_})),n.d(e,\"window\",(function(){return Lt})),n.d(e,\"event\",(function(){return le})),n.d(e,\"customEvent\",(function(){return me})),n.d(e,\"arc\",(function(){return I_})),n.d(e,\"area\",(function(){return j_})),n.d(e,\"line\",(function(){return F_})),n.d(e,\"pie\",(function(){return U_})),n.d(e,\"areaRadial\",(function(){return q_})),n.d(e,\"radialArea\",(function(){return q_})),n.d(e,\"lineRadial\",(function(){return W_})),n.d(e,\"radialLine\",(function(){return W_})),n.d(e,\"pointRadial\",(function(){return X_})),n.d(e,\"linkHorizontal\",(function(){return nx})),n.d(e,\"linkVertical\",(function(){return ix})),n.d(e,\"linkRadial\",(function(){return rx})),n.d(e,\"symbol\",(function(){return wx})),n.d(e,\"symbols\",(function(){return xx})),n.d(e,\"symbolCircle\",(function(){return ox})),n.d(e,\"symbolCross\",(function(){return ax})),n.d(e,\"symbolDiamond\",(function(){return lx})),n.d(e,\"symbolSquare\",(function(){return fx})),n.d(e,\"symbolStar\",(function(){return px})),n.d(e,\"symbolTriangle\",(function(){return gx})),n.d(e,\"symbolWye\",(function(){return _x})),n.d(e,\"curveBasisClosed\",(function(){return Ax})),n.d(e,\"curveBasisOpen\",(function(){return kx})),n.d(e,\"curveBasis\",(function(){return Tx})),n.d(e,\"curveBundle\",(function(){return Ix})),n.d(e,\"curveCardinalClosed\",(function(){return Fx})),n.d(e,\"curveCardinalOpen\",(function(){return Bx})),n.d(e,\"curveCardinal\",(function(){return Dx})),n.d(e,\"curveCatmullRomClosed\",(function(){return Gx})),n.d(e,\"curveCatmullRomOpen\",(function(){return Wx})),n.d(e,\"curveCatmullRom\",(function(){return Hx})),n.d(e,\"curveLinearClosed\",(function(){return Xx})),n.d(e,\"curveLinear\",(function(){return P_})),n.d(e,\"curveMonotoneX\",(function(){return nw})),n.d(e,\"curveMonotoneY\",(function(){return iw})),n.d(e,\"curveNatural\",(function(){return aw})),n.d(e,\"curveStep\",(function(){return cw})),n.d(e,\"curveStepAfter\",(function(){return dw})),n.d(e,\"curveStepBefore\",(function(){return lw})),n.d(e,\"stack\",(function(){return fw})),n.d(e,\"stackOffsetExpand\",(function(){return mw})),n.d(e,\"stackOffsetDiverging\",(function(){return gw})),n.d(e,\"stackOffsetNone\",(function(){return uw})),n.d(e,\"stackOffsetSilhouette\",(function(){return vw})),n.d(e,\"stackOffsetWiggle\",(function(){return yw})),n.d(e,\"stackOrderAppearance\",(function(){return bw})),n.d(e,\"stackOrderAscending\",(function(){return xw})),n.d(e,\"stackOrderDescending\",(function(){return Sw})),n.d(e,\"stackOrderInsideOut\",(function(){return Mw})),n.d(e,\"stackOrderNone\",(function(){return hw})),n.d(e,\"stackOrderReverse\",(function(){return Ew})),n.d(e,\"timeInterval\",(function(){return Rm})),n.d(e,\"timeMillisecond\",(function(){return fg})),n.d(e,\"timeMilliseconds\",(function(){return mg})),n.d(e,\"utcMillisecond\",(function(){return fg})),n.d(e,\"utcMilliseconds\",(function(){return mg})),n.d(e,\"timeSecond\",(function(){return ug})),n.d(e,\"timeSeconds\",(function(){return hg})),n.d(e,\"utcSecond\",(function(){return ug})),n.d(e,\"utcSeconds\",(function(){return hg})),n.d(e,\"timeMinute\",(function(){return cg})),n.d(e,\"timeMinutes\",(function(){return lg})),n.d(e,\"timeHour\",(function(){return og})),n.d(e,\"timeHours\",(function(){return ag})),n.d(e,\"timeDay\",(function(){return ng})),n.d(e,\"timeDays\",(function(){return ig})),n.d(e,\"timeWeek\",(function(){return Um})),n.d(e,\"timeWeeks\",(function(){return Xm})),n.d(e,\"timeSunday\",(function(){return Um})),n.d(e,\"timeSundays\",(function(){return Xm})),n.d(e,\"timeMonday\",(function(){return Hm})),n.d(e,\"timeMondays\",(function(){return Ym})),n.d(e,\"timeTuesday\",(function(){return $m})),n.d(e,\"timeTuesdays\",(function(){return Km})),n.d(e,\"timeWednesday\",(function(){return Gm})),n.d(e,\"timeWednesdays\",(function(){return Zm})),n.d(e,\"timeThursday\",(function(){return Vm})),n.d(e,\"timeThursdays\",(function(){return Jm})),n.d(e,\"timeFriday\",(function(){return Wm})),n.d(e,\"timeFridays\",(function(){return Qm})),n.d(e,\"timeSaturday\",(function(){return qm})),n.d(e,\"timeSaturdays\",(function(){return tg})),n.d(e,\"timeMonth\",(function(){return jm})),n.d(e,\"timeMonths\",(function(){return Bm})),n.d(e,\"timeYear\",(function(){return Dm})),n.d(e,\"timeYears\",(function(){return Nm})),n.d(e,\"utcMinute\",(function(){return my})),n.d(e,\"utcMinutes\",(function(){return gy})),n.d(e,\"utcHour\",(function(){return hy})),n.d(e,\"utcHours\",(function(){return py})),n.d(e,\"utcDay\",(function(){return Ig})),n.d(e,\"utcDays\",(function(){return Rg})),n.d(e,\"utcWeek\",(function(){return vg})),n.d(e,\"utcWeeks\",(function(){return Mg})),n.d(e,\"utcSunday\",(function(){return vg})),n.d(e,\"utcSundays\",(function(){return Mg})),n.d(e,\"utcMonday\",(function(){return yg})),n.d(e,\"utcMondays\",(function(){return Eg})),n.d(e,\"utcTuesday\",(function(){return bg})),n.d(e,\"utcTuesdays\",(function(){return Tg})),n.d(e,\"utcWednesday\",(function(){return _g})),n.d(e,\"utcWednesdays\",(function(){return Cg})),n.d(e,\"utcThursday\",(function(){return xg})),n.d(e,\"utcThursdays\",(function(){return Ag})),n.d(e,\"utcFriday\",(function(){return wg})),n.d(e,\"utcFridays\",(function(){return Og})),n.d(e,\"utcSaturday\",(function(){return Sg})),n.d(e,\"utcSaturdays\",(function(){return kg})),n.d(e,\"utcMonth\",(function(){return ly})),n.d(e,\"utcMonths\",(function(){return dy})),n.d(e,\"utcYear\",(function(){return Dg})),n.d(e,\"utcYears\",(function(){return Ng})),n.d(e,\"timeFormatDefaultLocale\",(function(){return iy})),n.d(e,\"timeFormat\",(function(){return Hg})),n.d(e,\"timeParse\",(function(){return $g})),n.d(e,\"utcFormat\",(function(){return Gg})),n.d(e,\"utcParse\",(function(){return Vg})),n.d(e,\"timeFormatLocale\",(function(){return zg})),n.d(e,\"isoFormat\",(function(){return Tw})),n.d(e,\"isoParse\",(function(){return Cw})),n.d(e,\"now\",(function(){return Hn})),n.d(e,\"timer\",(function(){return Vn})),n.d(e,\"timerFlush\",(function(){return Wn})),n.d(e,\"timeout\",(function(){return Kn})),n.d(e,\"interval\",(function(){return Aw})),n.d(e,\"transition\",(function(){return Hi})),n.d(e,\"active\",(function(){return Zi})),n.d(e,\"interrupt\",(function(){return si})),n.d(e,\"voronoi\",(function(){return pS})),n.d(e,\"zoom\",(function(){return CS})),n.d(e,\"zoomTransform\",(function(){return yS})),n.d(e,\"zoomIdentity\",(function(){return vS}));var i=\"5.16.0\",r=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},o=function(t){var e;return 1===t.length&&(e=t,t=function(t,n){return r(e(t),n)}),{left:function(e,n,i,r){for(null==i&&(i=0),null==r&&(r=e.length);i<r;){var o=i+r>>>1;t(e[o],n)<0?i=o+1:r=o}return i},right:function(e,n,i,r){for(null==i&&(i=0),null==r&&(r=e.length);i<r;){var o=i+r>>>1;t(e[o],n)>0?r=o:i=o+1}return i}}};var a=o(r),s=a.right,c=a.left,l=s,d=function(t,e){null==e&&(e=u);for(var n=0,i=t.length-1,r=t[0],o=new Array(i<0?0:i);n<i;)o[n]=e(r,r=t[++n]);return o};function u(t,e){return[t,e]}var h=function(t,e,n){var i,r,o,a,s=t.length,c=e.length,l=new Array(s*c);for(null==n&&(n=u),i=o=0;i<s;++i)for(a=t[i],r=0;r<c;++r,++o)l[o]=n(a,e[r]);return l},p=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},f=function(t){return null===t?NaN:+t},m=function(t,e){var n,i,r=t.length,o=0,a=-1,s=0,c=0;if(null==e)for(;++a<r;)isNaN(n=f(t[a]))||(c+=(i=n-s)*(n-(s+=i/++o)));else for(;++a<r;)isNaN(n=f(e(t[a],a,t)))||(c+=(i=n-s)*(n-(s+=i/++o)));if(o>1)return c/(o-1)},g=function(t,e){var n=m(t,e);return n?Math.sqrt(n):n},v=function(t,e){var n,i,r,o=t.length,a=-1;if(null==e){for(;++a<o;)if(null!=(n=t[a])&&n>=n)for(i=r=n;++a<o;)null!=(n=t[a])&&(i>n&&(i=n),r<n&&(r=n))}else for(;++a<o;)if(null!=(n=e(t[a],a,t))&&n>=n)for(i=r=n;++a<o;)null!=(n=e(t[a],a,t))&&(i>n&&(i=n),r<n&&(r=n));return[i,r]},y=Array.prototype,b=y.slice,_=y.map,x=function(t){return function(){return t}},w=function(t){return t},S=function(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(r);++i<r;)o[i]=t+i*n;return o},M=Math.sqrt(50),E=Math.sqrt(10),T=Math.sqrt(2),C=function(t,e,n){var i,r,o,a,s=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((i=e<t)&&(r=t,t=e,e=r),0===(a=A(t,e,n))||!isFinite(a))return[];if(a>0)for(t=Math.ceil(t/a),e=Math.floor(e/a),o=new Array(r=Math.ceil(e-t+1));++s<r;)o[s]=(t+s)*a;else for(t=Math.floor(t*a),e=Math.ceil(e*a),o=new Array(r=Math.ceil(t-e+1));++s<r;)o[s]=(t-s)/a;return i&&o.reverse(),o};function A(t,e,n){var i=(e-t)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),o=i/Math.pow(10,r);return r>=0?(o>=M?10:o>=E?5:o>=T?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(o>=M?10:o>=E?5:o>=T?2:1)}function O(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),o=i/r;return o>=M?r*=10:o>=E?r*=5:o>=T&&(r*=2),e<t?-r:r}var k=function(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1},L=function(){var t=w,e=v,n=k;function i(i){var r,o,a=i.length,s=new Array(a);for(r=0;r<a;++r)s[r]=t(i[r],r,i);var c=e(s),d=c[0],u=c[1],h=n(s,d,u);Array.isArray(h)||(h=O(d,u,h),h=S(Math.ceil(d/h)*h,u,h));for(var p=h.length;h[0]<=d;)h.shift(),--p;for(;h[p-1]>u;)h.pop(),--p;var f,m=new Array(p+1);for(r=0;r<=p;++r)(f=m[r]=[]).x0=r>0?h[r-1]:d,f.x1=r<p?h[r]:u;for(r=0;r<a;++r)d<=(o=s[r])&&o<=u&&m[l(h,o,0,p)].push(i[r]);return m}return i.value=function(e){return arguments.length?(t=\"function\"==typeof e?e:x(e),i):t},i.domain=function(t){return arguments.length?(e=\"function\"==typeof t?t:x([t[0],t[1]]),i):e},i.thresholds=function(t){return arguments.length?(n=\"function\"==typeof t?t:Array.isArray(t)?x(b.call(t)):x(t),i):n},i},I=function(t,e,n){if(null==n&&(n=f),i=t.length){if((e=+e)<=0||i<2)return+n(t[0],0,t);if(e>=1)return+n(t[i-1],i-1,t);var i,r=(i-1)*e,o=Math.floor(r),a=+n(t[o],o,t);return a+(+n(t[o+1],o+1,t)-a)*(r-o)}},R=function(t,e,n){return t=_.call(t,f).sort(r),Math.ceil((n-e)/(2*(I(t,.75)-I(t,.25))*Math.pow(t.length,-1/3)))},P=function(t,e,n){return Math.ceil((n-e)/(3.5*g(t)*Math.pow(t.length,-1/3)))},D=function(t,e){var n,i,r=t.length,o=-1;if(null==e){for(;++o<r;)if(null!=(n=t[o])&&n>=n)for(i=n;++o<r;)null!=(n=t[o])&&n>i&&(i=n)}else for(;++o<r;)if(null!=(n=e(t[o],o,t))&&n>=n)for(i=n;++o<r;)null!=(n=e(t[o],o,t))&&n>i&&(i=n);return i},N=function(t,e){var n,i=t.length,r=i,o=-1,a=0;if(null==e)for(;++o<i;)isNaN(n=f(t[o]))?--r:a+=n;else for(;++o<i;)isNaN(n=f(e(t[o],o,t)))?--r:a+=n;if(r)return a/r},F=function(t,e){var n,i=t.length,o=-1,a=[];if(null==e)for(;++o<i;)isNaN(n=f(t[o]))||a.push(n);else for(;++o<i;)isNaN(n=f(e(t[o],o,t)))||a.push(n);return I(a.sort(r),.5)},j=function(t){for(var e,n,i,r=t.length,o=-1,a=0;++o<r;)a+=t[o].length;for(n=new Array(a);--r>=0;)for(e=(i=t[r]).length;--e>=0;)n[--a]=i[e];return n},B=function(t,e){var n,i,r=t.length,o=-1;if(null==e){for(;++o<r;)if(null!=(n=t[o])&&n>=n)for(i=n;++o<r;)null!=(n=t[o])&&i>n&&(i=n)}else for(;++o<r;)if(null!=(n=e(t[o],o,t))&&n>=n)for(i=n;++o<r;)null!=(n=e(t[o],o,t))&&i>n&&(i=n);return i},z=function(t,e){for(var n=e.length,i=new Array(n);n--;)i[n]=t[e[n]];return i},U=function(t,e){if(n=t.length){var n,i,o=0,a=0,s=t[a];for(null==e&&(e=r);++o<n;)(e(i=t[o],s)<0||0!==e(s,s))&&(s=i,a=o);return 0===e(s,s)?a:void 0}},H=function(t,e,n){for(var i,r,o=(null==n?t.length:n)-(e=null==e?0:+e);o;)r=Math.random()*o--|0,i=t[o+e],t[o+e]=t[r+e],t[r+e]=i;return t},$=function(t,e){var n,i=t.length,r=-1,o=0;if(null==e)for(;++r<i;)(n=+t[r])&&(o+=n);else for(;++r<i;)(n=+e(t[r],r,t))&&(o+=n);return o},G=function(t){if(!(r=t.length))return[];for(var e=-1,n=B(t,V),i=new Array(n);++e<n;)for(var r,o=-1,a=i[e]=new Array(r);++o<r;)a[o]=t[o][e];return i};function V(t){return t.length}var W=function(){return G(arguments)},q=Array.prototype.slice,X=function(t){return t};function Y(t){return\"translate(\"+(t+.5)+\",0)\"}function K(t){return\"translate(0,\"+(t+.5)+\")\"}function Z(t){return function(e){return+t(e)}}function J(t){var e=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(e=Math.round(e)),function(n){return+t(n)+e}}function Q(){return!this.__axis}function tt(t,e){var n=[],i=null,r=null,o=6,a=6,s=3,c=1===t||4===t?-1:1,l=4===t||2===t?\"x\":\"y\",d=1===t||3===t?Y:K;function u(u){var h=null==i?e.ticks?e.ticks.apply(e,n):e.domain():i,p=null==r?e.tickFormat?e.tickFormat.apply(e,n):X:r,f=Math.max(o,0)+s,m=e.range(),g=+m[0]+.5,v=+m[m.length-1]+.5,y=(e.bandwidth?J:Z)(e.copy()),b=u.selection?u.selection():u,_=b.selectAll(\".domain\").data([null]),x=b.selectAll(\".tick\").data(h,e).order(),w=x.exit(),S=x.enter().append(\"g\").attr(\"class\",\"tick\"),M=x.select(\"line\"),E=x.select(\"text\");_=_.merge(_.enter().insert(\"path\",\".tick\").attr(\"class\",\"domain\").attr(\"stroke\",\"currentColor\")),x=x.merge(S),M=M.merge(S.append(\"line\").attr(\"stroke\",\"currentColor\").attr(l+\"2\",c*o)),E=E.merge(S.append(\"text\").attr(\"fill\",\"currentColor\").attr(l,c*f).attr(\"dy\",1===t?\"0em\":3===t?\"0.71em\":\"0.32em\")),u!==b&&(_=_.transition(u),x=x.transition(u),M=M.transition(u),E=E.transition(u),w=w.transition(u).attr(\"opacity\",1e-6).attr(\"transform\",(function(t){return isFinite(t=y(t))?d(t):this.getAttribute(\"transform\")})),S.attr(\"opacity\",1e-6).attr(\"transform\",(function(t){var e=this.parentNode.__axis;return d(e&&isFinite(e=e(t))?e:y(t))}))),w.remove(),_.attr(\"d\",4===t||2==t?a?\"M\"+c*a+\",\"+g+\"H0.5V\"+v+\"H\"+c*a:\"M0.5,\"+g+\"V\"+v:a?\"M\"+g+\",\"+c*a+\"V0.5H\"+v+\"V\"+c*a:\"M\"+g+\",0.5H\"+v),x.attr(\"opacity\",1).attr(\"transform\",(function(t){return d(y(t))})),M.attr(l+\"2\",c*o),E.attr(l,c*f).text(p),b.filter(Q).attr(\"fill\",\"none\").attr(\"font-size\",10).attr(\"font-family\",\"sans-serif\").attr(\"text-anchor\",2===t?\"start\":4===t?\"end\":\"middle\"),b.each((function(){this.__axis=y}))}return u.scale=function(t){return arguments.length?(e=t,u):e},u.ticks=function(){return n=q.call(arguments),u},u.tickArguments=function(t){return arguments.length?(n=null==t?[]:q.call(t),u):n.slice()},u.tickValues=function(t){return arguments.length?(i=null==t?null:q.call(t),u):i&&i.slice()},u.tickFormat=function(t){return arguments.length?(r=t,u):r},u.tickSize=function(t){return arguments.length?(o=a=+t,u):o},u.tickSizeInner=function(t){return arguments.length?(o=+t,u):o},u.tickSizeOuter=function(t){return arguments.length?(a=+t,u):a},u.tickPadding=function(t){return arguments.length?(s=+t,u):s},u}function et(t){return tt(1,t)}function nt(t){return tt(2,t)}function it(t){return tt(3,t)}function rt(t){return tt(4,t)}var ot={value:function(){}};function at(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+\"\")||t in i||/[\\s.]/.test(t))throw new Error(\"illegal type: \"+t);i[t]=[]}return new st(i)}function st(t){this._=t}function ct(t,e){return t.trim().split(/^|\\s+/).map((function(t){var n=\"\",i=t.indexOf(\".\");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error(\"unknown type: \"+t);return{type:t,name:n}}))}function lt(t,e){for(var n,i=0,r=t.length;i<r;++i)if((n=t[i]).name===e)return n.value}function dt(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=ot,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}st.prototype=at.prototype={constructor:st,on:function(t,e){var n,i=this._,r=ct(t+\"\",i),o=-1,a=r.length;if(!(arguments.length<2)){if(null!=e&&\"function\"!=typeof e)throw new Error(\"invalid callback: \"+e);for(;++o<a;)if(n=(t=r[o]).type)i[n]=dt(i[n],t.name,e);else if(null==e)for(n in i)i[n]=dt(i[n],t.name,null);return this}for(;++o<a;)if((n=(t=r[o]).type)&&(n=lt(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new st(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,r=new Array(n),o=0;o<n;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error(\"unknown type: \"+t);for(o=0,n=(i=this._[t]).length;o<n;++o)i[o].value.apply(e,r)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error(\"unknown type: \"+t);for(var i=this._[t],r=0,o=i.length;r<o;++r)i[r].value.apply(e,n)}};var ut=at;function ht(){}var pt=function(t){return null==t?ht:function(){return this.querySelector(t)}};function ft(){return[]}var mt=function(t){return null==t?ft:function(){return this.querySelectorAll(t)}},gt=function(t){return function(){return this.matches(t)}},vt=function(t){return new Array(t.length)};function yt(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}yt.prototype={constructor:yt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function bt(t,e,n,i,r,o){for(var a,s=0,c=e.length,l=o.length;s<l;++s)(a=e[s])?(a.__data__=o[s],i[s]=a):n[s]=new yt(t,o[s]);for(;s<c;++s)(a=e[s])&&(r[s]=a)}function _t(t,e,n,i,r,o,a){var s,c,l,d={},u=e.length,h=o.length,p=new Array(u);for(s=0;s<u;++s)(c=e[s])&&(p[s]=l=\"$\"+a.call(c,c.__data__,s,e),l in d?r[s]=c:d[l]=c);for(s=0;s<h;++s)(c=d[l=\"$\"+a.call(t,o[s],s,o)])?(i[s]=c,c.__data__=o[s],d[l]=null):n[s]=new yt(t,o[s]);for(s=0;s<u;++s)(c=e[s])&&d[p[s]]===c&&(r[s]=c)}function xt(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var wt=\"http://www.w3.org/1999/xhtml\",St={svg:\"http://www.w3.org/2000/svg\",xhtml:wt,xlink:\"http://www.w3.org/1999/xlink\",xml:\"http://www.w3.org/XML/1998/namespace\",xmlns:\"http://www.w3.org/2000/xmlns/\"},Mt=function(t){var e=t+=\"\",n=e.indexOf(\":\");return n>=0&&\"xmlns\"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),St.hasOwnProperty(e)?{space:St[e],local:t}:t};function Et(t){return function(){this.removeAttribute(t)}}function Tt(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ct(t,e){return function(){this.setAttribute(t,e)}}function At(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Ot(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function kt(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}var Lt=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function It(t){return function(){this.style.removeProperty(t)}}function Rt(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Pt(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function Dt(t,e){return t.style.getPropertyValue(e)||Lt(t).getComputedStyle(t,null).getPropertyValue(e)}function Nt(t){return function(){delete this[t]}}function Ft(t,e){return function(){this[t]=e}}function jt(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function Bt(t){return t.trim().split(/^|\\s+/)}function zt(t){return t.classList||new Ut(t)}function Ut(t){this._node=t,this._names=Bt(t.getAttribute(\"class\")||\"\")}function Ht(t,e){for(var n=zt(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function $t(t,e){for(var n=zt(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function Gt(t){return function(){Ht(this,t)}}function Vt(t){return function(){$t(this,t)}}function Wt(t,e){return function(){(e.apply(this,arguments)?Ht:$t)(this,t)}}Ut.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute(\"class\",this._names.join(\" \")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute(\"class\",this._names.join(\" \")))},contains:function(t){return this._names.indexOf(t)>=0}};function qt(){this.textContent=\"\"}function Xt(t){return function(){this.textContent=t}}function Yt(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?\"\":e}}function Kt(){this.innerHTML=\"\"}function Zt(t){return function(){this.innerHTML=t}}function Jt(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?\"\":e}}function Qt(){this.nextSibling&&this.parentNode.appendChild(this)}function te(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ee(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===wt&&e.documentElement.namespaceURI===wt?e.createElement(t):e.createElementNS(n,t)}}function ne(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}var ie=function(t){var e=Mt(t);return(e.local?ne:ee)(e)};function re(){return null}function oe(){var t=this.parentNode;t&&t.removeChild(this)}function ae(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function se(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}var ce={},le=null;\"undefined\"!=typeof document&&(\"onmouseenter\"in document.documentElement||(ce={mouseenter:\"mouseover\",mouseleave:\"mouseout\"}));function de(t,e,n){return t=ue(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function ue(t,e,n){return function(i){var r=le;le=i;try{t.call(this,this.__data__,e,n)}finally{le=r}}}function he(t){return t.trim().split(/^|\\s+/).map((function(t){var e=\"\",n=t.indexOf(\".\");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function pe(t){return function(){var e=this.__on;if(e){for(var n,i=0,r=-1,o=e.length;i<o;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++r]=n:this.removeEventListener(n.type,n.listener,n.capture);++r?e.length=r:delete this.__on}}}function fe(t,e,n){var i=ce.hasOwnProperty(t.type)?de:ue;return function(r,o,a){var s,c=this.__on,l=i(e,o,a);if(c)for(var d=0,u=c.length;d<u;++d)if((s=c[d]).type===t.type&&s.name===t.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=l,s.capture=n),void(s.value=e);this.addEventListener(t.type,l,n),s={type:t.type,name:t.name,value:e,listener:l,capture:n},c?c.push(s):this.__on=[s]}}function me(t,e,n,i){var r=le;t.sourceEvent=le,le=t;try{return e.apply(n,i)}finally{le=r}}function ge(t,e,n){var i=Lt(t),r=i.CustomEvent;\"function\"==typeof r?r=new r(e,n):(r=i.document.createEvent(\"Event\"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function ve(t,e){return function(){return ge(this,t,e)}}function ye(t,e){return function(){return ge(this,t,e.apply(this,arguments))}}var be=[null];function _e(t,e){this._groups=t,this._parents=e}function xe(){return new _e([[document.documentElement]],be)}_e.prototype=xe.prototype={constructor:_e,select:function(t){\"function\"!=typeof t&&(t=pt(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,a,s=e[r],c=s.length,l=i[r]=new Array(c),d=0;d<c;++d)(o=s[d])&&(a=t.call(o,o.__data__,d,s))&&(\"__data__\"in o&&(a.__data__=o.__data__),l[d]=a);return new _e(i,this._parents)},selectAll:function(t){\"function\"!=typeof t&&(t=mt(t));for(var e=this._groups,n=e.length,i=[],r=[],o=0;o<n;++o)for(var a,s=e[o],c=s.length,l=0;l<c;++l)(a=s[l])&&(i.push(t.call(a,a.__data__,l,s)),r.push(a));return new _e(i,r)},filter:function(t){\"function\"!=typeof t&&(t=gt(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,a=e[r],s=a.length,c=i[r]=[],l=0;l<s;++l)(o=a[l])&&t.call(o,o.__data__,l,a)&&c.push(o);return new _e(i,this._parents)},data:function(t,e){if(!t)return f=new Array(this.size()),d=-1,this.each((function(t){f[++d]=t})),f;var n,i=e?_t:bt,r=this._parents,o=this._groups;\"function\"!=typeof t&&(n=t,t=function(){return n});for(var a=o.length,s=new Array(a),c=new Array(a),l=new Array(a),d=0;d<a;++d){var u=r[d],h=o[d],p=h.length,f=t.call(u,u&&u.__data__,d,r),m=f.length,g=c[d]=new Array(m),v=s[d]=new Array(m);i(u,h,g,v,l[d]=new Array(p),f,e);for(var y,b,_=0,x=0;_<m;++_)if(y=g[_]){for(_>=x&&(x=_+1);!(b=v[x])&&++x<m;);y._next=b||null}}return(s=new _e(s,r))._enter=c,s._exit=l,s},enter:function(){return new _e(this._enter||this._groups.map(vt),this._parents)},exit:function(){return new _e(this._exit||this._groups.map(vt),this._parents)},join:function(t,e,n){var i=this.enter(),r=this,o=this.exit();return i=\"function\"==typeof t?t(i):i.append(t+\"\"),null!=e&&(r=e(r)),null==n?o.remove():n(o),i&&r?i.merge(r).order():r},merge:function(t){for(var e=this._groups,n=t._groups,i=e.length,r=n.length,o=Math.min(i,r),a=new Array(i),s=0;s<o;++s)for(var c,l=e[s],d=n[s],u=l.length,h=a[s]=new Array(u),p=0;p<u;++p)(c=l[p]||d[p])&&(h[p]=c);for(;s<i;++s)a[s]=e[s];return new _e(a,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,r=t[e],o=r.length-1,a=r[o];--o>=0;)(i=r[o])&&(a&&4^i.compareDocumentPosition(a)&&a.parentNode.insertBefore(i,a),a=i);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=xt);for(var n=this._groups,i=n.length,r=new Array(i),o=0;o<i;++o){for(var a,s=n[o],c=s.length,l=r[o]=new Array(c),d=0;d<c;++d)(a=s[d])&&(l[d]=a);l.sort(e)}return new _e(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each((function(){t[++e]=this})),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,o=i.length;r<o;++r){var a=i[r];if(a)return a}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r,o=e[n],a=0,s=o.length;a<s;++a)(r=o[a])&&t.call(r,r.__data__,a,o);return this},attr:function(t,e){var n=Mt(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?Tt:Et:\"function\"==typeof e?n.local?kt:Ot:n.local?At:Ct)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?It:\"function\"==typeof e?Pt:Rt)(t,e,null==n?\"\":n)):Dt(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?Nt:\"function\"==typeof e?jt:Ft)(t,e)):this.node()[t]},classed:function(t,e){var n=Bt(t+\"\");if(arguments.length<2){for(var i=zt(this.node()),r=-1,o=n.length;++r<o;)if(!i.contains(n[r]))return!1;return!0}return this.each((\"function\"==typeof e?Wt:e?Gt:Vt)(n,e))},text:function(t){return arguments.length?this.each(null==t?qt:(\"function\"==typeof t?Yt:Xt)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Kt:(\"function\"==typeof t?Jt:Zt)(t)):this.node().innerHTML},raise:function(){return this.each(Qt)},lower:function(){return this.each(te)},append:function(t){var e=\"function\"==typeof t?t:ie(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n=\"function\"==typeof t?t:ie(t),i=null==e?re:\"function\"==typeof e?e:pt(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)}))},remove:function(){return this.each(oe)},clone:function(t){return this.select(t?se:ae)},datum:function(t){return arguments.length?this.property(\"__data__\",t):this.node().__data__},on:function(t,e,n){var i,r,o=he(t+\"\"),a=o.length;if(!(arguments.length<2)){for(s=e?fe:pe,null==n&&(n=!1),i=0;i<a;++i)this.each(s(o[i],e,n));return this}var s=this.node().__on;if(s)for(var c,l=0,d=s.length;l<d;++l)for(i=0,c=s[l];i<a;++i)if((r=o[i]).type===c.type&&r.name===c.name)return c.value},dispatch:function(t,e){return this.each((\"function\"==typeof e?ye:ve)(t,e))}};var we=xe,Se=function(t){return\"string\"==typeof t?new _e([[document.querySelector(t)]],[document.documentElement]):new _e([[t]],be)};function Me(){le.stopImmediatePropagation()}var Ee=function(){le.preventDefault(),le.stopImmediatePropagation()},Te=function(t){var e=t.document.documentElement,n=Se(t).on(\"dragstart.drag\",Ee,!0);\"onselectstart\"in e?n.on(\"selectstart.drag\",Ee,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect=\"none\")};function Ce(t,e){var n=t.document.documentElement,i=Se(t).on(\"dragstart.drag\",null);e&&(i.on(\"click.drag\",Ee,!0),setTimeout((function(){i.on(\"click.drag\",null)}),0)),\"onselectstart\"in n?i.on(\"selectstart.drag\",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var Ae=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function Oe(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function ke(){}var Le=\"\\\\s*([+-]?\\\\d+)\\\\s*\",Ie=\"\\\\s*([+-]?\\\\d*\\\\.?\\\\d+(?:[eE][+-]?\\\\d+)?)\\\\s*\",Re=\"\\\\s*([+-]?\\\\d*\\\\.?\\\\d+(?:[eE][+-]?\\\\d+)?)%\\\\s*\",Pe=/^#([0-9a-f]{3,8})$/,De=new RegExp(\"^rgb\\\\(\"+[Le,Le,Le]+\"\\\\)$\"),Ne=new RegExp(\"^rgb\\\\(\"+[Re,Re,Re]+\"\\\\)$\"),Fe=new RegExp(\"^rgba\\\\(\"+[Le,Le,Le,Ie]+\"\\\\)$\"),je=new RegExp(\"^rgba\\\\(\"+[Re,Re,Re,Ie]+\"\\\\)$\"),Be=new RegExp(\"^hsl\\\\(\"+[Ie,Re,Re]+\"\\\\)$\"),ze=new RegExp(\"^hsla\\\\(\"+[Ie,Re,Re,Ie]+\"\\\\)$\"),Ue={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function He(){return this.rgb().formatHex()}function $e(){return this.rgb().formatRgb()}function Ge(t){var e,n;return t=(t+\"\").trim().toLowerCase(),(e=Pe.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Ve(e):3===n?new Ye(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?We(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?We(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=De.exec(t))?new Ye(e[1],e[2],e[3],1):(e=Ne.exec(t))?new Ye(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Fe.exec(t))?We(e[1],e[2],e[3],e[4]):(e=je.exec(t))?We(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Be.exec(t))?Qe(e[1],e[2]/100,e[3]/100,1):(e=ze.exec(t))?Qe(e[1],e[2]/100,e[3]/100,e[4]):Ue.hasOwnProperty(t)?Ve(Ue[t]):\"transparent\"===t?new Ye(NaN,NaN,NaN,0):null}function Ve(t){return new Ye(t>>16&255,t>>8&255,255&t,1)}function We(t,e,n,i){return i<=0&&(t=e=n=NaN),new Ye(t,e,n,i)}function qe(t){return t instanceof ke||(t=Ge(t)),t?new Ye((t=t.rgb()).r,t.g,t.b,t.opacity):new Ye}function Xe(t,e,n,i){return 1===arguments.length?qe(t):new Ye(t,e,n,null==i?1:i)}function Ye(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function Ke(){return\"#\"+Je(this.r)+Je(this.g)+Je(this.b)}function Ze(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?\"rgb(\":\"rgba(\")+Math.max(0,Math.min(255,Math.round(this.r)||0))+\", \"+Math.max(0,Math.min(255,Math.round(this.g)||0))+\", \"+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?\")\":\", \"+t+\")\")}function Je(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?\"0\":\"\")+t.toString(16)}function Qe(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new nn(t,e,n,i)}function tn(t){if(t instanceof nn)return new nn(t.h,t.s,t.l,t.opacity);if(t instanceof ke||(t=Ge(t)),!t)return new nn;if(t instanceof nn)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),o=Math.max(e,n,i),a=NaN,s=o-r,c=(o+r)/2;return s?(a=e===o?(n-i)/s+6*(n<i):n===o?(i-e)/s+2:(e-n)/s+4,s/=c<.5?o+r:2-o-r,a*=60):s=c>0&&c<1?0:a,new nn(a,s,c,t.opacity)}function en(t,e,n,i){return 1===arguments.length?tn(t):new nn(t,e,n,null==i?1:i)}function nn(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function rn(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function on(t,e,n,i,r){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*i+a*r)/6}Ae(ke,Ge,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:He,formatHex:He,formatHsl:function(){return tn(this).formatHsl()},formatRgb:$e,toString:$e}),Ae(Ye,Xe,Oe(ke,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Ye(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Ye(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ke,formatHex:Ke,formatRgb:Ze,toString:Ze})),Ae(nn,en,Oe(ke,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new nn(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new nn(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new Ye(rn(t>=240?t-240:t+120,r,i),rn(t,r,i),rn(t<120?t+240:t-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?\"hsl(\":\"hsla(\")+(this.h||0)+\", \"+100*(this.s||0)+\"%, \"+100*(this.l||0)+\"%\"+(1===t?\")\":\", \"+t+\")\")}}));var an=function(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],o=t[i+1],a=i>0?t[i-1]:2*r-o,s=i<e-1?t[i+2]:2*o-r;return on((n-i/e)*e,a,r,o,s)}},sn=function(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),r=t[(i+e-1)%e],o=t[i%e],a=t[(i+1)%e],s=t[(i+2)%e];return on((n-i/e)*e,r,o,a,s)}},cn=function(t){return function(){return t}};function ln(t,e){return function(n){return t+n*e}}function dn(t,e){var n=e-t;return n?ln(t,n>180||n<-180?n-360*Math.round(n/360):n):cn(isNaN(t)?e:t)}function un(t){return 1==(t=+t)?hn:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}(e,n,t):cn(isNaN(e)?n:e)}}function hn(t,e){var n=e-t;return n?ln(t,n):cn(isNaN(t)?e:t)}var pn=function t(e){var n=un(e);function i(t,e){var i=n((t=Xe(t)).r,(e=Xe(e)).r),r=n(t.g,e.g),o=n(t.b,e.b),a=hn(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=r(e),t.b=o(e),t.opacity=a(e),t+\"\"}}return i.gamma=t,i}(1);function fn(t){return function(e){var n,i,r=e.length,o=new Array(r),a=new Array(r),s=new Array(r);for(n=0;n<r;++n)i=Xe(e[n]),o[n]=i.r||0,a[n]=i.g||0,s[n]=i.b||0;return o=t(o),a=t(a),s=t(s),i.opacity=1,function(t){return i.r=o(t),i.g=a(t),i.b=s(t),i+\"\"}}}var mn=fn(an),gn=fn(sn),vn=function(t,e){e||(e=[]);var n,i=t?Math.min(e.length,t.length):0,r=e.slice();return function(o){for(n=0;n<i;++n)r[n]=t[n]*(1-o)+e[n]*o;return r}};function yn(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}var bn=function(t,e){return(yn(e)?vn:_n)(t,e)};function _n(t,e){var n,i=e?e.length:0,r=t?Math.min(i,t.length):0,o=new Array(r),a=new Array(i);for(n=0;n<r;++n)o[n]=On(t[n],e[n]);for(;n<i;++n)a[n]=e[n];return function(t){for(n=0;n<r;++n)a[n]=o[n](t);return a}}var xn=function(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}},wn=function(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}},Sn=function(t,e){var n,i={},r={};for(n in null!==t&&\"object\"==typeof t||(t={}),null!==e&&\"object\"==typeof e||(e={}),e)n in t?i[n]=On(t[n],e[n]):r[n]=e[n];return function(t){for(n in i)r[n]=i[n](t);return r}},Mn=/[-+]?(?:\\d+\\.?\\d*|\\.?\\d+)(?:[eE][-+]?\\d+)?/g,En=new RegExp(Mn.source,\"g\");var Tn,Cn,An=function(t,e){var n,i,r,o=Mn.lastIndex=En.lastIndex=0,a=-1,s=[],c=[];for(t+=\"\",e+=\"\";(n=Mn.exec(t))&&(i=En.exec(e));)(r=i.index)>o&&(r=e.slice(o,r),s[a]?s[a]+=r:s[++a]=r),(n=n[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,c.push({i:a,x:wn(n,i)})),o=En.lastIndex;return o<e.length&&(r=e.slice(o),s[a]?s[a]+=r:s[++a]=r),s.length<2?c[0]?function(t){return function(e){return t(e)+\"\"}}(c[0].x):function(t){return function(){return t}}(e):(e=c.length,function(t){for(var n,i=0;i<e;++i)s[(n=c[i]).i]=n.x(t);return s.join(\"\")})},On=function(t,e){var n,i=typeof e;return null==e||\"boolean\"===i?cn(e):(\"number\"===i?wn:\"string\"===i?(n=Ge(e))?(e=n,pn):An:e instanceof Ge?pn:e instanceof Date?xn:yn(e)?vn:Array.isArray(e)?_n:\"function\"!=typeof e.valueOf&&\"function\"!=typeof e.toString||isNaN(e)?Sn:wn)(t,e)},kn=function(){for(var t,e=le;t=e.sourceEvent;)e=t;return e},Ln=function(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,[(i=i.matrixTransform(t.getScreenCTM().inverse())).x,i.y]}var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]},In=function(t,e,n){arguments.length<3&&(n=e,e=kn().changedTouches);for(var i,r=0,o=e?e.length:0;r<o;++r)if((i=e[r]).identifier===n)return Ln(t,i);return null},Rn=function(t){var e=kn();return e.changedTouches&&(e=e.changedTouches[0]),Ln(t,e)},Pn=0,Dn=0,Nn=0,Fn=0,jn=0,Bn=0,zn=\"object\"==typeof performance&&performance.now?performance:Date,Un=\"object\"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Hn(){return jn||(Un($n),jn=zn.now()+Bn)}function $n(){jn=0}function Gn(){this._call=this._time=this._next=null}function Vn(t,e,n){var i=new Gn;return i.restart(t,e,n),i}function Wn(){Hn(),++Pn;for(var t,e=Tn;e;)(t=jn-e._time)>=0&&e._call.call(null,t),e=e._next;--Pn}function qn(){jn=(Fn=zn.now())+Bn,Pn=Dn=0;try{Wn()}finally{Pn=0,function(){var t,e,n=Tn,i=1/0;for(;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Tn=e);Cn=t,Yn(i)}(),jn=0}}function Xn(){var t=zn.now(),e=t-Fn;e>1e3&&(Bn-=e,Fn=t)}function Yn(t){Pn||(Dn&&(Dn=clearTimeout(Dn)),t-jn>24?(t<1/0&&(Dn=setTimeout(qn,t-zn.now()-Bn)),Nn&&(Nn=clearInterval(Nn))):(Nn||(Fn=zn.now(),Nn=setInterval(Xn,1e3)),Pn=1,Un(qn)))}Gn.prototype=Vn.prototype={constructor:Gn,restart:function(t,e,n){if(\"function\"!=typeof t)throw new TypeError(\"callback is not a function\");n=(null==n?Hn():+n)+(null==e?0:+e),this._next||Cn===this||(Cn?Cn._next=this:Tn=this,Cn=this),this._call=t,this._time=n,Yn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Yn())}};var Kn=function(t,e,n){var i=new Gn;return e=null==e?0:+e,i.restart((function(n){i.stop(),t(n+e)}),e,n),i},Zn=ut(\"start\",\"end\",\"cancel\",\"interrupt\"),Jn=[],Qn=function(t,e,n,i,r,o){var a=t.__transition;if(a){if(n in a)return}else t.__transition={};!function(t,e,n){var i,r=t.__transition;function o(c){var l,d,u,h;if(1!==n.state)return s();for(l in r)if((h=r[l]).name===n.name){if(3===h.state)return Kn(o);4===h.state?(h.state=6,h.timer.stop(),h.on.call(\"interrupt\",t,t.__data__,h.index,h.group),delete r[l]):+l<e&&(h.state=6,h.timer.stop(),h.on.call(\"cancel\",t,t.__data__,h.index,h.group),delete r[l])}if(Kn((function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(c))})),n.state=2,n.on.call(\"start\",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,i=new Array(u=n.tween.length),l=0,d=-1;l<u;++l)(h=n.tween[l].value.call(t,t.__data__,n.index,n.group))&&(i[++d]=h);i.length=d+1}}function a(e){for(var r=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(s),n.state=5,1),o=-1,a=i.length;++o<a;)i[o].call(t,r);5===n.state&&(n.on.call(\"end\",t,t.__data__,n.index,n.group),s())}function s(){for(var i in n.state=6,n.timer.stop(),delete r[e],r)return;delete t.__transition}r[e]=n,n.timer=Vn((function(t){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)}),0,n.time)}(t,n,{name:e,index:i,group:r,on:Zn,tween:Jn,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})};function ti(t,e){var n=ni(t,e);if(n.state>0)throw new Error(\"too late; already scheduled\");return n}function ei(t,e){var n=ni(t,e);if(n.state>3)throw new Error(\"too late; already running\");return n}function ni(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error(\"transition not found\");return n}var ii,ri,oi,ai,si=function(t,e){var n,i,r,o=t.__transition,a=!0;if(o){for(r in e=null==e?null:e+\"\",o)(n=o[r]).name===e?(i=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(i?\"interrupt\":\"cancel\",t,t.__data__,n.index,n.group),delete o[r]):a=!1;a&&delete t.__transition}},ci=180/Math.PI,li={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},di=function(t,e,n,i,r,o){var a,s,c;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(c=t*n+e*i)&&(n-=t*c,i-=e*c),(s=Math.sqrt(n*n+i*i))&&(n/=s,i/=s,c/=s),t*i<e*n&&(t=-t,e=-e,c=-c,a=-a),{translateX:r,translateY:o,rotate:Math.atan2(e,t)*ci,skewX:Math.atan(c)*ci,scaleX:a,scaleY:s}};function ui(t,e,n,i){function r(t){return t.length?t.pop()+\" \":\"\"}return function(o,a){var s=[],c=[];return o=t(o),a=t(a),function(t,i,r,o,a,s){if(t!==r||i!==o){var c=a.push(\"translate(\",null,e,null,n);s.push({i:c-4,x:wn(t,r)},{i:c-2,x:wn(i,o)})}else(r||o)&&a.push(\"translate(\"+r+e+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,c),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(r(n)+\"rotate(\",null,i)-2,x:wn(t,e)})):e&&n.push(r(n)+\"rotate(\"+e+i)}(o.rotate,a.rotate,s,c),function(t,e,n,o){t!==e?o.push({i:n.push(r(n)+\"skewX(\",null,i)-2,x:wn(t,e)}):e&&n.push(r(n)+\"skewX(\"+e+i)}(o.skewX,a.skewX,s,c),function(t,e,n,i,o,a){if(t!==n||e!==i){var s=o.push(r(o)+\"scale(\",null,\",\",null,\")\");a.push({i:s-4,x:wn(t,n)},{i:s-2,x:wn(e,i)})}else 1===n&&1===i||o.push(r(o)+\"scale(\"+n+\",\"+i+\")\")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,c),o=a=null,function(t){for(var e,n=-1,i=c.length;++n<i;)s[(e=c[n]).i]=e.x(t);return s.join(\"\")}}}var hi=ui((function(t){return\"none\"===t?li:(ii||(ii=document.createElement(\"DIV\"),ri=document.documentElement,oi=document.defaultView),ii.style.transform=t,t=oi.getComputedStyle(ri.appendChild(ii),null).getPropertyValue(\"transform\"),ri.removeChild(ii),t=t.slice(7,-1).split(\",\"),di(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}),\"px, \",\"px)\",\"deg)\"),pi=ui((function(t){return null==t?li:(ai||(ai=document.createElementNS(\"http://www.w3.org/2000/svg\",\"g\")),ai.setAttribute(\"transform\",t),(t=ai.transform.baseVal.consolidate())?(t=t.matrix,di(t.a,t.b,t.c,t.d,t.e,t.f)):li)}),\", \",\")\",\")\");function fi(t,e){var n,i;return function(){var r=ei(this,t),o=r.tween;if(o!==n)for(var a=0,s=(i=n=o).length;a<s;++a)if(i[a].name===e){(i=i.slice()).splice(a,1);break}r.tween=i}}function mi(t,e,n){var i,r;if(\"function\"!=typeof n)throw new Error;return function(){var o=ei(this,t),a=o.tween;if(a!==i){r=(i=a).slice();for(var s={name:e,value:n},c=0,l=r.length;c<l;++c)if(r[c].name===e){r[c]=s;break}c===l&&r.push(s)}o.tween=r}}function gi(t,e,n){var i=t._id;return t.each((function(){var t=ei(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return ni(t,i).value[e]}}var vi=function(t,e){var n;return(\"number\"==typeof e?wn:e instanceof Ge?pn:(n=Ge(e))?(e=n,pn):An)(t,e)};function yi(t){return function(){this.removeAttribute(t)}}function bi(t){return function(){this.removeAttributeNS(t.space,t.local)}}function _i(t,e,n){var i,r,o=n+\"\";return function(){var a=this.getAttribute(t);return a===o?null:a===i?r:r=e(i=a,n)}}function xi(t,e,n){var i,r,o=n+\"\";return function(){var a=this.getAttributeNS(t.space,t.local);return a===o?null:a===i?r:r=e(i=a,n)}}function wi(t,e,n){var i,r,o;return function(){var a,s,c=n(this);if(null!=c)return(a=this.getAttribute(t))===(s=c+\"\")?null:a===i&&s===r?o:(r=s,o=e(i=a,c));this.removeAttribute(t)}}function Si(t,e,n){var i,r,o;return function(){var a,s,c=n(this);if(null!=c)return(a=this.getAttributeNS(t.space,t.local))===(s=c+\"\")?null:a===i&&s===r?o:(r=s,o=e(i=a,c));this.removeAttributeNS(t.space,t.local)}}function Mi(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Ei(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Ti(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&Ei(t,r)),n}return r._value=e,r}function Ci(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&Mi(t,r)),n}return r._value=e,r}function Ai(t,e){return function(){ti(this,t).delay=+e.apply(this,arguments)}}function Oi(t,e){return e=+e,function(){ti(this,t).delay=e}}function ki(t,e){return function(){ei(this,t).duration=+e.apply(this,arguments)}}function Li(t,e){return e=+e,function(){ei(this,t).duration=e}}function Ii(t,e){if(\"function\"!=typeof e)throw new Error;return function(){ei(this,t).ease=e}}function Ri(t,e,n){var i,r,o=function(t){return(t+\"\").trim().split(/^|\\s+/).every((function(t){var e=t.indexOf(\".\");return e>=0&&(t=t.slice(0,e)),!t||\"start\"===t}))}(e)?ti:ei;return function(){var a=o(this,t),s=a.on;s!==i&&(r=(i=s).copy()).on(e,n),a.on=r}}var Pi=we.prototype.constructor;function Di(t){return function(){this.style.removeProperty(t)}}function Ni(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function Fi(t,e,n){var i,r;function o(){var o=e.apply(this,arguments);return o!==r&&(i=(r=o)&&Ni(t,o,n)),i}return o._value=e,o}function ji(t){return function(e){this.textContent=t.call(this,e)}}function Bi(t){var e,n;function i(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&ji(i)),e}return i._value=t,i}var zi=0;function Ui(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function Hi(t){return we().transition(t)}function $i(){return++zi}var Gi=we.prototype;function Vi(t){return t*t*t}function Wi(t){return--t*t*t+1}function qi(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}Ui.prototype=Hi.prototype={constructor:Ui,select:function(t){var e=this._name,n=this._id;\"function\"!=typeof t&&(t=pt(t));for(var i=this._groups,r=i.length,o=new Array(r),a=0;a<r;++a)for(var s,c,l=i[a],d=l.length,u=o[a]=new Array(d),h=0;h<d;++h)(s=l[h])&&(c=t.call(s,s.__data__,h,l))&&(\"__data__\"in s&&(c.__data__=s.__data__),u[h]=c,Qn(u[h],e,n,h,u,ni(s,n)));return new Ui(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;\"function\"!=typeof t&&(t=mt(t));for(var i=this._groups,r=i.length,o=[],a=[],s=0;s<r;++s)for(var c,l=i[s],d=l.length,u=0;u<d;++u)if(c=l[u]){for(var h,p=t.call(c,c.__data__,u,l),f=ni(c,n),m=0,g=p.length;m<g;++m)(h=p[m])&&Qn(h,e,n,m,p,f);o.push(p),a.push(c)}return new Ui(o,a,e,n)},filter:function(t){\"function\"!=typeof t&&(t=gt(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,a=e[r],s=a.length,c=i[r]=[],l=0;l<s;++l)(o=a[l])&&t.call(o,o.__data__,l,a)&&c.push(o);return new Ui(i,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,o=Math.min(i,r),a=new Array(i),s=0;s<o;++s)for(var c,l=e[s],d=n[s],u=l.length,h=a[s]=new Array(u),p=0;p<u;++p)(c=l[p]||d[p])&&(h[p]=c);for(;s<i;++s)a[s]=e[s];return new Ui(a,this._parents,this._name,this._id)},selection:function(){return new Pi(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=$i(),i=this._groups,r=i.length,o=0;o<r;++o)for(var a,s=i[o],c=s.length,l=0;l<c;++l)if(a=s[l]){var d=ni(a,e);Qn(a,t,n,l,s,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new Ui(i,this._parents,t,n)},call:Gi.call,nodes:Gi.nodes,node:Gi.node,size:Gi.size,empty:Gi.empty,each:Gi.each,on:function(t,e){var n=this._id;return arguments.length<2?ni(this.node(),n).on.on(t):this.each(Ri(n,t,e))},attr:function(t,e){var n=Mt(t),i=\"transform\"===n?pi:vi;return this.attrTween(t,\"function\"==typeof e?(n.local?Si:wi)(n,i,gi(this,\"attr.\"+t,e)):null==e?(n.local?bi:yi)(n):(n.local?xi:_i)(n,i,e))},attrTween:function(t,e){var n=\"attr.\"+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if(\"function\"!=typeof e)throw new Error;var i=Mt(t);return this.tween(n,(i.local?Ti:Ci)(i,e))},style:function(t,e,n){var i=\"transform\"==(t+=\"\")?hi:vi;return null==e?this.styleTween(t,function(t,e){var n,i,r;return function(){var o=Dt(this,t),a=(this.style.removeProperty(t),Dt(this,t));return o===a?null:o===n&&a===i?r:r=e(n=o,i=a)}}(t,i)).on(\"end.style.\"+t,Di(t)):\"function\"==typeof e?this.styleTween(t,function(t,e,n){var i,r,o;return function(){var a=Dt(this,t),s=n(this),c=s+\"\";return null==s&&(this.style.removeProperty(t),c=s=Dt(this,t)),a===c?null:a===i&&c===r?o:(r=c,o=e(i=a,s))}}(t,i,gi(this,\"style.\"+t,e))).each(function(t,e){var n,i,r,o,a=\"style.\"+e,s=\"end.\"+a;return function(){var c=ei(this,t),l=c.on,d=null==c.value[a]?o||(o=Di(e)):void 0;l===n&&r===d||(i=(n=l).copy()).on(s,r=d),c.on=i}}(this._id,t)):this.styleTween(t,function(t,e,n){var i,r,o=n+\"\";return function(){var a=Dt(this,t);return a===o?null:a===i?r:r=e(i=a,n)}}(t,i,e),n).on(\"end.style.\"+t,null)},styleTween:function(t,e,n){var i=\"style.\"+(t+=\"\");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if(\"function\"!=typeof e)throw new Error;return this.tween(i,Fi(t,e,null==n?\"\":n))},text:function(t){return this.tween(\"text\",\"function\"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?\"\":e}}(gi(this,\"text\",t)):function(t){return function(){this.textContent=t}}(null==t?\"\":t+\"\"))},textTween:function(t){var e=\"text\";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if(\"function\"!=typeof t)throw new Error;return this.tween(e,Bi(t))},remove:function(){return this.on(\"end.remove\",(t=this._id,function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}));var t},tween:function(t,e){var n=this._id;if(t+=\"\",arguments.length<2){for(var i,r=ni(this.node(),n).tween,o=0,a=r.length;o<a;++o)if((i=r[o]).name===t)return i.value;return null}return this.each((null==e?fi:mi)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each((\"function\"==typeof t?Ai:Oi)(e,t)):ni(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each((\"function\"==typeof t?ki:Li)(e,t)):ni(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(Ii(e,t)):ni(this.node(),e).ease},end:function(){var t,e,n=this,i=n._id,r=n.size();return new Promise((function(o,a){var s={value:a},c={value:function(){0==--r&&o()}};n.each((function(){var n=ei(this,i),r=n.on;r!==t&&((e=(t=r).copy())._.cancel.push(s),e._.interrupt.push(s),e._.end.push(c)),n.on=e}))}))}};var Xi={time:null,delay:0,duration:250,ease:qi};function Yi(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return Xi.time=Hn(),Xi;return n}we.prototype.interrupt=function(t){return this.each((function(){si(this,t)}))},we.prototype.transition=function(t){var e,n;t instanceof Ui?(e=t._id,t=t._name):(e=$i(),(n=Xi).time=Hn(),t=null==t?null:t+\"\");for(var i=this._groups,r=i.length,o=0;o<r;++o)for(var a,s=i[o],c=s.length,l=0;l<c;++l)(a=s[l])&&Qn(a,t,e,l,s,n||Yi(a,e));return new Ui(i,this._parents,t,e)};var Ki=[null],Zi=function(t,e){var n,i,r=t.__transition;if(r)for(i in e=null==e?null:e+\"\",r)if((n=r[i]).state>1&&n.name===e)return new Ui([[t]],Ki,e,+i);return null},Ji=function(t){return function(){return t}},Qi=function(t,e,n){this.target=t,this.type=e,this.selection=n};function tr(){le.stopImmediatePropagation()}var er=function(){le.preventDefault(),le.stopImmediatePropagation()},nr={name:\"drag\"},ir={name:\"space\"},rr={name:\"handle\"},or={name:\"center\"};function ar(t){return[+t[0],+t[1]]}function sr(t){return[ar(t[0]),ar(t[1])]}function cr(t){return function(e){return In(e,le.touches,t)}}var lr={name:\"x\",handles:[\"w\",\"e\"].map(vr),input:function(t,e){return null==t?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},dr={name:\"y\",handles:[\"n\",\"s\"].map(vr),input:function(t,e){return null==t?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},ur={name:\"xy\",handles:[\"n\",\"w\",\"e\",\"s\",\"nw\",\"ne\",\"sw\",\"se\"].map(vr),input:function(t){return null==t?null:sr(t)},output:function(t){return t}},hr={overlay:\"crosshair\",selection:\"move\",n:\"ns-resize\",e:\"ew-resize\",s:\"ns-resize\",w:\"ew-resize\",nw:\"nwse-resize\",ne:\"nesw-resize\",se:\"nwse-resize\",sw:\"nesw-resize\"},pr={e:\"w\",w:\"e\",nw:\"ne\",ne:\"nw\",se:\"sw\",sw:\"se\"},fr={n:\"s\",s:\"n\",nw:\"sw\",ne:\"se\",se:\"ne\",sw:\"nw\"},mr={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},gr={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function vr(t){return{type:t}}function yr(){return!le.ctrlKey&&!le.button}function br(){var t=this.ownerSVGElement||this;return t.hasAttribute(\"viewBox\")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function _r(){return navigator.maxTouchPoints||\"ontouchstart\"in this}function xr(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function wr(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function Sr(t){var e=t.__brush;return e?e.dim.output(e.selection):null}function Mr(){return Cr(lr)}function Er(){return Cr(dr)}var Tr=function(){return Cr(ur)};function Cr(t){var e,n=br,i=yr,r=_r,o=!0,a=ut(\"start\",\"brush\",\"end\"),s=6;function c(e){var n=e.property(\"__brush\",m).selectAll(\".overlay\").data([vr(\"overlay\")]);n.enter().append(\"rect\").attr(\"class\",\"overlay\").attr(\"pointer-events\",\"all\").attr(\"cursor\",hr.overlay).merge(n).each((function(){var t=xr(this).extent;Se(this).attr(\"x\",t[0][0]).attr(\"y\",t[0][1]).attr(\"width\",t[1][0]-t[0][0]).attr(\"height\",t[1][1]-t[0][1])})),e.selectAll(\".selection\").data([vr(\"selection\")]).enter().append(\"rect\").attr(\"class\",\"selection\").attr(\"cursor\",hr.selection).attr(\"fill\",\"#777\").attr(\"fill-opacity\",.3).attr(\"stroke\",\"#fff\").attr(\"shape-rendering\",\"crispEdges\");var i=e.selectAll(\".handle\").data(t.handles,(function(t){return t.type}));i.exit().remove(),i.enter().append(\"rect\").attr(\"class\",(function(t){return\"handle handle--\"+t.type})).attr(\"cursor\",(function(t){return hr[t.type]})),e.each(l).attr(\"fill\",\"none\").attr(\"pointer-events\",\"all\").on(\"mousedown.brush\",h).filter(r).on(\"touchstart.brush\",h).on(\"touchmove.brush\",p).on(\"touchend.brush touchcancel.brush\",f).style(\"touch-action\",\"none\").style(\"-webkit-tap-highlight-color\",\"rgba(0,0,0,0)\")}function l(){var t=Se(this),e=xr(this).selection;e?(t.selectAll(\".selection\").style(\"display\",null).attr(\"x\",e[0][0]).attr(\"y\",e[0][1]).attr(\"width\",e[1][0]-e[0][0]).attr(\"height\",e[1][1]-e[0][1]),t.selectAll(\".handle\").style(\"display\",null).attr(\"x\",(function(t){return\"e\"===t.type[t.type.length-1]?e[1][0]-s/2:e[0][0]-s/2})).attr(\"y\",(function(t){return\"s\"===t.type[0]?e[1][1]-s/2:e[0][1]-s/2})).attr(\"width\",(function(t){return\"n\"===t.type||\"s\"===t.type?e[1][0]-e[0][0]+s:s})).attr(\"height\",(function(t){return\"e\"===t.type||\"w\"===t.type?e[1][1]-e[0][1]+s:s}))):t.selectAll(\".selection,.handle\").style(\"display\",\"none\").attr(\"x\",null).attr(\"y\",null).attr(\"width\",null).attr(\"height\",null)}function d(t,e,n){return!n&&t.__brush.emitter||new u(t,e)}function u(t,e){this.that=t,this.args=e,this.state=t.__brush,this.active=0}function h(){if((!e||le.touches)&&i.apply(this,arguments)){var n,r,a,s,c,u,h,p,f,m,g,v=this,y=le.target.__data__.type,b=\"selection\"===(o&&le.metaKey?y=\"overlay\":y)?nr:o&&le.altKey?or:rr,_=t===dr?null:mr[y],x=t===lr?null:gr[y],w=xr(v),S=w.extent,M=w.selection,E=S[0][0],T=S[0][1],C=S[1][0],A=S[1][1],O=0,k=0,L=_&&x&&o&&le.shiftKey,I=le.touches?cr(le.changedTouches[0].identifier):Rn,R=I(v),P=R,D=d(v,arguments,!0).beforestart();\"overlay\"===y?(M&&(f=!0),w.selection=M=[[n=t===dr?E:R[0],a=t===lr?T:R[1]],[c=t===dr?C:n,h=t===lr?A:a]]):(n=M[0][0],a=M[0][1],c=M[1][0],h=M[1][1]),r=n,s=a,u=c,p=h;var N=Se(v).attr(\"pointer-events\",\"none\"),F=N.selectAll(\".overlay\").attr(\"cursor\",hr[y]);if(le.touches)D.moved=B,D.ended=U;else{var j=Se(le.view).on(\"mousemove.brush\",B,!0).on(\"mouseup.brush\",U,!0);o&&j.on(\"keydown.brush\",H,!0).on(\"keyup.brush\",$,!0),Te(le.view)}tr(),si(v),l.call(v),D.start()}function B(){var t=I(v);!L||m||g||(Math.abs(t[0]-P[0])>Math.abs(t[1]-P[1])?g=!0:m=!0),P=t,f=!0,er(),z()}function z(){var t;switch(O=P[0]-R[0],k=P[1]-R[1],b){case ir:case nr:_&&(O=Math.max(E-n,Math.min(C-c,O)),r=n+O,u=c+O),x&&(k=Math.max(T-a,Math.min(A-h,k)),s=a+k,p=h+k);break;case rr:_<0?(O=Math.max(E-n,Math.min(C-n,O)),r=n+O,u=c):_>0&&(O=Math.max(E-c,Math.min(C-c,O)),r=n,u=c+O),x<0?(k=Math.max(T-a,Math.min(A-a,k)),s=a+k,p=h):x>0&&(k=Math.max(T-h,Math.min(A-h,k)),s=a,p=h+k);break;case or:_&&(r=Math.max(E,Math.min(C,n-O*_)),u=Math.max(E,Math.min(C,c+O*_))),x&&(s=Math.max(T,Math.min(A,a-k*x)),p=Math.max(T,Math.min(A,h+k*x)))}u<r&&(_*=-1,t=n,n=c,c=t,t=r,r=u,u=t,y in pr&&F.attr(\"cursor\",hr[y=pr[y]])),p<s&&(x*=-1,t=a,a=h,h=t,t=s,s=p,p=t,y in fr&&F.attr(\"cursor\",hr[y=fr[y]])),w.selection&&(M=w.selection),m&&(r=M[0][0],u=M[1][0]),g&&(s=M[0][1],p=M[1][1]),M[0][0]===r&&M[0][1]===s&&M[1][0]===u&&M[1][1]===p||(w.selection=[[r,s],[u,p]],l.call(v),D.brush())}function U(){if(tr(),le.touches){if(le.touches.length)return;e&&clearTimeout(e),e=setTimeout((function(){e=null}),500)}else Ce(le.view,f),j.on(\"keydown.brush keyup.brush mousemove.brush mouseup.brush\",null);N.attr(\"pointer-events\",\"all\"),F.attr(\"cursor\",hr.overlay),w.selection&&(M=w.selection),wr(M)&&(w.selection=null,l.call(v)),D.end()}function H(){switch(le.keyCode){case 16:L=_&&x;break;case 18:b===rr&&(_&&(c=u-O*_,n=r+O*_),x&&(h=p-k*x,a=s+k*x),b=or,z());break;case 32:b!==rr&&b!==or||(_<0?c=u-O:_>0&&(n=r-O),x<0?h=p-k:x>0&&(a=s-k),b=ir,F.attr(\"cursor\",hr.selection),z());break;default:return}er()}function $(){switch(le.keyCode){case 16:L&&(m=g=L=!1,z());break;case 18:b===or&&(_<0?c=u:_>0&&(n=r),x<0?h=p:x>0&&(a=s),b=rr,z());break;case 32:b===ir&&(le.altKey?(_&&(c=u-O*_,n=r+O*_),x&&(h=p-k*x,a=s+k*x),b=or):(_<0?c=u:_>0&&(n=r),x<0?h=p:x>0&&(a=s),b=rr),F.attr(\"cursor\",hr[y]),z());break;default:return}er()}}function p(){d(this,arguments).moved()}function f(){d(this,arguments).ended()}function m(){var e=this.__brush||{selection:null};return e.extent=sr(n.apply(this,arguments)),e.dim=t,e}return c.move=function(e,n){e.selection?e.on(\"start.brush\",(function(){d(this,arguments).beforestart().start()})).on(\"interrupt.brush end.brush\",(function(){d(this,arguments).end()})).tween(\"brush\",(function(){var e=this,i=e.__brush,r=d(e,arguments),o=i.selection,a=t.input(\"function\"==typeof n?n.apply(this,arguments):n,i.extent),s=On(o,a);function c(t){i.selection=1===t&&null===a?null:s(t),l.call(e),r.brush()}return null!==o&&null!==a?c:c(1)})):e.each((function(){var e=this,i=arguments,r=e.__brush,o=t.input(\"function\"==typeof n?n.apply(e,i):n,r.extent),a=d(e,i).beforestart();si(e),r.selection=null===o?null:o,l.call(e),a.start().brush().end()}))},c.clear=function(t){c.move(t,null)},u.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting?(this.starting=!1,this.emit(\"start\")):this.emit(\"brush\"),this},brush:function(){return this.emit(\"brush\"),this},end:function(){return 0==--this.active&&(delete this.state.emitter,this.emit(\"end\")),this},emit:function(e){me(new Qi(c,e,t.output(this.state.selection)),a.apply,a,[e,this.that,this.args])}},c.extent=function(t){return arguments.length?(n=\"function\"==typeof t?t:Ji(sr(t)),c):n},c.filter=function(t){return arguments.length?(i=\"function\"==typeof t?t:Ji(!!t),c):i},c.touchable=function(t){return arguments.length?(r=\"function\"==typeof t?t:Ji(!!t),c):r},c.handleSize=function(t){return arguments.length?(s=+t,c):s},c.keyModifiers=function(t){return arguments.length?(o=!!t,c):o},c.on=function(){var t=a.on.apply(a,arguments);return t===a?c:t},c}var Ar=Math.cos,Or=Math.sin,kr=Math.PI,Lr=kr/2,Ir=2*kr,Rr=Math.max;function Pr(t){return function(e,n){return t(e.source.value+e.target.value,n.source.value+n.target.value)}}var Dr=function(){var t=0,e=null,n=null,i=null;function r(r){var o,a,s,c,l,d,u=r.length,h=[],p=S(u),f=[],m=[],g=m.groups=new Array(u),v=new Array(u*u);for(o=0,l=-1;++l<u;){for(a=0,d=-1;++d<u;)a+=r[l][d];h.push(a),f.push(S(u)),o+=a}for(e&&p.sort((function(t,n){return e(h[t],h[n])})),n&&f.forEach((function(t,e){t.sort((function(t,i){return n(r[e][t],r[e][i])}))})),c=(o=Rr(0,Ir-t*u)/o)?t:Ir/u,a=0,l=-1;++l<u;){for(s=a,d=-1;++d<u;){var y=p[l],b=f[y][d],_=r[y][b],x=a,w=a+=_*o;v[b*u+y]={index:y,subindex:b,startAngle:x,endAngle:w,value:_}}g[y]={index:y,startAngle:s,endAngle:a,value:h[y]},a+=c}for(l=-1;++l<u;)for(d=l-1;++d<u;){var M=v[d*u+l],E=v[l*u+d];(M.value||E.value)&&m.push(M.value<E.value?{source:E,target:M}:{source:M,target:E})}return i?m.sort(i):m}return r.padAngle=function(e){return arguments.length?(t=Rr(0,e),r):t},r.sortGroups=function(t){return arguments.length?(e=t,r):e},r.sortSubgroups=function(t){return arguments.length?(n=t,r):n},r.sortChords=function(t){return arguments.length?(null==t?i=null:(i=Pr(t))._=t,r):i&&i._},r},Nr=Array.prototype.slice,Fr=function(t){return function(){return t}},jr=Math.PI,Br=2*jr,zr=Br-1e-6;function Ur(){this._x0=this._y0=this._x1=this._y1=null,this._=\"\"}function Hr(){return new Ur}Ur.prototype=Hr.prototype={constructor:Ur,moveTo:function(t,e){this._+=\"M\"+(this._x0=this._x1=+t)+\",\"+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+=\"Z\")},lineTo:function(t,e){this._+=\"L\"+(this._x1=+t)+\",\"+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+=\"Q\"+ +t+\",\"+ +e+\",\"+(this._x1=+n)+\",\"+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,r,o){this._+=\"C\"+ +t+\",\"+ +e+\",\"+ +n+\",\"+ +i+\",\"+(this._x1=+r)+\",\"+(this._y1=+o)},arcTo:function(t,e,n,i,r){t=+t,e=+e,n=+n,i=+i,r=+r;var o=this._x1,a=this._y1,s=n-t,c=i-e,l=o-t,d=a-e,u=l*l+d*d;if(r<0)throw new Error(\"negative radius: \"+r);if(null===this._x1)this._+=\"M\"+(this._x1=t)+\",\"+(this._y1=e);else if(u>1e-6)if(Math.abs(d*s-c*l)>1e-6&&r){var h=n-o,p=i-a,f=s*s+c*c,m=h*h+p*p,g=Math.sqrt(f),v=Math.sqrt(u),y=r*Math.tan((jr-Math.acos((f+u-m)/(2*g*v)))/2),b=y/v,_=y/g;Math.abs(b-1)>1e-6&&(this._+=\"L\"+(t+b*l)+\",\"+(e+b*d)),this._+=\"A\"+r+\",\"+r+\",0,0,\"+ +(d*h>l*p)+\",\"+(this._x1=t+_*s)+\",\"+(this._y1=e+_*c)}else this._+=\"L\"+(this._x1=t)+\",\"+(this._y1=e);else;},arc:function(t,e,n,i,r,o){t=+t,e=+e,o=!!o;var a=(n=+n)*Math.cos(i),s=n*Math.sin(i),c=t+a,l=e+s,d=1^o,u=o?i-r:r-i;if(n<0)throw new Error(\"negative radius: \"+n);null===this._x1?this._+=\"M\"+c+\",\"+l:(Math.abs(this._x1-c)>1e-6||Math.abs(this._y1-l)>1e-6)&&(this._+=\"L\"+c+\",\"+l),n&&(u<0&&(u=u%Br+Br),u>zr?this._+=\"A\"+n+\",\"+n+\",0,1,\"+d+\",\"+(t-a)+\",\"+(e-s)+\"A\"+n+\",\"+n+\",0,1,\"+d+\",\"+(this._x1=c)+\",\"+(this._y1=l):u>1e-6&&(this._+=\"A\"+n+\",\"+n+\",0,\"+ +(u>=jr)+\",\"+d+\",\"+(this._x1=t+n*Math.cos(r))+\",\"+(this._y1=e+n*Math.sin(r))))},rect:function(t,e,n,i){this._+=\"M\"+(this._x0=this._x1=+t)+\",\"+(this._y0=this._y1=+e)+\"h\"+ +n+\"v\"+ +i+\"h\"+-n+\"Z\"},toString:function(){return this._}};var $r=Hr;function Gr(t){return t.source}function Vr(t){return t.target}function Wr(t){return t.radius}function qr(t){return t.startAngle}function Xr(t){return t.endAngle}var Yr=function(){var t=Gr,e=Vr,n=Wr,i=qr,r=Xr,o=null;function a(){var a,s=Nr.call(arguments),c=t.apply(this,s),l=e.apply(this,s),d=+n.apply(this,(s[0]=c,s)),u=i.apply(this,s)-Lr,h=r.apply(this,s)-Lr,p=d*Ar(u),f=d*Or(u),m=+n.apply(this,(s[0]=l,s)),g=i.apply(this,s)-Lr,v=r.apply(this,s)-Lr;if(o||(o=a=$r()),o.moveTo(p,f),o.arc(0,0,d,u,h),u===g&&h===v||(o.quadraticCurveTo(0,0,m*Ar(g),m*Or(g)),o.arc(0,0,m,g,v)),o.quadraticCurveTo(0,0,p,f),o.closePath(),a)return o=null,a+\"\"||null}return a.radius=function(t){return arguments.length?(n=\"function\"==typeof t?t:Fr(+t),a):n},a.startAngle=function(t){return arguments.length?(i=\"function\"==typeof t?t:Fr(+t),a):i},a.endAngle=function(t){return arguments.length?(r=\"function\"==typeof t?t:Fr(+t),a):r},a.source=function(e){return arguments.length?(t=e,a):t},a.target=function(t){return arguments.length?(e=t,a):e},a.context=function(t){return arguments.length?(o=null==t?null:t,a):o},a};function Kr(){}function Zr(t,e){var n=new Kr;if(t instanceof Kr)t.each((function(t,e){n.set(e,t)}));else if(Array.isArray(t)){var i,r=-1,o=t.length;if(null==e)for(;++r<o;)n.set(r,t[r]);else for(;++r<o;)n.set(e(i=t[r],r,t),i)}else if(t)for(var a in t)n.set(a,t[a]);return n}Kr.prototype=Zr.prototype={constructor:Kr,has:function(t){return\"$\"+t in this},get:function(t){return this[\"$\"+t]},set:function(t,e){return this[\"$\"+t]=e,this},remove:function(t){var e=\"$\"+t;return e in this&&delete this[e]},clear:function(){for(var t in this)\"$\"===t[0]&&delete this[t]},keys:function(){var t=[];for(var e in this)\"$\"===e[0]&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)\"$\"===e[0]&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)\"$\"===e[0]&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)\"$\"===e[0]&&++t;return t},empty:function(){for(var t in this)if(\"$\"===t[0])return!1;return!0},each:function(t){for(var e in this)\"$\"===e[0]&&t(this[e],e.slice(1),this)}};var Jr=Zr,Qr=function(){var t,e,n,i=[],r=[];function o(n,r,a,s){if(r>=i.length)return null!=t&&n.sort(t),null!=e?e(n):n;for(var c,l,d,u=-1,h=n.length,p=i[r++],f=Jr(),m=a();++u<h;)(d=f.get(c=p(l=n[u])+\"\"))?d.push(l):f.set(c,[l]);return f.each((function(t,e){s(m,e,o(t,r,a,s))})),m}return n={object:function(t){return o(t,0,to,eo)},map:function(t){return o(t,0,no,io)},entries:function(t){return function t(n,o){if(++o>i.length)return n;var a,s=r[o-1];return null!=e&&o>=i.length?a=n.entries():(a=[],n.each((function(e,n){a.push({key:n,values:t(e,o)})}))),null!=s?a.sort((function(t,e){return s(t.key,e.key)})):a}(o(t,0,no,io),0)},key:function(t){return i.push(t),n},sortKeys:function(t){return r[i.length-1]=t,n},sortValues:function(e){return t=e,n},rollup:function(t){return e=t,n}}};function to(){return{}}function eo(t,e,n){t[e]=n}function no(){return Jr()}function io(t,e,n){t.set(e,n)}function ro(){}var oo=Jr.prototype;function ao(t,e){var n=new ro;if(t instanceof ro)t.each((function(t){n.add(t)}));else if(t){var i=-1,r=t.length;if(null==e)for(;++i<r;)n.add(t[i]);else for(;++i<r;)n.add(e(t[i],i,t))}return n}ro.prototype=ao.prototype={constructor:ro,has:oo.has,add:function(t){return this[\"$\"+(t+=\"\")]=t,this},remove:oo.remove,clear:oo.clear,values:oo.keys,size:oo.size,empty:oo.empty,each:oo.each};var so=ao,co=function(t){var e=[];for(var n in t)e.push(n);return e},lo=function(t){var e=[];for(var n in t)e.push(t[n]);return e},uo=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},ho=Math.PI/180,po=180/Math.PI;function fo(t){if(t instanceof vo)return new vo(t.l,t.a,t.b,t.opacity);if(t instanceof Eo)return To(t);t instanceof Ye||(t=qe(t));var e,n,i=xo(t.r),r=xo(t.g),o=xo(t.b),a=yo((.2225045*i+.7168786*r+.0606169*o)/1);return i===r&&r===o?e=n=a:(e=yo((.4360747*i+.3850649*r+.1430804*o)/.96422),n=yo((.0139322*i+.0971045*r+.7141733*o)/.82521)),new vo(116*a-16,500*(e-a),200*(a-n),t.opacity)}function mo(t,e){return new vo(t,0,0,null==e?1:e)}function go(t,e,n,i){return 1===arguments.length?fo(t):new vo(t,e,n,null==i?1:i)}function vo(t,e,n,i){this.l=+t,this.a=+e,this.b=+n,this.opacity=+i}function yo(t){return t>6/29*(6/29)*(6/29)?Math.pow(t,1/3):t/(6/29*3*(6/29))+4/29}function bo(t){return t>6/29?t*t*t:6/29*3*(6/29)*(t-4/29)}function _o(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function xo(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function wo(t){if(t instanceof Eo)return new Eo(t.h,t.c,t.l,t.opacity);if(t instanceof vo||(t=fo(t)),0===t.a&&0===t.b)return new Eo(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*po;return new Eo(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function So(t,e,n,i){return 1===arguments.length?wo(t):new Eo(n,e,t,null==i?1:i)}function Mo(t,e,n,i){return 1===arguments.length?wo(t):new Eo(t,e,n,null==i?1:i)}function Eo(t,e,n,i){this.h=+t,this.c=+e,this.l=+n,this.opacity=+i}function To(t){if(isNaN(t.h))return new vo(t.l,0,0,t.opacity);var e=t.h*ho;return new vo(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}Ae(vo,go,Oe(ke,{brighter:function(t){return new vo(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new vo(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new Ye(_o(3.1338561*(e=.96422*bo(e))-1.6168667*(t=1*bo(t))-.4906146*(n=.82521*bo(n))),_o(-.9787684*e+1.9161415*t+.033454*n),_o(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),Ae(Eo,Mo,Oe(ke,{brighter:function(t){return new Eo(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new Eo(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return To(this).rgb()}}));var Co=-.29227,Ao=-1.7884503806,Oo=3.5172982438,ko=-.6557636667999999;function Lo(t){if(t instanceof Ro)return new Ro(t.h,t.s,t.l,t.opacity);t instanceof Ye||(t=qe(t));var e=t.r/255,n=t.g/255,i=t.b/255,r=(ko*i+Ao*e-Oo*n)/(ko+Ao-Oo),o=i-r,a=(1.97294*(n-r)-Co*o)/-.90649,s=Math.sqrt(a*a+o*o)/(1.97294*r*(1-r)),c=s?Math.atan2(a,o)*po-120:NaN;return new Ro(c<0?c+360:c,s,r,t.opacity)}function Io(t,e,n,i){return 1===arguments.length?Lo(t):new Ro(t,e,n,null==i?1:i)}function Ro(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}Ae(Ro,Io,Oe(ke,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Ro(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Ro(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*ho,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),i=Math.cos(t),r=Math.sin(t);return new Ye(255*(e+n*(-.14861*i+1.78277*r)),255*(e+n*(Co*i+-.90649*r)),255*(e+n*(1.97294*i)),this.opacity)}}));var Po=Array.prototype.slice,Do=function(t,e){return t-e},No=function(t){return function(){return t}},Fo=function(t,e){for(var n,i=-1,r=e.length;++i<r;)if(n=jo(t,e[i]))return n;return 0};function jo(t,e){for(var n=e[0],i=e[1],r=-1,o=0,a=t.length,s=a-1;o<a;s=o++){var c=t[o],l=c[0],d=c[1],u=t[s],h=u[0],p=u[1];if(Bo(c,u,e))return 0;d>i!=p>i&&n<(h-l)*(i-d)/(p-d)+l&&(r=-r)}return r}function Bo(t,e,n){var i,r,o,a;return function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])==(n[0]-t[0])*(e[1]-t[1])}(t,e,n)&&(r=t[i=+(t[0]===e[0])],o=n[i],a=e[i],r<=o&&o<=a||a<=o&&o<=r)}var zo=function(){},Uo=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]],Ho=function(){var t=1,e=1,n=k,i=s;function r(t){var e=n(t);if(Array.isArray(e))e=e.slice().sort(Do);else{var i=v(t),r=i[0],a=i[1];e=O(r,a,e),e=S(Math.floor(r/e)*e,Math.floor(a/e)*e,e)}return e.map((function(e){return o(t,e)}))}function o(n,r){var o=[],s=[];return function(n,i,r){var o,s,c,l,d,u,h=new Array,p=new Array;o=s=-1,l=n[0]>=i,Uo[l<<1].forEach(f);for(;++o<t-1;)c=l,l=n[o+1]>=i,Uo[c|l<<1].forEach(f);Uo[l<<0].forEach(f);for(;++s<e-1;){for(o=-1,l=n[s*t+t]>=i,d=n[s*t]>=i,Uo[l<<1|d<<2].forEach(f);++o<t-1;)c=l,l=n[s*t+t+o+1]>=i,u=d,d=n[s*t+o+1]>=i,Uo[c|l<<1|d<<2|u<<3].forEach(f);Uo[l|d<<3].forEach(f)}o=-1,d=n[s*t]>=i,Uo[d<<2].forEach(f);for(;++o<t-1;)u=d,d=n[s*t+o+1]>=i,Uo[d<<2|u<<3].forEach(f);function f(t){var e,n,i=[t[0][0]+o,t[0][1]+s],c=[t[1][0]+o,t[1][1]+s],l=a(i),d=a(c);(e=p[l])?(n=h[d])?(delete p[e.end],delete h[n.start],e===n?(e.ring.push(c),r(e.ring)):h[e.start]=p[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete p[e.end],e.ring.push(c),p[e.end=d]=e):(e=h[d])?(n=p[l])?(delete h[e.start],delete p[n.end],e===n?(e.ring.push(c),r(e.ring)):h[n.start]=p[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete h[e.start],e.ring.unshift(i),h[e.start=l]=e):h[l]=p[d]={start:l,end:d,ring:[i,c]}}Uo[d<<3].forEach(f)}(n,r,(function(t){i(t,n,r),function(t){for(var e=0,n=t.length,i=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];++e<n;)i+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return i}(t)>0?o.push([t]):s.push(t)})),s.forEach((function(t){for(var e,n=0,i=o.length;n<i;++n)if(-1!==Fo((e=o[n])[0],t))return void e.push(t)})),{type:\"MultiPolygon\",value:r,coordinates:o}}function a(e){return 2*e[0]+e[1]*(t+1)*4}function s(n,i,r){n.forEach((function(n){var o,a=n[0],s=n[1],c=0|a,l=0|s,d=i[l*t+c];a>0&&a<t&&c===a&&(o=i[l*t+c-1],n[0]=a+(r-o)/(d-o)-.5),s>0&&s<e&&l===s&&(o=i[(l-1)*t+c],n[1]=s+(r-o)/(d-o)-.5)}))}return r.contour=o,r.size=function(n){if(!arguments.length)return[t,e];var i=Math.ceil(n[0]),o=Math.ceil(n[1]);if(!(i>0&&o>0))throw new Error(\"invalid size\");return t=i,e=o,r},r.thresholds=function(t){return arguments.length?(n=\"function\"==typeof t?t:Array.isArray(t)?No(Po.call(t)):No(t),r):n},r.smooth=function(t){return arguments.length?(i=t?s:zo,r):i===s},r};function $o(t,e,n){for(var i=t.width,r=t.height,o=1+(n<<1),a=0;a<r;++a)for(var s=0,c=0;s<i+n;++s)s<i&&(c+=t.data[s+a*i]),s>=n&&(s>=o&&(c-=t.data[s-o+a*i]),e.data[s-n+a*i]=c/Math.min(s+1,i-1+o-s,o))}function Go(t,e,n){for(var i=t.width,r=t.height,o=1+(n<<1),a=0;a<i;++a)for(var s=0,c=0;s<r+n;++s)s<r&&(c+=t.data[a+s*i]),s>=n&&(s>=o&&(c-=t.data[a+(s-o)*i]),e.data[a+(s-n)*i]=c/Math.min(s+1,r-1+o-s,o))}function Vo(t){return t[0]}function Wo(t){return t[1]}function qo(){return 1}var Xo=function(){var t=Vo,e=Wo,n=qo,i=960,r=500,o=20,a=2,s=3*o,c=i+2*s>>a,l=r+2*s>>a,d=No(20);function u(i){var r=new Float32Array(c*l),u=new Float32Array(c*l);i.forEach((function(i,o,d){var u=+t(i,o,d)+s>>a,h=+e(i,o,d)+s>>a,p=+n(i,o,d);u>=0&&u<c&&h>=0&&h<l&&(r[u+h*c]+=p)})),$o({width:c,height:l,data:r},{width:c,height:l,data:u},o>>a),Go({width:c,height:l,data:u},{width:c,height:l,data:r},o>>a),$o({width:c,height:l,data:r},{width:c,height:l,data:u},o>>a),Go({width:c,height:l,data:u},{width:c,height:l,data:r},o>>a),$o({width:c,height:l,data:r},{width:c,height:l,data:u},o>>a),Go({width:c,height:l,data:u},{width:c,height:l,data:r},o>>a);var p=d(r);if(!Array.isArray(p)){var f=D(r);p=O(0,f,p),(p=S(0,Math.floor(f/p)*p,p)).shift()}return Ho().thresholds(p).size([c,l])(r).map(h)}function h(t){return t.value*=Math.pow(2,-2*a),t.coordinates.forEach(p),t}function p(t){t.forEach(f)}function f(t){t.forEach(m)}function m(t){t[0]=t[0]*Math.pow(2,a)-s,t[1]=t[1]*Math.pow(2,a)-s}function g(){return c=i+2*(s=3*o)>>a,l=r+2*s>>a,u}return u.x=function(e){return arguments.length?(t=\"function\"==typeof e?e:No(+e),u):t},u.y=function(t){return arguments.length?(e=\"function\"==typeof t?t:No(+t),u):e},u.weight=function(t){return arguments.length?(n=\"function\"==typeof t?t:No(+t),u):n},u.size=function(t){if(!arguments.length)return[i,r];var e=Math.ceil(t[0]),n=Math.ceil(t[1]);if(!(e>=0||e>=0))throw new Error(\"invalid size\");return i=e,r=n,g()},u.cellSize=function(t){if(!arguments.length)return 1<<a;if(!((t=+t)>=1))throw new Error(\"invalid cell size\");return a=Math.floor(Math.log(t)/Math.LN2),g()},u.thresholds=function(t){return arguments.length?(d=\"function\"==typeof t?t:Array.isArray(t)?No(Po.call(t)):No(t),u):d},u.bandwidth=function(t){if(!arguments.length)return Math.sqrt(o*(o+1));if(!((t=+t)>=0))throw new Error(\"invalid bandwidth\");return o=Math.round((Math.sqrt(4*t*t+1)-1)/2),g()},u},Yo=function(t){return function(){return t}};function Ko(t,e,n,i,r,o,a,s,c,l){this.target=t,this.type=e,this.subject=n,this.identifier=i,this.active=r,this.x=o,this.y=a,this.dx=s,this.dy=c,this._=l}function Zo(){return!le.ctrlKey&&!le.button}function Jo(){return this.parentNode}function Qo(t){return null==t?{x:le.x,y:le.y}:t}function ta(){return navigator.maxTouchPoints||\"ontouchstart\"in this}Ko.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var ea=function(){var t,e,n,i,r=Zo,o=Jo,a=Qo,s=ta,c={},l=ut(\"start\",\"drag\",\"end\"),d=0,u=0;function h(t){t.on(\"mousedown.drag\",p).filter(s).on(\"touchstart.drag\",g).on(\"touchmove.drag\",v).on(\"touchend.drag touchcancel.drag\",y).style(\"touch-action\",\"none\").style(\"-webkit-tap-highlight-color\",\"rgba(0,0,0,0)\")}function p(){if(!i&&r.apply(this,arguments)){var a=b(\"mouse\",o.apply(this,arguments),Rn,this,arguments);a&&(Se(le.view).on(\"mousemove.drag\",f,!0).on(\"mouseup.drag\",m,!0),Te(le.view),Me(),n=!1,t=le.clientX,e=le.clientY,a(\"start\"))}}function f(){if(Ee(),!n){var i=le.clientX-t,r=le.clientY-e;n=i*i+r*r>u}c.mouse(\"drag\")}function m(){Se(le.view).on(\"mousemove.drag mouseup.drag\",null),Ce(le.view,n),Ee(),c.mouse(\"end\")}function g(){if(r.apply(this,arguments)){var t,e,n=le.changedTouches,i=o.apply(this,arguments),a=n.length;for(t=0;t<a;++t)(e=b(n[t].identifier,i,In,this,arguments))&&(Me(),e(\"start\"))}}function v(){var t,e,n=le.changedTouches,i=n.length;for(t=0;t<i;++t)(e=c[n[t].identifier])&&(Ee(),e(\"drag\"))}function y(){var t,e,n=le.changedTouches,r=n.length;for(i&&clearTimeout(i),i=setTimeout((function(){i=null}),500),t=0;t<r;++t)(e=c[n[t].identifier])&&(Me(),e(\"end\"))}function b(t,e,n,i,r){var o,s,u,p=n(e,t),f=l.copy();if(me(new Ko(h,\"beforestart\",o,t,d,p[0],p[1],0,0,f),(function(){return null!=(le.subject=o=a.apply(i,r))&&(s=o.x-p[0]||0,u=o.y-p[1]||0,!0)})))return function a(l){var m,g=p;switch(l){case\"start\":c[t]=a,m=d++;break;case\"end\":delete c[t],--d;case\"drag\":p=n(e,t),m=d}me(new Ko(h,l,o,t,m,p[0]+s,p[1]+u,p[0]-g[0],p[1]-g[1],f),f.apply,f,[l,i,r])}}return h.filter=function(t){return arguments.length?(r=\"function\"==typeof t?t:Yo(!!t),h):r},h.container=function(t){return arguments.length?(o=\"function\"==typeof t?t:Yo(t),h):o},h.subject=function(t){return arguments.length?(a=\"function\"==typeof t?t:Yo(t),h):a},h.touchable=function(t){return arguments.length?(s=\"function\"==typeof t?t:Yo(!!t),h):s},h.on=function(){var t=l.on.apply(l,arguments);return t===l?h:t},h.clickDistance=function(t){return arguments.length?(u=(t=+t)*t,h):Math.sqrt(u)},h},na={},ia={};function ra(t){return new Function(\"d\",\"return {\"+t.map((function(t,e){return JSON.stringify(t)+\": d[\"+e+'] || \"\"'})).join(\",\")+\"}\")}function oa(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var i in t)i in e||n.push(e[i]=i)})),n}function aa(t,e){var n=t+\"\",i=n.length;return i<e?new Array(e-i+1).join(0)+n:n}function sa(t){var e,n=t.getUTCHours(),i=t.getUTCMinutes(),r=t.getUTCSeconds(),o=t.getUTCMilliseconds();return isNaN(t)?\"Invalid Date\":((e=t.getUTCFullYear())<0?\"-\"+aa(-e,6):e>9999?\"+\"+aa(e,6):aa(e,4))+\"-\"+aa(t.getUTCMonth()+1,2)+\"-\"+aa(t.getUTCDate(),2)+(o?\"T\"+aa(n,2)+\":\"+aa(i,2)+\":\"+aa(r,2)+\".\"+aa(o,3)+\"Z\":r?\"T\"+aa(n,2)+\":\"+aa(i,2)+\":\"+aa(r,2)+\"Z\":i||n?\"T\"+aa(n,2)+\":\"+aa(i,2)+\"Z\":\"\")}var ca=function(t){var e=new RegExp('[\"'+t+\"\\n\\r]\"),n=t.charCodeAt(0);function i(t,e){var i,r=[],o=t.length,a=0,s=0,c=o<=0,l=!1;function d(){if(c)return ia;if(l)return l=!1,na;var e,i,r=a;if(34===t.charCodeAt(r)){for(;a++<o&&34!==t.charCodeAt(a)||34===t.charCodeAt(++a););return(e=a)>=o?c=!0:10===(i=t.charCodeAt(a++))?l=!0:13===i&&(l=!0,10===t.charCodeAt(a)&&++a),t.slice(r+1,e-1).replace(/\"\"/g,'\"')}for(;a<o;){if(10===(i=t.charCodeAt(e=a++)))l=!0;else if(13===i)l=!0,10===t.charCodeAt(a)&&++a;else if(i!==n)continue;return t.slice(r,e)}return c=!0,t.slice(r,o)}for(10===t.charCodeAt(o-1)&&--o,13===t.charCodeAt(o-1)&&--o;(i=d())!==ia;){for(var u=[];i!==na&&i!==ia;)u.push(i),i=d();e&&null==(u=e(u,s++))||r.push(u)}return r}function r(e,n){return e.map((function(e){return n.map((function(t){return a(e[t])})).join(t)}))}function o(e){return e.map(a).join(t)}function a(t){return null==t?\"\":t instanceof Date?sa(t):e.test(t+=\"\")?'\"'+t.replace(/\"/g,'\"\"')+'\"':t}return{parse:function(t,e){var n,r,o=i(t,(function(t,i){if(n)return n(t,i-1);r=t,n=e?function(t,e){var n=ra(t);return function(i,r){return e(n(i),r,t)}}(t,e):ra(t)}));return o.columns=r||[],o},parseRows:i,format:function(e,n){return null==n&&(n=oa(e)),[n.map(a).join(t)].concat(r(e,n)).join(\"\\n\")},formatBody:function(t,e){return null==e&&(e=oa(t)),r(t,e).join(\"\\n\")},formatRows:function(t){return t.map(o).join(\"\\n\")},formatRow:o,formatValue:a}},la=ca(\",\"),da=la.parse,ua=la.parseRows,ha=la.format,pa=la.formatBody,fa=la.formatRows,ma=la.formatRow,ga=la.formatValue,va=ca(\"\\t\"),ya=va.parse,ba=va.parseRows,_a=va.format,xa=va.formatBody,wa=va.formatRows,Sa=va.formatRow,Ma=va.formatValue;function Ea(t){for(var e in t){var n,i,r=t[e].trim();if(r)if(\"true\"===r)r=!0;else if(\"false\"===r)r=!1;else if(\"NaN\"===r)r=NaN;else if(isNaN(n=+r)){if(!(i=r.match(/^([-+]\\d{2})?\\d{4}(-\\d{2}(-\\d{2})?)?(T\\d{2}:\\d{2}(:\\d{2}(\\.\\d{3})?)?(Z|[-+]\\d{2}:\\d{2})?)?$/)))continue;Ta&&i[4]&&!i[7]&&(r=r.replace(/-/g,\"/\").replace(/T/,\" \")),r=new Date(r)}else r=n;else r=null;t[e]=r}return t}var Ta=new Date(\"2019-01-01T00:00\").getHours()||new Date(\"2019-07-01T00:00\").getHours();function Ca(t){return+t}function Aa(t){return t*t}function Oa(t){return t*(2-t)}function ka(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}var La=function t(e){function n(t){return Math.pow(t,e)}return e=+e,n.exponent=t,n}(3),Ia=function t(e){function n(t){return 1-Math.pow(1-t,e)}return e=+e,n.exponent=t,n}(3),Ra=function t(e){function n(t){return((t*=2)<=1?Math.pow(t,e):2-Math.pow(2-t,e))/2}return e=+e,n.exponent=t,n}(3),Pa=Math.PI,Da=Pa/2;function Na(t){return 1-Math.cos(t*Da)}function Fa(t){return Math.sin(t*Da)}function ja(t){return(1-Math.cos(Pa*t))/2}function Ba(t){return Math.pow(2,10*t-10)}function za(t){return 1-Math.pow(2,-10*t)}function Ua(t){return((t*=2)<=1?Math.pow(2,10*t-10):2-Math.pow(2,10-10*t))/2}function Ha(t){return 1-Math.sqrt(1-t*t)}function $a(t){return Math.sqrt(1- --t*t)}function Ga(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}function Va(t){return 1-Wa(1-t)}function Wa(t){return(t=+t)<4/11?7.5625*t*t:t<8/11?7.5625*(t-=6/11)*t+3/4:t<10/11?7.5625*(t-=9/11)*t+15/16:7.5625*(t-=21/22)*t+63/64}function qa(t){return((t*=2)<=1?1-Wa(1-t):Wa(t-1)+1)/2}var Xa=function t(e){function n(t){return t*t*((e+1)*t-e)}return e=+e,n.overshoot=t,n}(1.70158),Ya=function t(e){function n(t){return--t*t*((e+1)*t+e)+1}return e=+e,n.overshoot=t,n}(1.70158),Ka=function t(e){function n(t){return((t*=2)<1?t*t*((e+1)*t-e):(t-=2)*t*((e+1)*t+e)+2)/2}return e=+e,n.overshoot=t,n}(1.70158),Za=2*Math.PI,Ja=function t(e,n){var i=Math.asin(1/(e=Math.max(1,e)))*(n/=Za);function r(t){return e*Math.pow(2,10*--t)*Math.sin((i-t)/n)}return r.amplitude=function(e){return t(e,n*Za)},r.period=function(n){return t(e,n)},r}(1,.3),Qa=function t(e,n){var i=Math.asin(1/(e=Math.max(1,e)))*(n/=Za);function r(t){return 1-e*Math.pow(2,-10*(t=+t))*Math.sin((t+i)/n)}return r.amplitude=function(e){return t(e,n*Za)},r.period=function(n){return t(e,n)},r}(1,.3),ts=function t(e,n){var i=Math.asin(1/(e=Math.max(1,e)))*(n/=Za);function r(t){return((t=2*t-1)<0?e*Math.pow(2,10*t)*Math.sin((i-t)/n):2-e*Math.pow(2,-10*t)*Math.sin((i+t)/n))/2}return r.amplitude=function(e){return t(e,n*Za)},r.period=function(n){return t(e,n)},r}(1,.3);function es(t){if(!t.ok)throw new Error(t.status+\" \"+t.statusText);return t.blob()}var ns=function(t,e){return fetch(t,e).then(es)};function is(t){if(!t.ok)throw new Error(t.status+\" \"+t.statusText);return t.arrayBuffer()}var rs=function(t,e){return fetch(t,e).then(is)};function os(t){if(!t.ok)throw new Error(t.status+\" \"+t.statusText);return t.text()}var as=function(t,e){return fetch(t,e).then(os)};function ss(t){return function(e,n,i){return 2===arguments.length&&\"function\"==typeof n&&(i=n,n=void 0),as(e,n).then((function(e){return t(e,i)}))}}function cs(t,e,n,i){3===arguments.length&&\"function\"==typeof n&&(i=n,n=void 0);var r=ca(t);return as(e,n).then((function(t){return r.parse(t,i)}))}var ls=ss(da),ds=ss(ya),us=function(t,e){return new Promise((function(n,i){var r=new Image;for(var o in e)r[o]=e[o];r.onerror=i,r.onload=function(){n(r)},r.src=t}))};function hs(t){if(!t.ok)throw new Error(t.status+\" \"+t.statusText);if(204!==t.status&&205!==t.status)return t.json()}var ps=function(t,e){return fetch(t,e).then(hs)};function fs(t){return function(e,n){return as(e,n).then((function(e){return(new DOMParser).parseFromString(e,t)}))}}var ms=fs(\"application/xml\"),gs=fs(\"text/html\"),vs=fs(\"image/svg+xml\"),ys=function(t,e){var n;function i(){var i,r,o=n.length,a=0,s=0;for(i=0;i<o;++i)a+=(r=n[i]).x,s+=r.y;for(a=a/o-t,s=s/o-e,i=0;i<o;++i)(r=n[i]).x-=a,r.y-=s}return null==t&&(t=0),null==e&&(e=0),i.initialize=function(t){n=t},i.x=function(e){return arguments.length?(t=+e,i):t},i.y=function(t){return arguments.length?(e=+t,i):e},i},bs=function(t){return function(){return t}},_s=function(){return 1e-6*(Math.random()-.5)};function xs(t,e,n,i){if(isNaN(e)||isNaN(n))return t;var r,o,a,s,c,l,d,u,h,p=t._root,f={data:i},m=t._x0,g=t._y0,v=t._x1,y=t._y1;if(!p)return t._root=f,t;for(;p.length;)if((l=e>=(o=(m+v)/2))?m=o:v=o,(d=n>=(a=(g+y)/2))?g=a:y=a,r=p,!(p=p[u=d<<1|l]))return r[u]=f,t;if(s=+t._x.call(null,p.data),c=+t._y.call(null,p.data),e===s&&n===c)return f.next=p,r?r[u]=f:t._root=f,t;do{r=r?r[u]=new Array(4):t._root=new Array(4),(l=e>=(o=(m+v)/2))?m=o:v=o,(d=n>=(a=(g+y)/2))?g=a:y=a}while((u=d<<1|l)==(h=(c>=a)<<1|s>=o));return r[h]=p,r[u]=f,t}var ws=function(t,e,n,i,r){this.node=t,this.x0=e,this.y0=n,this.x1=i,this.y1=r};function Ss(t){return t[0]}function Ms(t){return t[1]}function Es(t,e,n){var i=new Ts(null==e?Ss:e,null==n?Ms:n,NaN,NaN,NaN,NaN);return null==t?i:i.addAll(t)}function Ts(t,e,n,i,r,o){this._x=t,this._y=e,this._x0=n,this._y0=i,this._x1=r,this._y1=o,this._root=void 0}function Cs(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var As=Es.prototype=Ts.prototype;function Os(t){return t.x+t.vx}function ks(t){return t.y+t.vy}As.copy=function(){var t,e,n=new Ts(this._x,this._y,this._x0,this._y0,this._x1,this._y1),i=this._root;if(!i)return n;if(!i.length)return n._root=Cs(i),n;for(t=[{source:i,target:n._root=new Array(4)}];i=t.pop();)for(var r=0;r<4;++r)(e=i.source[r])&&(e.length?t.push({source:e,target:i.target[r]=new Array(4)}):i.target[r]=Cs(e));return n},As.add=function(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return xs(this.cover(e,n),e,n,t)},As.addAll=function(t){var e,n,i,r,o=t.length,a=new Array(o),s=new Array(o),c=1/0,l=1/0,d=-1/0,u=-1/0;for(n=0;n<o;++n)isNaN(i=+this._x.call(null,e=t[n]))||isNaN(r=+this._y.call(null,e))||(a[n]=i,s[n]=r,i<c&&(c=i),i>d&&(d=i),r<l&&(l=r),r>u&&(u=r));if(c>d||l>u)return this;for(this.cover(c,l).cover(d,u),n=0;n<o;++n)xs(this,a[n],s[n],t[n]);return this},As.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,r=this._x1,o=this._y1;if(isNaN(n))r=(n=Math.floor(t))+1,o=(i=Math.floor(e))+1;else{for(var a,s,c=r-n,l=this._root;n>t||t>=r||i>e||e>=o;)switch(s=(e<i)<<1|t<n,(a=new Array(4))[s]=l,l=a,c*=2,s){case 0:r=n+c,o=i+c;break;case 1:n=r-c,o=i+c;break;case 2:r=n+c,i=o-c;break;case 3:n=r-c,i=o-c}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=i,this._x1=r,this._y1=o,this},As.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},As.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},As.find=function(t,e,n){var i,r,o,a,s,c,l,d=this._x0,u=this._y0,h=this._x1,p=this._y1,f=[],m=this._root;for(m&&f.push(new ws(m,d,u,h,p)),null==n?n=1/0:(d=t-n,u=e-n,h=t+n,p=e+n,n*=n);c=f.pop();)if(!(!(m=c.node)||(r=c.x0)>h||(o=c.y0)>p||(a=c.x1)<d||(s=c.y1)<u))if(m.length){var g=(r+a)/2,v=(o+s)/2;f.push(new ws(m[3],g,v,a,s),new ws(m[2],r,v,g,s),new ws(m[1],g,o,a,v),new ws(m[0],r,o,g,v)),(l=(e>=v)<<1|t>=g)&&(c=f[f.length-1],f[f.length-1]=f[f.length-1-l],f[f.length-1-l]=c)}else{var y=t-+this._x.call(null,m.data),b=e-+this._y.call(null,m.data),_=y*y+b*b;if(_<n){var x=Math.sqrt(n=_);d=t-x,u=e-x,h=t+x,p=e+x,i=m.data}}return i},As.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,n,i,r,o,a,s,c,l,d,u,h,p=this._root,f=this._x0,m=this._y0,g=this._x1,v=this._y1;if(!p)return this;if(p.length)for(;;){if((l=o>=(s=(f+g)/2))?f=s:g=s,(d=a>=(c=(m+v)/2))?m=c:v=c,e=p,!(p=p[u=d<<1|l]))return this;if(!p.length)break;(e[u+1&3]||e[u+2&3]||e[u+3&3])&&(n=e,h=u)}for(;p.data!==t;)if(i=p,!(p=p.next))return this;return(r=p.next)&&delete p.next,i?(r?i.next=r:delete i.next,this):e?(r?e[u]=r:delete e[u],(p=e[0]||e[1]||e[2]||e[3])&&p===(e[3]||e[2]||e[1]||e[0])&&!p.length&&(n?n[h]=p:this._root=p),this):(this._root=r,this)},As.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},As.root=function(){return this._root},As.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},As.visit=function(t){var e,n,i,r,o,a,s=[],c=this._root;for(c&&s.push(new ws(c,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(c=e.node,i=e.x0,r=e.y0,o=e.x1,a=e.y1)&&c.length){var l=(i+o)/2,d=(r+a)/2;(n=c[3])&&s.push(new ws(n,l,d,o,a)),(n=c[2])&&s.push(new ws(n,i,d,l,a)),(n=c[1])&&s.push(new ws(n,l,r,o,d)),(n=c[0])&&s.push(new ws(n,i,r,l,d))}return this},As.visitAfter=function(t){var e,n=[],i=[];for(this._root&&n.push(new ws(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var r=e.node;if(r.length){var o,a=e.x0,s=e.y0,c=e.x1,l=e.y1,d=(a+c)/2,u=(s+l)/2;(o=r[0])&&n.push(new ws(o,a,s,d,u)),(o=r[1])&&n.push(new ws(o,d,s,c,u)),(o=r[2])&&n.push(new ws(o,a,u,d,l)),(o=r[3])&&n.push(new ws(o,d,u,c,l))}i.push(e)}for(;e=i.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},As.x=function(t){return arguments.length?(this._x=t,this):this._x},As.y=function(t){return arguments.length?(this._y=t,this):this._y};var Ls=function(t){var e,n,i=1,r=1;function o(){for(var t,o,s,c,l,d,u,h=e.length,p=0;p<r;++p)for(o=Es(e,Os,ks).visitAfter(a),t=0;t<h;++t)s=e[t],d=n[s.index],u=d*d,c=s.x+s.vx,l=s.y+s.vy,o.visit(f);function f(t,e,n,r,o){var a=t.data,h=t.r,p=d+h;if(!a)return e>c+p||r<c-p||n>l+p||o<l-p;if(a.index>s.index){var f=c-a.x-a.vx,m=l-a.y-a.vy,g=f*f+m*m;g<p*p&&(0===f&&(g+=(f=_s())*f),0===m&&(g+=(m=_s())*m),g=(p-(g=Math.sqrt(g)))/g*i,s.vx+=(f*=g)*(p=(h*=h)/(u+h)),s.vy+=(m*=g)*p,a.vx-=f*(p=1-p),a.vy-=m*p)}}}function a(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function s(){if(e){var i,r,o=e.length;for(n=new Array(o),i=0;i<o;++i)r=e[i],n[r.index]=+t(r,i,e)}}return\"function\"!=typeof t&&(t=bs(null==t?1:+t)),o.initialize=function(t){e=t,s()},o.iterations=function(t){return arguments.length?(r=+t,o):r},o.strength=function(t){return arguments.length?(i=+t,o):i},o.radius=function(e){return arguments.length?(t=\"function\"==typeof e?e:bs(+e),s(),o):t},o};function Is(t){return t.index}function Rs(t,e){var n=t.get(e);if(!n)throw new Error(\"missing: \"+e);return n}var Ps=function(t){var e,n,i,r,o,a=Is,s=function(t){return 1/Math.min(r[t.source.index],r[t.target.index])},c=bs(30),l=1;function d(i){for(var r=0,a=t.length;r<l;++r)for(var s,c,d,u,h,p,f,m=0;m<a;++m)c=(s=t[m]).source,u=(d=s.target).x+d.vx-c.x-c.vx||_s(),h=d.y+d.vy-c.y-c.vy||_s(),u*=p=((p=Math.sqrt(u*u+h*h))-n[m])/p*i*e[m],h*=p,d.vx-=u*(f=o[m]),d.vy-=h*f,c.vx+=u*(f=1-f),c.vy+=h*f}function u(){if(i){var s,c,l=i.length,d=t.length,u=Jr(i,a);for(s=0,r=new Array(l);s<d;++s)(c=t[s]).index=s,\"object\"!=typeof c.source&&(c.source=Rs(u,c.source)),\"object\"!=typeof c.target&&(c.target=Rs(u,c.target)),r[c.source.index]=(r[c.source.index]||0)+1,r[c.target.index]=(r[c.target.index]||0)+1;for(s=0,o=new Array(d);s<d;++s)c=t[s],o[s]=r[c.source.index]/(r[c.source.index]+r[c.target.index]);e=new Array(d),h(),n=new Array(d),p()}}function h(){if(i)for(var n=0,r=t.length;n<r;++n)e[n]=+s(t[n],n,t)}function p(){if(i)for(var e=0,r=t.length;e<r;++e)n[e]=+c(t[e],e,t)}return null==t&&(t=[]),d.initialize=function(t){i=t,u()},d.links=function(e){return arguments.length?(t=e,u(),d):t},d.id=function(t){return arguments.length?(a=t,d):a},d.iterations=function(t){return arguments.length?(l=+t,d):l},d.strength=function(t){return arguments.length?(s=\"function\"==typeof t?t:bs(+t),h(),d):s},d.distance=function(t){return arguments.length?(c=\"function\"==typeof t?t:bs(+t),p(),d):c},d};function Ds(t){return t.x}function Ns(t){return t.y}var Fs=Math.PI*(3-Math.sqrt(5)),js=function(t){var e,n=1,i=.001,r=1-Math.pow(i,1/300),o=0,a=.6,s=Jr(),c=Vn(d),l=ut(\"tick\",\"end\");function d(){u(),l.call(\"tick\",e),n<i&&(c.stop(),l.call(\"end\",e))}function u(i){var c,l,d=t.length;void 0===i&&(i=1);for(var u=0;u<i;++u)for(n+=(o-n)*r,s.each((function(t){t(n)})),c=0;c<d;++c)null==(l=t[c]).fx?l.x+=l.vx*=a:(l.x=l.fx,l.vx=0),null==l.fy?l.y+=l.vy*=a:(l.y=l.fy,l.vy=0);return e}function h(){for(var e,n=0,i=t.length;n<i;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var r=10*Math.sqrt(n),o=n*Fs;e.x=r*Math.cos(o),e.y=r*Math.sin(o)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function p(e){return e.initialize&&e.initialize(t),e}return null==t&&(t=[]),h(),e={tick:u,restart:function(){return c.restart(d),e},stop:function(){return c.stop(),e},nodes:function(n){return arguments.length?(t=n,h(),s.each(p),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(i=+t,e):i},alphaDecay:function(t){return arguments.length?(r=+t,e):+r},alphaTarget:function(t){return arguments.length?(o=+t,e):o},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},force:function(t,n){return arguments.length>1?(null==n?s.remove(t):s.set(t,p(n)),e):s.get(t)},find:function(e,n,i){var r,o,a,s,c,l=0,d=t.length;for(null==i?i=1/0:i*=i,l=0;l<d;++l)(a=(r=e-(s=t[l]).x)*r+(o=n-s.y)*o)<i&&(c=s,i=a);return c},on:function(t,n){return arguments.length>1?(l.on(t,n),e):l.on(t)}}},Bs=function(){var t,e,n,i,r=bs(-30),o=1,a=1/0,s=.81;function c(i){var r,o=t.length,a=Es(t,Ds,Ns).visitAfter(d);for(n=i,r=0;r<o;++r)e=t[r],a.visit(u)}function l(){if(t){var e,n,o=t.length;for(i=new Array(o),e=0;e<o;++e)n=t[e],i[n.index]=+r(n,e,t)}}function d(t){var e,n,r,o,a,s=0,c=0;if(t.length){for(r=o=a=0;a<4;++a)(e=t[a])&&(n=Math.abs(e.value))&&(s+=e.value,c+=n,r+=n*e.x,o+=n*e.y);t.x=r/c,t.y=o/c}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=i[e.data.index]}while(e=e.next)}t.value=s}function u(t,r,c,l){if(!t.value)return!0;var d=t.x-e.x,u=t.y-e.y,h=l-r,p=d*d+u*u;if(h*h/s<p)return p<a&&(0===d&&(p+=(d=_s())*d),0===u&&(p+=(u=_s())*u),p<o&&(p=Math.sqrt(o*p)),e.vx+=d*t.value*n/p,e.vy+=u*t.value*n/p),!0;if(!(t.length||p>=a)){(t.data!==e||t.next)&&(0===d&&(p+=(d=_s())*d),0===u&&(p+=(u=_s())*u),p<o&&(p=Math.sqrt(o*p)));do{t.data!==e&&(h=i[t.data.index]*n/p,e.vx+=d*h,e.vy+=u*h)}while(t=t.next)}}return c.initialize=function(e){t=e,l()},c.strength=function(t){return arguments.length?(r=\"function\"==typeof t?t:bs(+t),l(),c):r},c.distanceMin=function(t){return arguments.length?(o=t*t,c):Math.sqrt(o)},c.distanceMax=function(t){return arguments.length?(a=t*t,c):Math.sqrt(a)},c.theta=function(t){return arguments.length?(s=t*t,c):Math.sqrt(s)},c},zs=function(t,e,n){var i,r,o,a=bs(.1);function s(t){for(var a=0,s=i.length;a<s;++a){var c=i[a],l=c.x-e||1e-6,d=c.y-n||1e-6,u=Math.sqrt(l*l+d*d),h=(o[a]-u)*r[a]*t/u;c.vx+=l*h,c.vy+=d*h}}function c(){if(i){var e,n=i.length;for(r=new Array(n),o=new Array(n),e=0;e<n;++e)o[e]=+t(i[e],e,i),r[e]=isNaN(o[e])?0:+a(i[e],e,i)}}return\"function\"!=typeof t&&(t=bs(+t)),null==e&&(e=0),null==n&&(n=0),s.initialize=function(t){i=t,c()},s.strength=function(t){return arguments.length?(a=\"function\"==typeof t?t:bs(+t),c(),s):a},s.radius=function(e){return arguments.length?(t=\"function\"==typeof e?e:bs(+e),c(),s):t},s.x=function(t){return arguments.length?(e=+t,s):e},s.y=function(t){return arguments.length?(n=+t,s):n},s},Us=function(t){var e,n,i,r=bs(.1);function o(t){for(var r,o=0,a=e.length;o<a;++o)(r=e[o]).vx+=(i[o]-r.x)*n[o]*t}function a(){if(e){var o,a=e.length;for(n=new Array(a),i=new Array(a),o=0;o<a;++o)n[o]=isNaN(i[o]=+t(e[o],o,e))?0:+r(e[o],o,e)}}return\"function\"!=typeof t&&(t=bs(null==t?0:+t)),o.initialize=function(t){e=t,a()},o.strength=function(t){return arguments.length?(r=\"function\"==typeof t?t:bs(+t),a(),o):r},o.x=function(e){return arguments.length?(t=\"function\"==typeof e?e:bs(+e),a(),o):t},o},Hs=function(t){var e,n,i,r=bs(.1);function o(t){for(var r,o=0,a=e.length;o<a;++o)(r=e[o]).vy+=(i[o]-r.y)*n[o]*t}function a(){if(e){var o,a=e.length;for(n=new Array(a),i=new Array(a),o=0;o<a;++o)n[o]=isNaN(i[o]=+t(e[o],o,e))?0:+r(e[o],o,e)}}return\"function\"!=typeof t&&(t=bs(null==t?0:+t)),o.initialize=function(t){e=t,a()},o.strength=function(t){return arguments.length?(r=\"function\"==typeof t?t:bs(+t),a(),o):r},o.y=function(e){return arguments.length?(t=\"function\"==typeof e?e:bs(+e),a(),o):t},o},$s=function(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf(\"e\"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]},Gs=function(t){return(t=$s(Math.abs(t)))?t[1]:NaN},Vs=/^(?:(.)?([<>=^]))?([+\\-( ])?([$#])?(0)?(\\d+)?(,)?(\\.\\d+)?(~)?([a-z%])?$/i;function Ws(t){if(!(e=Vs.exec(t)))throw new Error(\"invalid format: \"+t);var e;return new qs({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function qs(t){this.fill=void 0===t.fill?\" \":t.fill+\"\",this.align=void 0===t.align?\">\":t.align+\"\",this.sign=void 0===t.sign?\"-\":t.sign+\"\",this.symbol=void 0===t.symbol?\"\":t.symbol+\"\",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?\"\":t.type+\"\"}Ws.prototype=qs.prototype,qs.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?\"0\":\"\")+(void 0===this.width?\"\":Math.max(1,0|this.width))+(this.comma?\",\":\"\")+(void 0===this.precision?\"\":\".\"+Math.max(0,0|this.precision))+(this.trim?\"~\":\"\")+this.type};var Xs,Ys,Ks,Zs,Js=function(t,e){var n=$s(t,e);if(!n)return t+\"\";var i=n[0],r=n[1];return r<0?\"0.\"+new Array(-r).join(\"0\")+i:i.length>r+1?i.slice(0,r+1)+\".\"+i.slice(r+1):i+new Array(r-i.length+2).join(\"0\")},Qs={\"%\":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+\"\"},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return Js(100*t,e)},r:Js,s:function(t,e){var n=$s(t,e);if(!n)return t+\"\";var i=n[0],r=n[1],o=r-(Xs=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,a=i.length;return o===a?i:o>a?i+new Array(o-a+1).join(\"0\"):o>0?i.slice(0,o)+\".\"+i.slice(o):\"0.\"+new Array(1-o).join(\"0\")+$s(t,Math.max(0,e+o-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},tc=function(t){return t},ec=Array.prototype.map,nc=[\"y\",\"z\",\"a\",\"f\",\"p\",\"n\",\"\",\"m\",\"\",\"k\",\"M\",\"G\",\"T\",\"P\",\"E\",\"Z\",\"Y\"],ic=function(t){var e,n,i=void 0===t.grouping||void 0===t.thousands?tc:(e=ec.call(t.grouping,Number),n=t.thousands+\"\",function(t,i){for(var r=t.length,o=[],a=0,s=e[0],c=0;r>0&&s>0&&(c+s+1>i&&(s=Math.max(1,i-c)),o.push(t.substring(r-=s,r+s)),!((c+=s+1)>i));)s=e[a=(a+1)%e.length];return o.reverse().join(n)}),r=void 0===t.currency?\"\":t.currency[0]+\"\",o=void 0===t.currency?\"\":t.currency[1]+\"\",a=void 0===t.decimal?\".\":t.decimal+\"\",s=void 0===t.numerals?tc:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(ec.call(t.numerals,String)),c=void 0===t.percent?\"%\":t.percent+\"\",l=void 0===t.minus?\"-\":t.minus+\"\",d=void 0===t.nan?\"NaN\":t.nan+\"\";function u(t){var e=(t=Ws(t)).fill,n=t.align,u=t.sign,h=t.symbol,p=t.zero,f=t.width,m=t.comma,g=t.precision,v=t.trim,y=t.type;\"n\"===y?(m=!0,y=\"g\"):Qs[y]||(void 0===g&&(g=12),v=!0,y=\"g\"),(p||\"0\"===e&&\"=\"===n)&&(p=!0,e=\"0\",n=\"=\");var b=\"$\"===h?r:\"#\"===h&&/[boxX]/.test(y)?\"0\"+y.toLowerCase():\"\",_=\"$\"===h?o:/[%p]/.test(y)?c:\"\",x=Qs[y],w=/[defgprs%]/.test(y);function S(t){var r,o,c,h=b,S=_;if(\"c\"===y)S=x(t)+S,t=\"\";else{var M=(t=+t)<0||1/t<0;if(t=isNaN(t)?d:x(Math.abs(t),g),v&&(t=function(t){t:for(var e,n=t.length,i=1,r=-1;i<n;++i)switch(t[i]){case\".\":r=e=i;break;case\"0\":0===r&&(r=i),e=i;break;default:if(!+t[i])break t;r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(e+1):t}(t)),M&&0==+t&&\"+\"!==u&&(M=!1),h=(M?\"(\"===u?u:l:\"-\"===u||\"(\"===u?\"\":u)+h,S=(\"s\"===y?nc[8+Xs/3]:\"\")+S+(M&&\"(\"===u?\")\":\"\"),w)for(r=-1,o=t.length;++r<o;)if(48>(c=t.charCodeAt(r))||c>57){S=(46===c?a+t.slice(r+1):t.slice(r))+S,t=t.slice(0,r);break}}m&&!p&&(t=i(t,1/0));var E=h.length+t.length+S.length,T=E<f?new Array(f-E+1).join(e):\"\";switch(m&&p&&(t=i(T+t,T.length?f-S.length:1/0),T=\"\"),n){case\"<\":t=h+t+S+T;break;case\"=\":t=h+T+t+S;break;case\"^\":t=T.slice(0,E=T.length>>1)+h+t+S+T.slice(E);break;default:t=T+h+t+S}return s(t)}return g=void 0===g?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),S.toString=function(){return t+\"\"},S}return{format:u,formatPrefix:function(t,e){var n=u(((t=Ws(t)).type=\"f\",t)),i=3*Math.max(-8,Math.min(8,Math.floor(Gs(e)/3))),r=Math.pow(10,-i),o=nc[8+i/3];return function(t){return n(r*t)+o}}}};function rc(t){return Ys=ic(t),Ks=Ys.format,Zs=Ys.formatPrefix,Ys}rc({decimal:\".\",thousands:\",\",grouping:[3],currency:[\"$\",\"\"],minus:\"-\"});var oc=function(t){return Math.max(0,-Gs(Math.abs(t)))},ac=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Gs(e)/3)))-Gs(Math.abs(t)))},sc=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Gs(e)-Gs(t))+1},cc=function(){return new lc};function lc(){this.reset()}lc.prototype={constructor:lc,reset:function(){this.s=this.t=0},add:function(t){uc(dc,t,this.t),uc(this,dc.s,this.s),this.s?this.t+=dc.t:this.s=dc.t},valueOf:function(){return this.s}};var dc=new lc;function uc(t,e,n){var i=t.s=e+n,r=i-e,o=i-r;t.t=e-o+(n-r)}var hc=Math.PI,pc=hc/2,fc=hc/4,mc=2*hc,gc=180/hc,vc=hc/180,yc=Math.abs,bc=Math.atan,_c=Math.atan2,xc=Math.cos,wc=Math.ceil,Sc=Math.exp,Mc=(Math.floor,Math.log),Ec=Math.pow,Tc=Math.sin,Cc=Math.sign||function(t){return t>0?1:t<0?-1:0},Ac=Math.sqrt,Oc=Math.tan;function kc(t){return t>1?0:t<-1?hc:Math.acos(t)}function Lc(t){return t>1?pc:t<-1?-pc:Math.asin(t)}function Ic(t){return(t=Tc(t/2))*t}function Rc(){}function Pc(t,e){t&&Nc.hasOwnProperty(t.type)&&Nc[t.type](t,e)}var Dc={Feature:function(t,e){Pc(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)Pc(n[i].geometry,e)}},Nc={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){Fc(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)Fc(n[i],e,0)},Polygon:function(t,e){jc(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)jc(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)Pc(n[i],e)}};function Fc(t,e,n){var i,r=-1,o=t.length-n;for(e.lineStart();++r<o;)i=t[r],e.point(i[0],i[1],i[2]);e.lineEnd()}function jc(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)Fc(t[n],e,1);e.polygonEnd()}var Bc,zc,Uc,Hc,$c,Gc=function(t,e){t&&Dc.hasOwnProperty(t.type)?Dc[t.type](t,e):Pc(t,e)},Vc=cc(),Wc=cc(),qc={point:Rc,lineStart:Rc,lineEnd:Rc,polygonStart:function(){Vc.reset(),qc.lineStart=Xc,qc.lineEnd=Yc},polygonEnd:function(){var t=+Vc;Wc.add(t<0?mc+t:t),this.lineStart=this.lineEnd=this.point=Rc},sphere:function(){Wc.add(mc)}};function Xc(){qc.point=Kc}function Yc(){Zc(Bc,zc)}function Kc(t,e){qc.point=Zc,Bc=t,zc=e,Uc=t*=vc,Hc=xc(e=(e*=vc)/2+fc),$c=Tc(e)}function Zc(t,e){var n=(t*=vc)-Uc,i=n>=0?1:-1,r=i*n,o=xc(e=(e*=vc)/2+fc),a=Tc(e),s=$c*a,c=Hc*o+s*xc(r),l=s*i*Tc(r);Vc.add(_c(l,c)),Uc=t,Hc=o,$c=a}var Jc=function(t){return Wc.reset(),Gc(t,qc),2*Wc};function Qc(t){return[_c(t[1],t[0]),Lc(t[2])]}function tl(t){var e=t[0],n=t[1],i=xc(n);return[i*xc(e),i*Tc(e),Tc(n)]}function el(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function nl(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function il(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function rl(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function ol(t){var e=Ac(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var al,sl,cl,ll,dl,ul,hl,pl,fl,ml,gl=cc(),vl={point:yl,lineStart:_l,lineEnd:xl,polygonStart:function(){vl.point=wl,vl.lineStart=Sl,vl.lineEnd=Ml,gl.reset(),qc.polygonStart()},polygonEnd:function(){qc.polygonEnd(),vl.point=yl,vl.lineStart=_l,vl.lineEnd=xl,Vc<0?(al=-(cl=180),sl=-(ll=90)):gl>1e-6?ll=90:gl<-1e-6&&(sl=-90),ml[0]=al,ml[1]=cl},sphere:function(){al=-(cl=180),sl=-(ll=90)}};function yl(t,e){fl.push(ml=[al=t,cl=t]),e<sl&&(sl=e),e>ll&&(ll=e)}function bl(t,e){var n=tl([t*vc,e*vc]);if(pl){var i=nl(pl,n),r=nl([i[1],-i[0],0],i);ol(r),r=Qc(r);var o,a=t-dl,s=a>0?1:-1,c=r[0]*gc*s,l=yc(a)>180;l^(s*dl<c&&c<s*t)?(o=r[1]*gc)>ll&&(ll=o):l^(s*dl<(c=(c+360)%360-180)&&c<s*t)?(o=-r[1]*gc)<sl&&(sl=o):(e<sl&&(sl=e),e>ll&&(ll=e)),l?t<dl?El(al,t)>El(al,cl)&&(cl=t):El(t,cl)>El(al,cl)&&(al=t):cl>=al?(t<al&&(al=t),t>cl&&(cl=t)):t>dl?El(al,t)>El(al,cl)&&(cl=t):El(t,cl)>El(al,cl)&&(al=t)}else fl.push(ml=[al=t,cl=t]);e<sl&&(sl=e),e>ll&&(ll=e),pl=n,dl=t}function _l(){vl.point=bl}function xl(){ml[0]=al,ml[1]=cl,vl.point=yl,pl=null}function wl(t,e){if(pl){var n=t-dl;gl.add(yc(n)>180?n+(n>0?360:-360):n)}else ul=t,hl=e;qc.point(t,e),bl(t,e)}function Sl(){qc.lineStart()}function Ml(){wl(ul,hl),qc.lineEnd(),yc(gl)>1e-6&&(al=-(cl=180)),ml[0]=al,ml[1]=cl,pl=null}function El(t,e){return(e-=t)<0?e+360:e}function Tl(t,e){return t[0]-e[0]}function Cl(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var Al,Ol,kl,Ll,Il,Rl,Pl,Dl,Nl,Fl,jl,Bl,zl,Ul,Hl,$l,Gl=function(t){var e,n,i,r,o,a,s;if(ll=cl=-(al=sl=1/0),fl=[],Gc(t,vl),n=fl.length){for(fl.sort(Tl),e=1,o=[i=fl[0]];e<n;++e)Cl(i,(r=fl[e])[0])||Cl(i,r[1])?(El(i[0],r[1])>El(i[0],i[1])&&(i[1]=r[1]),El(r[0],i[1])>El(i[0],i[1])&&(i[0]=r[0])):o.push(i=r);for(a=-1/0,e=0,i=o[n=o.length-1];e<=n;i=r,++e)r=o[e],(s=El(i[1],r[0]))>a&&(a=s,al=r[0],cl=i[1])}return fl=ml=null,al===1/0||sl===1/0?[[NaN,NaN],[NaN,NaN]]:[[al,sl],[cl,ll]]},Vl={sphere:Rc,point:Wl,lineStart:Xl,lineEnd:Zl,polygonStart:function(){Vl.lineStart=Jl,Vl.lineEnd=Ql},polygonEnd:function(){Vl.lineStart=Xl,Vl.lineEnd=Zl}};function Wl(t,e){t*=vc;var n=xc(e*=vc);ql(n*xc(t),n*Tc(t),Tc(e))}function ql(t,e,n){++Al,kl+=(t-kl)/Al,Ll+=(e-Ll)/Al,Il+=(n-Il)/Al}function Xl(){Vl.point=Yl}function Yl(t,e){t*=vc;var n=xc(e*=vc);Ul=n*xc(t),Hl=n*Tc(t),$l=Tc(e),Vl.point=Kl,ql(Ul,Hl,$l)}function Kl(t,e){t*=vc;var n=xc(e*=vc),i=n*xc(t),r=n*Tc(t),o=Tc(e),a=_c(Ac((a=Hl*o-$l*r)*a+(a=$l*i-Ul*o)*a+(a=Ul*r-Hl*i)*a),Ul*i+Hl*r+$l*o);Ol+=a,Rl+=a*(Ul+(Ul=i)),Pl+=a*(Hl+(Hl=r)),Dl+=a*($l+($l=o)),ql(Ul,Hl,$l)}function Zl(){Vl.point=Wl}function Jl(){Vl.point=td}function Ql(){ed(Bl,zl),Vl.point=Wl}function td(t,e){Bl=t,zl=e,t*=vc,e*=vc,Vl.point=ed;var n=xc(e);Ul=n*xc(t),Hl=n*Tc(t),$l=Tc(e),ql(Ul,Hl,$l)}function ed(t,e){t*=vc;var n=xc(e*=vc),i=n*xc(t),r=n*Tc(t),o=Tc(e),a=Hl*o-$l*r,s=$l*i-Ul*o,c=Ul*r-Hl*i,l=Ac(a*a+s*s+c*c),d=Lc(l),u=l&&-d/l;Nl+=u*a,Fl+=u*s,jl+=u*c,Ol+=d,Rl+=d*(Ul+(Ul=i)),Pl+=d*(Hl+(Hl=r)),Dl+=d*($l+($l=o)),ql(Ul,Hl,$l)}var nd=function(t){Al=Ol=kl=Ll=Il=Rl=Pl=Dl=Nl=Fl=jl=0,Gc(t,Vl);var e=Nl,n=Fl,i=jl,r=e*e+n*n+i*i;return r<1e-12&&(e=Rl,n=Pl,i=Dl,Ol<1e-6&&(e=kl,n=Ll,i=Il),(r=e*e+n*n+i*i)<1e-12)?[NaN,NaN]:[_c(n,e)*gc,Lc(i/Ac(r))*gc]},id=function(t){return function(){return t}},rd=function(t,e){function n(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,i){return(n=e.invert(n,i))&&t.invert(n[0],n[1])}),n};function od(t,e){return[yc(t)>hc?t+Math.round(-t/mc)*mc:t,e]}function ad(t,e,n){return(t%=mc)?e||n?rd(cd(t),ld(e,n)):cd(t):e||n?ld(e,n):od}function sd(t){return function(e,n){return[(e+=t)>hc?e-mc:e<-hc?e+mc:e,n]}}function cd(t){var e=sd(t);return e.invert=sd(-t),e}function ld(t,e){var n=xc(t),i=Tc(t),r=xc(e),o=Tc(e);function a(t,e){var a=xc(e),s=xc(t)*a,c=Tc(t)*a,l=Tc(e),d=l*n+s*i;return[_c(c*r-d*o,s*n-l*i),Lc(d*r+c*o)]}return a.invert=function(t,e){var a=xc(e),s=xc(t)*a,c=Tc(t)*a,l=Tc(e),d=l*r-c*o;return[_c(c*r+l*o,s*n+d*i),Lc(d*n-s*i)]},a}od.invert=od;var dd=function(t){function e(e){return(e=t(e[0]*vc,e[1]*vc))[0]*=gc,e[1]*=gc,e}return t=ad(t[0]*vc,t[1]*vc,t.length>2?t[2]*vc:0),e.invert=function(e){return(e=t.invert(e[0]*vc,e[1]*vc))[0]*=gc,e[1]*=gc,e},e};function ud(t,e,n,i,r,o){if(n){var a=xc(e),s=Tc(e),c=i*n;null==r?(r=e+i*mc,o=e-c/2):(r=hd(a,r),o=hd(a,o),(i>0?r<o:r>o)&&(r+=i*mc));for(var l,d=r;i>0?d>o:d<o;d-=c)l=Qc([a,-s*xc(d),-s*Tc(d)]),t.point(l[0],l[1])}}function hd(t,e){(e=tl(e))[0]-=t,ol(e);var n=kc(-e[1]);return((-e[2]<0?-n:n)+mc-1e-6)%mc}var pd=function(){var t,e,n=id([0,0]),i=id(90),r=id(6),o={point:function(n,i){t.push(n=e(n,i)),n[0]*=gc,n[1]*=gc}};function a(){var a=n.apply(this,arguments),s=i.apply(this,arguments)*vc,c=r.apply(this,arguments)*vc;return t=[],e=ad(-a[0]*vc,-a[1]*vc,0).invert,ud(o,s,c,1),a={type:\"Polygon\",coordinates:[t]},t=e=null,a}return a.center=function(t){return arguments.length?(n=\"function\"==typeof t?t:id([+t[0],+t[1]]),a):n},a.radius=function(t){return arguments.length?(i=\"function\"==typeof t?t:id(+t),a):i},a.precision=function(t){return arguments.length?(r=\"function\"==typeof t?t:id(+t),a):r},a},fd=function(){var t,e=[];return{point:function(e,n,i){t.push([e,n,i])},lineStart:function(){e.push(t=[])},lineEnd:Rc,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}},md=function(t,e){return yc(t[0]-e[0])<1e-6&&yc(t[1]-e[1])<1e-6};function gd(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}var vd=function(t,e,n,i,r){var o,a,s=[],c=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,i=t[0],a=t[e];if(md(i,a)){if(!i[2]&&!a[2]){for(r.lineStart(),o=0;o<e;++o)r.point((i=t[o])[0],i[1]);return void r.lineEnd()}a[0]+=2e-6}s.push(n=new gd(i,t,null,!0)),c.push(n.o=new gd(i,null,n,!1)),s.push(n=new gd(a,t,null,!1)),c.push(n.o=new gd(a,null,n,!0))}})),s.length){for(c.sort(e),yd(s),yd(c),o=0,a=c.length;o<a;++o)c[o].e=n=!n;for(var l,d,u=s[0];;){for(var h=u,p=!0;h.v;)if((h=h.n)===u)return;l=h.z,r.lineStart();do{if(h.v=h.o.v=!0,h.e){if(p)for(o=0,a=l.length;o<a;++o)r.point((d=l[o])[0],d[1]);else i(h.x,h.n.x,1,r);h=h.n}else{if(p)for(l=h.p.z,o=l.length-1;o>=0;--o)r.point((d=l[o])[0],d[1]);else i(h.x,h.p.x,-1,r);h=h.p}l=(h=h.o).z,p=!p}while(!h.v);r.lineEnd()}}};function yd(t){if(e=t.length){for(var e,n,i=0,r=t[0];++i<e;)r.n=n=t[i],n.p=r,r=n;r.n=n=t[0],n.p=r}}var bd=cc();function _d(t){return yc(t[0])<=hc?t[0]:Cc(t[0])*((yc(t[0])+hc)%mc-hc)}var xd=function(t,e){var n=_d(e),i=e[1],r=Tc(i),o=[Tc(n),-xc(n),0],a=0,s=0;bd.reset(),1===r?i=pc+1e-6:-1===r&&(i=-pc-1e-6);for(var c=0,l=t.length;c<l;++c)if(u=(d=t[c]).length)for(var d,u,h=d[u-1],p=_d(h),f=h[1]/2+fc,m=Tc(f),g=xc(f),v=0;v<u;++v,p=b,m=x,g=w,h=y){var y=d[v],b=_d(y),_=y[1]/2+fc,x=Tc(_),w=xc(_),S=b-p,M=S>=0?1:-1,E=M*S,T=E>hc,C=m*x;if(bd.add(_c(C*M*Tc(E),g*w+C*xc(E))),a+=T?S+M*mc:S,T^p>=n^b>=n){var A=nl(tl(h),tl(y));ol(A);var O=nl(o,A);ol(O);var k=(T^S>=0?-1:1)*Lc(O[2]);(i>k||i===k&&(A[0]||A[1]))&&(s+=T^S>=0?1:-1)}}return(a<-1e-6||a<1e-6&&bd<-1e-6)^1&s},wd=function(t,e,n,i){return function(r){var o,a,s,c=e(r),l=fd(),d=e(l),u=!1,h={point:p,lineStart:m,lineEnd:g,polygonStart:function(){h.point=v,h.lineStart=y,h.lineEnd=b,a=[],o=[]},polygonEnd:function(){h.point=p,h.lineStart=m,h.lineEnd=g,a=j(a);var t=xd(o,i);a.length?(u||(r.polygonStart(),u=!0),vd(a,Md,t,n,r)):t&&(u||(r.polygonStart(),u=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),u&&(r.polygonEnd(),u=!1),a=o=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function p(e,n){t(e,n)&&r.point(e,n)}function f(t,e){c.point(t,e)}function m(){h.point=f,c.lineStart()}function g(){h.point=p,c.lineEnd()}function v(t,e){s.push([t,e]),d.point(t,e)}function y(){d.lineStart(),s=[]}function b(){v(s[0][0],s[0][1]),d.lineEnd();var t,e,n,i,c=d.clean(),h=l.result(),p=h.length;if(s.pop(),o.push(s),s=null,p)if(1&c){if((e=(n=h[0]).length-1)>0){for(u||(r.polygonStart(),u=!0),r.lineStart(),t=0;t<e;++t)r.point((i=n[t])[0],i[1]);r.lineEnd()}}else p>1&&2&c&&h.push(h.pop().concat(h.shift())),a.push(h.filter(Sd))}return h}};function Sd(t){return t.length>1}function Md(t,e){return((t=t.x)[0]<0?t[1]-pc-1e-6:pc-t[1])-((e=e.x)[0]<0?e[1]-pc-1e-6:pc-e[1])}var Ed=wd((function(){return!0}),(function(t){var e,n=NaN,i=NaN,r=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,a){var s=o>0?hc:-hc,c=yc(o-n);yc(c-hc)<1e-6?(t.point(n,i=(i+a)/2>0?pc:-pc),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(s,i),t.point(o,i),e=0):r!==s&&c>=hc&&(yc(n-r)<1e-6&&(n-=1e-6*r),yc(o-s)<1e-6&&(o-=1e-6*s),i=function(t,e,n,i){var r,o,a=Tc(t-n);return yc(a)>1e-6?bc((Tc(e)*(o=xc(i))*Tc(n)-Tc(i)*(r=xc(e))*Tc(t))/(r*o*a)):(e+i)/2}(n,i,o,a),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(s,i),e=0),t.point(n=o,i=a),r=s},lineEnd:function(){t.lineEnd(),n=i=NaN},clean:function(){return 2-e}}}),(function(t,e,n,i){var r;if(null==t)r=n*pc,i.point(-hc,r),i.point(0,r),i.point(hc,r),i.point(hc,0),i.point(hc,-r),i.point(0,-r),i.point(-hc,-r),i.point(-hc,0),i.point(-hc,r);else if(yc(t[0]-e[0])>1e-6){var o=t[0]<e[0]?hc:-hc;r=n*o/2,i.point(-o,r),i.point(0,r),i.point(o,r)}else i.point(e[0],e[1])}),[-hc,-pc]);var Td=function(t){var e=xc(t),n=6*vc,i=e>0,r=yc(e)>1e-6;function o(t,n){return xc(t)*xc(n)>e}function a(t,n,i){var r=[1,0,0],o=nl(tl(t),tl(n)),a=el(o,o),s=o[0],c=a-s*s;if(!c)return!i&&t;var l=e*a/c,d=-e*s/c,u=nl(r,o),h=rl(r,l);il(h,rl(o,d));var p=u,f=el(h,p),m=el(p,p),g=f*f-m*(el(h,h)-1);if(!(g<0)){var v=Ac(g),y=rl(p,(-f-v)/m);if(il(y,h),y=Qc(y),!i)return y;var b,_=t[0],x=n[0],w=t[1],S=n[1];x<_&&(b=_,_=x,x=b);var M=x-_,E=yc(M-hc)<1e-6;if(!E&&S<w&&(b=w,w=S,S=b),E||M<1e-6?E?w+S>0^y[1]<(yc(y[0]-_)<1e-6?w:S):w<=y[1]&&y[1]<=S:M>hc^(_<=y[0]&&y[0]<=x)){var T=rl(p,(-f+v)/m);return il(T,h),[y,Qc(T)]}}}function s(e,n){var r=i?t:hc-t,o=0;return e<-r?o|=1:e>r&&(o|=2),n<-r?o|=4:n>r&&(o|=8),o}return wd(o,(function(t){var e,n,c,l,d;return{lineStart:function(){l=c=!1,d=1},point:function(u,h){var p,f=[u,h],m=o(u,h),g=i?m?0:s(u,h):m?s(u+(u<0?hc:-hc),h):0;if(!e&&(l=c=m)&&t.lineStart(),m!==c&&(!(p=a(e,f))||md(e,p)||md(f,p))&&(f[2]=1),m!==c)d=0,m?(t.lineStart(),p=a(f,e),t.point(p[0],p[1])):(p=a(e,f),t.point(p[0],p[1],2),t.lineEnd()),e=p;else if(r&&e&&i^m){var v;g&n||!(v=a(f,e,!0))||(d=0,i?(t.lineStart(),t.point(v[0][0],v[0][1]),t.point(v[1][0],v[1][1]),t.lineEnd()):(t.point(v[1][0],v[1][1]),t.lineEnd(),t.lineStart(),t.point(v[0][0],v[0][1],3)))}!m||e&&md(e,f)||t.point(f[0],f[1]),e=f,c=m,n=g},lineEnd:function(){c&&t.lineEnd(),e=null},clean:function(){return d|(l&&c)<<1}}}),(function(e,i,r,o){ud(o,t,n,r,e,i)}),i?[0,-t]:[-hc,t-hc])};function Cd(t,e,n,i){function r(r,o){return t<=r&&r<=n&&e<=o&&o<=i}function o(r,o,s,l){var d=0,u=0;if(null==r||(d=a(r,s))!==(u=a(o,s))||c(r,o)<0^s>0)do{l.point(0===d||3===d?t:n,d>1?i:e)}while((d=(d+s+4)%4)!==u);else l.point(o[0],o[1])}function a(i,r){return yc(i[0]-t)<1e-6?r>0?0:3:yc(i[0]-n)<1e-6?r>0?2:1:yc(i[1]-e)<1e-6?r>0?1:0:r>0?3:2}function s(t,e){return c(t.x,e.x)}function c(t,e){var n=a(t,1),i=a(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(a){var c,l,d,u,h,p,f,m,g,v,y,b=a,_=fd(),x={point:w,lineStart:function(){x.point=S,l&&l.push(d=[]);v=!0,g=!1,f=m=NaN},lineEnd:function(){c&&(S(u,h),p&&g&&_.rejoin(),c.push(_.result()));x.point=w,g&&b.lineEnd()},polygonStart:function(){b=_,c=[],l=[],y=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,r=l.length;n<r;++n)for(var o,a,s=l[n],c=1,d=s.length,u=s[0],h=u[0],p=u[1];c<d;++c)o=h,a=p,u=s[c],h=u[0],p=u[1],a<=i?p>i&&(h-o)*(i-a)>(p-a)*(t-o)&&++e:p<=i&&(h-o)*(i-a)<(p-a)*(t-o)&&--e;return e}(),n=y&&e,r=(c=j(c)).length;(n||r)&&(a.polygonStart(),n&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),r&&vd(c,s,e,o,a),a.polygonEnd());b=a,c=l=d=null}};function w(t,e){r(t,e)&&b.point(t,e)}function S(o,a){var s=r(o,a);if(l&&d.push([o,a]),v)u=o,h=a,p=s,v=!1,s&&(b.lineStart(),b.point(o,a));else if(s&&g)b.point(o,a);else{var c=[f=Math.max(-1e9,Math.min(1e9,f)),m=Math.max(-1e9,Math.min(1e9,m))],_=[o=Math.max(-1e9,Math.min(1e9,o)),a=Math.max(-1e9,Math.min(1e9,a))];!function(t,e,n,i,r,o){var a,s=t[0],c=t[1],l=0,d=1,u=e[0]-s,h=e[1]-c;if(a=n-s,u||!(a>0)){if(a/=u,u<0){if(a<l)return;a<d&&(d=a)}else if(u>0){if(a>d)return;a>l&&(l=a)}if(a=r-s,u||!(a<0)){if(a/=u,u<0){if(a>d)return;a>l&&(l=a)}else if(u>0){if(a<l)return;a<d&&(d=a)}if(a=i-c,h||!(a>0)){if(a/=h,h<0){if(a<l)return;a<d&&(d=a)}else if(h>0){if(a>d)return;a>l&&(l=a)}if(a=o-c,h||!(a<0)){if(a/=h,h<0){if(a>d)return;a>l&&(l=a)}else if(h>0){if(a<l)return;a<d&&(d=a)}return l>0&&(t[0]=s+l*u,t[1]=c+l*h),d<1&&(e[0]=s+d*u,e[1]=c+d*h),!0}}}}}(c,_,t,e,n,i)?s&&(b.lineStart(),b.point(o,a),y=!1):(g||(b.lineStart(),b.point(c[0],c[1])),b.point(_[0],_[1]),s||b.lineEnd(),y=!1)}f=o,m=a,g=s}return x}}var Ad,Od,kd,Ld=function(){var t,e,n,i=0,r=0,o=960,a=500;return n={stream:function(n){return t&&e===n?t:t=Cd(i,r,o,a)(e=n)},extent:function(s){return arguments.length?(i=+s[0][0],r=+s[0][1],o=+s[1][0],a=+s[1][1],t=e=null,n):[[i,r],[o,a]]}}},Id=cc(),Rd={sphere:Rc,point:Rc,lineStart:function(){Rd.point=Dd,Rd.lineEnd=Pd},lineEnd:Rc,polygonStart:Rc,polygonEnd:Rc};function Pd(){Rd.point=Rd.lineEnd=Rc}function Dd(t,e){Ad=t*=vc,Od=Tc(e*=vc),kd=xc(e),Rd.point=Nd}function Nd(t,e){t*=vc;var n=Tc(e*=vc),i=xc(e),r=yc(t-Ad),o=xc(r),a=i*Tc(r),s=kd*n-Od*i*o,c=Od*n+kd*i*o;Id.add(_c(Ac(a*a+s*s),c)),Ad=t,Od=n,kd=i}var Fd=function(t){return Id.reset(),Gc(t,Rd),+Id},jd=[null,null],Bd={type:\"LineString\",coordinates:jd},zd=function(t,e){return jd[0]=t,jd[1]=e,Fd(Bd)},Ud={Feature:function(t,e){return $d(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)if($d(n[i].geometry,e))return!0;return!1}},Hd={Sphere:function(){return!0},Point:function(t,e){return Gd(t.coordinates,e)},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)if(Gd(n[i],e))return!0;return!1},LineString:function(t,e){return Vd(t.coordinates,e)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)if(Vd(n[i],e))return!0;return!1},Polygon:function(t,e){return Wd(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)if(Wd(n[i],e))return!0;return!1},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)if($d(n[i],e))return!0;return!1}};function $d(t,e){return!(!t||!Hd.hasOwnProperty(t.type))&&Hd[t.type](t,e)}function Gd(t,e){return 0===zd(t,e)}function Vd(t,e){for(var n,i,r,o=0,a=t.length;o<a;o++){if(0===(i=zd(t[o],e)))return!0;if(o>0&&(r=zd(t[o],t[o-1]))>0&&n<=r&&i<=r&&(n+i-r)*(1-Math.pow((n-i)/r,2))<1e-12*r)return!0;n=i}return!1}function Wd(t,e){return!!xd(t.map(qd),Xd(e))}function qd(t){return(t=t.map(Xd)).pop(),t}function Xd(t){return[t[0]*vc,t[1]*vc]}var Yd=function(t,e){return(t&&Ud.hasOwnProperty(t.type)?Ud[t.type]:$d)(t,e)};function Kd(t,e,n){var i=S(t,e-1e-6,n).concat(e);return function(t){return i.map((function(e){return[t,e]}))}}function Zd(t,e,n){var i=S(t,e-1e-6,n).concat(e);return function(t){return i.map((function(e){return[e,t]}))}}function Jd(){var t,e,n,i,r,o,a,s,c,l,d,u,h=10,p=h,f=90,m=360,g=2.5;function v(){return{type:\"MultiLineString\",coordinates:y()}}function y(){return S(wc(i/f)*f,n,f).map(d).concat(S(wc(s/m)*m,a,m).map(u)).concat(S(wc(e/h)*h,t,h).filter((function(t){return yc(t%f)>1e-6})).map(c)).concat(S(wc(o/p)*p,r,p).filter((function(t){return yc(t%m)>1e-6})).map(l))}return v.lines=function(){return y().map((function(t){return{type:\"LineString\",coordinates:t}}))},v.outline=function(){return{type:\"Polygon\",coordinates:[d(i).concat(u(a).slice(1),d(n).reverse().slice(1),u(s).reverse().slice(1))]}},v.extent=function(t){return arguments.length?v.extentMajor(t).extentMinor(t):v.extentMinor()},v.extentMajor=function(t){return arguments.length?(i=+t[0][0],n=+t[1][0],s=+t[0][1],a=+t[1][1],i>n&&(t=i,i=n,n=t),s>a&&(t=s,s=a,a=t),v.precision(g)):[[i,s],[n,a]]},v.extentMinor=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],o=+n[0][1],r=+n[1][1],e>t&&(n=e,e=t,t=n),o>r&&(n=o,o=r,r=n),v.precision(g)):[[e,o],[t,r]]},v.step=function(t){return arguments.length?v.stepMajor(t).stepMinor(t):v.stepMinor()},v.stepMajor=function(t){return arguments.length?(f=+t[0],m=+t[1],v):[f,m]},v.stepMinor=function(t){return arguments.length?(h=+t[0],p=+t[1],v):[h,p]},v.precision=function(h){return arguments.length?(g=+h,c=Kd(o,r,90),l=Zd(e,t,g),d=Kd(s,a,90),u=Zd(i,n,g),v):g},v.extentMajor([[-180,-89.999999],[180,89.999999]]).extentMinor([[-180,-80.000001],[180,80.000001]])}function Qd(){return Jd()()}var tu,eu,nu,iu,ru=function(t,e){var n=t[0]*vc,i=t[1]*vc,r=e[0]*vc,o=e[1]*vc,a=xc(i),s=Tc(i),c=xc(o),l=Tc(o),d=a*xc(n),u=a*Tc(n),h=c*xc(r),p=c*Tc(r),f=2*Lc(Ac(Ic(o-i)+a*c*Ic(r-n))),m=Tc(f),g=f?function(t){var e=Tc(t*=f)/m,n=Tc(f-t)/m,i=n*d+e*h,r=n*u+e*p,o=n*s+e*l;return[_c(r,i)*gc,_c(o,Ac(i*i+r*r))*gc]}:function(){return[n*gc,i*gc]};return g.distance=f,g},ou=function(t){return t},au=cc(),su=cc(),cu={point:Rc,lineStart:Rc,lineEnd:Rc,polygonStart:function(){cu.lineStart=lu,cu.lineEnd=hu},polygonEnd:function(){cu.lineStart=cu.lineEnd=cu.point=Rc,au.add(yc(su)),su.reset()},result:function(){var t=au/2;return au.reset(),t}};function lu(){cu.point=du}function du(t,e){cu.point=uu,tu=nu=t,eu=iu=e}function uu(t,e){su.add(iu*t-nu*e),nu=t,iu=e}function hu(){uu(tu,eu)}var pu=cu,fu=1/0,mu=fu,gu=-fu,vu=gu;var yu,bu,_u,xu,wu={point:function(t,e){t<fu&&(fu=t);t>gu&&(gu=t);e<mu&&(mu=e);e>vu&&(vu=e)},lineStart:Rc,lineEnd:Rc,polygonStart:Rc,polygonEnd:Rc,result:function(){var t=[[fu,mu],[gu,vu]];return gu=vu=-(mu=fu=1/0),t}},Su=0,Mu=0,Eu=0,Tu=0,Cu=0,Au=0,Ou=0,ku=0,Lu=0,Iu={point:Ru,lineStart:Pu,lineEnd:Fu,polygonStart:function(){Iu.lineStart=ju,Iu.lineEnd=Bu},polygonEnd:function(){Iu.point=Ru,Iu.lineStart=Pu,Iu.lineEnd=Fu},result:function(){var t=Lu?[Ou/Lu,ku/Lu]:Au?[Tu/Au,Cu/Au]:Eu?[Su/Eu,Mu/Eu]:[NaN,NaN];return Su=Mu=Eu=Tu=Cu=Au=Ou=ku=Lu=0,t}};function Ru(t,e){Su+=t,Mu+=e,++Eu}function Pu(){Iu.point=Du}function Du(t,e){Iu.point=Nu,Ru(_u=t,xu=e)}function Nu(t,e){var n=t-_u,i=e-xu,r=Ac(n*n+i*i);Tu+=r*(_u+t)/2,Cu+=r*(xu+e)/2,Au+=r,Ru(_u=t,xu=e)}function Fu(){Iu.point=Ru}function ju(){Iu.point=zu}function Bu(){Uu(yu,bu)}function zu(t,e){Iu.point=Uu,Ru(yu=_u=t,bu=xu=e)}function Uu(t,e){var n=t-_u,i=e-xu,r=Ac(n*n+i*i);Tu+=r*(_u+t)/2,Cu+=r*(xu+e)/2,Au+=r,Ou+=(r=xu*t-_u*e)*(_u+t),ku+=r*(xu+e),Lu+=3*r,Ru(_u=t,xu=e)}var Hu=Iu;function $u(t){this._context=t}$u.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,mc)}},result:Rc};var Gu,Vu,Wu,qu,Xu,Yu=cc(),Ku={point:Rc,lineStart:function(){Ku.point=Zu},lineEnd:function(){Gu&&Ju(Vu,Wu),Ku.point=Rc},polygonStart:function(){Gu=!0},polygonEnd:function(){Gu=null},result:function(){var t=+Yu;return Yu.reset(),t}};function Zu(t,e){Ku.point=Ju,Vu=qu=t,Wu=Xu=e}function Ju(t,e){qu-=t,Xu-=e,Yu.add(Ac(qu*qu+Xu*Xu)),qu=t,Xu=e}var Qu=Ku;function th(){this._string=[]}function eh(t){return\"m0,\"+t+\"a\"+t+\",\"+t+\" 0 1,1 0,\"+-2*t+\"a\"+t+\",\"+t+\" 0 1,1 0,\"+2*t+\"z\"}th.prototype={_radius:4.5,_circle:eh(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push(\"Z\"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push(\"M\",t,\",\",e),this._point=1;break;case 1:this._string.push(\"L\",t,\",\",e);break;default:null==this._circle&&(this._circle=eh(this._radius)),this._string.push(\"M\",t,\",\",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join(\"\");return this._string=[],t}return null}};var nh=function(t,e){var n,i,r=4.5;function o(t){return t&&(\"function\"==typeof r&&i.pointRadius(+r.apply(this,arguments)),Gc(t,n(i))),i.result()}return o.area=function(t){return Gc(t,n(pu)),pu.result()},o.measure=function(t){return Gc(t,n(Qu)),Qu.result()},o.bounds=function(t){return Gc(t,n(wu)),wu.result()},o.centroid=function(t){return Gc(t,n(Hu)),Hu.result()},o.projection=function(e){return arguments.length?(n=null==e?(t=null,ou):(t=e).stream,o):t},o.context=function(t){return arguments.length?(i=null==t?(e=null,new th):new $u(e=t),\"function\"!=typeof r&&i.pointRadius(r),o):e},o.pointRadius=function(t){return arguments.length?(r=\"function\"==typeof t?t:(i.pointRadius(+t),+t),o):r},o.projection(t).context(e)},ih=function(t){return{stream:rh(t)}};function rh(t){return function(e){var n=new oh;for(var i in t)n[i]=t[i];return n.stream=e,n}}function oh(){}function ah(t,e,n){var i=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=i&&t.clipExtent(null),Gc(n,t.stream(wu)),e(wu.result()),null!=i&&t.clipExtent(i),t}function sh(t,e,n){return ah(t,(function(n){var i=e[1][0]-e[0][0],r=e[1][1]-e[0][1],o=Math.min(i/(n[1][0]-n[0][0]),r/(n[1][1]-n[0][1])),a=+e[0][0]+(i-o*(n[1][0]+n[0][0]))/2,s=+e[0][1]+(r-o*(n[1][1]+n[0][1]))/2;t.scale(150*o).translate([a,s])}),n)}function ch(t,e,n){return sh(t,[[0,0],e],n)}function lh(t,e,n){return ah(t,(function(n){var i=+e,r=i/(n[1][0]-n[0][0]),o=(i-r*(n[1][0]+n[0][0]))/2,a=-r*n[0][1];t.scale(150*r).translate([o,a])}),n)}function dh(t,e,n){return ah(t,(function(n){var i=+e,r=i/(n[1][1]-n[0][1]),o=-r*n[0][0],a=(i-r*(n[1][1]+n[0][1]))/2;t.scale(150*r).translate([o,a])}),n)}oh.prototype={constructor:oh,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var uh=xc(30*vc),hh=function(t,e){return+e?function(t,e){function n(i,r,o,a,s,c,l,d,u,h,p,f,m,g){var v=l-i,y=d-r,b=v*v+y*y;if(b>4*e&&m--){var _=a+h,x=s+p,w=c+f,S=Ac(_*_+x*x+w*w),M=Lc(w/=S),E=yc(yc(w)-1)<1e-6||yc(o-u)<1e-6?(o+u)/2:_c(x,_),T=t(E,M),C=T[0],A=T[1],O=C-i,k=A-r,L=y*O-v*k;(L*L/b>e||yc((v*O+y*k)/b-.5)>.3||a*h+s*p+c*f<uh)&&(n(i,r,o,a,s,c,C,A,E,_/=S,x/=S,w,m,g),g.point(C,A),n(C,A,E,_,x,w,l,d,u,h,p,f,m,g))}}return function(e){var i,r,o,a,s,c,l,d,u,h,p,f,m={point:g,lineStart:v,lineEnd:b,polygonStart:function(){e.polygonStart(),m.lineStart=_},polygonEnd:function(){e.polygonEnd(),m.lineStart=v}};function g(n,i){n=t(n,i),e.point(n[0],n[1])}function v(){d=NaN,m.point=y,e.lineStart()}function y(i,r){var o=tl([i,r]),a=t(i,r);n(d,u,l,h,p,f,d=a[0],u=a[1],l=i,h=o[0],p=o[1],f=o[2],16,e),e.point(d,u)}function b(){m.point=g,e.lineEnd()}function _(){v(),m.point=x,m.lineEnd=w}function x(t,e){y(i=t,e),r=d,o=u,a=h,s=p,c=f,m.point=y}function w(){n(d,u,l,h,p,f,r,o,i,a,s,c,16,e),m.lineEnd=b,b()}return m}}(t,e):function(t){return rh({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)};var ph=rh({point:function(t,e){this.stream.point(t*vc,e*vc)}});function fh(t,e,n,i,r){function o(o,a){return[e+t*(o*=i),n-t*(a*=r)]}return o.invert=function(o,a){return[(o-e)/t*i,(n-a)/t*r]},o}function mh(t,e,n,i,r,o){var a=xc(o),s=Tc(o),c=a*t,l=s*t,d=a/t,u=s/t,h=(s*n-a*e)/t,p=(s*e+a*n)/t;function f(t,o){return[c*(t*=i)-l*(o*=r)+e,n-l*t-c*o]}return f.invert=function(t,e){return[i*(d*t-u*e+h),r*(p-u*t-d*e)]},f}function gh(t){return vh((function(){return t}))()}function vh(t){var e,n,i,r,o,a,s,c,l,d,u=150,h=480,p=250,f=0,m=0,g=0,v=0,y=0,b=0,_=1,x=1,w=null,S=Ed,M=null,E=ou,T=.5;function C(t){return c(t[0]*vc,t[1]*vc)}function A(t){return(t=c.invert(t[0],t[1]))&&[t[0]*gc,t[1]*gc]}function O(){var t=mh(u,0,0,_,x,b).apply(null,e(f,m)),i=(b?mh:fh)(u,h-t[0],p-t[1],_,x,b);return n=ad(g,v,y),s=rd(e,i),c=rd(n,s),a=hh(s,T),k()}function k(){return l=d=null,C}return C.stream=function(t){return l&&d===t?l:l=ph(function(t){return rh({point:function(e,n){var i=t(e,n);return this.stream.point(i[0],i[1])}})}(n)(S(a(E(d=t)))))},C.preclip=function(t){return arguments.length?(S=t,w=void 0,k()):S},C.postclip=function(t){return arguments.length?(E=t,M=i=r=o=null,k()):E},C.clipAngle=function(t){return arguments.length?(S=+t?Td(w=t*vc):(w=null,Ed),k()):w*gc},C.clipExtent=function(t){return arguments.length?(E=null==t?(M=i=r=o=null,ou):Cd(M=+t[0][0],i=+t[0][1],r=+t[1][0],o=+t[1][1]),k()):null==M?null:[[M,i],[r,o]]},C.scale=function(t){return arguments.length?(u=+t,O()):u},C.translate=function(t){return arguments.length?(h=+t[0],p=+t[1],O()):[h,p]},C.center=function(t){return arguments.length?(f=t[0]%360*vc,m=t[1]%360*vc,O()):[f*gc,m*gc]},C.rotate=function(t){return arguments.length?(g=t[0]%360*vc,v=t[1]%360*vc,y=t.length>2?t[2]%360*vc:0,O()):[g*gc,v*gc,y*gc]},C.angle=function(t){return arguments.length?(b=t%360*vc,O()):b*gc},C.reflectX=function(t){return arguments.length?(_=t?-1:1,O()):_<0},C.reflectY=function(t){return arguments.length?(x=t?-1:1,O()):x<0},C.precision=function(t){return arguments.length?(a=hh(s,T=t*t),k()):Ac(T)},C.fitExtent=function(t,e){return sh(C,t,e)},C.fitSize=function(t,e){return ch(C,t,e)},C.fitWidth=function(t,e){return lh(C,t,e)},C.fitHeight=function(t,e){return dh(C,t,e)},function(){return e=t.apply(this,arguments),C.invert=e.invert&&A,O()}}function yh(t){var e=0,n=hc/3,i=vh(t),r=i(e,n);return r.parallels=function(t){return arguments.length?i(e=t[0]*vc,n=t[1]*vc):[e*gc,n*gc]},r}function bh(t,e){var n=Tc(t),i=(n+Tc(e))/2;if(yc(i)<1e-6)return function(t){var e=xc(t);function n(t,n){return[t*e,Tc(n)/e]}return n.invert=function(t,n){return[t/e,Lc(n*e)]},n}(t);var r=1+n*(2*i-n),o=Ac(r)/i;function a(t,e){var n=Ac(r-2*i*Tc(e))/i;return[n*Tc(t*=i),o-n*xc(t)]}return a.invert=function(t,e){var n=o-e,a=_c(t,yc(n))*Cc(n);return n*i<0&&(a-=hc*Cc(t)*Cc(n)),[a/i,Lc((r-(t*t+n*n)*i*i)/(2*i))]},a}var _h=function(){return yh(bh).scale(155.424).center([0,33.6442])},xh=function(){return _h().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])};var wh=function(){var t,e,n,i,r,o,a=xh(),s=_h().rotate([154,0]).center([-2,58.5]).parallels([55,65]),c=_h().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(t,e){o=[t,e]}};function d(t){var e=t[0],a=t[1];return o=null,n.point(e,a),o||(i.point(e,a),o)||(r.point(e,a),o)}function u(){return t=e=null,d}return d.invert=function(t){var e=a.scale(),n=a.translate(),i=(t[0]-n[0])/e,r=(t[1]-n[1])/e;return(r>=.12&&r<.234&&i>=-.425&&i<-.214?s:r>=.166&&r<.234&&i>=-.214&&i<-.115?c:a).invert(t)},d.stream=function(n){return t&&e===n?t:(i=[a.stream(e=n),s.stream(n),c.stream(n)],r=i.length,t={point:function(t,e){for(var n=-1;++n<r;)i[n].point(t,e)},sphere:function(){for(var t=-1;++t<r;)i[t].sphere()},lineStart:function(){for(var t=-1;++t<r;)i[t].lineStart()},lineEnd:function(){for(var t=-1;++t<r;)i[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<r;)i[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<r;)i[t].polygonEnd()}});var i,r},d.precision=function(t){return arguments.length?(a.precision(t),s.precision(t),c.precision(t),u()):a.precision()},d.scale=function(t){return arguments.length?(a.scale(t),s.scale(.35*t),c.scale(t),d.translate(a.translate())):a.scale()},d.translate=function(t){if(!arguments.length)return a.translate();var e=a.scale(),o=+t[0],d=+t[1];return n=a.translate(t).clipExtent([[o-.455*e,d-.238*e],[o+.455*e,d+.238*e]]).stream(l),i=s.translate([o-.307*e,d+.201*e]).clipExtent([[o-.425*e+1e-6,d+.12*e+1e-6],[o-.214*e-1e-6,d+.234*e-1e-6]]).stream(l),r=c.translate([o-.205*e,d+.212*e]).clipExtent([[o-.214*e+1e-6,d+.166*e+1e-6],[o-.115*e-1e-6,d+.234*e-1e-6]]).stream(l),u()},d.fitExtent=function(t,e){return sh(d,t,e)},d.fitSize=function(t,e){return ch(d,t,e)},d.fitWidth=function(t,e){return lh(d,t,e)},d.fitHeight=function(t,e){return dh(d,t,e)},d.scale(1070)};function Sh(t){return function(e,n){var i=xc(e),r=xc(n),o=t(i*r);return[o*r*Tc(e),o*Tc(n)]}}function Mh(t){return function(e,n){var i=Ac(e*e+n*n),r=t(i),o=Tc(r),a=xc(r);return[_c(e*o,i*a),Lc(i&&n*o/i)]}}var Eh=Sh((function(t){return Ac(2/(1+t))}));Eh.invert=Mh((function(t){return 2*Lc(t/2)}));var Th=function(){return gh(Eh).scale(124.75).clipAngle(179.999)},Ch=Sh((function(t){return(t=kc(t))&&t/Tc(t)}));Ch.invert=Mh((function(t){return t}));var Ah=function(){return gh(Ch).scale(79.4188).clipAngle(179.999)};function Oh(t,e){return[t,Mc(Oc((pc+e)/2))]}Oh.invert=function(t,e){return[t,2*bc(Sc(e))-pc]};var kh=function(){return Lh(Oh).scale(961/mc)};function Lh(t){var e,n,i,r=gh(t),o=r.center,a=r.scale,s=r.translate,c=r.clipExtent,l=null;function d(){var o=hc*a(),s=r(dd(r.rotate()).invert([0,0]));return c(null==l?[[s[0]-o,s[1]-o],[s[0]+o,s[1]+o]]:t===Oh?[[Math.max(s[0]-o,l),e],[Math.min(s[0]+o,n),i]]:[[l,Math.max(s[1]-o,e)],[n,Math.min(s[1]+o,i)]])}return r.scale=function(t){return arguments.length?(a(t),d()):a()},r.translate=function(t){return arguments.length?(s(t),d()):s()},r.center=function(t){return arguments.length?(o(t),d()):o()},r.clipExtent=function(t){return arguments.length?(null==t?l=e=n=i=null:(l=+t[0][0],e=+t[0][1],n=+t[1][0],i=+t[1][1]),d()):null==l?null:[[l,e],[n,i]]},d()}function Ih(t){return Oc((pc+t)/2)}function Rh(t,e){var n=xc(t),i=t===e?Tc(t):Mc(n/xc(e))/Mc(Ih(e)/Ih(t)),r=n*Ec(Ih(t),i)/i;if(!i)return Oh;function o(t,e){r>0?e<1e-6-pc&&(e=1e-6-pc):e>pc-1e-6&&(e=pc-1e-6);var n=r/Ec(Ih(e),i);return[n*Tc(i*t),r-n*xc(i*t)]}return o.invert=function(t,e){var n=r-e,o=Cc(i)*Ac(t*t+n*n),a=_c(t,yc(n))*Cc(n);return n*i<0&&(a-=hc*Cc(t)*Cc(n)),[a/i,2*bc(Ec(r/o,1/i))-pc]},o}var Ph=function(){return yh(Rh).scale(109.5).parallels([30,30])};function Dh(t,e){return[t,e]}Dh.invert=Dh;var Nh=function(){return gh(Dh).scale(152.63)};function Fh(t,e){var n=xc(t),i=t===e?Tc(t):(n-xc(e))/(e-t),r=n/i+t;if(yc(i)<1e-6)return Dh;function o(t,e){var n=r-e,o=i*t;return[n*Tc(o),r-n*xc(o)]}return o.invert=function(t,e){var n=r-e,o=_c(t,yc(n))*Cc(n);return n*i<0&&(o-=hc*Cc(t)*Cc(n)),[o/i,r-Cc(i)*Ac(t*t+n*n)]},o}var jh=function(){return yh(Fh).scale(131.154).center([0,13.9389])},Bh=1.340264,zh=-.081106,Uh=893e-6,Hh=.003796,$h=Ac(3)/2;function Gh(t,e){var n=Lc($h*Tc(e)),i=n*n,r=i*i*i;return[t*xc(n)/($h*(Bh+3*zh*i+r*(7*Uh+9*Hh*i))),n*(Bh+zh*i+r*(Uh+Hh*i))]}Gh.invert=function(t,e){for(var n,i=e,r=i*i,o=r*r*r,a=0;a<12&&(o=(r=(i-=n=(i*(Bh+zh*r+o*(Uh+Hh*r))-e)/(Bh+3*zh*r+o*(7*Uh+9*Hh*r)))*i)*r*r,!(yc(n)<1e-12));++a);return[$h*t*(Bh+3*zh*r+o*(7*Uh+9*Hh*r))/xc(i),Lc(Tc(i)/$h)]};var Vh=function(){return gh(Gh).scale(177.158)};function Wh(t,e){var n=xc(e),i=xc(t)*n;return[n*Tc(t)/i,Tc(e)/i]}Wh.invert=Mh(bc);var qh=function(){return gh(Wh).scale(144.049).clipAngle(60)},Xh=function(){var t,e,n,i,r,o,a,s=1,c=0,l=0,d=1,u=1,h=0,p=null,f=1,m=1,g=rh({point:function(t,e){var n=b([t,e]);this.stream.point(n[0],n[1])}}),v=ou;function y(){return f=s*d,m=s*u,o=a=null,b}function b(n){var i=n[0]*f,r=n[1]*m;if(h){var o=r*t-i*e;i=i*t+r*e,r=o}return[i+c,r+l]}return b.invert=function(n){var i=n[0]-c,r=n[1]-l;if(h){var o=r*t+i*e;i=i*t-r*e,r=o}return[i/f,r/m]},b.stream=function(t){return o&&a===t?o:o=g(v(a=t))},b.postclip=function(t){return arguments.length?(v=t,p=n=i=r=null,y()):v},b.clipExtent=function(t){return arguments.length?(v=null==t?(p=n=i=r=null,ou):Cd(p=+t[0][0],n=+t[0][1],i=+t[1][0],r=+t[1][1]),y()):null==p?null:[[p,n],[i,r]]},b.scale=function(t){return arguments.length?(s=+t,y()):s},b.translate=function(t){return arguments.length?(c=+t[0],l=+t[1],y()):[c,l]},b.angle=function(n){return arguments.length?(e=Tc(h=n%360*vc),t=xc(h),y()):h*gc},b.reflectX=function(t){return arguments.length?(d=t?-1:1,y()):d<0},b.reflectY=function(t){return arguments.length?(u=t?-1:1,y()):u<0},b.fitExtent=function(t,e){return sh(b,t,e)},b.fitSize=function(t,e){return ch(b,t,e)},b.fitWidth=function(t,e){return lh(b,t,e)},b.fitHeight=function(t,e){return dh(b,t,e)},b};function Yh(t,e){var n=e*e,i=n*n;return[t*(.8707-.131979*n+i*(i*(.003971*n-.001529*i)-.013791)),e*(1.007226+n*(.015085+i*(.028874*n-.044475-.005916*i)))]}Yh.invert=function(t,e){var n,i=e,r=25;do{var o=i*i,a=o*o;i-=n=(i*(1.007226+o*(.015085+a*(.028874*o-.044475-.005916*a)))-e)/(1.007226+o*(.045255+a*(.259866*o-.311325-.005916*11*a)))}while(yc(n)>1e-6&&--r>0);return[t/(.8707+(o=i*i)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),i]};var Kh=function(){return gh(Yh).scale(175.295)};function Zh(t,e){return[xc(e)*Tc(t),Tc(e)]}Zh.invert=Mh(Lc);var Jh=function(){return gh(Zh).scale(249.5).clipAngle(90.000001)};function Qh(t,e){var n=xc(e),i=1+xc(t)*n;return[n*Tc(t)/i,Tc(e)/i]}Qh.invert=Mh((function(t){return 2*bc(t)}));var tp=function(){return gh(Qh).scale(250).clipAngle(142)};function ep(t,e){return[Mc(Oc((pc+e)/2)),-t]}ep.invert=function(t,e){return[-e,2*bc(Sc(t))-pc]};var np=function(){var t=Lh(ep),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)};function ip(t,e){return t.parent===e.parent?1:2}function rp(t,e){return t+e.x}function op(t,e){return Math.max(t,e.y)}var ap=function(){var t=ip,e=1,n=1,i=!1;function r(r){var o,a=0;r.eachAfter((function(e){var n=e.children;n?(e.x=function(t){return t.reduce(rp,0)/t.length}(n),e.y=function(t){return 1+t.reduce(op,0)}(n)):(e.x=o?a+=t(e,o):0,e.y=0,o=e)}));var s=function(t){for(var e;e=t.children;)t=e[0];return t}(r),c=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(r),l=s.x-t(s,c)/2,d=c.x+t(c,s)/2;return r.eachAfter(i?function(t){t.x=(t.x-r.x)*e,t.y=(r.y-t.y)*n}:function(t){t.x=(t.x-l)/(d-l)*e,t.y=(1-(r.y?t.y/r.y:1))*n})}return r.separation=function(e){return arguments.length?(t=e,r):t},r.size=function(t){return arguments.length?(i=!1,e=+t[0],n=+t[1],r):i?null:[e,n]},r.nodeSize=function(t){return arguments.length?(i=!0,e=+t[0],n=+t[1],r):i?[e,n]:null},r};function sp(t){var e=0,n=t.children,i=n&&n.length;if(i)for(;--i>=0;)e+=n[i].value;else e=1;t.value=e}function cp(t,e){var n,i,r,o,a,s=new hp(t),c=+t.value&&(s.value=t.value),l=[s];for(null==e&&(e=lp);n=l.pop();)if(c&&(n.value=+n.data.value),(r=e(n.data))&&(a=r.length))for(n.children=new Array(a),o=a-1;o>=0;--o)l.push(i=n.children[o]=new hp(r[o])),i.parent=n,i.depth=n.depth+1;return s.eachBefore(up)}function lp(t){return t.children}function dp(t){t.data=t.data.data}function up(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function hp(t){this.data=t,this.depth=this.height=0,this.parent=null}hp.prototype=cp.prototype={constructor:hp,count:function(){return this.eachAfter(sp)},each:function(t){var e,n,i,r,o=this,a=[o];do{for(e=a.reverse(),a=[];o=e.pop();)if(t(o),n=o.children)for(i=0,r=n.length;i<r;++i)a.push(n[i])}while(a.length);return this},eachAfter:function(t){for(var e,n,i,r=this,o=[r],a=[];r=o.pop();)if(a.push(r),e=r.children)for(n=0,i=e.length;n<i;++n)o.push(e[n]);for(;r=a.pop();)t(r);return this},eachBefore:function(t){for(var e,n,i=this,r=[i];i=r.pop();)if(t(i),e=i.children)for(n=e.length-1;n>=0;--n)r.push(e[n]);return this},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,i=e.children,r=i&&i.length;--r>=0;)n+=i[r].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),i=e.ancestors(),r=null;t=n.pop(),e=i.pop();for(;t===e;)r=t,t=n.pop(),e=i.pop();return r}(e,t),i=[e];e!==n;)e=e.parent,i.push(e);for(var r=i.length;t!==n;)i.splice(r,0,t),t=t.parent;return i},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){var t=[];return this.each((function(e){t.push(e)})),t},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return cp(this).eachBefore(dp)}};var pp=Array.prototype.slice;var fp=function(t){for(var e,n,i=0,r=(t=function(t){for(var e,n,i=t.length;i;)n=Math.random()*i--|0,e=t[i],t[i]=t[n],t[n]=e;return t}(pp.call(t))).length,o=[];i<r;)e=t[i],n&&vp(n,e)?++i:(n=bp(o=mp(o,e)),i=0);return n};function mp(t,e){var n,i;if(yp(e,t))return[e];for(n=0;n<t.length;++n)if(gp(e,t[n])&&yp(_p(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(i=n+1;i<t.length;++i)if(gp(_p(t[n],t[i]),e)&&gp(_p(t[n],e),t[i])&&gp(_p(t[i],e),t[n])&&yp(xp(t[n],t[i],e),t))return[t[n],t[i],e];throw new Error}function gp(t,e){var n=t.r-e.r,i=e.x-t.x,r=e.y-t.y;return n<0||n*n<i*i+r*r}function vp(t,e){var n=t.r-e.r+1e-6,i=e.x-t.x,r=e.y-t.y;return n>0&&n*n>i*i+r*r}function yp(t,e){for(var n=0;n<e.length;++n)if(!vp(t,e[n]))return!1;return!0}function bp(t){switch(t.length){case 1:return{x:(e=t[0]).x,y:e.y,r:e.r};case 2:return _p(t[0],t[1]);case 3:return xp(t[0],t[1],t[2])}var e}function _p(t,e){var n=t.x,i=t.y,r=t.r,o=e.x,a=e.y,s=e.r,c=o-n,l=a-i,d=s-r,u=Math.sqrt(c*c+l*l);return{x:(n+o+c/u*d)/2,y:(i+a+l/u*d)/2,r:(u+r+s)/2}}function xp(t,e,n){var i=t.x,r=t.y,o=t.r,a=e.x,s=e.y,c=e.r,l=n.x,d=n.y,u=n.r,h=i-a,p=i-l,f=r-s,m=r-d,g=c-o,v=u-o,y=i*i+r*r-o*o,b=y-a*a-s*s+c*c,_=y-l*l-d*d+u*u,x=p*f-h*m,w=(f*_-m*b)/(2*x)-i,S=(m*g-f*v)/x,M=(p*b-h*_)/(2*x)-r,E=(h*v-p*g)/x,T=S*S+E*E-1,C=2*(o+w*S+M*E),A=w*w+M*M-o*o,O=-(T?(C+Math.sqrt(C*C-4*T*A))/(2*T):A/C);return{x:i+w+S*O,y:r+M+E*O,r:O}}function wp(t,e,n){var i,r,o,a,s=t.x-e.x,c=t.y-e.y,l=s*s+c*c;l?(r=e.r+n.r,r*=r,a=t.r+n.r,r>(a*=a)?(i=(l+a-r)/(2*l),o=Math.sqrt(Math.max(0,a/l-i*i)),n.x=t.x-i*s-o*c,n.y=t.y-i*c+o*s):(i=(l+r-a)/(2*l),o=Math.sqrt(Math.max(0,r/l-i*i)),n.x=e.x+i*s-o*c,n.y=e.y+i*c+o*s)):(n.x=e.x+n.r,n.y=e.y)}function Sp(t,e){var n=t.r+e.r-1e-6,i=e.x-t.x,r=e.y-t.y;return n>0&&n*n>i*i+r*r}function Mp(t){var e=t._,n=t.next._,i=e.r+n.r,r=(e.x*n.r+n.x*e.r)/i,o=(e.y*n.r+n.y*e.r)/i;return r*r+o*o}function Ep(t){this._=t,this.next=null,this.previous=null}function Tp(t){if(!(r=t.length))return 0;var e,n,i,r,o,a,s,c,l,d,u;if((e=t[0]).x=0,e.y=0,!(r>1))return e.r;if(n=t[1],e.x=-n.r,n.x=e.r,n.y=0,!(r>2))return e.r+n.r;wp(n,e,i=t[2]),e=new Ep(e),n=new Ep(n),i=new Ep(i),e.next=i.previous=n,n.next=e.previous=i,i.next=n.previous=e;t:for(s=3;s<r;++s){wp(e._,n._,i=t[s]),i=new Ep(i),c=n.next,l=e.previous,d=n._.r,u=e._.r;do{if(d<=u){if(Sp(c._,i._)){n=c,e.next=n,n.previous=e,--s;continue t}d+=c._.r,c=c.next}else{if(Sp(l._,i._)){(e=l).next=n,n.previous=e,--s;continue t}u+=l._.r,l=l.previous}}while(c!==l.next);for(i.previous=e,i.next=n,e.next=n.previous=n=i,o=Mp(e);(i=i.next)!==n;)(a=Mp(i))<o&&(e=i,o=a);n=e.next}for(e=[n._],i=n;(i=i.next)!==n;)e.push(i._);for(i=fp(e),s=0;s<r;++s)(e=t[s]).x-=i.x,e.y-=i.y;return i.r}var Cp=function(t){return Tp(t),t};function Ap(t){return null==t?null:Op(t)}function Op(t){if(\"function\"!=typeof t)throw new Error;return t}function kp(){return 0}var Lp=function(t){return function(){return t}};function Ip(t){return Math.sqrt(t.value)}var Rp=function(){var t=null,e=1,n=1,i=kp;function r(r){return r.x=e/2,r.y=n/2,t?r.eachBefore(Pp(t)).eachAfter(Dp(i,.5)).eachBefore(Np(1)):r.eachBefore(Pp(Ip)).eachAfter(Dp(kp,1)).eachAfter(Dp(i,r.r/Math.min(e,n))).eachBefore(Np(Math.min(e,n)/(2*r.r))),r}return r.radius=function(e){return arguments.length?(t=Ap(e),r):t},r.size=function(t){return arguments.length?(e=+t[0],n=+t[1],r):[e,n]},r.padding=function(t){return arguments.length?(i=\"function\"==typeof t?t:Lp(+t),r):i},r};function Pp(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function Dp(t,e){return function(n){if(i=n.children){var i,r,o,a=i.length,s=t(n)*e||0;if(s)for(r=0;r<a;++r)i[r].r+=s;if(o=Tp(i),s)for(r=0;r<a;++r)i[r].r-=s;n.r=o+s}}}function Np(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}var Fp=function(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)},jp=function(t,e,n,i,r){for(var o,a=t.children,s=-1,c=a.length,l=t.value&&(i-e)/t.value;++s<c;)(o=a[s]).y0=n,o.y1=r,o.x0=e,o.x1=e+=o.value*l},Bp=function(){var t=1,e=1,n=0,i=!1;function r(r){var o=r.height+1;return r.x0=r.y0=n,r.x1=t,r.y1=e/o,r.eachBefore(function(t,e){return function(i){i.children&&jp(i,i.x0,t*(i.depth+1)/e,i.x1,t*(i.depth+2)/e);var r=i.x0,o=i.y0,a=i.x1-n,s=i.y1-n;a<r&&(r=a=(r+a)/2),s<o&&(o=s=(o+s)/2),i.x0=r,i.y0=o,i.x1=a,i.y1=s}}(e,o)),i&&r.eachBefore(Fp),r}return r.round=function(t){return arguments.length?(i=!!t,r):i},r.size=function(n){return arguments.length?(t=+n[0],e=+n[1],r):[t,e]},r.padding=function(t){return arguments.length?(n=+t,r):n},r},zp={depth:-1},Up={};function Hp(t){return t.id}function $p(t){return t.parentId}var Gp=function(){var t=Hp,e=$p;function n(n){var i,r,o,a,s,c,l,d=n.length,u=new Array(d),h={};for(r=0;r<d;++r)i=n[r],s=u[r]=new hp(i),null!=(c=t(i,r,n))&&(c+=\"\")&&(h[l=\"$\"+(s.id=c)]=l in h?Up:s);for(r=0;r<d;++r)if(s=u[r],null!=(c=e(n[r],r,n))&&(c+=\"\")){if(!(a=h[\"$\"+c]))throw new Error(\"missing: \"+c);if(a===Up)throw new Error(\"ambiguous: \"+c);a.children?a.children.push(s):a.children=[s],s.parent=a}else{if(o)throw new Error(\"multiple roots\");o=s}if(!o)throw new Error(\"no root\");if(o.parent=zp,o.eachBefore((function(t){t.depth=t.parent.depth+1,--d})).eachBefore(up),o.parent=null,d>0)throw new Error(\"cycle\");return o}return n.id=function(e){return arguments.length?(t=Op(e),n):t},n.parentId=function(t){return arguments.length?(e=Op(t),n):e},n};function Vp(t,e){return t.parent===e.parent?1:2}function Wp(t){var e=t.children;return e?e[0]:t.t}function qp(t){var e=t.children;return e?e[e.length-1]:t.t}function Xp(t,e,n){var i=n/(e.i-t.i);e.c-=i,e.s+=n,t.c+=i,e.z+=n,e.m+=n}function Yp(t,e,n){return t.a.parent===e.parent?t.a:n}function Kp(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}Kp.prototype=Object.create(hp.prototype);var Zp=function(){var t=Vp,e=1,n=1,i=null;function r(r){var c=function(t){for(var e,n,i,r,o,a=new Kp(t,0),s=[a];e=s.pop();)if(i=e._.children)for(e.children=new Array(o=i.length),r=o-1;r>=0;--r)s.push(n=e.children[r]=new Kp(i[r],r)),n.parent=e;return(a.parent=new Kp(null,0)).children=[a],a}(r);if(c.eachAfter(o),c.parent.m=-c.z,c.eachBefore(a),i)r.eachBefore(s);else{var l=r,d=r,u=r;r.eachBefore((function(t){t.x<l.x&&(l=t),t.x>d.x&&(d=t),t.depth>u.depth&&(u=t)}));var h=l===d?1:t(l,d)/2,p=h-l.x,f=e/(d.x+h+p),m=n/(u.depth||1);r.eachBefore((function(t){t.x=(t.x+p)*f,t.y=t.depth*m}))}return r}function o(e){var n=e.children,i=e.parent.children,r=e.i?i[e.i-1]:null;if(n){!function(t){for(var e,n=0,i=0,r=t.children,o=r.length;--o>=0;)(e=r[o]).z+=n,e.m+=n,n+=e.s+(i+=e.c)}(e);var o=(n[0].z+n[n.length-1].z)/2;r?(e.z=r.z+t(e._,r._),e.m=e.z-o):e.z=o}else r&&(e.z=r.z+t(e._,r._));e.parent.A=function(e,n,i){if(n){for(var r,o=e,a=e,s=n,c=o.parent.children[0],l=o.m,d=a.m,u=s.m,h=c.m;s=qp(s),o=Wp(o),s&&o;)c=Wp(c),(a=qp(a)).a=e,(r=s.z+u-o.z-l+t(s._,o._))>0&&(Xp(Yp(s,e,i),e,r),l+=r,d+=r),u+=s.m,l+=o.m,h+=c.m,d+=a.m;s&&!qp(a)&&(a.t=s,a.m+=u-d),o&&!Wp(c)&&(c.t=o,c.m+=l-h,i=e)}return i}(e,r,e.parent.A||i[0])}function a(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function s(t){t.x*=e,t.y=t.depth*n}return r.separation=function(e){return arguments.length?(t=e,r):t},r.size=function(t){return arguments.length?(i=!1,e=+t[0],n=+t[1],r):i?null:[e,n]},r.nodeSize=function(t){return arguments.length?(i=!0,e=+t[0],n=+t[1],r):i?[e,n]:null},r},Jp=function(t,e,n,i,r){for(var o,a=t.children,s=-1,c=a.length,l=t.value&&(r-n)/t.value;++s<c;)(o=a[s]).x0=e,o.x1=i,o.y0=n,o.y1=n+=o.value*l},Qp=(1+Math.sqrt(5))/2;function tf(t,e,n,i,r,o){for(var a,s,c,l,d,u,h,p,f,m,g,v=[],y=e.children,b=0,_=0,x=y.length,w=e.value;b<x;){c=r-n,l=o-i;do{d=y[_++].value}while(!d&&_<x);for(u=h=d,g=d*d*(m=Math.max(l/c,c/l)/(w*t)),f=Math.max(h/g,g/u);_<x;++_){if(d+=s=y[_].value,s<u&&(u=s),s>h&&(h=s),g=d*d*m,(p=Math.max(h/g,g/u))>f){d-=s;break}f=p}v.push(a={value:d,dice:c<l,children:y.slice(b,_)}),a.dice?jp(a,n,i,r,w?i+=l*d/w:o):Jp(a,n,i,w?n+=c*d/w:r,o),w-=d,b=_}return v}var ef=function t(e){function n(t,n,i,r,o){tf(e,t,n,i,r,o)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(Qp),nf=function(){var t=ef,e=!1,n=1,i=1,r=[0],o=kp,a=kp,s=kp,c=kp,l=kp;function d(t){return t.x0=t.y0=0,t.x1=n,t.y1=i,t.eachBefore(u),r=[0],e&&t.eachBefore(Fp),t}function u(e){var n=r[e.depth],i=e.x0+n,d=e.y0+n,u=e.x1-n,h=e.y1-n;u<i&&(i=u=(i+u)/2),h<d&&(d=h=(d+h)/2),e.x0=i,e.y0=d,e.x1=u,e.y1=h,e.children&&(n=r[e.depth+1]=o(e)/2,i+=l(e)-n,d+=a(e)-n,(u-=s(e)-n)<i&&(i=u=(i+u)/2),(h-=c(e)-n)<d&&(d=h=(d+h)/2),t(e,i,d,u,h))}return d.round=function(t){return arguments.length?(e=!!t,d):e},d.size=function(t){return arguments.length?(n=+t[0],i=+t[1],d):[n,i]},d.tile=function(e){return arguments.length?(t=Op(e),d):t},d.padding=function(t){return arguments.length?d.paddingInner(t).paddingOuter(t):d.paddingInner()},d.paddingInner=function(t){return arguments.length?(o=\"function\"==typeof t?t:Lp(+t),d):o},d.paddingOuter=function(t){return arguments.length?d.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):d.paddingTop()},d.paddingTop=function(t){return arguments.length?(a=\"function\"==typeof t?t:Lp(+t),d):a},d.paddingRight=function(t){return arguments.length?(s=\"function\"==typeof t?t:Lp(+t),d):s},d.paddingBottom=function(t){return arguments.length?(c=\"function\"==typeof t?t:Lp(+t),d):c},d.paddingLeft=function(t){return arguments.length?(l=\"function\"==typeof t?t:Lp(+t),d):l},d},rf=function(t,e,n,i,r){var o,a,s=t.children,c=s.length,l=new Array(c+1);for(l[0]=a=o=0;o<c;++o)l[o+1]=a+=s[o].value;!function t(e,n,i,r,o,a,c){if(e>=n-1){var d=s[e];return d.x0=r,d.y0=o,d.x1=a,void(d.y1=c)}var u=l[e],h=i/2+u,p=e+1,f=n-1;for(;p<f;){var m=p+f>>>1;l[m]<h?p=m+1:f=m}h-l[p-1]<l[p]-h&&e+1<p&&--p;var g=l[p]-u,v=i-g;if(a-r>c-o){var y=(r*v+a*g)/i;t(e,p,g,r,o,y,c),t(p,n,v,y,o,a,c)}else{var b=(o*v+c*g)/i;t(e,p,g,r,o,a,b),t(p,n,v,r,b,a,c)}}(0,c,t.value,e,n,i,r)},of=function(t,e,n,i,r){(1&t.depth?Jp:jp)(t,e,n,i,r)},af=function t(e){function n(t,n,i,r,o){if((a=t._squarify)&&a.ratio===e)for(var a,s,c,l,d,u=-1,h=a.length,p=t.value;++u<h;){for(c=(s=a[u]).children,l=s.value=0,d=c.length;l<d;++l)s.value+=c[l].value;s.dice?jp(s,n,i,r,i+=(o-i)*s.value/p):Jp(s,n,i,n+=(r-n)*s.value/p,o),p-=s.value}else t._squarify=a=tf(e,t,n,i,r,o),a.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(Qp),sf=function(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}},cf=function(t,e){var n=dn(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}},lf=function(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}},df=Math.SQRT2;function uf(t){return((t=Math.exp(t))+1/t)/2}var hf=function(t,e){var n,i,r=t[0],o=t[1],a=t[2],s=e[0],c=e[1],l=e[2],d=s-r,u=c-o,h=d*d+u*u;if(h<1e-12)i=Math.log(l/a)/df,n=function(t){return[r+t*d,o+t*u,a*Math.exp(df*t*i)]};else{var p=Math.sqrt(h),f=(l*l-a*a+4*h)/(2*a*2*p),m=(l*l-a*a-4*h)/(2*l*2*p),g=Math.log(Math.sqrt(f*f+1)-f),v=Math.log(Math.sqrt(m*m+1)-m);i=(v-g)/df,n=function(t){var e,n=t*i,s=uf(g),c=a/(2*p)*(s*(e=df*n+g,((e=Math.exp(2*e))-1)/(e+1))-function(t){return((t=Math.exp(t))-1/t)/2}(g));return[r+c*d,o+c*u,a*s/uf(df*n+g)]}}return n.duration=1e3*i,n};function pf(t){return function(e,n){var i=t((e=en(e)).h,(n=en(n)).h),r=hn(e.s,n.s),o=hn(e.l,n.l),a=hn(e.opacity,n.opacity);return function(t){return e.h=i(t),e.s=r(t),e.l=o(t),e.opacity=a(t),e+\"\"}}}var ff=pf(dn),mf=pf(hn);function gf(t,e){var n=hn((t=go(t)).l,(e=go(e)).l),i=hn(t.a,e.a),r=hn(t.b,e.b),o=hn(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=i(e),t.b=r(e),t.opacity=o(e),t+\"\"}}function vf(t){return function(e,n){var i=t((e=Mo(e)).h,(n=Mo(n)).h),r=hn(e.c,n.c),o=hn(e.l,n.l),a=hn(e.opacity,n.opacity);return function(t){return e.h=i(t),e.c=r(t),e.l=o(t),e.opacity=a(t),e+\"\"}}}var yf=vf(dn),bf=vf(hn);function _f(t){return function e(n){function i(e,i){var r=t((e=Io(e)).h,(i=Io(i)).h),o=hn(e.s,i.s),a=hn(e.l,i.l),s=hn(e.opacity,i.opacity);return function(t){return e.h=r(t),e.s=o(t),e.l=a(Math.pow(t,n)),e.opacity=s(t),e+\"\"}}return n=+n,i.gamma=e,i}(1)}var xf=_f(dn),wf=_f(hn);function Sf(t,e){for(var n=0,i=e.length-1,r=e[0],o=new Array(i<0?0:i);n<i;)o[n]=t(r,r=e[++n]);return function(t){var e=Math.max(0,Math.min(i-1,Math.floor(t*=i)));return o[e](t-e)}}var Mf=function(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t(i/(e-1));return n},Ef=function(t){for(var e,n=-1,i=t.length,r=t[i-1],o=0;++n<i;)e=r,r=t[n],o+=e[1]*r[0]-e[0]*r[1];return o/2},Tf=function(t){for(var e,n,i=-1,r=t.length,o=0,a=0,s=t[r-1],c=0;++i<r;)e=s,s=t[i],c+=n=e[0]*s[1]-s[0]*e[1],o+=(e[0]+s[0])*n,a+=(e[1]+s[1])*n;return[o/(c*=3),a/c]};function Cf(t,e){return t[0]-e[0]||t[1]-e[1]}function Af(t){for(var e,n,i,r=t.length,o=[0,1],a=2,s=2;s<r;++s){for(;a>1&&(e=t[o[a-2]],n=t[o[a-1]],i=t[s],(n[0]-e[0])*(i[1]-e[1])-(n[1]-e[1])*(i[0]-e[0])<=0);)--a;o[a++]=s}return o.slice(0,a)}var Of=function(t){if((n=t.length)<3)return null;var e,n,i=new Array(n),r=new Array(n);for(e=0;e<n;++e)i[e]=[+t[e][0],+t[e][1],e];for(i.sort(Cf),e=0;e<n;++e)r[e]=[i[e][0],-i[e][1]];var o=Af(i),a=Af(r),s=a[0]===o[0],c=a[a.length-1]===o[o.length-1],l=[];for(e=o.length-1;e>=0;--e)l.push(t[i[o[e]][2]]);for(e=+s;e<a.length-c;++e)l.push(t[i[a[e]][2]]);return l},kf=function(t,e){for(var n,i,r=t.length,o=t[r-1],a=e[0],s=e[1],c=o[0],l=o[1],d=!1,u=0;u<r;++u)n=(o=t[u])[0],(i=o[1])>s!=l>s&&a<(c-n)*(s-i)/(l-i)+n&&(d=!d),c=n,l=i;return d},Lf=function(t){for(var e,n,i=-1,r=t.length,o=t[r-1],a=o[0],s=o[1],c=0;++i<r;)e=a,n=s,e-=a=(o=t[i])[0],n-=s=o[1],c+=Math.sqrt(e*e+n*n);return c},If=function(){return Math.random()},Rf=function t(e){function n(t,n){return t=null==t?0:+t,n=null==n?1:+n,1===arguments.length?(n=t,t=0):n-=t,function(){return e()*n+t}}return n.source=t,n}(If),Pf=function t(e){function n(t,n){var i,r;return t=null==t?0:+t,n=null==n?1:+n,function(){var o;if(null!=i)o=i,i=null;else do{i=2*e()-1,o=2*e()-1,r=i*i+o*o}while(!r||r>1);return t+n*o*Math.sqrt(-2*Math.log(r)/r)}}return n.source=t,n}(If),Df=function t(e){function n(){var t=Pf.source(e).apply(this,arguments);return function(){return Math.exp(t())}}return n.source=t,n}(If),Nf=function t(e){function n(t){return function(){for(var n=0,i=0;i<t;++i)n+=e();return n}}return n.source=t,n}(If),Ff=function t(e){function n(t){var n=Nf.source(e)(t);return function(){return n()/t}}return n.source=t,n}(If),jf=function t(e){function n(t){return function(){return-Math.log(1-e())/t}}return n.source=t,n}(If);function Bf(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function zf(t,e){switch(arguments.length){case 0:break;case 1:this.interpolator(t);break;default:this.interpolator(e).domain(t)}return this}var Uf=Array.prototype,Hf=Uf.map,$f=Uf.slice,Gf={name:\"implicit\"};function Vf(){var t=Jr(),e=[],n=[],i=Gf;function r(r){var o=r+\"\",a=t.get(o);if(!a){if(i!==Gf)return i;t.set(o,a=e.push(r))}return n[(a-1)%n.length]}return r.domain=function(n){if(!arguments.length)return e.slice();e=[],t=Jr();for(var i,o,a=-1,s=n.length;++a<s;)t.has(o=(i=n[a])+\"\")||t.set(o,e.push(i));return r},r.range=function(t){return arguments.length?(n=$f.call(t),r):n.slice()},r.unknown=function(t){return arguments.length?(i=t,r):i},r.copy=function(){return Vf(e,n).unknown(i)},Bf.apply(r,arguments),r}function Wf(){var t,e,n=Vf().unknown(void 0),i=n.domain,r=n.range,o=[0,1],a=!1,s=0,c=0,l=.5;function d(){var n=i().length,d=o[1]<o[0],u=o[d-0],h=o[1-d];t=(h-u)/Math.max(1,n-s+2*c),a&&(t=Math.floor(t)),u+=(h-u-t*(n-s))*l,e=t*(1-s),a&&(u=Math.round(u),e=Math.round(e));var p=S(n).map((function(e){return u+t*e}));return r(d?p.reverse():p)}return delete n.unknown,n.domain=function(t){return arguments.length?(i(t),d()):i()},n.range=function(t){return arguments.length?(o=[+t[0],+t[1]],d()):o.slice()},n.rangeRound=function(t){return o=[+t[0],+t[1]],a=!0,d()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(a=!!t,d()):a},n.padding=function(t){return arguments.length?(s=Math.min(1,c=+t),d()):s},n.paddingInner=function(t){return arguments.length?(s=Math.min(1,t),d()):s},n.paddingOuter=function(t){return arguments.length?(c=+t,d()):c},n.align=function(t){return arguments.length?(l=Math.max(0,Math.min(1,t)),d()):l},n.copy=function(){return Wf(i(),o).round(a).paddingInner(s).paddingOuter(c).align(l)},Bf.apply(d(),arguments)}function qf(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return qf(e())},t}function Xf(){return qf(Wf.apply(null,arguments).paddingInner(1))}var Yf=function(t){return+t},Kf=[0,1];function Zf(t){return t}function Jf(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function Qf(t){var e,n=t[0],i=t[t.length-1];return n>i&&(e=n,n=i,i=e),function(t){return Math.max(n,Math.min(i,t))}}function tm(t,e,n){var i=t[0],r=t[1],o=e[0],a=e[1];return r<i?(i=Jf(r,i),o=n(a,o)):(i=Jf(i,r),o=n(o,a)),function(t){return o(i(t))}}function em(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),o=new Array(i),a=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<i;)r[a]=Jf(t[a],t[a+1]),o[a]=n(e[a],e[a+1]);return function(e){var n=l(t,e,1,i)-1;return o[n](r[n](e))}}function nm(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function im(){var t,e,n,i,r,o,a=Kf,s=Kf,c=On,l=Zf;function d(){return i=Math.min(a.length,s.length)>2?em:tm,r=o=null,u}function u(e){return isNaN(e=+e)?n:(r||(r=i(a.map(t),s,c)))(t(l(e)))}return u.invert=function(n){return l(e((o||(o=i(s,a.map(t),wn)))(n)))},u.domain=function(t){return arguments.length?(a=Hf.call(t,Yf),l===Zf||(l=Qf(a)),d()):a.slice()},u.range=function(t){return arguments.length?(s=$f.call(t),d()):s.slice()},u.rangeRound=function(t){return s=$f.call(t),c=lf,d()},u.clamp=function(t){return arguments.length?(l=t?Qf(a):Zf,u):l!==Zf},u.interpolate=function(t){return arguments.length?(c=t,d()):c},u.unknown=function(t){return arguments.length?(n=t,u):n},function(n,i){return t=n,e=i,d()}}function rm(t,e){return im()(t,e)}var om=function(t,e,n,i){var r,o=O(t,e,n);switch((i=Ws(null==i?\",f\":i)).type){case\"s\":var a=Math.max(Math.abs(t),Math.abs(e));return null!=i.precision||isNaN(r=ac(o,a))||(i.precision=r),Zs(i,a);case\"\":case\"e\":case\"g\":case\"p\":case\"r\":null!=i.precision||isNaN(r=sc(o,Math.max(Math.abs(t),Math.abs(e))))||(i.precision=r-(\"e\"===i.type));break;case\"f\":case\"%\":null!=i.precision||isNaN(r=oc(o))||(i.precision=r-2*(\"%\"===i.type))}return Ks(i)};function am(t){var e=t.domain;return t.ticks=function(t){var n=e();return C(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var i=e();return om(i[0],i[i.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var i,r=e(),o=0,a=r.length-1,s=r[o],c=r[a];return c<s&&(i=s,s=c,c=i,i=o,o=a,a=i),(i=A(s,c,n))>0?i=A(s=Math.floor(s/i)*i,c=Math.ceil(c/i)*i,n):i<0&&(i=A(s=Math.ceil(s*i)/i,c=Math.floor(c*i)/i,n)),i>0?(r[o]=Math.floor(s/i)*i,r[a]=Math.ceil(c/i)*i,e(r)):i<0&&(r[o]=Math.ceil(s*i)/i,r[a]=Math.floor(c*i)/i,e(r)),t},t}function sm(){var t=rm(Zf,Zf);return t.copy=function(){return nm(t,sm())},Bf.apply(t,arguments),am(t)}function cm(t){var e;function n(t){return isNaN(t=+t)?e:t}return n.invert=n,n.domain=n.range=function(e){return arguments.length?(t=Hf.call(e,Yf),n):t.slice()},n.unknown=function(t){return arguments.length?(e=t,n):e},n.copy=function(){return cm(t).unknown(e)},t=arguments.length?Hf.call(t,Yf):[0,1],am(n)}var lm=function(t,e){var n,i=0,r=(t=t.slice()).length-1,o=t[i],a=t[r];return a<o&&(n=i,i=r,r=n,n=o,o=a,a=n),t[i]=e.floor(o),t[r]=e.ceil(a),t};function dm(t){return Math.log(t)}function um(t){return Math.exp(t)}function hm(t){return-Math.log(-t)}function pm(t){return-Math.exp(-t)}function fm(t){return isFinite(t)?+(\"1e\"+t):t<0?0:t}function mm(t){return function(e){return-t(-e)}}function gm(t){var e,n,i=t(dm,um),r=i.domain,o=10;function a(){return e=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}(o),n=function(t){return 10===t?fm:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}(o),r()[0]<0?(e=mm(e),n=mm(n),t(hm,pm)):t(dm,um),i}return i.base=function(t){return arguments.length?(o=+t,a()):o},i.domain=function(t){return arguments.length?(r(t),a()):r()},i.ticks=function(t){var i,a=r(),s=a[0],c=a[a.length-1];(i=c<s)&&(h=s,s=c,c=h);var l,d,u,h=e(s),p=e(c),f=null==t?10:+t,m=[];if(!(o%1)&&p-h<f){if(h=Math.round(h)-1,p=Math.round(p)+1,s>0){for(;h<p;++h)for(d=1,l=n(h);d<o;++d)if(!((u=l*d)<s)){if(u>c)break;m.push(u)}}else for(;h<p;++h)for(d=o-1,l=n(h);d>=1;--d)if(!((u=l*d)<s)){if(u>c)break;m.push(u)}}else m=C(h,p,Math.min(p-h,f)).map(n);return i?m.reverse():m},i.tickFormat=function(t,r){if(null==r&&(r=10===o?\".0e\":\",\"),\"function\"!=typeof r&&(r=Ks(r)),t===1/0)return r;null==t&&(t=10);var a=Math.max(1,o*t/i.ticks().length);return function(t){var i=t/n(Math.round(e(t)));return i*o<o-.5&&(i*=o),i<=a?r(t):\"\"}},i.nice=function(){return r(lm(r(),{floor:function(t){return n(Math.floor(e(t)))},ceil:function(t){return n(Math.ceil(e(t)))}}))},i}function vm(){var t=gm(im()).domain([1,10]);return t.copy=function(){return nm(t,vm()).base(t.base())},Bf.apply(t,arguments),t}function ym(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function bm(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function _m(t){var e=1,n=t(ym(e),bm(e));return n.constant=function(n){return arguments.length?t(ym(e=+n),bm(e)):e},am(n)}function xm(){var t=_m(im());return t.copy=function(){return nm(t,xm()).constant(t.constant())},Bf.apply(t,arguments)}function wm(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Sm(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Mm(t){return t<0?-t*t:t*t}function Em(t){var e=t(Zf,Zf),n=1;function i(){return 1===n?t(Zf,Zf):.5===n?t(Sm,Mm):t(wm(n),wm(1/n))}return e.exponent=function(t){return arguments.length?(n=+t,i()):n},am(e)}function Tm(){var t=Em(im());return t.copy=function(){return nm(t,Tm()).exponent(t.exponent())},Bf.apply(t,arguments),t}function Cm(){return Tm.apply(null,arguments).exponent(.5)}function Am(){var t,e=[],n=[],i=[];function o(){var t=0,r=Math.max(1,n.length);for(i=new Array(r-1);++t<r;)i[t-1]=I(e,t/r);return a}function a(e){return isNaN(e=+e)?t:n[l(i,e)]}return a.invertExtent=function(t){var r=n.indexOf(t);return r<0?[NaN,NaN]:[r>0?i[r-1]:e[0],r<i.length?i[r]:e[e.length-1]]},a.domain=function(t){if(!arguments.length)return e.slice();e=[];for(var n,i=0,a=t.length;i<a;++i)null==(n=t[i])||isNaN(n=+n)||e.push(n);return e.sort(r),o()},a.range=function(t){return arguments.length?(n=$f.call(t),o()):n.slice()},a.unknown=function(e){return arguments.length?(t=e,a):t},a.quantiles=function(){return i.slice()},a.copy=function(){return Am().domain(e).range(n).unknown(t)},Bf.apply(a,arguments)}function Om(){var t,e=0,n=1,i=1,r=[.5],o=[0,1];function a(e){return e<=e?o[l(r,e,0,i)]:t}function s(){var t=-1;for(r=new Array(i);++t<i;)r[t]=((t+1)*n-(t-i)*e)/(i+1);return a}return a.domain=function(t){return arguments.length?(e=+t[0],n=+t[1],s()):[e,n]},a.range=function(t){return arguments.length?(i=(o=$f.call(t)).length-1,s()):o.slice()},a.invertExtent=function(t){var a=o.indexOf(t);return a<0?[NaN,NaN]:a<1?[e,r[0]]:a>=i?[r[i-1],n]:[r[a-1],r[a]]},a.unknown=function(e){return arguments.length?(t=e,a):a},a.thresholds=function(){return r.slice()},a.copy=function(){return Om().domain([e,n]).range(o).unknown(t)},Bf.apply(am(a),arguments)}function km(){var t,e=[.5],n=[0,1],i=1;function r(r){return r<=r?n[l(e,r,0,i)]:t}return r.domain=function(t){return arguments.length?(e=$f.call(t),i=Math.min(e.length,n.length-1),r):e.slice()},r.range=function(t){return arguments.length?(n=$f.call(t),i=Math.min(e.length,n.length-1),r):n.slice()},r.invertExtent=function(t){var i=n.indexOf(t);return[e[i-1],e[i]]},r.unknown=function(e){return arguments.length?(t=e,r):t},r.copy=function(){return km().domain(e).range(n).unknown(t)},Bf.apply(r,arguments)}var Lm=new Date,Im=new Date;function Rm(t,e,n,i){function r(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return r.floor=function(e){return t(e=new Date(+e)),e},r.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},r.round=function(t){var e=r(t),n=r.ceil(t);return t-e<n-t?e:n},r.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},r.range=function(n,i,o){var a,s=[];if(n=r.ceil(n),o=null==o?1:Math.floor(o),!(n<i&&o>0))return s;do{s.push(a=new Date(+n)),e(n,o),t(n)}while(a<n&&n<i);return s},r.filter=function(n){return Rm((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,i){if(t>=t)if(i<0)for(;++i<=0;)for(;e(t,-1),!n(t););else for(;--i>=0;)for(;e(t,1),!n(t););}))},n&&(r.count=function(e,i){return Lm.setTime(+e),Im.setTime(+i),t(Lm),t(Im),Math.floor(n(Lm,Im))},r.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?r.filter(i?function(e){return i(e)%t==0}:function(e){return r.count(0,e)%t==0}):r:null}),r}var Pm=Rm((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));Pm.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Rm((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};var Dm=Pm,Nm=Pm.range,Fm=Rm((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()})),jm=Fm,Bm=Fm.range;function zm(t){return Rm((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/6048e5}))}var Um=zm(0),Hm=zm(1),$m=zm(2),Gm=zm(3),Vm=zm(4),Wm=zm(5),qm=zm(6),Xm=Um.range,Ym=Hm.range,Km=$m.range,Zm=Gm.range,Jm=Vm.range,Qm=Wm.range,tg=qm.range,eg=Rm((function(t){t.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+e)}),(function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5}),(function(t){return t.getDate()-1})),ng=eg,ig=eg.range,rg=Rm((function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds()-6e4*t.getMinutes())}),(function(t,e){t.setTime(+t+36e5*e)}),(function(t,e){return(e-t)/36e5}),(function(t){return t.getHours()})),og=rg,ag=rg.range,sg=Rm((function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds())}),(function(t,e){t.setTime(+t+6e4*e)}),(function(t,e){return(e-t)/6e4}),(function(t){return t.getMinutes()})),cg=sg,lg=sg.range,dg=Rm((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+1e3*e)}),(function(t,e){return(e-t)/1e3}),(function(t){return t.getUTCSeconds()})),ug=dg,hg=dg.range,pg=Rm((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t}));pg.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?Rm((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):pg:null};var fg=pg,mg=pg.range;function gg(t){return Rm((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/6048e5}))}var vg=gg(0),yg=gg(1),bg=gg(2),_g=gg(3),xg=gg(4),wg=gg(5),Sg=gg(6),Mg=vg.range,Eg=yg.range,Tg=bg.range,Cg=_g.range,Ag=xg.range,Og=wg.range,kg=Sg.range,Lg=Rm((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/864e5}),(function(t){return t.getUTCDate()-1})),Ig=Lg,Rg=Lg.range,Pg=Rm((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()}));Pg.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Rm((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};var Dg=Pg,Ng=Pg.range;function Fg(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function jg(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Bg(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function zg(t){var e=t.dateTime,n=t.date,i=t.time,r=t.periods,o=t.days,a=t.shortDays,s=t.months,c=t.shortMonths,l=Jg(r),d=Qg(r),u=Jg(o),h=Qg(o),p=Jg(a),f=Qg(a),m=Jg(s),g=Qg(s),v=Jg(c),y=Qg(c),b={a:function(t){return a[t.getDay()]},A:function(t){return o[t.getDay()]},b:function(t){return c[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:_v,e:_v,f:Ev,H:xv,I:wv,j:Sv,L:Mv,m:Tv,M:Cv,p:function(t){return r[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:ey,s:ny,S:Av,u:Ov,U:kv,V:Lv,w:Iv,W:Rv,x:null,X:null,y:Pv,Y:Dv,Z:Nv,\"%\":ty},_={a:function(t){return a[t.getUTCDay()]},A:function(t){return o[t.getUTCDay()]},b:function(t){return c[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:Fv,e:Fv,f:Hv,H:jv,I:Bv,j:zv,L:Uv,m:$v,M:Gv,p:function(t){return r[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:ey,s:ny,S:Vv,u:Wv,U:qv,V:Xv,w:Yv,W:Kv,x:null,X:null,y:Zv,Y:Jv,Z:Qv,\"%\":ty},x={a:function(t,e,n){var i=p.exec(e.slice(n));return i?(t.w=f[i[0].toLowerCase()],n+i[0].length):-1},A:function(t,e,n){var i=u.exec(e.slice(n));return i?(t.w=h[i[0].toLowerCase()],n+i[0].length):-1},b:function(t,e,n){var i=v.exec(e.slice(n));return i?(t.m=y[i[0].toLowerCase()],n+i[0].length):-1},B:function(t,e,n){var i=m.exec(e.slice(n));return i?(t.m=g[i[0].toLowerCase()],n+i[0].length):-1},c:function(t,n,i){return M(t,e,n,i)},d:dv,e:dv,f:gv,H:hv,I:hv,j:uv,L:mv,m:lv,M:pv,p:function(t,e,n){var i=l.exec(e.slice(n));return i?(t.p=d[i[0].toLowerCase()],n+i[0].length):-1},q:cv,Q:yv,s:bv,S:fv,u:ev,U:nv,V:iv,w:tv,W:rv,x:function(t,e,i){return M(t,n,e,i)},X:function(t,e,n){return M(t,i,e,n)},y:av,Y:ov,Z:sv,\"%\":vv};function w(t,e){return function(n){var i,r,o,a=[],s=-1,c=0,l=t.length;for(n instanceof Date||(n=new Date(+n));++s<l;)37===t.charCodeAt(s)&&(a.push(t.slice(c,s)),null!=(r=Wg[i=t.charAt(++s)])?i=t.charAt(++s):r=\"e\"===i?\" \":\"0\",(o=e[i])&&(i=o(n,r)),a.push(i),c=s+1);return a.push(t.slice(c,s)),a.join(\"\")}}function S(t,e){return function(n){var i,r,o=Bg(1900,void 0,1);if(M(o,t,n+=\"\",0)!=n.length)return null;if(\"Q\"in o)return new Date(o.Q);if(\"s\"in o)return new Date(1e3*o.s+(\"L\"in o?o.L:0));if(e&&!(\"Z\"in o)&&(o.Z=0),\"p\"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m=\"q\"in o?o.q:0),\"V\"in o){if(o.V<1||o.V>53)return null;\"w\"in o||(o.w=1),\"Z\"in o?(r=(i=jg(Bg(o.y,0,1))).getUTCDay(),i=r>4||0===r?yg.ceil(i):yg(i),i=Ig.offset(i,7*(o.V-1)),o.y=i.getUTCFullYear(),o.m=i.getUTCMonth(),o.d=i.getUTCDate()+(o.w+6)%7):(r=(i=Fg(Bg(o.y,0,1))).getDay(),i=r>4||0===r?Hm.ceil(i):Hm(i),i=ng.offset(i,7*(o.V-1)),o.y=i.getFullYear(),o.m=i.getMonth(),o.d=i.getDate()+(o.w+6)%7)}else(\"W\"in o||\"U\"in o)&&(\"w\"in o||(o.w=\"u\"in o?o.u%7:\"W\"in o?1:0),r=\"Z\"in o?jg(Bg(o.y,0,1)).getUTCDay():Fg(Bg(o.y,0,1)).getDay(),o.m=0,o.d=\"W\"in o?(o.w+6)%7+7*o.W-(r+5)%7:o.w+7*o.U-(r+6)%7);return\"Z\"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,jg(o)):Fg(o)}}function M(t,e,n,i){for(var r,o,a=0,s=e.length,c=n.length;a<s;){if(i>=c)return-1;if(37===(r=e.charCodeAt(a++))){if(r=e.charAt(a++),!(o=x[r in Wg?e.charAt(a++):r])||(i=o(t,n,i))<0)return-1}else if(r!=n.charCodeAt(i++))return-1}return i}return b.x=w(n,b),b.X=w(i,b),b.c=w(e,b),_.x=w(n,_),_.X=w(i,_),_.c=w(e,_),{format:function(t){var e=w(t+=\"\",b);return e.toString=function(){return t},e},parse:function(t){var e=S(t+=\"\",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=w(t+=\"\",_);return e.toString=function(){return t},e},utcParse:function(t){var e=S(t+=\"\",!0);return e.toString=function(){return t},e}}}var Ug,Hg,$g,Gg,Vg,Wg={\"-\":\"\",_:\" \",0:\"0\"},qg=/^\\s*\\d+/,Xg=/^%/,Yg=/[\\\\^$*+?|[\\]().{}]/g;function Kg(t,e,n){var i=t<0?\"-\":\"\",r=(i?-t:t)+\"\",o=r.length;return i+(o<n?new Array(n-o+1).join(e)+r:r)}function Zg(t){return t.replace(Yg,\"\\\\$&\")}function Jg(t){return new RegExp(\"^(?:\"+t.map(Zg).join(\"|\")+\")\",\"i\")}function Qg(t){for(var e={},n=-1,i=t.length;++n<i;)e[t[n].toLowerCase()]=n;return e}function tv(t,e,n){var i=qg.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function ev(t,e,n){var i=qg.exec(e.slice(n,n+1));return i?(t.u=+i[0],n+i[0].length):-1}function nv(t,e,n){var i=qg.exec(e.slice(n,n+2));return i?(t.U=+i[0],n+i[0].length):-1}function iv(t,e,n){var i=qg.exec(e.slice(n,n+2));return i?(t.V=+i[0],n+i[0].length):-1}function rv(t,e,n){var i=qg.exec(e.slice(n,n+2));return i?(t.W=+i[0],n+i[0].length):-1}function ov(t,e,n){var i=qg.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function av(t,e,n){var i=qg.exec(e.slice(n,n+2));return i?(t.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function sv(t,e,n){var i=/^(Z)|([+-]\\d\\d)(?::?(\\d\\d))?/.exec(e.slice(n,n+6));return i?(t.Z=i[1]?0:-(i[2]+(i[3]||\"00\")),n+i[0].length):-1}function cv(t,e,n){var i=qg.exec(e.slice(n,n+1));return i?(t.q=3*i[0]-3,n+i[0].length):-1}function lv(t,e,n){var i=qg.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function dv(t,e,n){var i=qg.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function uv(t,e,n){var i=qg.exec(e.slice(n,n+3));return i?(t.m=0,t.d=+i[0],n+i[0].length):-1}function hv(t,e,n){var i=qg.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function pv(t,e,n){var i=qg.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function fv(t,e,n){var i=qg.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function mv(t,e,n){var i=qg.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function gv(t,e,n){var i=qg.exec(e.slice(n,n+6));return i?(t.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function vv(t,e,n){var i=Xg.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function yv(t,e,n){var i=qg.exec(e.slice(n));return i?(t.Q=+i[0],n+i[0].length):-1}function bv(t,e,n){var i=qg.exec(e.slice(n));return i?(t.s=+i[0],n+i[0].length):-1}function _v(t,e){return Kg(t.getDate(),e,2)}function xv(t,e){return Kg(t.getHours(),e,2)}function wv(t,e){return Kg(t.getHours()%12||12,e,2)}function Sv(t,e){return Kg(1+ng.count(Dm(t),t),e,3)}function Mv(t,e){return Kg(t.getMilliseconds(),e,3)}function Ev(t,e){return Mv(t,e)+\"000\"}function Tv(t,e){return Kg(t.getMonth()+1,e,2)}function Cv(t,e){return Kg(t.getMinutes(),e,2)}function Av(t,e){return Kg(t.getSeconds(),e,2)}function Ov(t){var e=t.getDay();return 0===e?7:e}function kv(t,e){return Kg(Um.count(Dm(t)-1,t),e,2)}function Lv(t,e){var n=t.getDay();return t=n>=4||0===n?Vm(t):Vm.ceil(t),Kg(Vm.count(Dm(t),t)+(4===Dm(t).getDay()),e,2)}function Iv(t){return t.getDay()}function Rv(t,e){return Kg(Hm.count(Dm(t)-1,t),e,2)}function Pv(t,e){return Kg(t.getFullYear()%100,e,2)}function Dv(t,e){return Kg(t.getFullYear()%1e4,e,4)}function Nv(t){var e=t.getTimezoneOffset();return(e>0?\"-\":(e*=-1,\"+\"))+Kg(e/60|0,\"0\",2)+Kg(e%60,\"0\",2)}function Fv(t,e){return Kg(t.getUTCDate(),e,2)}function jv(t,e){return Kg(t.getUTCHours(),e,2)}function Bv(t,e){return Kg(t.getUTCHours()%12||12,e,2)}function zv(t,e){return Kg(1+Ig.count(Dg(t),t),e,3)}function Uv(t,e){return Kg(t.getUTCMilliseconds(),e,3)}function Hv(t,e){return Uv(t,e)+\"000\"}function $v(t,e){return Kg(t.getUTCMonth()+1,e,2)}function Gv(t,e){return Kg(t.getUTCMinutes(),e,2)}function Vv(t,e){return Kg(t.getUTCSeconds(),e,2)}function Wv(t){var e=t.getUTCDay();return 0===e?7:e}function qv(t,e){return Kg(vg.count(Dg(t)-1,t),e,2)}function Xv(t,e){var n=t.getUTCDay();return t=n>=4||0===n?xg(t):xg.ceil(t),Kg(xg.count(Dg(t),t)+(4===Dg(t).getUTCDay()),e,2)}function Yv(t){return t.getUTCDay()}function Kv(t,e){return Kg(yg.count(Dg(t)-1,t),e,2)}function Zv(t,e){return Kg(t.getUTCFullYear()%100,e,2)}function Jv(t,e){return Kg(t.getUTCFullYear()%1e4,e,4)}function Qv(){return\"+0000\"}function ty(){return\"%\"}function ey(t){return+t}function ny(t){return Math.floor(+t/1e3)}function iy(t){return Ug=zg(t),Hg=Ug.format,$g=Ug.parse,Gg=Ug.utcFormat,Vg=Ug.utcParse,Ug}iy({dateTime:\"%x, %X\",date:\"%-m/%-d/%Y\",time:\"%-I:%M:%S %p\",periods:[\"AM\",\"PM\"],days:[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"],shortDays:[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],months:[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],shortMonths:[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"]});function ry(t){return new Date(t)}function oy(t){return t instanceof Date?+t:+new Date(+t)}function ay(t,e,n,i,r,a,s,c,l){var d=rm(Zf,Zf),u=d.invert,h=d.domain,p=l(\".%L\"),f=l(\":%S\"),m=l(\"%I:%M\"),g=l(\"%I %p\"),v=l(\"%a %d\"),y=l(\"%b %d\"),b=l(\"%B\"),_=l(\"%Y\"),x=[[s,1,1e3],[s,5,5e3],[s,15,15e3],[s,30,3e4],[a,1,6e4],[a,5,3e5],[a,15,9e5],[a,30,18e5],[r,1,36e5],[r,3,108e5],[r,6,216e5],[r,12,432e5],[i,1,864e5],[i,2,1728e5],[n,1,6048e5],[e,1,2592e6],[e,3,7776e6],[t,1,31536e6]];function w(o){return(s(o)<o?p:a(o)<o?f:r(o)<o?m:i(o)<o?g:e(o)<o?n(o)<o?v:y:t(o)<o?b:_)(o)}function S(e,n,i,r){if(null==e&&(e=10),\"number\"==typeof e){var a=Math.abs(i-n)/e,s=o((function(t){return t[2]})).right(x,a);s===x.length?(r=O(n/31536e6,i/31536e6,e),e=t):s?(r=(s=x[a/x[s-1][2]<x[s][2]/a?s-1:s])[1],e=s[0]):(r=Math.max(O(n,i,e),1),e=c)}return null==r?e:e.every(r)}return d.invert=function(t){return new Date(u(t))},d.domain=function(t){return arguments.length?h(Hf.call(t,oy)):h().map(ry)},d.ticks=function(t,e){var n,i=h(),r=i[0],o=i[i.length-1],a=o<r;return a&&(n=r,r=o,o=n),n=(n=S(t,r,o,e))?n.range(r,o+1):[],a?n.reverse():n},d.tickFormat=function(t,e){return null==e?w:l(e)},d.nice=function(t,e){var n=h();return(t=S(t,n[0],n[n.length-1],e))?h(lm(n,t)):d},d.copy=function(){return nm(d,ay(t,e,n,i,r,a,s,c,l))},d}var sy=function(){return Bf.apply(ay(Dm,jm,Um,ng,og,cg,ug,fg,Hg).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},cy=Rm((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()})),ly=cy,dy=cy.range,uy=Rm((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+36e5*e)}),(function(t,e){return(e-t)/36e5}),(function(t){return t.getUTCHours()})),hy=uy,py=uy.range,fy=Rm((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+6e4*e)}),(function(t,e){return(e-t)/6e4}),(function(t){return t.getUTCMinutes()})),my=fy,gy=fy.range,vy=function(){return Bf.apply(ay(Dg,ly,vg,Ig,hy,my,ug,fg,Gg).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)};function yy(){var t,e,n,i,r,o=0,a=1,s=Zf,c=!1;function l(e){return isNaN(e=+e)?r:s(0===n?.5:(e=(i(e)-t)*n,c?Math.max(0,Math.min(1,e)):e))}return l.domain=function(r){return arguments.length?(t=i(o=+r[0]),e=i(a=+r[1]),n=t===e?0:1/(e-t),l):[o,a]},l.clamp=function(t){return arguments.length?(c=!!t,l):c},l.interpolator=function(t){return arguments.length?(s=t,l):s},l.unknown=function(t){return arguments.length?(r=t,l):r},function(r){return i=r,t=r(o),e=r(a),n=t===e?0:1/(e-t),l}}function by(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function _y(){var t=am(yy()(Zf));return t.copy=function(){return by(t,_y())},zf.apply(t,arguments)}function xy(){var t=gm(yy()).domain([1,10]);return t.copy=function(){return by(t,xy()).base(t.base())},zf.apply(t,arguments)}function wy(){var t=_m(yy());return t.copy=function(){return by(t,wy()).constant(t.constant())},zf.apply(t,arguments)}function Sy(){var t=Em(yy());return t.copy=function(){return by(t,Sy()).exponent(t.exponent())},zf.apply(t,arguments)}function My(){return Sy.apply(null,arguments).exponent(.5)}function Ey(){var t=[],e=Zf;function n(n){if(!isNaN(n=+n))return e((l(t,n)-1)/(t.length-1))}return n.domain=function(e){if(!arguments.length)return t.slice();t=[];for(var i,o=0,a=e.length;o<a;++o)null==(i=e[o])||isNaN(i=+i)||t.push(i);return t.sort(r),n},n.interpolator=function(t){return arguments.length?(e=t,n):e},n.copy=function(){return Ey(e).domain(t)},zf.apply(n,arguments)}function Ty(){var t,e,n,i,r,o,a,s=0,c=.5,l=1,d=Zf,u=!1;function h(t){return isNaN(t=+t)?a:(t=.5+((t=+o(t))-e)*(t<e?i:r),d(u?Math.max(0,Math.min(1,t)):t))}return h.domain=function(a){return arguments.length?(t=o(s=+a[0]),e=o(c=+a[1]),n=o(l=+a[2]),i=t===e?0:.5/(e-t),r=e===n?0:.5/(n-e),h):[s,c,l]},h.clamp=function(t){return arguments.length?(u=!!t,h):u},h.interpolator=function(t){return arguments.length?(d=t,h):d},h.unknown=function(t){return arguments.length?(a=t,h):a},function(a){return o=a,t=a(s),e=a(c),n=a(l),i=t===e?0:.5/(e-t),r=e===n?0:.5/(n-e),h}}function Cy(){var t=am(Ty()(Zf));return t.copy=function(){return by(t,Cy())},zf.apply(t,arguments)}function Ay(){var t=gm(Ty()).domain([.1,1,10]);return t.copy=function(){return by(t,Ay()).base(t.base())},zf.apply(t,arguments)}function Oy(){var t=_m(Ty());return t.copy=function(){return by(t,Oy()).constant(t.constant())},zf.apply(t,arguments)}function ky(){var t=Em(Ty());return t.copy=function(){return by(t,ky()).exponent(t.exponent())},zf.apply(t,arguments)}function Ly(){return ky.apply(null,arguments).exponent(.5)}var Iy=function(t){for(var e=t.length/6|0,n=new Array(e),i=0;i<e;)n[i]=\"#\"+t.slice(6*i,6*++i);return n},Ry=Iy(\"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf\"),Py=Iy(\"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666\"),Dy=Iy(\"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666\"),Ny=Iy(\"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928\"),Fy=Iy(\"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2\"),jy=Iy(\"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc\"),By=Iy(\"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999\"),zy=Iy(\"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3\"),Uy=Iy(\"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f\"),Hy=Iy(\"4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab\"),$y=function(t){return mn(t[t.length-1])},Gy=new Array(3).concat(\"d8b365f5f5f55ab4ac\",\"a6611adfc27d80cdc1018571\",\"a6611adfc27df5f5f580cdc1018571\",\"8c510ad8b365f6e8c3c7eae55ab4ac01665e\",\"8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e\",\"8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e\",\"8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e\",\"5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30\",\"5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30\").map(Iy),Vy=$y(Gy),Wy=new Array(3).concat(\"af8dc3f7f7f77fbf7b\",\"7b3294c2a5cfa6dba0008837\",\"7b3294c2a5cff7f7f7a6dba0008837\",\"762a83af8dc3e7d4e8d9f0d37fbf7b1b7837\",\"762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837\",\"762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837\",\"762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837\",\"40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b\",\"40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b\").map(Iy),qy=$y(Wy),Xy=new Array(3).concat(\"e9a3c9f7f7f7a1d76a\",\"d01c8bf1b6dab8e1864dac26\",\"d01c8bf1b6daf7f7f7b8e1864dac26\",\"c51b7de9a3c9fde0efe6f5d0a1d76a4d9221\",\"c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221\",\"c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221\",\"c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221\",\"8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419\",\"8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419\").map(Iy),Yy=$y(Xy),Ky=new Array(3).concat(\"998ec3f7f7f7f1a340\",\"5e3c99b2abd2fdb863e66101\",\"5e3c99b2abd2f7f7f7fdb863e66101\",\"542788998ec3d8daebfee0b6f1a340b35806\",\"542788998ec3d8daebf7f7f7fee0b6f1a340b35806\",\"5427888073acb2abd2d8daebfee0b6fdb863e08214b35806\",\"5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806\",\"2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08\",\"2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08\").map(Iy),Zy=$y(Ky),Jy=new Array(3).concat(\"ef8a62f7f7f767a9cf\",\"ca0020f4a58292c5de0571b0\",\"ca0020f4a582f7f7f792c5de0571b0\",\"b2182bef8a62fddbc7d1e5f067a9cf2166ac\",\"b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac\",\"b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac\",\"b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac\",\"67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061\",\"67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061\").map(Iy),Qy=$y(Jy),tb=new Array(3).concat(\"ef8a62ffffff999999\",\"ca0020f4a582bababa404040\",\"ca0020f4a582ffffffbababa404040\",\"b2182bef8a62fddbc7e0e0e09999994d4d4d\",\"b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d\",\"b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d\",\"b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d\",\"67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a\",\"67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a\").map(Iy),eb=$y(tb),nb=new Array(3).concat(\"fc8d59ffffbf91bfdb\",\"d7191cfdae61abd9e92c7bb6\",\"d7191cfdae61ffffbfabd9e92c7bb6\",\"d73027fc8d59fee090e0f3f891bfdb4575b4\",\"d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4\",\"d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4\",\"d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4\",\"a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695\",\"a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695\").map(Iy),ib=$y(nb),rb=new Array(3).concat(\"fc8d59ffffbf91cf60\",\"d7191cfdae61a6d96a1a9641\",\"d7191cfdae61ffffbfa6d96a1a9641\",\"d73027fc8d59fee08bd9ef8b91cf601a9850\",\"d73027fc8d59fee08bffffbfd9ef8b91cf601a9850\",\"d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850\",\"d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850\",\"a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837\",\"a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837\").map(Iy),ob=$y(rb),ab=new Array(3).concat(\"fc8d59ffffbf99d594\",\"d7191cfdae61abdda42b83ba\",\"d7191cfdae61ffffbfabdda42b83ba\",\"d53e4ffc8d59fee08be6f59899d5943288bd\",\"d53e4ffc8d59fee08bffffbfe6f59899d5943288bd\",\"d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd\",\"d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd\",\"9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2\",\"9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2\").map(Iy),sb=$y(ab),cb=new Array(3).concat(\"e5f5f999d8c92ca25f\",\"edf8fbb2e2e266c2a4238b45\",\"edf8fbb2e2e266c2a42ca25f006d2c\",\"edf8fbccece699d8c966c2a42ca25f006d2c\",\"edf8fbccece699d8c966c2a441ae76238b45005824\",\"f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824\",\"f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b\").map(Iy),lb=$y(cb),db=new Array(3).concat(\"e0ecf49ebcda8856a7\",\"edf8fbb3cde38c96c688419d\",\"edf8fbb3cde38c96c68856a7810f7c\",\"edf8fbbfd3e69ebcda8c96c68856a7810f7c\",\"edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b\",\"f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b\",\"f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b\").map(Iy),ub=$y(db),hb=new Array(3).concat(\"e0f3dba8ddb543a2ca\",\"f0f9e8bae4bc7bccc42b8cbe\",\"f0f9e8bae4bc7bccc443a2ca0868ac\",\"f0f9e8ccebc5a8ddb57bccc443a2ca0868ac\",\"f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e\",\"f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e\",\"f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081\").map(Iy),pb=$y(hb),fb=new Array(3).concat(\"fee8c8fdbb84e34a33\",\"fef0d9fdcc8afc8d59d7301f\",\"fef0d9fdcc8afc8d59e34a33b30000\",\"fef0d9fdd49efdbb84fc8d59e34a33b30000\",\"fef0d9fdd49efdbb84fc8d59ef6548d7301f990000\",\"fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000\",\"fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000\").map(Iy),mb=$y(fb),gb=new Array(3).concat(\"ece2f0a6bddb1c9099\",\"f6eff7bdc9e167a9cf02818a\",\"f6eff7bdc9e167a9cf1c9099016c59\",\"f6eff7d0d1e6a6bddb67a9cf1c9099016c59\",\"f6eff7d0d1e6a6bddb67a9cf3690c002818a016450\",\"fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450\",\"fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636\").map(Iy),vb=$y(gb),yb=new Array(3).concat(\"ece7f2a6bddb2b8cbe\",\"f1eef6bdc9e174a9cf0570b0\",\"f1eef6bdc9e174a9cf2b8cbe045a8d\",\"f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d\",\"f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b\",\"fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b\",\"fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858\").map(Iy),bb=$y(yb),_b=new Array(3).concat(\"e7e1efc994c7dd1c77\",\"f1eef6d7b5d8df65b0ce1256\",\"f1eef6d7b5d8df65b0dd1c77980043\",\"f1eef6d4b9dac994c7df65b0dd1c77980043\",\"f1eef6d4b9dac994c7df65b0e7298ace125691003f\",\"f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f\",\"f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f\").map(Iy),xb=$y(_b),wb=new Array(3).concat(\"fde0ddfa9fb5c51b8a\",\"feebe2fbb4b9f768a1ae017e\",\"feebe2fbb4b9f768a1c51b8a7a0177\",\"feebe2fcc5c0fa9fb5f768a1c51b8a7a0177\",\"feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177\",\"fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177\",\"fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a\").map(Iy),Sb=$y(wb),Mb=new Array(3).concat(\"edf8b17fcdbb2c7fb8\",\"ffffcca1dab441b6c4225ea8\",\"ffffcca1dab441b6c42c7fb8253494\",\"ffffccc7e9b47fcdbb41b6c42c7fb8253494\",\"ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84\",\"ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84\",\"ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58\").map(Iy),Eb=$y(Mb),Tb=new Array(3).concat(\"f7fcb9addd8e31a354\",\"ffffccc2e69978c679238443\",\"ffffccc2e69978c67931a354006837\",\"ffffccd9f0a3addd8e78c67931a354006837\",\"ffffccd9f0a3addd8e78c67941ab5d238443005a32\",\"ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32\",\"ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529\").map(Iy),Cb=$y(Tb),Ab=new Array(3).concat(\"fff7bcfec44fd95f0e\",\"ffffd4fed98efe9929cc4c02\",\"ffffd4fed98efe9929d95f0e993404\",\"ffffd4fee391fec44ffe9929d95f0e993404\",\"ffffd4fee391fec44ffe9929ec7014cc4c028c2d04\",\"ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04\",\"ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506\").map(Iy),Ob=$y(Ab),kb=new Array(3).concat(\"ffeda0feb24cf03b20\",\"ffffb2fecc5cfd8d3ce31a1c\",\"ffffb2fecc5cfd8d3cf03b20bd0026\",\"ffffb2fed976feb24cfd8d3cf03b20bd0026\",\"ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026\",\"ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026\",\"ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026\").map(Iy),Lb=$y(kb),Ib=new Array(3).concat(\"deebf79ecae13182bd\",\"eff3ffbdd7e76baed62171b5\",\"eff3ffbdd7e76baed63182bd08519c\",\"eff3ffc6dbef9ecae16baed63182bd08519c\",\"eff3ffc6dbef9ecae16baed64292c62171b5084594\",\"f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594\",\"f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b\").map(Iy),Rb=$y(Ib),Pb=new Array(3).concat(\"e5f5e0a1d99b31a354\",\"edf8e9bae4b374c476238b45\",\"edf8e9bae4b374c47631a354006d2c\",\"edf8e9c7e9c0a1d99b74c47631a354006d2c\",\"edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32\",\"f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32\",\"f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b\").map(Iy),Db=$y(Pb),Nb=new Array(3).concat(\"f0f0f0bdbdbd636363\",\"f7f7f7cccccc969696525252\",\"f7f7f7cccccc969696636363252525\",\"f7f7f7d9d9d9bdbdbd969696636363252525\",\"f7f7f7d9d9d9bdbdbd969696737373525252252525\",\"fffffff0f0f0d9d9d9bdbdbd969696737373525252252525\",\"fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000\").map(Iy),Fb=$y(Nb),jb=new Array(3).concat(\"efedf5bcbddc756bb1\",\"f2f0f7cbc9e29e9ac86a51a3\",\"f2f0f7cbc9e29e9ac8756bb154278f\",\"f2f0f7dadaebbcbddc9e9ac8756bb154278f\",\"f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486\",\"fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486\",\"fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d\").map(Iy),Bb=$y(jb),zb=new Array(3).concat(\"fee0d2fc9272de2d26\",\"fee5d9fcae91fb6a4acb181d\",\"fee5d9fcae91fb6a4ade2d26a50f15\",\"fee5d9fcbba1fc9272fb6a4ade2d26a50f15\",\"fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d\",\"fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d\",\"fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d\").map(Iy),Ub=$y(zb),Hb=new Array(3).concat(\"fee6cefdae6be6550d\",\"feeddefdbe85fd8d3cd94701\",\"feeddefdbe85fd8d3ce6550da63603\",\"feeddefdd0a2fdae6bfd8d3ce6550da63603\",\"feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04\",\"fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04\",\"fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704\").map(Iy),$b=$y(Hb),Gb=function(t){return t=Math.max(0,Math.min(1,t)),\"rgb(\"+Math.max(0,Math.min(255,Math.round(-4.54-t*(35.34-t*(2381.73-t*(6402.7-t*(7024.72-2710.57*t)))))))+\", \"+Math.max(0,Math.min(255,Math.round(32.49+t*(170.73+t*(52.82-t*(131.46-t*(176.58-67.37*t)))))))+\", \"+Math.max(0,Math.min(255,Math.round(81.24+t*(442.36-t*(2482.43-t*(6167.24-t*(6614.94-2475.67*t)))))))+\")\"},Vb=wf(Io(300,.5,0),Io(-240,.5,1)),Wb=wf(Io(-100,.75,.35),Io(80,1.5,.8)),qb=wf(Io(260,.75,.35),Io(80,1.5,.8)),Xb=Io(),Yb=function(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return Xb.h=360*t-100,Xb.s=1.5-1.5*e,Xb.l=.8-.9*e,Xb+\"\"},Kb=Xe(),Zb=Math.PI/3,Jb=2*Math.PI/3,Qb=function(t){var e;return t=(.5-t)*Math.PI,Kb.r=255*(e=Math.sin(t))*e,Kb.g=255*(e=Math.sin(t+Zb))*e,Kb.b=255*(e=Math.sin(t+Jb))*e,Kb+\"\"},t_=function(t){return t=Math.max(0,Math.min(1,t)),\"rgb(\"+Math.max(0,Math.min(255,Math.round(34.61+t*(1172.33-t*(10793.56-t*(33300.12-t*(38394.49-14825.05*t)))))))+\", \"+Math.max(0,Math.min(255,Math.round(23.31+t*(557.33+t*(1225.33-t*(3574.96-t*(1073.77+707.56*t)))))))+\", \"+Math.max(0,Math.min(255,Math.round(27.2+t*(3211.1-t*(15327.97-t*(27814-t*(22569.18-6838.66*t)))))))+\")\"};function e_(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}var n_=e_(Iy(\"44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725\")),i_=e_(Iy(\"00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf\")),r_=e_(Iy(\"00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4\")),o_=e_(Iy(\"0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921\")),a_=function(t){return Se(ie(t).call(document.documentElement))},s_=0;function c_(){return new l_}function l_(){this._=\"@\"+(++s_).toString(36)}l_.prototype=c_.prototype={constructor:l_,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};var d_=function(t){return\"string\"==typeof t?new _e([document.querySelectorAll(t)],[document.documentElement]):new _e([null==t?[]:t],be)},u_=function(t,e){null==e&&(e=kn().touches);for(var n=0,i=e?e.length:0,r=new Array(i);n<i;++n)r[n]=Ln(t,e[n]);return r},h_=function(t){return function(){return t}},p_=Math.abs,f_=Math.atan2,m_=Math.cos,g_=Math.max,v_=Math.min,y_=Math.sin,b_=Math.sqrt,__=Math.PI,x_=__/2,w_=2*__;function S_(t){return t>1?0:t<-1?__:Math.acos(t)}function M_(t){return t>=1?x_:t<=-1?-x_:Math.asin(t)}function E_(t){return t.innerRadius}function T_(t){return t.outerRadius}function C_(t){return t.startAngle}function A_(t){return t.endAngle}function O_(t){return t&&t.padAngle}function k_(t,e,n,i,r,o,a,s){var c=n-t,l=i-e,d=a-r,u=s-o,h=u*c-d*l;if(!(h*h<1e-12))return[t+(h=(d*(e-o)-u*(t-r))/h)*c,e+h*l]}function L_(t,e,n,i,r,o,a){var s=t-n,c=e-i,l=(a?o:-o)/b_(s*s+c*c),d=l*c,u=-l*s,h=t+d,p=e+u,f=n+d,m=i+u,g=(h+f)/2,v=(p+m)/2,y=f-h,b=m-p,_=y*y+b*b,x=r-o,w=h*m-f*p,S=(b<0?-1:1)*b_(g_(0,x*x*_-w*w)),M=(w*b-y*S)/_,E=(-w*y-b*S)/_,T=(w*b+y*S)/_,C=(-w*y+b*S)/_,A=M-g,O=E-v,k=T-g,L=C-v;return A*A+O*O>k*k+L*L&&(M=T,E=C),{cx:M,cy:E,x01:-d,y01:-u,x11:M*(r/x-1),y11:E*(r/x-1)}}var I_=function(){var t=E_,e=T_,n=h_(0),i=null,r=C_,o=A_,a=O_,s=null;function c(){var c,l,d=+t.apply(this,arguments),u=+e.apply(this,arguments),h=r.apply(this,arguments)-x_,p=o.apply(this,arguments)-x_,f=p_(p-h),m=p>h;if(s||(s=c=$r()),u<d&&(l=u,u=d,d=l),u>1e-12)if(f>w_-1e-12)s.moveTo(u*m_(h),u*y_(h)),s.arc(0,0,u,h,p,!m),d>1e-12&&(s.moveTo(d*m_(p),d*y_(p)),s.arc(0,0,d,p,h,m));else{var g,v,y=h,b=p,_=h,x=p,w=f,S=f,M=a.apply(this,arguments)/2,E=M>1e-12&&(i?+i.apply(this,arguments):b_(d*d+u*u)),T=v_(p_(u-d)/2,+n.apply(this,arguments)),C=T,A=T;if(E>1e-12){var O=M_(E/d*y_(M)),k=M_(E/u*y_(M));(w-=2*O)>1e-12?(_+=O*=m?1:-1,x-=O):(w=0,_=x=(h+p)/2),(S-=2*k)>1e-12?(y+=k*=m?1:-1,b-=k):(S=0,y=b=(h+p)/2)}var L=u*m_(y),I=u*y_(y),R=d*m_(x),P=d*y_(x);if(T>1e-12){var D,N=u*m_(b),F=u*y_(b),j=d*m_(_),B=d*y_(_);if(f<__&&(D=k_(L,I,j,B,N,F,R,P))){var z=L-D[0],U=I-D[1],H=N-D[0],$=F-D[1],G=1/y_(S_((z*H+U*$)/(b_(z*z+U*U)*b_(H*H+$*$)))/2),V=b_(D[0]*D[0]+D[1]*D[1]);C=v_(T,(d-V)/(G-1)),A=v_(T,(u-V)/(G+1))}}S>1e-12?A>1e-12?(g=L_(j,B,L,I,u,A,m),v=L_(N,F,R,P,u,A,m),s.moveTo(g.cx+g.x01,g.cy+g.y01),A<T?s.arc(g.cx,g.cy,A,f_(g.y01,g.x01),f_(v.y01,v.x01),!m):(s.arc(g.cx,g.cy,A,f_(g.y01,g.x01),f_(g.y11,g.x11),!m),s.arc(0,0,u,f_(g.cy+g.y11,g.cx+g.x11),f_(v.cy+v.y11,v.cx+v.x11),!m),s.arc(v.cx,v.cy,A,f_(v.y11,v.x11),f_(v.y01,v.x01),!m))):(s.moveTo(L,I),s.arc(0,0,u,y,b,!m)):s.moveTo(L,I),d>1e-12&&w>1e-12?C>1e-12?(g=L_(R,P,N,F,d,-C,m),v=L_(L,I,j,B,d,-C,m),s.lineTo(g.cx+g.x01,g.cy+g.y01),C<T?s.arc(g.cx,g.cy,C,f_(g.y01,g.x01),f_(v.y01,v.x01),!m):(s.arc(g.cx,g.cy,C,f_(g.y01,g.x01),f_(g.y11,g.x11),!m),s.arc(0,0,d,f_(g.cy+g.y11,g.cx+g.x11),f_(v.cy+v.y11,v.cx+v.x11),m),s.arc(v.cx,v.cy,C,f_(v.y11,v.x11),f_(v.y01,v.x01),!m))):s.arc(0,0,d,x,_,m):s.lineTo(R,P)}else s.moveTo(0,0);if(s.closePath(),c)return s=null,c+\"\"||null}return c.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,i=(+r.apply(this,arguments)+ +o.apply(this,arguments))/2-__/2;return[m_(i)*n,y_(i)*n]},c.innerRadius=function(e){return arguments.length?(t=\"function\"==typeof e?e:h_(+e),c):t},c.outerRadius=function(t){return arguments.length?(e=\"function\"==typeof t?t:h_(+t),c):e},c.cornerRadius=function(t){return arguments.length?(n=\"function\"==typeof t?t:h_(+t),c):n},c.padRadius=function(t){return arguments.length?(i=null==t?null:\"function\"==typeof t?t:h_(+t),c):i},c.startAngle=function(t){return arguments.length?(r=\"function\"==typeof t?t:h_(+t),c):r},c.endAngle=function(t){return arguments.length?(o=\"function\"==typeof t?t:h_(+t),c):o},c.padAngle=function(t){return arguments.length?(a=\"function\"==typeof t?t:h_(+t),c):a},c.context=function(t){return arguments.length?(s=null==t?null:t,c):s},c};function R_(t){this._context=t}R_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var P_=function(t){return new R_(t)};function D_(t){return t[0]}function N_(t){return t[1]}var F_=function(){var t=D_,e=N_,n=h_(!0),i=null,r=P_,o=null;function a(a){var s,c,l,d=a.length,u=!1;for(null==i&&(o=r(l=$r())),s=0;s<=d;++s)!(s<d&&n(c=a[s],s,a))===u&&((u=!u)?o.lineStart():o.lineEnd()),u&&o.point(+t(c,s,a),+e(c,s,a));if(l)return o=null,l+\"\"||null}return a.x=function(e){return arguments.length?(t=\"function\"==typeof e?e:h_(+e),a):t},a.y=function(t){return arguments.length?(e=\"function\"==typeof t?t:h_(+t),a):e},a.defined=function(t){return arguments.length?(n=\"function\"==typeof t?t:h_(!!t),a):n},a.curve=function(t){return arguments.length?(r=t,null!=i&&(o=r(i)),a):r},a.context=function(t){return arguments.length?(null==t?i=o=null:o=r(i=t),a):i},a},j_=function(){var t=D_,e=null,n=h_(0),i=N_,r=h_(!0),o=null,a=P_,s=null;function c(c){var l,d,u,h,p,f=c.length,m=!1,g=new Array(f),v=new Array(f);for(null==o&&(s=a(p=$r())),l=0;l<=f;++l){if(!(l<f&&r(h=c[l],l,c))===m)if(m=!m)d=l,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),u=l-1;u>=d;--u)s.point(g[u],v[u]);s.lineEnd(),s.areaEnd()}m&&(g[l]=+t(h,l,c),v[l]=+n(h,l,c),s.point(e?+e(h,l,c):g[l],i?+i(h,l,c):v[l]))}if(p)return s=null,p+\"\"||null}function l(){return F_().defined(r).curve(a).context(o)}return c.x=function(n){return arguments.length?(t=\"function\"==typeof n?n:h_(+n),e=null,c):t},c.x0=function(e){return arguments.length?(t=\"function\"==typeof e?e:h_(+e),c):t},c.x1=function(t){return arguments.length?(e=null==t?null:\"function\"==typeof t?t:h_(+t),c):e},c.y=function(t){return arguments.length?(n=\"function\"==typeof t?t:h_(+t),i=null,c):n},c.y0=function(t){return arguments.length?(n=\"function\"==typeof t?t:h_(+t),c):n},c.y1=function(t){return arguments.length?(i=null==t?null:\"function\"==typeof t?t:h_(+t),c):i},c.lineX0=c.lineY0=function(){return l().x(t).y(n)},c.lineY1=function(){return l().x(t).y(i)},c.lineX1=function(){return l().x(e).y(n)},c.defined=function(t){return arguments.length?(r=\"function\"==typeof t?t:h_(!!t),c):r},c.curve=function(t){return arguments.length?(a=t,null!=o&&(s=a(o)),c):a},c.context=function(t){return arguments.length?(null==t?o=s=null:s=a(o=t),c):o},c},B_=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},z_=function(t){return t},U_=function(){var t=z_,e=B_,n=null,i=h_(0),r=h_(w_),o=h_(0);function a(a){var s,c,l,d,u,h=a.length,p=0,f=new Array(h),m=new Array(h),g=+i.apply(this,arguments),v=Math.min(w_,Math.max(-w_,r.apply(this,arguments)-g)),y=Math.min(Math.abs(v)/h,o.apply(this,arguments)),b=y*(v<0?-1:1);for(s=0;s<h;++s)(u=m[f[s]=s]=+t(a[s],s,a))>0&&(p+=u);for(null!=e?f.sort((function(t,n){return e(m[t],m[n])})):null!=n&&f.sort((function(t,e){return n(a[t],a[e])})),s=0,l=p?(v-h*b)/p:0;s<h;++s,g=d)c=f[s],d=g+((u=m[c])>0?u*l:0)+b,m[c]={data:a[c],index:s,value:u,startAngle:g,endAngle:d,padAngle:y};return m}return a.value=function(e){return arguments.length?(t=\"function\"==typeof e?e:h_(+e),a):t},a.sortValues=function(t){return arguments.length?(e=t,n=null,a):e},a.sort=function(t){return arguments.length?(n=t,e=null,a):n},a.startAngle=function(t){return arguments.length?(i=\"function\"==typeof t?t:h_(+t),a):i},a.endAngle=function(t){return arguments.length?(r=\"function\"==typeof t?t:h_(+t),a):r},a.padAngle=function(t){return arguments.length?(o=\"function\"==typeof t?t:h_(+t),a):o},a},H_=G_(P_);function $_(t){this._curve=t}function G_(t){function e(e){return new $_(t(e))}return e._curve=t,e}function V_(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?e(G_(t)):e()._curve},t}$_.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};var W_=function(){return V_(F_().curve(H_))},q_=function(){var t=j_().curve(H_),e=t.curve,n=t.lineX0,i=t.lineX1,r=t.lineY0,o=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return V_(n())},delete t.lineX0,t.lineEndAngle=function(){return V_(i())},delete t.lineX1,t.lineInnerRadius=function(){return V_(r())},delete t.lineY0,t.lineOuterRadius=function(){return V_(o())},delete t.lineY1,t.curve=function(t){return arguments.length?e(G_(t)):e()._curve},t},X_=function(t,e){return[(e=+e)*Math.cos(t-=Math.PI/2),e*Math.sin(t)]},Y_=Array.prototype.slice;function K_(t){return t.source}function Z_(t){return t.target}function J_(t){var e=K_,n=Z_,i=D_,r=N_,o=null;function a(){var a,s=Y_.call(arguments),c=e.apply(this,s),l=n.apply(this,s);if(o||(o=a=$r()),t(o,+i.apply(this,(s[0]=c,s)),+r.apply(this,s),+i.apply(this,(s[0]=l,s)),+r.apply(this,s)),a)return o=null,a+\"\"||null}return a.source=function(t){return arguments.length?(e=t,a):e},a.target=function(t){return arguments.length?(n=t,a):n},a.x=function(t){return arguments.length?(i=\"function\"==typeof t?t:h_(+t),a):i},a.y=function(t){return arguments.length?(r=\"function\"==typeof t?t:h_(+t),a):r},a.context=function(t){return arguments.length?(o=null==t?null:t,a):o},a}function Q_(t,e,n,i,r){t.moveTo(e,n),t.bezierCurveTo(e=(e+i)/2,n,e,r,i,r)}function tx(t,e,n,i,r){t.moveTo(e,n),t.bezierCurveTo(e,n=(n+r)/2,i,n,i,r)}function ex(t,e,n,i,r){var o=X_(e,n),a=X_(e,n=(n+r)/2),s=X_(i,n),c=X_(i,r);t.moveTo(o[0],o[1]),t.bezierCurveTo(a[0],a[1],s[0],s[1],c[0],c[1])}function nx(){return J_(Q_)}function ix(){return J_(tx)}function rx(){var t=J_(ex);return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t}var ox={draw:function(t,e){var n=Math.sqrt(e/__);t.moveTo(n,0),t.arc(0,0,n,0,w_)}},ax={draw:function(t,e){var n=Math.sqrt(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},sx=Math.sqrt(1/3),cx=2*sx,lx={draw:function(t,e){var n=Math.sqrt(e/cx),i=n*sx;t.moveTo(0,-n),t.lineTo(i,0),t.lineTo(0,n),t.lineTo(-i,0),t.closePath()}},dx=Math.sin(__/10)/Math.sin(7*__/10),ux=Math.sin(w_/10)*dx,hx=-Math.cos(w_/10)*dx,px={draw:function(t,e){var n=Math.sqrt(.8908130915292852*e),i=ux*n,r=hx*n;t.moveTo(0,-n),t.lineTo(i,r);for(var o=1;o<5;++o){var a=w_*o/5,s=Math.cos(a),c=Math.sin(a);t.lineTo(c*n,-s*n),t.lineTo(s*i-c*r,c*i+s*r)}t.closePath()}},fx={draw:function(t,e){var n=Math.sqrt(e),i=-n/2;t.rect(i,i,n,n)}},mx=Math.sqrt(3),gx={draw:function(t,e){var n=-Math.sqrt(e/(3*mx));t.moveTo(0,2*n),t.lineTo(-mx*n,-n),t.lineTo(mx*n,-n),t.closePath()}},vx=Math.sqrt(3)/2,yx=1/Math.sqrt(12),bx=3*(yx/2+1),_x={draw:function(t,e){var n=Math.sqrt(e/bx),i=n/2,r=n*yx,o=i,a=n*yx+n,s=-o,c=a;t.moveTo(i,r),t.lineTo(o,a),t.lineTo(s,c),t.lineTo(-.5*i-vx*r,vx*i+-.5*r),t.lineTo(-.5*o-vx*a,vx*o+-.5*a),t.lineTo(-.5*s-vx*c,vx*s+-.5*c),t.lineTo(-.5*i+vx*r,-.5*r-vx*i),t.lineTo(-.5*o+vx*a,-.5*a-vx*o),t.lineTo(-.5*s+vx*c,-.5*c-vx*s),t.closePath()}},xx=[ox,ax,lx,fx,px,gx,_x],wx=function(){var t=h_(ox),e=h_(64),n=null;function i(){var i;if(n||(n=i=$r()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),i)return n=null,i+\"\"||null}return i.type=function(e){return arguments.length?(t=\"function\"==typeof e?e:h_(e),i):t},i.size=function(t){return arguments.length?(e=\"function\"==typeof t?t:h_(+t),i):e},i.context=function(t){return arguments.length?(n=null==t?null:t,i):n},i},Sx=function(){};function Mx(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function Ex(t){this._context=t}Ex.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Mx(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Mx(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var Tx=function(t){return new Ex(t)};function Cx(t){this._context=t}Cx.prototype={areaStart:Sx,areaEnd:Sx,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:Mx(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var Ax=function(t){return new Cx(t)};function Ox(t){this._context=t}Ox.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,i=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:Mx(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var kx=function(t){return new Ox(t)};function Lx(t,e){this._basis=new Ex(t),this._beta=e}Lx.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var i,r=t[0],o=e[0],a=t[n]-r,s=e[n]-o,c=-1;++c<=n;)i=c/n,this._basis.point(this._beta*t[c]+(1-this._beta)*(r+i*a),this._beta*e[c]+(1-this._beta)*(o+i*s));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var Ix=function t(e){function n(t){return 1===e?new Ex(t):new Lx(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function Rx(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function Px(t,e){this._context=t,this._k=(1-e)/6}Px.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Rx(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:Rx(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Dx=function t(e){function n(t){return new Px(t,e)}return n.tension=function(e){return t(+e)},n}(0);function Nx(t,e){this._context=t,this._k=(1-e)/6}Nx.prototype={areaStart:Sx,areaEnd:Sx,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:Rx(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Fx=function t(e){function n(t){return new Nx(t,e)}return n.tension=function(e){return t(+e)},n}(0);function jx(t,e){this._context=t,this._k=(1-e)/6}jx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Rx(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Bx=function t(e){function n(t){return new jx(t,e)}return n.tension=function(e){return t(+e)},n}(0);function zx(t,e,n){var i=t._x1,r=t._y1,o=t._x2,a=t._y2;if(t._l01_a>1e-12){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,c=3*t._l01_a*(t._l01_a+t._l12_a);i=(i*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/c,r=(r*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/c}if(t._l23_a>1e-12){var l=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,d=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*l+t._x1*t._l23_2a-e*t._l12_2a)/d,a=(a*l+t._y1*t._l23_2a-n*t._l12_2a)/d}t._context.bezierCurveTo(i,r,o,a,t._x2,t._y2)}function Ux(t,e){this._context=t,this._alpha=e}Ux.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:zx(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Hx=function t(e){function n(t){return e?new Ux(t,e):new Px(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function $x(t,e){this._context=t,this._alpha=e}$x.prototype={areaStart:Sx,areaEnd:Sx,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:zx(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Gx=function t(e){function n(t){return e?new $x(t,e):new Nx(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Vx(t,e){this._context=t,this._alpha=e}Vx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:zx(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Wx=function t(e){function n(t){return e?new Vx(t,e):new jx(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function qx(t){this._context=t}qx.prototype={areaStart:Sx,areaEnd:Sx,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};var Xx=function(t){return new qx(t)};function Yx(t){return t<0?-1:1}function Kx(t,e,n){var i=t._x1-t._x0,r=e-t._x1,o=(t._y1-t._y0)/(i||r<0&&-0),a=(n-t._y1)/(r||i<0&&-0),s=(o*r+a*i)/(i+r);return(Yx(o)+Yx(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function Zx(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Jx(t,e,n){var i=t._x0,r=t._y0,o=t._x1,a=t._y1,s=(o-i)/3;t._context.bezierCurveTo(i+s,r+s*e,o-s,a-s*n,o,a)}function Qx(t){this._context=t}function tw(t){this._context=new ew(t)}function ew(t){this._context=t}function nw(t){return new Qx(t)}function iw(t){return new tw(t)}function rw(t){this._context=t}function ow(t){var e,n,i=t.length-1,r=new Array(i),o=new Array(i),a=new Array(i);for(r[0]=0,o[0]=2,a[0]=t[0]+2*t[1],e=1;e<i-1;++e)r[e]=1,o[e]=4,a[e]=4*t[e]+2*t[e+1];for(r[i-1]=2,o[i-1]=7,a[i-1]=8*t[i-1]+t[i],e=1;e<i;++e)n=r[e]/o[e-1],o[e]-=n,a[e]-=n*a[e-1];for(r[i-1]=a[i-1]/o[i-1],e=i-2;e>=0;--e)r[e]=(a[e]-r[e+1])/o[e];for(o[i-1]=(t[i]+r[i-1])/2,e=0;e<i-1;++e)o[e]=2*t[e+1]-r[e+1];return[r,o]}Qx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Jx(this,this._t0,Zx(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Jx(this,Zx(this,n=Kx(this,t,e)),n);break;default:Jx(this,this._t0,n=Kx(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(tw.prototype=Object.create(Qx.prototype)).point=function(t,e){Qx.prototype.point.call(this,e,t)},ew.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,i,r,o){this._context.bezierCurveTo(e,t,i,n,o,r)}},rw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var i=ow(t),r=ow(e),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(i[0][o],r[0][o],i[1][o],r[1][o],t[a],e[a]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var aw=function(t){return new rw(t)};function sw(t,e){this._context=t,this._t=e}sw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};var cw=function(t){return new sw(t,.5)};function lw(t){return new sw(t,0)}function dw(t){return new sw(t,1)}var uw=function(t,e){if((r=t.length)>1)for(var n,i,r,o=1,a=t[e[0]],s=a.length;o<r;++o)for(i=a,a=t[e[o]],n=0;n<s;++n)a[n][1]+=a[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]},hw=function(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n};function pw(t,e){return t[e]}var fw=function(){var t=h_([]),e=hw,n=uw,i=pw;function r(r){var o,a,s=t.apply(this,arguments),c=r.length,l=s.length,d=new Array(l);for(o=0;o<l;++o){for(var u,h=s[o],p=d[o]=new Array(c),f=0;f<c;++f)p[f]=u=[0,+i(r[f],h,f,r)],u.data=r[f];p.key=h}for(o=0,a=e(d);o<l;++o)d[a[o]].index=o;return n(d,a),d}return r.keys=function(e){return arguments.length?(t=\"function\"==typeof e?e:h_(Y_.call(e)),r):t},r.value=function(t){return arguments.length?(i=\"function\"==typeof t?t:h_(+t),r):i},r.order=function(t){return arguments.length?(e=null==t?hw:\"function\"==typeof t?t:h_(Y_.call(t)),r):e},r.offset=function(t){return arguments.length?(n=null==t?uw:t,r):n},r},mw=function(t,e){if((i=t.length)>0){for(var n,i,r,o=0,a=t[0].length;o<a;++o){for(r=n=0;n<i;++n)r+=t[n][o][1]||0;if(r)for(n=0;n<i;++n)t[n][o][1]/=r}uw(t,e)}},gw=function(t,e){if((s=t.length)>0)for(var n,i,r,o,a,s,c=0,l=t[e[0]].length;c<l;++c)for(o=a=0,n=0;n<s;++n)(r=(i=t[e[n]][c])[1]-i[0])>0?(i[0]=o,i[1]=o+=r):r<0?(i[1]=a,i[0]=a+=r):(i[0]=0,i[1]=r)},vw=function(t,e){if((n=t.length)>0){for(var n,i=0,r=t[e[0]],o=r.length;i<o;++i){for(var a=0,s=0;a<n;++a)s+=t[a][i][1]||0;r[i][1]+=r[i][0]=-s/2}uw(t,e)}},yw=function(t,e){if((r=t.length)>0&&(i=(n=t[e[0]]).length)>0){for(var n,i,r,o=0,a=1;a<i;++a){for(var s=0,c=0,l=0;s<r;++s){for(var d=t[e[s]],u=d[a][1]||0,h=(u-(d[a-1][1]||0))/2,p=0;p<s;++p){var f=t[e[p]];h+=(f[a][1]||0)-(f[a-1][1]||0)}c+=u,l+=h*u}n[a-1][1]+=n[a-1][0]=o,c&&(o-=l/c)}n[a-1][1]+=n[a-1][0]=o,uw(t,e)}},bw=function(t){var e=t.map(_w);return hw(t).sort((function(t,n){return e[t]-e[n]}))};function _w(t){for(var e,n=-1,i=0,r=t.length,o=-1/0;++n<r;)(e=+t[n][1])>o&&(o=e,i=n);return i}var xw=function(t){var e=t.map(ww);return hw(t).sort((function(t,n){return e[t]-e[n]}))};function ww(t){for(var e,n=0,i=-1,r=t.length;++i<r;)(e=+t[i][1])&&(n+=e);return n}var Sw=function(t){return xw(t).reverse()},Mw=function(t){var e,n,i=t.length,r=t.map(ww),o=bw(t),a=0,s=0,c=[],l=[];for(e=0;e<i;++e)n=o[e],a<s?(a+=r[n],c.push(n)):(s+=r[n],l.push(n));return l.reverse().concat(c)},Ew=function(t){return hw(t).reverse()};var Tw=Date.prototype.toISOString?function(t){return t.toISOString()}:Gg(\"%Y-%m-%dT%H:%M:%S.%LZ\");var Cw=+new Date(\"2000-01-01T00:00:00.000Z\")?function(t){var e=new Date(t);return isNaN(e)?null:e}:Vg(\"%Y-%m-%dT%H:%M:%S.%LZ\"),Aw=function(t,e,n){var i=new Gn,r=e;return null==e?(i.restart(t,e,n),i):(e=+e,n=null==n?Hn():+n,i.restart((function o(a){a+=r,i.restart(o,r+=e,n),t(a)}),e,n),i)},Ow=function(t){return function(){return t}};function kw(t){return t[0]}function Lw(t){return t[1]}function Iw(){this._=null}function Rw(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function Pw(t,e){var n=e,i=e.R,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function Dw(t,e){var n=e,i=e.L,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function Nw(t){for(;t.L;)t=t.L;return t}Iw.prototype={constructor:Iw,insert:function(t,e){var n,i,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=Nw(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(i=n.U).L?(r=i.R)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.R&&(Pw(this,n),n=(t=n).U),n.C=!1,i.C=!0,Dw(this,i)):(r=i.L)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.L&&(Dw(this,n),n=(t=n).U),n.C=!1,i.C=!0,Pw(this,i)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,i,r=t.U,o=t.L,a=t.R;if(n=o?a?Nw(a):o:a,r?r.L===t?r.L=n:r.R=n:this._=n,o&&a?(i=n.C,n.C=t.C,n.L=o,o.U=n,n!==a?(r=n.U,n.U=t.U,t=n.R,r.L=t,n.R=a,a.U=n):(n.U=r,r=n,t=n.R)):(i=t.C,t=n),t&&(t.U=r),!i)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===r.L){if((e=r.R).C&&(e.C=!1,r.C=!0,Pw(this,r),e=r.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,Dw(this,e),e=r.R),e.C=r.C,r.C=e.R.C=!1,Pw(this,r),t=this._;break}}else if((e=r.L).C&&(e.C=!1,r.C=!0,Dw(this,r),e=r.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,Pw(this,e),e=r.L),e.C=r.C,r.C=e.L.C=!1,Dw(this,r),t=this._;break}e.C=!0,t=r,r=r.U}while(!t.C);t&&(t.C=!1)}}};var Fw=Iw;function jw(t,e,n,i){var r=[null,null],o=cS.push(r)-1;return r.left=t,r.right=e,n&&zw(r,t,e,n),i&&zw(r,e,t,i),aS[t.index].halfedges.push(o),aS[e.index].halfedges.push(o),r}function Bw(t,e,n){var i=[e,n];return i.left=t,i}function zw(t,e,n,i){t[0]||t[1]?t.left===n?t[1]=i:t[0]=i:(t[0]=i,t.left=e,t.right=n)}function Uw(t,e,n,i,r){var o,a=t[0],s=t[1],c=a[0],l=a[1],d=0,u=1,h=s[0]-c,p=s[1]-l;if(o=e-c,h||!(o>0)){if(o/=h,h<0){if(o<d)return;o<u&&(u=o)}else if(h>0){if(o>u)return;o>d&&(d=o)}if(o=i-c,h||!(o<0)){if(o/=h,h<0){if(o>u)return;o>d&&(d=o)}else if(h>0){if(o<d)return;o<u&&(u=o)}if(o=n-l,p||!(o>0)){if(o/=p,p<0){if(o<d)return;o<u&&(u=o)}else if(p>0){if(o>u)return;o>d&&(d=o)}if(o=r-l,p||!(o<0)){if(o/=p,p<0){if(o>u)return;o>d&&(d=o)}else if(p>0){if(o<d)return;o<u&&(u=o)}return!(d>0||u<1)||(d>0&&(t[0]=[c+d*h,l+d*p]),u<1&&(t[1]=[c+u*h,l+u*p]),!0)}}}}}function Hw(t,e,n,i,r){var o=t[1];if(o)return!0;var a,s,c=t[0],l=t.left,d=t.right,u=l[0],h=l[1],p=d[0],f=d[1],m=(u+p)/2,g=(h+f)/2;if(f===h){if(m<e||m>=i)return;if(u>p){if(c){if(c[1]>=r)return}else c=[m,n];o=[m,r]}else{if(c){if(c[1]<n)return}else c=[m,r];o=[m,n]}}else if(s=g-(a=(u-p)/(f-h))*m,a<-1||a>1)if(u>p){if(c){if(c[1]>=r)return}else c=[(n-s)/a,n];o=[(r-s)/a,r]}else{if(c){if(c[1]<n)return}else c=[(r-s)/a,r];o=[(n-s)/a,n]}else if(h<f){if(c){if(c[0]>=i)return}else c=[e,a*e+s];o=[i,a*i+s]}else{if(c){if(c[0]<e)return}else c=[i,a*i+s];o=[e,a*e+s]}return t[0]=c,t[1]=o,!0}function $w(t,e){var n=t.site,i=e.left,r=e.right;return n===r&&(r=i,i=n),r?Math.atan2(r[1]-i[1],r[0]-i[0]):(n===i?(i=e[1],r=e[0]):(i=e[0],r=e[1]),Math.atan2(i[0]-r[0],r[1]-i[1]))}function Gw(t,e){return e[+(e.left!==t.site)]}function Vw(t,e){return e[+(e.left===t.site)]}var Ww,qw=[];function Xw(){Rw(this),this.x=this.y=this.arc=this.site=this.cy=null}function Yw(t){var e=t.P,n=t.N;if(e&&n){var i=e.site,r=t.site,o=n.site;if(i!==o){var a=r[0],s=r[1],c=i[0]-a,l=i[1]-s,d=o[0]-a,u=o[1]-s,h=2*(c*u-l*d);if(!(h>=-dS)){var p=c*c+l*l,f=d*d+u*u,m=(u*p-l*f)/h,g=(c*f-d*p)/h,v=qw.pop()||new Xw;v.arc=t,v.site=r,v.x=m+a,v.y=(v.cy=g+s)+Math.sqrt(m*m+g*g),t.circle=v;for(var y=null,b=sS._;b;)if(v.y<b.y||v.y===b.y&&v.x<=b.x){if(!b.L){y=b.P;break}b=b.L}else{if(!b.R){y=b;break}b=b.R}sS.insert(y,v),y||(Ww=v)}}}}function Kw(t){var e=t.circle;e&&(e.P||(Ww=e.N),sS.remove(e),qw.push(e),Rw(e),t.circle=null)}var Zw=[];function Jw(){Rw(this),this.edge=this.site=this.circle=null}function Qw(t){var e=Zw.pop()||new Jw;return e.site=t,e}function tS(t){Kw(t),oS.remove(t),Zw.push(t),Rw(t)}function eS(t){var e=t.circle,n=e.x,i=e.cy,r=[n,i],o=t.P,a=t.N,s=[t];tS(t);for(var c=o;c.circle&&Math.abs(n-c.circle.x)<lS&&Math.abs(i-c.circle.cy)<lS;)o=c.P,s.unshift(c),tS(c),c=o;s.unshift(c),Kw(c);for(var l=a;l.circle&&Math.abs(n-l.circle.x)<lS&&Math.abs(i-l.circle.cy)<lS;)a=l.N,s.push(l),tS(l),l=a;s.push(l),Kw(l);var d,u=s.length;for(d=1;d<u;++d)l=s[d],c=s[d-1],zw(l.edge,c.site,l.site,r);c=s[0],(l=s[u-1]).edge=jw(c.site,l.site,null,r),Yw(c),Yw(l)}function nS(t){for(var e,n,i,r,o=t[0],a=t[1],s=oS._;s;)if((i=iS(s,a)-o)>lS)s=s.L;else{if(!((r=o-rS(s,a))>lS)){i>-lS?(e=s.P,n=s):r>-lS?(e=s,n=s.N):e=n=s;break}if(!s.R){e=s;break}s=s.R}!function(t){aS[t.index]={site:t,halfedges:[]}}(t);var c=Qw(t);if(oS.insert(e,c),e||n){if(e===n)return Kw(e),n=Qw(e.site),oS.insert(c,n),c.edge=n.edge=jw(e.site,c.site),Yw(e),void Yw(n);if(n){Kw(e),Kw(n);var l=e.site,d=l[0],u=l[1],h=t[0]-d,p=t[1]-u,f=n.site,m=f[0]-d,g=f[1]-u,v=2*(h*g-p*m),y=h*h+p*p,b=m*m+g*g,_=[(g*y-p*b)/v+d,(h*b-m*y)/v+u];zw(n.edge,l,f,_),c.edge=jw(l,t,null,_),n.edge=jw(t,f,null,_),Yw(e),Yw(n)}else c.edge=jw(e.site,c.site)}}function iS(t,e){var n=t.site,i=n[0],r=n[1],o=r-e;if(!o)return i;var a=t.P;if(!a)return-1/0;var s=(n=a.site)[0],c=n[1],l=c-e;if(!l)return s;var d=s-i,u=1/o-1/l,h=d/l;return u?(-h+Math.sqrt(h*h-2*u*(d*d/(-2*l)-c+l/2+r-o/2)))/u+i:(i+s)/2}function rS(t,e){var n=t.N;if(n)return iS(n,e);var i=t.site;return i[1]===e?i[0]:1/0}var oS,aS,sS,cS,lS=1e-6,dS=1e-12;function uS(t,e){return e[1]-t[1]||e[0]-t[0]}function hS(t,e){var n,i,r,o=t.sort(uS).pop();for(cS=[],aS=new Array(t.length),oS=new Fw,sS=new Fw;;)if(r=Ww,o&&(!r||o[1]<r.y||o[1]===r.y&&o[0]<r.x))o[0]===n&&o[1]===i||(nS(o),n=o[0],i=o[1]),o=t.pop();else{if(!r)break;eS(r.arc)}if(function(){for(var t,e,n,i,r=0,o=aS.length;r<o;++r)if((t=aS[r])&&(i=(e=t.halfedges).length)){var a=new Array(i),s=new Array(i);for(n=0;n<i;++n)a[n]=n,s[n]=$w(t,cS[e[n]]);for(a.sort((function(t,e){return s[e]-s[t]})),n=0;n<i;++n)s[n]=e[a[n]];for(n=0;n<i;++n)e[n]=s[n]}}(),e){var a=+e[0][0],s=+e[0][1],c=+e[1][0],l=+e[1][1];!function(t,e,n,i){for(var r,o=cS.length;o--;)Hw(r=cS[o],t,e,n,i)&&Uw(r,t,e,n,i)&&(Math.abs(r[0][0]-r[1][0])>lS||Math.abs(r[0][1]-r[1][1])>lS)||delete cS[o]}(a,s,c,l),function(t,e,n,i){var r,o,a,s,c,l,d,u,h,p,f,m,g=aS.length,v=!0;for(r=0;r<g;++r)if(o=aS[r]){for(a=o.site,s=(c=o.halfedges).length;s--;)cS[c[s]]||c.splice(s,1);for(s=0,l=c.length;s<l;)f=(p=Vw(o,cS[c[s]]))[0],m=p[1],u=(d=Gw(o,cS[c[++s%l]]))[0],h=d[1],(Math.abs(f-u)>lS||Math.abs(m-h)>lS)&&(c.splice(s,0,cS.push(Bw(a,p,Math.abs(f-t)<lS&&i-m>lS?[t,Math.abs(u-t)<lS?h:i]:Math.abs(m-i)<lS&&n-f>lS?[Math.abs(h-i)<lS?u:n,i]:Math.abs(f-n)<lS&&m-e>lS?[n,Math.abs(u-n)<lS?h:e]:Math.abs(m-e)<lS&&f-t>lS?[Math.abs(h-e)<lS?u:t,e]:null))-1),++l);l&&(v=!1)}if(v){var y,b,_,x=1/0;for(r=0,v=null;r<g;++r)(o=aS[r])&&(_=(y=(a=o.site)[0]-t)*y+(b=a[1]-e)*b)<x&&(x=_,v=o);if(v){var w=[t,e],S=[t,i],M=[n,i],E=[n,e];v.halfedges.push(cS.push(Bw(a=v.site,w,S))-1,cS.push(Bw(a,S,M))-1,cS.push(Bw(a,M,E))-1,cS.push(Bw(a,E,w))-1)}}for(r=0;r<g;++r)(o=aS[r])&&(o.halfedges.length||delete aS[r])}(a,s,c,l)}this.edges=cS,this.cells=aS,oS=sS=cS=aS=null}hS.prototype={constructor:hS,polygons:function(){var t=this.edges;return this.cells.map((function(e){var n=e.halfedges.map((function(n){return Gw(e,t[n])}));return n.data=e.site.data,n}))},triangles:function(){var t=[],e=this.edges;return this.cells.forEach((function(n,i){if(o=(r=n.halfedges).length)for(var r,o,a,s,c,l,d=n.site,u=-1,h=e[r[o-1]],p=h.left===d?h.right:h.left;++u<o;)a=p,p=(h=e[r[u]]).left===d?h.right:h.left,a&&p&&i<a.index&&i<p.index&&(c=a,l=p,((s=d)[0]-l[0])*(c[1]-s[1])-(s[0]-c[0])*(l[1]-s[1])<0)&&t.push([d.data,a.data,p.data])})),t},links:function(){return this.edges.filter((function(t){return t.right})).map((function(t){return{source:t.left.data,target:t.right.data}}))},find:function(t,e,n){for(var i,r,o=this,a=o._found||0,s=o.cells.length;!(r=o.cells[a]);)if(++a>=s)return null;var c=t-r.site[0],l=e-r.site[1],d=c*c+l*l;do{r=o.cells[i=a],a=null,r.halfedges.forEach((function(n){var i=o.edges[n],s=i.left;if(s!==r.site&&s||(s=i.right)){var c=t-s[0],l=e-s[1],u=c*c+l*l;u<d&&(d=u,a=s.index)}}))}while(null!==a);return o._found=i,null==n||d<=n*n?r.site:null}};var pS=function(){var t=kw,e=Lw,n=null;function i(i){return new hS(i.map((function(n,r){var o=[Math.round(t(n,r,i)/lS)*lS,Math.round(e(n,r,i)/lS)*lS];return o.index=r,o.data=n,o})),n)}return i.polygons=function(t){return i(t).polygons()},i.links=function(t){return i(t).links()},i.triangles=function(t){return i(t).triangles()},i.x=function(e){return arguments.length?(t=\"function\"==typeof e?e:Ow(+e),i):t},i.y=function(t){return arguments.length?(e=\"function\"==typeof t?t:Ow(+t),i):e},i.extent=function(t){return arguments.length?(n=null==t?null:[[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]],i):n&&[[n[0][0],n[0][1]],[n[1][0],n[1][1]]]},i.size=function(t){return arguments.length?(n=null==t?null:[[0,0],[+t[0],+t[1]]],i):n&&[n[1][0]-n[0][0],n[1][1]-n[0][1]]},i},fS=function(t){return function(){return t}};function mS(t,e,n){this.target=t,this.type=e,this.transform=n}function gS(t,e,n){this.k=t,this.x=e,this.y=n}gS.prototype={constructor:gS,scale:function(t){return 1===t?this:new gS(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new gS(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return\"translate(\"+this.x+\",\"+this.y+\") scale(\"+this.k+\")\"}};var vS=new gS(1,0,0);function yS(t){for(;!t.__zoom;)if(!(t=t.parentNode))return vS;return t.__zoom}function bS(){le.stopImmediatePropagation()}yS.prototype=gS.prototype;var _S=function(){le.preventDefault(),le.stopImmediatePropagation()};function xS(){return!le.ctrlKey&&!le.button}function wS(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute(\"viewBox\")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function SS(){return this.__zoom||vS}function MS(){return-le.deltaY*(1===le.deltaMode?.05:le.deltaMode?1:.002)}function ES(){return navigator.maxTouchPoints||\"ontouchstart\"in this}function TS(t,e,n){var i=t.invertX(e[0][0])-n[0][0],r=t.invertX(e[1][0])-n[1][0],o=t.invertY(e[0][1])-n[0][1],a=t.invertY(e[1][1])-n[1][1];return t.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}var CS=function(){var t,e,n=xS,i=wS,r=TS,o=MS,a=ES,s=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],l=250,d=hf,u=ut(\"start\",\"zoom\",\"end\"),h=0;function p(t){t.property(\"__zoom\",SS).on(\"wheel.zoom\",_).on(\"mousedown.zoom\",x).on(\"dblclick.zoom\",w).filter(a).on(\"touchstart.zoom\",S).on(\"touchmove.zoom\",M).on(\"touchend.zoom touchcancel.zoom\",E).style(\"touch-action\",\"none\").style(\"-webkit-tap-highlight-color\",\"rgba(0,0,0,0)\")}function f(t,e){return(e=Math.max(s[0],Math.min(s[1],e)))===t.k?t:new gS(e,t.x,t.y)}function m(t,e,n){var i=e[0]-n[0]*t.k,r=e[1]-n[1]*t.k;return i===t.x&&r===t.y?t:new gS(t.k,i,r)}function g(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function v(t,e,n){t.on(\"start.zoom\",(function(){y(this,arguments).start()})).on(\"interrupt.zoom end.zoom\",(function(){y(this,arguments).end()})).tween(\"zoom\",(function(){var t=this,r=arguments,o=y(t,r),a=i.apply(t,r),s=null==n?g(a):\"function\"==typeof n?n.apply(t,r):n,c=Math.max(a[1][0]-a[0][0],a[1][1]-a[0][1]),l=t.__zoom,u=\"function\"==typeof e?e.apply(t,r):e,h=d(l.invert(s).concat(c/l.k),u.invert(s).concat(c/u.k));return function(t){if(1===t)t=u;else{var e=h(t),n=c/e[2];t=new gS(n,s[0]-e[0]*n,s[1]-e[1]*n)}o.zoom(null,t)}}))}function y(t,e,n){return!n&&t.__zooming||new b(t,e)}function b(t,e){this.that=t,this.args=e,this.active=0,this.extent=i.apply(t,e),this.taps=0}function _(){if(n.apply(this,arguments)){var t=y(this,arguments),e=this.__zoom,i=Math.max(s[0],Math.min(s[1],e.k*Math.pow(2,o.apply(this,arguments)))),a=Rn(this);if(t.wheel)t.mouse[0][0]===a[0]&&t.mouse[0][1]===a[1]||(t.mouse[1]=e.invert(t.mouse[0]=a)),clearTimeout(t.wheel);else{if(e.k===i)return;t.mouse=[a,e.invert(a)],si(this),t.start()}_S(),t.wheel=setTimeout(l,150),t.zoom(\"mouse\",r(m(f(e,i),t.mouse[0],t.mouse[1]),t.extent,c))}function l(){t.wheel=null,t.end()}}function x(){if(!e&&n.apply(this,arguments)){var t=y(this,arguments,!0),i=Se(le.view).on(\"mousemove.zoom\",l,!0).on(\"mouseup.zoom\",d,!0),o=Rn(this),a=le.clientX,s=le.clientY;Te(le.view),bS(),t.mouse=[o,this.__zoom.invert(o)],si(this),t.start()}function l(){if(_S(),!t.moved){var e=le.clientX-a,n=le.clientY-s;t.moved=e*e+n*n>h}t.zoom(\"mouse\",r(m(t.that.__zoom,t.mouse[0]=Rn(t.that),t.mouse[1]),t.extent,c))}function d(){i.on(\"mousemove.zoom mouseup.zoom\",null),Ce(le.view,t.moved),_S(),t.end()}}function w(){if(n.apply(this,arguments)){var t=this.__zoom,e=Rn(this),o=t.invert(e),a=t.k*(le.shiftKey?.5:2),s=r(m(f(t,a),e,o),i.apply(this,arguments),c);_S(),l>0?Se(this).transition().duration(l).call(v,s,e):Se(this).call(p.transform,s)}}function S(){if(n.apply(this,arguments)){var e,i,r,o,a=le.touches,s=a.length,c=y(this,arguments,le.changedTouches.length===s);for(bS(),i=0;i<s;++i)r=a[i],o=[o=In(this,a,r.identifier),this.__zoom.invert(o),r.identifier],c.touch0?c.touch1||c.touch0[2]===o[2]||(c.touch1=o,c.taps=0):(c.touch0=o,e=!0,c.taps=1+!!t);t&&(t=clearTimeout(t)),e&&(c.taps<2&&(t=setTimeout((function(){t=null}),500)),si(this),c.start())}}function M(){if(this.__zooming){var e,n,i,o,a=y(this,arguments),s=le.changedTouches,l=s.length;for(_S(),t&&(t=clearTimeout(t)),a.taps=0,e=0;e<l;++e)n=s[e],i=In(this,s,n.identifier),a.touch0&&a.touch0[2]===n.identifier?a.touch0[0]=i:a.touch1&&a.touch1[2]===n.identifier&&(a.touch1[0]=i);if(n=a.that.__zoom,a.touch1){var d=a.touch0[0],u=a.touch0[1],h=a.touch1[0],p=a.touch1[1],g=(g=h[0]-d[0])*g+(g=h[1]-d[1])*g,v=(v=p[0]-u[0])*v+(v=p[1]-u[1])*v;n=f(n,Math.sqrt(g/v)),i=[(d[0]+h[0])/2,(d[1]+h[1])/2],o=[(u[0]+p[0])/2,(u[1]+p[1])/2]}else{if(!a.touch0)return;i=a.touch0[0],o=a.touch0[1]}a.zoom(\"touch\",r(m(n,i,o),a.extent,c))}}function E(){if(this.__zooming){var t,n,i=y(this,arguments),r=le.changedTouches,o=r.length;for(bS(),e&&clearTimeout(e),e=setTimeout((function(){e=null}),500),t=0;t<o;++t)n=r[t],i.touch0&&i.touch0[2]===n.identifier?delete i.touch0:i.touch1&&i.touch1[2]===n.identifier&&delete i.touch1;if(i.touch1&&!i.touch0&&(i.touch0=i.touch1,delete i.touch1),i.touch0)i.touch0[1]=this.__zoom.invert(i.touch0[0]);else if(i.end(),2===i.taps){var a=Se(this).on(\"dblclick.zoom\");a&&a.apply(this,arguments)}}}return p.transform=function(t,e,n){var i=t.selection?t.selection():t;i.property(\"__zoom\",SS),t!==i?v(t,e,n):i.interrupt().each((function(){y(this,arguments).start().zoom(null,\"function\"==typeof e?e.apply(this,arguments):e).end()}))},p.scaleBy=function(t,e,n){p.scaleTo(t,(function(){var t=this.__zoom.k,n=\"function\"==typeof e?e.apply(this,arguments):e;return t*n}),n)},p.scaleTo=function(t,e,n){p.transform(t,(function(){var t=i.apply(this,arguments),o=this.__zoom,a=null==n?g(t):\"function\"==typeof n?n.apply(this,arguments):n,s=o.invert(a),l=\"function\"==typeof e?e.apply(this,arguments):e;return r(m(f(o,l),a,s),t,c)}),n)},p.translateBy=function(t,e,n){p.transform(t,(function(){return r(this.__zoom.translate(\"function\"==typeof e?e.apply(this,arguments):e,\"function\"==typeof n?n.apply(this,arguments):n),i.apply(this,arguments),c)}))},p.translateTo=function(t,e,n,o){p.transform(t,(function(){var t=i.apply(this,arguments),a=this.__zoom,s=null==o?g(t):\"function\"==typeof o?o.apply(this,arguments):o;return r(vS.translate(s[0],s[1]).scale(a.k).translate(\"function\"==typeof e?-e.apply(this,arguments):-e,\"function\"==typeof n?-n.apply(this,arguments):-n),t,c)}),o)},b.prototype={start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit(\"start\")),this},zoom:function(t,e){return this.mouse&&\"mouse\"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&\"touch\"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&\"touch\"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit(\"zoom\"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit(\"end\")),this},emit:function(t){me(new mS(p,t,this.that.__zoom),u.apply,u,[t,this.that,this.args])}},p.wheelDelta=function(t){return arguments.length?(o=\"function\"==typeof t?t:fS(+t),p):o},p.filter=function(t){return arguments.length?(n=\"function\"==typeof t?t:fS(!!t),p):n},p.touchable=function(t){return arguments.length?(a=\"function\"==typeof t?t:fS(!!t),p):a},p.extent=function(t){return arguments.length?(i=\"function\"==typeof t?t:fS([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),p):i},p.scaleExtent=function(t){return arguments.length?(s[0]=+t[0],s[1]=+t[1],p):[s[0],s[1]]},p.translateExtent=function(t){return arguments.length?(c[0][0]=+t[0][0],c[1][0]=+t[1][0],c[0][1]=+t[0][1],c[1][1]=+t[1][1],p):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},p.constrain=function(t){return arguments.length?(r=t,p):r},p.duration=function(t){return arguments.length?(l=+t,p):l},p.interpolate=function(t){return arguments.length?(d=t,p):d},p.on=function(){var t=u.on.apply(u,arguments);return t===u?p:t},p.clickDistance=function(t){return arguments.length?(h=(t=+t)*t,p):Math.sqrt(h)},p}},function(t,e,n){\"use strict\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nvar i;n.d(e,\"a\",(function(){return z})),n.d(e,\"b\",(function(){return w})),n.d(e,\"c\",(function(){return M})),n.d(e,\"d\",(function(){return E})),n.d(e,\"e\",(function(){return C})),n.d(e,\"f\",(function(){return S}));const r=globalThis.trustedTypes,o=r?r.createPolicy(\"lit-html\",{createHTML:t=>t}):void 0,a=`lit$${(Math.random()+\"\").slice(9)}$`,s=\"?\"+a,c=`<${s}>`,l=document,d=(t=\"\")=>l.createComment(t),u=t=>null===t||\"object\"!=typeof t&&\"function\"!=typeof t,h=Array.isArray,p=t=>h(t)||\"function\"==typeof(null==t?void 0:t[Symbol.iterator]),f=/<(?:(!--|\\/[^a-zA-Z])|(\\/?[a-zA-Z][^>\\s]*)|(\\/?$))/g,m=/-->/g,g=/>/g,v=RegExp(\">|[ \\t\\n\\f\\r](?:([^\\\\s\\\"'>=/]+)([ \\t\\n\\f\\r]*=[ \\t\\n\\f\\r]*(?:[^ \\t\\n\\f\\r\\\"'`<>=]|(\\\"|')|))|$)\",\"g\"),y=/'/g,b=/\"/g,_=/^(?:script|style|textarea|title)$/i,x=t=>(e,...n)=>({_$litType$:t,strings:e,values:n}),w=x(1),S=x(2),M=Symbol.for(\"lit-noChange\"),E=Symbol.for(\"lit-nothing\"),T=new WeakMap,C=(t,e,n)=>{var i,r;const o=null!==(i=null==n?void 0:n.renderBefore)&&void 0!==i?i:e;let a=o._$litPart$;if(void 0===a){const t=null!==(r=null==n?void 0:n.renderBefore)&&void 0!==r?r:null;o._$litPart$=a=new R(e.insertBefore(d(),t),t,void 0,null!=n?n:{})}return a._$AI(t),a},A=l.createTreeWalker(l,129,null,!1),O=(t,e)=>{const n=t.length-1,i=[];let r,s=2===e?\"<svg>\":\"\",l=f;for(let e=0;e<n;e++){const n=t[e];let o,d,u=-1,h=0;for(;h<n.length&&(l.lastIndex=h,d=l.exec(n),null!==d);)h=l.lastIndex,l===f?\"!--\"===d[1]?l=m:void 0!==d[1]?l=g:void 0!==d[2]?(_.test(d[2])&&(r=RegExp(\"</\"+d[2],\"g\")),l=v):void 0!==d[3]&&(l=v):l===v?\">\"===d[0]?(l=null!=r?r:f,u=-1):void 0===d[1]?u=-2:(u=l.lastIndex-d[2].length,o=d[1],l=void 0===d[3]?v:'\"'===d[3]?b:y):l===b||l===y?l=v:l===m||l===g?l=f:(l=v,r=void 0);const p=l===v&&t[e+1].startsWith(\"/>\")?\" \":\"\";s+=l===f?n+c:u>=0?(i.push(o),n.slice(0,u)+\"$lit$\"+n.slice(u)+a+p):n+a+(-2===u?(i.push(void 0),e):p)}const d=s+(t[n]||\"<?>\")+(2===e?\"</svg>\":\"\");if(!Array.isArray(t)||!t.hasOwnProperty(\"raw\"))throw Error(\"invalid template strings array\");return[void 0!==o?o.createHTML(d):d,i]};class k{constructor({strings:t,_$litType$:e},n){let i;this.parts=[];let o=0,c=0;const l=t.length-1,u=this.parts,[h,p]=O(t,e);if(this.el=k.createElement(h,n),A.currentNode=this.el.content,2===e){const t=this.el.content,e=t.firstChild;e.remove(),t.append(...e.childNodes)}for(;null!==(i=A.nextNode())&&u.length<l;){if(1===i.nodeType){if(i.hasAttributes()){const t=[];for(const e of i.getAttributeNames())if(e.endsWith(\"$lit$\")||e.startsWith(a)){const n=p[c++];if(t.push(e),void 0!==n){const t=i.getAttribute(n.toLowerCase()+\"$lit$\").split(a),e=/([.?@])?(.*)/.exec(n);u.push({type:1,index:o,name:e[2],strings:t,ctor:\".\"===e[1]?D:\"?\"===e[1]?F:\"@\"===e[1]?j:P})}else u.push({type:6,index:o})}for(const e of t)i.removeAttribute(e)}if(_.test(i.tagName)){const t=i.textContent.split(a),e=t.length-1;if(e>0){i.textContent=r?r.emptyScript:\"\";for(let n=0;n<e;n++)i.append(t[n],d()),A.nextNode(),u.push({type:2,index:++o});i.append(t[e],d())}}}else if(8===i.nodeType)if(i.data===s)u.push({type:2,index:o});else{let t=-1;for(;-1!==(t=i.data.indexOf(a,t+1));)u.push({type:7,index:o}),t+=a.length-1}o++}}static createElement(t,e){const n=l.createElement(\"template\");return n.innerHTML=t,n}}function L(t,e,n=t,i){var r,o,a,s;if(e===M)return e;let c=void 0!==i?null===(r=n._$Cl)||void 0===r?void 0:r[i]:n._$Cu;const l=u(e)?void 0:e._$litDirective$;return(null==c?void 0:c.constructor)!==l&&(null===(o=null==c?void 0:c._$AO)||void 0===o||o.call(c,!1),void 0===l?c=void 0:(c=new l(t),c._$AT(t,n,i)),void 0!==i?(null!==(a=(s=n)._$Cl)&&void 0!==a?a:s._$Cl=[])[i]=c:n._$Cu=c),void 0!==c&&(e=L(t,c._$AS(t,e.values),c,i)),e}class I{constructor(t,e){this.v=[],this._$AN=void 0,this._$AD=t,this._$AM=e}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}p(t){var e;const{el:{content:n},parts:i}=this._$AD,r=(null!==(e=null==t?void 0:t.creationScope)&&void 0!==e?e:l).importNode(n,!0);A.currentNode=r;let o=A.nextNode(),a=0,s=0,c=i[0];for(;void 0!==c;){if(a===c.index){let e;2===c.type?e=new R(o,o.nextSibling,this,t):1===c.type?e=new c.ctor(o,c.name,c.strings,this,t):6===c.type&&(e=new B(o,this,t)),this.v.push(e),c=i[++s]}a!==(null==c?void 0:c.index)&&(o=A.nextNode(),a++)}return r}m(t){let e=0;for(const n of this.v)void 0!==n&&(void 0!==n.strings?(n._$AI(t,n,e),e+=n.strings.length-2):n._$AI(t[e])),e++}}class R{constructor(t,e,n,i){var r;this.type=2,this._$AH=E,this._$AN=void 0,this._$AA=t,this._$AB=e,this._$AM=n,this.options=i,this._$C_=null===(r=null==i?void 0:i.isConnected)||void 0===r||r}get _$AU(){var t,e;return null!==(e=null===(t=this._$AM)||void 0===t?void 0:t._$AU)&&void 0!==e?e:this._$C_}get parentNode(){let t=this._$AA.parentNode;const e=this._$AM;return void 0!==e&&11===t.nodeType&&(t=e.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,e=this){t=L(this,t,e),u(t)?t===E||null==t||\"\"===t?(this._$AH!==E&&this._$AR(),this._$AH=E):t!==this._$AH&&t!==M&&this.T(t):void 0!==t._$litType$?this.$(t):void 0!==t.nodeType?this.k(t):p(t)?this.S(t):this.T(t)}j(t,e=this._$AB){return this._$AA.parentNode.insertBefore(t,e)}k(t){this._$AH!==t&&(this._$AR(),this._$AH=this.j(t))}T(t){this._$AH!==E&&u(this._$AH)?this._$AA.nextSibling.data=t:this.k(l.createTextNode(t)),this._$AH=t}$(t){var e;const{values:n,_$litType$:i}=t,r=\"number\"==typeof i?this._$AC(t):(void 0===i.el&&(i.el=k.createElement(i.h,this.options)),i);if((null===(e=this._$AH)||void 0===e?void 0:e._$AD)===r)this._$AH.m(n);else{const t=new I(r,this),e=t.p(this.options);t.m(n),this.k(e),this._$AH=t}}_$AC(t){let e=T.get(t.strings);return void 0===e&&T.set(t.strings,e=new k(t)),e}S(t){h(this._$AH)||(this._$AH=[],this._$AR());const e=this._$AH;let n,i=0;for(const r of t)i===e.length?e.push(n=new R(this.j(d()),this.j(d()),this,this.options)):n=e[i],n._$AI(r),i++;i<e.length&&(this._$AR(n&&n._$AB.nextSibling,i),e.length=i)}_$AR(t=this._$AA.nextSibling,e){var n;for(null===(n=this._$AP)||void 0===n||n.call(this,!1,!0,e);t&&t!==this._$AB;){const e=t.nextSibling;t.remove(),t=e}}setConnected(t){var e;void 0===this._$AM&&(this._$C_=t,null===(e=this._$AP)||void 0===e||e.call(this,t))}}class P{constructor(t,e,n,i,r){this.type=1,this._$AH=E,this._$AN=void 0,this.element=t,this.name=e,this._$AM=i,this.options=r,n.length>2||\"\"!==n[0]||\"\"!==n[1]?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=E}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(t,e=this,n,i){const r=this.strings;let o=!1;if(void 0===r)t=L(this,t,e,0),o=!u(t)||t!==this._$AH&&t!==M,o&&(this._$AH=t);else{const i=t;let a,s;for(t=r[0],a=0;a<r.length-1;a++)s=L(this,i[n+a],e,a),s===M&&(s=this._$AH[a]),o||(o=!u(s)||s!==this._$AH[a]),s===E?t=E:t!==E&&(t+=(null!=s?s:\"\")+r[a+1]),this._$AH[a]=s}o&&!i&&this.P(t)}P(t){t===E?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=t?t:\"\")}}class D extends P{constructor(){super(...arguments),this.type=3}P(t){this.element[this.name]=t===E?void 0:t}}const N=r?r.emptyScript:\"\";class F extends P{constructor(){super(...arguments),this.type=4}P(t){t&&t!==E?this.element.setAttribute(this.name,N):this.element.removeAttribute(this.name)}}class j extends P{constructor(t,e,n,i,r){super(t,e,n,i,r),this.type=5}_$AI(t,e=this){var n;if((t=null!==(n=L(this,t,e,0))&&void 0!==n?n:E)===M)return;const i=this._$AH,r=t===E&&i!==E||t.capture!==i.capture||t.once!==i.once||t.passive!==i.passive,o=t!==E&&(i===E||r);r&&this.element.removeEventListener(this.name,this,i),o&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){var e,n;\"function\"==typeof this._$AH?this._$AH.call(null!==(n=null===(e=this.options)||void 0===e?void 0:e.host)&&void 0!==n?n:this.element,t):this._$AH.handleEvent(t)}}class B{constructor(t,e,n){this.element=t,this.type=6,this._$AN=void 0,this._$AM=e,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(t){L(this,t)}}const z={A:\"$lit$\",C:a,M:s,L:1,R:O,V:I,D:p,I:L,H:R,N:P,U:F,B:j,F:D,W:B},U=window.litHtmlPolyfillSupport;null==U||U(k,R),(null!==(i=globalThis.litHtmlVersions)&&void 0!==i?i:globalThis.litHtmlVersions=[]).push(\"2.2.7\")},function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return o})),n.d(e,\"b\",(function(){return i})),n.d(e,\"c\",(function(){return r}));\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst i={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},r=t=>(...e)=>({_$litDirective$:t,values:e});class o{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,e,n){this._$Ct=t,this._$AM=e,this._$Ci=n}_$AS(t,e){return this.update(t,e)}update(t,e){return this.render(...e)}}},function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return r}));var i=n(18);n.d(e,\"b\",(function(){return i.b}));\n/**\n@license\nCopyright 2018 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\nclass r extends i.a{createRenderRoot(){return this.attachShadow({mode:\"open\",delegatesFocus:!0})}click(){this.formElement&&(this.formElement.focus(),this.formElement.click())}setAriaLabel(t){this.formElement&&this.formElement.setAttribute(\"aria-label\",t)}firstUpdated(){super.firstUpdated(),this.mdcRoot.addEventListener(\"change\",t=>{this.dispatchEvent(new Event(\"change\",t))})}}},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.LitService=void 0;e.LitService=class{}},function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return i})),n.d(e,\"c\",(function(){return r})),n.d(e,\"b\",(function(){return o}));\n/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nconst i=\"undefined\"!=typeof window&&null!=window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,r=(t,e,n=null,i=null)=>{for(;e!==n;){const n=e.nextSibling;t.insertBefore(e,i),e=n}},o=(t,e,n=null)=>{for(;e!==n;){const n=e.nextSibling;t.removeChild(e),e=n}}},function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return o}));var i=n(9);\n/**\n * @license\n * Copyright (c) 2018 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */const r=new WeakMap,o=Object(i.f)(t=>e=>{const n=r.get(e);if(void 0===t&&e instanceof i.a){if(void 0!==n||!r.has(e)){const t=e.committer.name;e.committer.element.removeAttribute(t)}}else t!==n&&e.setValue(t);r.set(e,t)})},function(t,e,n){\"use strict\";n.d(e,\"e\",(function(){return r})),n.d(e,\"d\",(function(){return o})),n.d(e,\"a\",(function(){return a})),n.d(e,\"b\",(function(){return d})),n.d(e,\"c\",(function(){return u}));var i=n(61);\n/**\n@license\nCopyright 2018 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/const r=t=>t.nodeType===Node.ELEMENT_NODE;function o(t,e){for(const n of t.assignedNodes({flatten:!0}))if(r(n)){const t=n;if(Object(i.a)(t,e))return t}return null}function a(t){return{addClass:e=>{t.classList.add(e)},removeClass:e=>{t.classList.remove(e)},hasClass:e=>t.classList.contains(e)}}let s=!1;const c=()=>{},l={get passive(){return s=!0,!1}};document.addEventListener(\"x\",c,l),document.removeEventListener(\"x\",c);const d=(t=window.document)=>{let e=t.activeElement;const n=[];if(!e)return n;for(;e&&(n.push(e),e.shadowRoot);)e=e.shadowRoot.activeElement;return n},u=t=>{const e=d();if(!e.length)return!1;const n=e[e.length-1],i=new Event(\"check-if-focused\",{bubbles:!0,composed:!0});let r=[];const o=t=>{r=t.composedPath()};return document.body.addEventListener(\"check-if-focused\",o),n.dispatchEvent(i),document.body.removeEventListener(\"check-if-focused\",o),-1!==r.indexOf(t)}},function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return a}));var i=n(9);\n/**\n * @license\n * Copyright (c) 2018 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */class r{constructor(t){this.classes=new Set,this.changed=!1,this.element=t;const e=(t.getAttribute(\"class\")||\"\").split(/\\s+/);for(const t of e)this.classes.add(t)}add(t){this.classes.add(t),this.changed=!0}remove(t){this.classes.delete(t),this.changed=!0}commit(){if(this.changed){let t=\"\";this.classes.forEach(e=>t+=e+\" \"),this.element.setAttribute(\"class\",t)}}}const o=new WeakMap,a=Object(i.f)(t=>e=>{if(!(e instanceof i.a)||e instanceof i.e||\"class\"!==e.committer.name||e.committer.parts.length>1)throw new Error(\"The `classMap` directive must be used in the `class` attribute and must be the only part in the attribute.\");const{committer:n}=e,{element:a}=n;let s=o.get(e);void 0===s&&(a.setAttribute(\"class\",n.strings.join(\" \")),o.set(e,s=new Set));const c=a.classList||new r(a);s.forEach(e=>{e in t||(c.remove(e),s.delete(e))});for(const e in t){const n=t[e];n!=s.has(e)&&(n?(c.add(e),s.add(e)):(c.remove(e),s.delete(e)))}\"function\"==typeof c.commit&&c.commit()})},function(t,e){t.exports=function(){throw new Error(\"define cannot be used indirect\")}},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"Icon\",(function(){return a}));var i=n(1),r=n(0);\n/**\n@license\nCopyright 2018 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\nconst o=r.b`:host{font-family:var(--mdc-icon-font, \"Material Icons\");font-weight:normal;font-style:normal;font-size:var(--mdc-icon-size, 24px);line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;font-feature-settings:\"liga\"}`;\n/**\n@license\nCopyright 2018 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/let a=class extends r.a{render(){return r.e`<slot></slot>`}};a.styles=o,a=Object(i.__decorate)([Object(r.c)(\"mwc-icon\")],a)},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.GroupService=e.FacetingMethod=void 0;const i=n(1),r=i.__importStar(n(21)),o=n(4);n(5);const a=n(8),s=n(25);var c;n(54),function(t){t.DISCRETE=\"discrete\",t.EQUAL_INTERVAL=\"equal-interval\",t.QUANTILE=\"quantile\",t.THRESHOLD=\"threshold\"}(c=e.FacetingMethod||(e.FacetingMethod={}));class l extends s.LitService{constructor(t){super(),this.appState=t}get categoricalFeatureNames(){const t=this.appState.currentDatasetSpec;return(0,a.findSpecKeys)(t,\"CategoryLabel\")}get numericalFeatureNames(){const t=this.appState.currentDatasetSpec;return(0,a.findSpecKeys)(t,\"Scalar\")}get booleanFeatureNames(){const t=this.appState.currentDatasetSpec;return(0,a.findSpecKeys)(t,\"Boolean\")}get denseFeatureNames(){return[...this.categoricalFeatureNames,...this.numericalFeatureNames,...this.booleanFeatureNames]}get categoricalFeatures(){const t={};for(const e of this.categoricalFeatureNames){const n=this.appState.currentDatasetSpec[e].vocab;if(null!=n)t[e]=[...n];else{const n=new Set(this.appState.currentInputData.map(t=>t.data[e]));t[e]=[...n]}}return t}get numericalFeatureRanges(){const t={};return this.numericalFeatureNames.forEach(e=>{const n=this.appState.currentInputData.map(t=>t.data[e]),i=Math.min(...n),r=Math.max(...n);t[e]=[i,r]}),t}numericBinKey(t,e,n){return`[${t}, ${e}${n?\"]\":\")\"}`}numericBinRange(t,e,n){return[t,e+(n?1e-6:0)]}freedmanDiaconisBins(t){const e=this.numericalFeatureRanges[t][0],n=this.numericalFeatureRanges[t][1],i=this.appState.currentInputData.map(e=>e.data[t]);let o=r.thresholdFreedmanDiaconis(i,e,n);0!==o&&isFinite(o)||(o=10);const s=r.histogram().domain([e,n]).thresholds(o)(i),c={};for(const t of s){const e=t.x1===n,i=(0,a.roundToDecimalPlaces)(t.x0,3),r=(0,a.roundToDecimalPlaces)(t.x1,3);if(null==i||null==r)continue;const o=this.numericBinRange(i,r,e);c[this.numericBinKey(i,r,e)]=o}return c}discreteBins(t){const e={},[n,i]=this.numericalFeatureRanges[t],{step:r}=this.appState.currentDatasetSpec[t];if(\"number\"!=typeof r)throw new Error(`Unable to generate discrete bins; '${t}' step is not defined`);for(let t=n;t<i;t+=r){const n=t+r;e[this.numericBinKey(t,n,n===i)]=[t,n]}return e}equalIntervalBins(t,e){const n={},i=this.numericalFeatureRanges[t][0],r=(this.numericalFeatureRanges[t][1]-i)/e;for(let t=0;t<e;t++){const o=(0,a.roundToDecimalPlaces)(i+r*t,3),s=(0,a.roundToDecimalPlaces)(i+r*(t+1),3),c=this.numericBinRange(o,s,t===e-1);n[this.numericBinKey(o,s,t===e-1)]=c}return n}quantileBins(t,e){const n={},i=this.appState.currentInputData.map(e=>e.data[t]).sort();e=Math.min(e,i.length);const r=i.length/e;for(let t=0;t<e;t++){const o=t===e-1,s=r*t,c=o?i.length-1:r*(t+1),l=(0,a.roundToDecimalPlaces)(i[s],3),d=(0,a.roundToDecimalPlaces)(i[c],3),u=this.numericBinRange(l,d,o);n[this.numericBinKey(l,d,o)]=u}return n}thresholdBins(t,e){const[n,i]=this.numericalFeatureRanges[t],[r,o]=[n,i].map(t=>(0,a.roundToDecimalPlaces)(t,3)),s=(0,a.roundToDecimalPlaces)(e,3);return{[this.numericBinKey(r,s,!1)]:[n,e-1e-6],[this.numericBinKey(s,o,!0)]:[e,i+1e-6]}}facetConfigsToKey(t){const e=t.sort((t,e)=>t.featureName<e.featureName?-1:t.featureName>e.featureName?1:0);return JSON.stringify(e)}validateFacetingConfig(t){const{featureName:e,method:n,numBins:i,threshold:r}=t,o=null==n||n===c.DISCRETE,a=n===c.EQUAL_INTERVAL,s=n===c.QUANTILE&&\"number\"==typeof i&&i>0,l=n===c.THRESHOLD&&\"number\"==typeof r,d=o||a||s||l;if(!d){const n=JSON.stringify(t);throw new Error(`Invalid faceting config for '${e}': ${n}`)}return d}validateFacetingConfigs(t){return t.filter(this.validateFacetingConfig)}numericalFeatureBins(t){const e={},n=t.filter(t=>this.numericalFeatureNames.includes(t.featureName));for(const t of n){const{featureName:n,method:i,numBins:r,threshold:o}=t;i===c.EQUAL_INTERVAL?e[n]=null==r||r<1?this.freedmanDiaconisBins(n):this.equalIntervalBins(n,r):i===c.QUANTILE?e[n]=this.quantileBins(n,r||4):i===c.THRESHOLD&&null!=o?e[n]=this.thresholdBins(n,o):e[n]=this.discreteBins(n)}return e}getNumericalBinForExample(t,e,n){const i=e.data[n];for(const e of Object.values(t[n])){const[t,n]=e;if(t<=i&&i<n)return e}return null}numIntersectionsLabel(t,e){const n=e.map(e=>this.categoricalFeatureNames.includes(e)?this.categoricalFeatures[e].length:this.numericalFeatureNames.includes(e)?Object.keys(t[e]).length:this.booleanFeatureNames.includes(e)?2:0),i=n.reduce((t,e)=>t*e);return n.length>1?`${n.join(\"x\")} = ${i}`:n[0].toString()}groupExamplesByFeatures(t,e,n,i=((t,e,n,i)=>this.getFeatureValForInput(t,e,i))){const r={};for(let o=0;o<e.length;o++){const s=e[o],c={};for(const e of n){const n=i(t,s,o,e);if(null!=n)if(Array.isArray(n)){const i=Object.values(t[e]).indexOf(n),r=Object.keys(t[e])[i];c[e]={val:n,displayVal:r}}else c[e]={val:n,displayVal:n.toString()}}const l=(0,a.facetMapToDictKey)(c);r.hasOwnProperty(l)||(r[l]={displayName:l,data:[],facets:c}),r[l].data.push(s)}return r}getFeatureValForInput(t,e,n){if(n in e.data){return this.numericalFeatureNames.includes(n)?this.getNumericalBinForExample(t,e,n):e.data[n]}return null}}i.__decorate([o.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],l.prototype,\"categoricalFeatureNames\",null),i.__decorate([o.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],l.prototype,\"numericalFeatureNames\",null),i.__decorate([o.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],l.prototype,\"booleanFeatureNames\",null),i.__decorate([o.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],l.prototype,\"denseFeatureNames\",null),i.__decorate([o.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],l.prototype,\"categoricalFeatures\",null),i.__decorate([o.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],l.prototype,\"numericalFeatureRanges\",null),e.GroupService=l},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.DIVERGING_6=e.DIVERGING_5=e.MULTIHUE_CONTINUOUS=e.DIVERGING_4=e.MAGE_CONTINUOUS=e.MAGE_DISCRETE=e.CYEA_CONTINUOUS=e.CYEA_DISCRETE=e.CONTINUOUS_UNSIGNED=e.CONTINUOUS_UNSIGNED_LAB=e.CONTINUOUS_SIGNED_LAB=e.labVizColors=e.labBrandColors=e.CONTINUOUS_SIGNED=e.BINARY_POS_NEG=e.CATEGORICAL_NORMAL=e.LOADING=e.HOVER=e.OTHER=e.DEFAULT=e.getVizColor=e.VIZ_COLORS=e.getErrorColor=e.ERROR_COLORS=e.getMinorTonalColor=e.MINOR_TONAL_COLORS=e.getMajorTonalColor=e.MAJOR_TONAL_COLORS=e.getBrandColor=e.BRAND_COLORS=e.ramp=void 0;const i=n(1).__importStar(n(21)),r=[\"50\",\"100\",\"200\",\"300\",\"400\",\"500\",\"600\",\"700\",\"800\",\"900\"],o=[\"1\",\"2\",\"3\",\"4\",\"5\"],a=[\"50\",\"500\",\"600\",\"700\"],s=[\"orange\",\"blue\",\"yellow\",\"purple\",\"coral\",\"teal\",\"magenta\",\"other\"];function c(t,e){return e=Math.trunc(e),(e%=t.length)<0&&(e+=t.length),t[e]}function l(t){return i.interpolateRgbBasis(t)}function d(t){return i.scaleLinear().domain(t.map((e,n)=>n/(t.length-1))).range(t).interpolate((t,e)=>i.interpolateLab(t.toString(),e.toString()))}function u(t,n){const r=[\"#ffffff\",...e.BRAND_COLORS[t].slice(1).map(t=>t.color)];if(n){const t=e.BRAND_COLORS[n].slice(1).map(t=>t.color);r.unshift(...t.reverse())}const o=d(r);return i.range(256).map(t=>o(t/256))}function h(t,n){const r=s.indexOf(t),o=[\"#ffffff\",...Object.values(e.VIZ_COLORS).map(t=>t[r].color)];if(n){const t=s.indexOf(n),i=Object.values(e.VIZ_COLORS).map(e=>e[t].color);o.unshift(...i.reverse())}const a=d(o);return i.range(256).map(t=>a(t/256))}e.ramp=l,e.BRAND_COLORS={cyea:[{color:\"#EDFFFA\",textColor:\"black\"},{color:\"#CDF2FA\",textColor:\"black\"},{color:\"#AFE6DE\",textColor:\"black\"},{color:\"#7BCCCC\",textColor:\"black\"},{color:\"#52A6B3\",textColor:\"black\"},{color:\"#348199\",textColor:\"white\"},{color:\"#1F6180\",textColor:\"white\"},{color:\"#114566\",textColor:\"white\"},{color:\"#092F4D\",textColor:\"white\"},{color:\"#041D33\",textColor:\"white\"}],mage:[{color:\"#FFF5F7\",textColor:\"black\"},{color:\"#FEEAEF\",textColor:\"black\"},{color:\"#FED5E0\",textColor:\"black\"},{color:\"#F9A9C0\",textColor:\"black\"},{color:\"#EF7CA1\",textColor:\"black\"},{color:\"#E25287\",textColor:\"white\"},{color:\"#CE2F75\",textColor:\"white\"},{color:\"#B7166A\",textColor:\"white\"},{color:\"#800060\",textColor:\"white\"},{color:\"#470046\",textColor:\"white\"}],bric:[{color:\"#FDF8EA\",textColor:\"black\"},{color:\"#F9F1DC\",textColor:\"black\"},{color:\"#EFD9AB\",textColor:\"black\"},{color:\"#E4BC78\",textColor:\"black\"},{color:\"#D59441\",textColor:\"black\"},{color:\"#C26412\",textColor:\"white\"},{color:\"#A93D00\",textColor:\"white\"},{color:\"#8B2100\",textColor:\"white\"},{color:\"#6A0C00\",textColor:\"white\"},{color:\"#470000\",textColor:\"white\"}],neutral:[{color:\"#F8F9FA\",textColor:\"black\"},{color:\"#F1F3F4\",textColor:\"black\"},{color:\"#E8EAED\",textColor:\"black\"},{color:\"#DADCE0\",textColor:\"black\"},{color:\"#BDC1C6\",textColor:\"black\"},{color:\"#9AA0A6\",textColor:\"white\"},{color:\"#80868B\",textColor:\"white\"},{color:\"#5F6368\",textColor:\"white\"},{color:\"#3C4043\",textColor:\"white\"},{color:\"#202124\",textColor:\"white\"}]},e.getBrandColor=function(t,n){return c(e.BRAND_COLORS[t],\"number\"==typeof n?n:r.indexOf(n))},e.MAJOR_TONAL_COLORS={primary:[{color:\"#EEFBF8\",textColor:\"black\"},{color:\"#D8F2ED\",textColor:\"black\"},{color:\"#C0E7E3\",textColor:\"black\"},{color:\"#A1D2D4\",textColor:\"black\"},{color:\"#72AEB9\",textColor:\"black\"},{color:\"#48879C\",textColor:\"white\"},{color:\"#326882\",textColor:\"white\"},{color:\"#284E67\",textColor:\"white\"},{color:\"#1D3649\",textColor:\"white\"},{color:\"#142838\",textColor:\"white\"}],secondary:[{color:\"#FFF5F7\",textColor:\"black\"},{color:\"#FAEDF0\",textColor:\"black\"},{color:\"#F7DBE4\",textColor:\"black\"},{color:\"#EDBDCD\",textColor:\"black\"},{color:\"#E091AC\",textColor:\"black\"},{color:\"#CC6990\",textColor:\"white\"},{color:\"#BE4079\",textColor:\"white\"},{color:\"#9D2D69\",textColor:\"white\"},{color:\"#651A54\",textColor:\"white\"},{color:\"#3B0A3C\",textColor:\"white\"}],tertiary:[{color:\"#FCF8EF\",textColor:\"black\"},{color:\"#F9F7ED\",textColor:\"black\"},{color:\"#EDDEBF\",textColor:\"black\"},{color:\"#E0C9A2\",textColor:\"black\"},{color:\"#CEA269\",textColor:\"black\"},{color:\"#B6763E\",textColor:\"white\"},{color:\"#A14C1C\",textColor:\"white\"},{color:\"#7E351F\",textColor:\"white\"},{color:\"#58211B\",textColor:\"white\"},{color:\"#3B0A0B\",textColor:\"white\"}],\"neutral-variant\":[{color:\"#F0F7F7\",textColor:\"black\"},{color:\"#EBF3F2\",textColor:\"black\"},{color:\"#E3ECED\",textColor:\"black\"},{color:\"#CCD9DD\",textColor:\"black\"},{color:\"#B5C6CA\",textColor:\"black\"},{color:\"#9CAFB4\",textColor:\"white\"},{color:\"#72868F\",textColor:\"white\"},{color:\"#596C75\",textColor:\"white\"},{color:\"#3F5259\",textColor:\"white\"},{color:\"#222C35\",textColor:\"white\"}]},e.getMajorTonalColor=function(t,n){return c(e.MAJOR_TONAL_COLORS[t],\"number\"==typeof n?n:r.indexOf(n))},e.MINOR_TONAL_COLORS={primary:[{color:\"#F5F9FA\",textColor:\"black\"},{color:\"#EFF5F7\",textColor:\"black\"},{color:\"#E9F1F4\",textColor:\"black\"},{color:\"#E7F0F3\",textColor:\"black\"},{color:\"#E3EDF1\",textColor:\"black\"}],secondary:[{color:\"#F9F2F7\",textColor:\"black\"},{color:\"#F5EBF2\",textColor:\"black\"},{color:\"#F1E3EE\",textColor:\"black\"},{color:\"#F0E0EC\",textColor:\"black\"},{color:\"#EDDBE9\",textColor:\"black\"}],tertiary:[{color:\"#FAF4F3\",textColor:\"black\"},{color:\"#F6EDEB\",textColor:\"black\"},{color:\"#F2E7E3\",textColor:\"black\"},{color:\"#F3E4E1\",textColor:\"black\"},{color:\"#EFE0DB\",textColor:\"black\"}]},e.getMinorTonalColor=function(t,n){return c(e.MINOR_TONAL_COLORS[t],\"number\"==typeof n?n:o.indexOf(n))},e.ERROR_COLORS=[{color:\"#FCE8E6\",textColor:\"black\"},{color:\"#EA4335\",textColor:\"white\"},{color:\"#D93025\",textColor:\"white\"},{color:\"#C5221F\",textColor:\"white\"}],e.getErrorColor=function(t){const n=\"number\"==typeof t?t:a.indexOf(t);return c(e.ERROR_COLORS,n)},e.VIZ_COLORS={pastel:[{color:\"#ffd8c3\",textColor:\"black\"},{color:\"#87cdf9\",textColor:\"black\"},{color:\"#faf49f\",textColor:\"black\"},{color:\"#cdc5ff\",textColor:\"black\"},{color:\"#f6aea9\",textColor:\"black\"},{color:\"#bdf4e7\",textColor:\"black\"},{color:\"#edc4e6\",textColor:\"black\"},{color:\"#dadce0\",textColor:\"black\"}],bright:[{color:\"#f0bd80\",textColor:\"black\"},{color:\"#61aff7\",textColor:\"black\"},{color:\"#ffe839\",textColor:\"black\"},{color:\"#9b86ef\",textColor:\"black\"},{color:\"#ff777b\",textColor:\"black\"},{color:\"#7ddad3\",textColor:\"black\"},{color:\"#ef96cd\",textColor:\"black\"},{color:\"#b5bcc3\",textColor:\"black\"}],deep:[{color:\"#ff9230\",textColor:\"black\"},{color:\"#3c7dbf\",textColor:\"white\"},{color:\"#ffc700\",textColor:\"black\"},{color:\"#7647ea\",textColor:\"white\"},{color:\"#fc4f61\",textColor:\"white\"},{color:\"#1f978a\",textColor:\"white\"},{color:\"#b22a72\",textColor:\"white\"},{color:\"#879695\",textColor:\"white\"}],dark:[{color:\"#ba4a0d\",textColor:\"white\"},{color:\"#184889\",textColor:\"white\"},{color:\"#b48014\",textColor:\"white\"},{color:\"#270086\",textColor:\"white\"},{color:\"#b12d33\",textColor:\"white\"},{color:\"#006067\",textColor:\"white\"},{color:\"#632440\",textColor:\"white\"},{color:\"#515050\",textColor:\"white\"}]},e.getVizColor=function(t,n){const i=e.VIZ_COLORS[t];return\"number\"==typeof n&&n>-1?i[Math.trunc(n)%(i.length-1)]:c(i,s.indexOf(n))},e.DEFAULT=e.BRAND_COLORS.cyea[4].color,e.OTHER=e.VIZ_COLORS.deep[e.VIZ_COLORS.deep.length-1].color,e.HOVER=e.BRAND_COLORS.mage[4].color,e.LOADING=e.BRAND_COLORS.neutral[5].color,e.CATEGORICAL_NORMAL=e.VIZ_COLORS.deep.slice(0,-1).map(t=>t.color),e.BINARY_POS_NEG=[e.VIZ_COLORS.deep[1].color,e.VIZ_COLORS.deep[4].color],e.CONTINUOUS_SIGNED=l([e.VIZ_COLORS.dark[4].color,e.VIZ_COLORS.deep[4].color,e.VIZ_COLORS.bright[4].color,e.VIZ_COLORS.pastel[7].color,e.VIZ_COLORS.bright[5].color,e.VIZ_COLORS.deep[5].color,e.VIZ_COLORS.dark[5].color]),e.labBrandColors=u,e.labVizColors=h,e.CONTINUOUS_SIGNED_LAB=l(u(\"cyea\",\"mage\")),e.CONTINUOUS_UNSIGNED_LAB=l(h(\"purple\")),e.CONTINUOUS_UNSIGNED=l([e.VIZ_COLORS.pastel[3].color,e.VIZ_COLORS.bright[3].color,e.VIZ_COLORS.deep[3].color,e.VIZ_COLORS.dark[3].color]),e.CYEA_DISCRETE=[e.BRAND_COLORS.cyea[2].color,e.BRAND_COLORS.cyea[4].color,e.BRAND_COLORS.cyea[6].color],e.CYEA_CONTINUOUS=l(e.BRAND_COLORS.cyea.slice(2,9).map(t=>t.color)),e.MAGE_DISCRETE=[e.BRAND_COLORS.mage[2].color,e.BRAND_COLORS.mage[4].color,e.BRAND_COLORS.mage[6].color],e.MAGE_CONTINUOUS=l(e.BRAND_COLORS.mage.slice(2,9).map(t=>t.color)),e.DIVERGING_4=[e.BRAND_COLORS.bric[5].color,e.BRAND_COLORS.bric[3].color,e.BRAND_COLORS.cyea[3].color,e.BRAND_COLORS.cyea[5].color],e.MULTIHUE_CONTINUOUS=l([e.VIZ_COLORS.deep[3].color,e.VIZ_COLORS.deep[1].color,e.VIZ_COLORS.deep[5].color,e.VIZ_COLORS.deep[2].color]),e.DIVERGING_5=[e.BRAND_COLORS.bric[5].color,e.BRAND_COLORS.bric[3].color,e.BRAND_COLORS.neutral[2].color,e.BRAND_COLORS.cyea[3].color,e.BRAND_COLORS.cyea[5].color],e.DIVERGING_6=[e.BRAND_COLORS.bric[5].color,e.BRAND_COLORS.bric[3].color,e.BRAND_COLORS.bric[1].color,e.BRAND_COLORS.cyea[1].color,e.BRAND_COLORS.cyea[3].color,e.BRAND_COLORS.cyea[5].color]},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.ReactiveElement=void 0;const i=n(35),r=n(4);class o extends i.MobxLitElement{constructor(){super(...arguments),this.__allowInstanceProperties=!0,this.reactionDisposers=[]}disconnectedCallback(){super.disconnectedCallback(),this.reactionDisposers.forEach(t=>{t()})}react(t,e,n={}){const i=(0,r.reaction)(t,e,n);this.reactionDisposers.push(i)}reactImmediately(t,e,n={}){this.react(t,e,Object.assign(Object.assign({},n),{fireImmediately:!0}))}}e.ReactiveElement=o},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"MobxReactionUpdate\",(function(){return a})),n.d(e,\"MobxLitElement\",(function(){return c}));var i=n(4);const r=Symbol(\"LitMobxRenderReaction\"),o=Symbol(\"LitMobxRequestUpdate\");function a(t){var e,n;return n=class extends t{constructor(){super(...arguments),this[e]=()=>{this.requestUpdate()}}connectedCallback(){super.connectedCallback();const t=this.constructor.name||this.nodeName;this[r]=new i.Reaction(t+\".update()\",this[o]),this.hasUpdated&&this.requestUpdate()}disconnectedCallback(){super.disconnectedCallback(),this[r]&&(this[r].dispose(),this[r]=void 0)}update(t){this[r]?this[r].track(super.update.bind(this,t)):super.update(t)}},e=o,n}var s=n(3);class c extends(a(s.LitElement)){}},function(t,e,n){\"use strict\";n.d(e,\"b\",(function(){return r})),n.d(e,\"a\",(function(){return o}));var i=n(14);\n/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */function r(t){let e=o.get(t.type);void 0===e&&(e={stringsArray:new WeakMap,keyString:new Map},o.set(t.type,e));let n=e.stringsArray.get(t.strings);if(void 0!==n)return n;const r=t.strings.join(i.f);return n=e.keyString.get(r),void 0===n&&(n=new i.a(t,t.getTemplateElement()),e.keyString.set(r,n)),e.stringsArray.set(t.strings,n),n}const o=new Map},function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return a})),n.d(e,\"b\",(function(){return s}));var i=n(26),r=n(19),o=n(36);\n/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nconst a=new WeakMap,s=(t,e,n)=>{let s=a.get(e);void 0===s&&(Object(i.b)(e,e.firstChild),a.set(e,s=new r.e(Object.assign({templateFactory:o.b},n))),s.appendInto(e)),s.setValue(t),s.commit()}},function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return r})),n.d(e,\"b\",(function(){return o}));\n/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nconst i=new WeakMap,r=t=>(...e)=>{const n=t(...e);return i.set(n,!0),n},o=t=>\"function\"==typeof t&&i.has(t)},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.LitCheckbox=void 0;const i=n(1),r=n(193),o=n(2),a=n(2),s=n(3),c=n(13);let l=class extends s.LitElement{constructor(){super(...arguments),this.label=\"\",this.checked=!1,this.indeterminate=!1,this.disabled=!1,this.value=\"\"}static get styles(){return s.css`\n      :host {\n        outline: none;\n      }\n\n      .wrapper {\n        display: flex;\n        align-items: center;\n        font-size: 10pt;\n        height: 28px;\n        margin-left: -12px;\n      }\n\n      .wrapper.disabled {\n        opacity: 0.2;\n      }\n\n      lit-mwc-checkbox-internal {\n        transform: scale(0.7);\n        margin-right: -8px;\n      }\n    `}render(){const t=(0,c.classMap)({wrapper:!0,disabled:this.disabled});return s.html`\n      <div class=${t}>\n        <lit-mwc-checkbox-internal\n          ?checked=${this.checked}\n          ?indeterminate=${this.indeterminate}\n          ?disabled=${this.disabled}\n          value=${this.value}\n          @change=${t=>{this.checked=t.target.checked;const e=new Event(\"change\");this.dispatchEvent(e)}}\n        >\n        </lit-mwc-checkbox-internal>\n        ${this.label}\n      </div>\n    `}};i.__decorate([(0,o.property)({type:String}),i.__metadata(\"design:type\",Object)],l.prototype,\"label\",void 0),i.__decorate([(0,o.property)({type:Boolean}),i.__metadata(\"design:type\",Object)],l.prototype,\"checked\",void 0),i.__decorate([(0,o.property)({type:Boolean}),i.__metadata(\"design:type\",Object)],l.prototype,\"indeterminate\",void 0),i.__decorate([(0,o.property)({type:Boolean}),i.__metadata(\"design:type\",Object)],l.prototype,\"disabled\",void 0),i.__decorate([(0,o.property)({type:String}),i.__metadata(\"design:type\",Object)],l.prototype,\"value\",void 0),l=i.__decorate([(0,a.customElement)(\"lit-checkbox\")],l),e.LitCheckbox=l;class d extends r.Checkbox{constructor(){super(),this.__allowInstanceProperties=!0,Object.defineProperty(this,\"shouldRenderRipple\",{get:()=>!1,set:()=>{}})}}customElements.define(\"lit-mwc-checkbox-internal\",d)},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.DataTable=void 0;const i=n(1);n(31);const r=n(21),o=n(3),a=n(2),s=n(107),c=n(13),l=n(17),d=n(4),u=n(34),h=n(5),p=n(8),f=n(7),m=n(108);var g;!function(t){t[t.START=0]=\"START\",t[t.END=1]=\"END\"}(g||(g={}));let v=class extends u.ReactiveElement{constructor(){super(...arguments),this.data=[],this.columnNames=[],this.selectedIndices=[],this.primarySelectedIndex=-1,this.referenceSelectedIndex=-1,this.focusedIndex=-1,this.selectionEnabled=!1,this.searchEnabled=!1,this.paginationEnabled=!1,this.verticalAlignMiddle=!1,this.onSelect=()=>{},this.onPrimarySelect=()=>{},this.sortAscending=!0,this.showColumnMenu=!1,this.columnMenuName=\"\",this.columnSearchQueries=new Map,this.pageNum=0,this.entriesPerPage=10,this.stickySortedData=null,this.needsEntriesPerPageRecompute=!0,this.lastContainerHeight=0,this.selectedIndicesSetForRender=new Set,this.shiftSelectionStartIndex=0,this.shiftSelectionEndIndex=0,this.shiftSpanAnchor=g.START,this.hoveredIndex=null}static get styles(){return[f.styles,m.styles]}firstUpdated(){const t=this.shadowRoot.querySelector(\".holder\");this.resizeObserver=new ResizeObserver(()=>{this.adjustEntriesIfHeightChanged()}),this.resizeObserver.observe(t),this.reactImmediately(()=>[this.data,this.rowFilteredData],()=>{this.stickySortedData=null,this.needsEntriesPerPageRecompute=!0,this.pageNum=0,this.requestUpdate()});this.reactImmediately(()=>[this.sortName,this.sortAscending],()=>{this.stickySortedData=this.getSortedData(this.rowFilteredData),this.pageNum=0,this.requestUpdate()});this.reactImmediately(()=>this.totalPages,()=>{this.pageNum>=this.totalPages&&(this.pageNum=0)})}shouldUpdate(t){return t.get(\"data\")&&(this.shiftSelectionStartIndex=0,this.shiftSelectionEndIndex=0),!0}updated(){this.needsEntriesPerPageRecompute&&this.computeEntriesPerPage()}getContainerHeight(){return this.shadowRoot.querySelector(\".holder\").getBoundingClientRect().height}adjustEntriesIfHeightChanged(){const t=this.getContainerHeight();Math.abs(t-this.lastContainerHeight)>20&&(this.lastContainerHeight=t,this.computeEntriesPerPage())}computeEntriesPerPage(){if(this.needsEntriesPerPageRecompute=!1,!this.paginationEnabled)return void(this.entriesPerPage=this.rowFilteredData.length+1);const t=this.getContainerHeight(),e=this.shadowRoot.querySelector(\"thead\").getBoundingClientRect().height,n=this.shadowRoot.querySelector(\"tfoot\").getBoundingClientRect().height,i=Math.max(0,t-e-n),r=this.shadowRoot.querySelectorAll(\"tbody > tr\");let o=0,a=0;for(a=0;a<r.length;a++)if(o+=r[a].getBoundingClientRect().height,o>i){this.entriesPerPage=a+1;break}if(0===o)this.entriesPerPage=10;else if(o<=i){const t=o/a;this.entriesPerPage=Math.ceil(i/t)}this.entriesPerPage=10*Math.ceil(this.entriesPerPage/10)}getSortableEntry(t){return\"string\"==typeof t||(0,p.isNumber)(t)?t:(0,s.isTemplateResult)(t)?0:t.value}get sortIndex(){return null!=this.sortName?this.columnStrings.indexOf(this.sortName):void 0}shouldRightAlignColumn(t){const e=this.pageData.map(e=>e.rowData[t]);return e.filter(t=>(0,p.isNumber)(t)).length/e.length>.5}get columnStrings(){return this.columnNames.map(t=>\"string\"==typeof t?t:t.name)}get columnHeaders(){return this.columnNames.map((t,e)=>{var n,i;const r=\"string\"==typeof t?{name:t}:Object.assign({},t);return r.html=null!==(n=r.html)&&void 0!==n?n:o.html`<div class=\"header-text\">${r.name}</div>`,r.rightAlign=null!==(i=r.rightAlign)&&void 0!==i?i:this.shouldRightAlignColumn(e),r})}get indexedData(){return this.data.map(t=>t instanceof Array?t:this.columnStrings.map(e=>t[e])).map((t,e)=>({inputIndex:e,rowData:t}))}get rowFilteredData(){return this.indexedData.filter(t=>{let e=!0;for(const[n,i]of this.columnSearchQueries){const r=this.columnStrings.indexOf(n);if(-1===r)return;const o=t.rowData[r];\"string\"==typeof o?e=e&&-1!==o.search(new RegExp(i)):\"number\"==typeof o&&(e=!(!e||\"\"!==i)||o.toString()===i)}return e})}getSortedData(t){if(null!=this.sortName){const e=this.sortAscending?r.ascending:r.descending;return t.slice().sort((t,n)=>e(this.getSortableEntry(t.rowData[this.sortIndex]),this.getSortableEntry(n.rowData[this.sortIndex])))}return t}get displayData(){return null!=this.stickySortedData?this.stickySortedData:this.getSortedData(this.rowFilteredData)}get totalPages(){return Math.ceil(this.displayData.length/this.entriesPerPage)}get pageData(){const t=this.pageNum*this.entriesPerPage,e=t+this.entriesPerPage;return this.displayData.slice(t,e)}get hasFooter(){return this.displayData.length>this.entriesPerPage}setShiftSelectionSpan(t,e){this.shiftSelectionStartIndex=t,this.shiftSelectionEndIndex=e}isRowWithinShiftSelectionSpan(t){return t>=this.shiftSelectionStartIndex&&t<=this.shiftSelectionEndIndex}getInputIndexFromRowIndex(t){return this.displayData[t].inputIndex}selectFromRange(t,e,n,i=!0){for(let r=e;r<=n;r++){const e=this.getInputIndexFromRowIndex(r);if(null==e)return;i?t.add(e):(t.delete(e),e===this.primarySelectedIndex&&this.setPrimarySelectedIndex(-1))}}handleRowClick(t,e,n){let i=new Set(this.selectedIndices),r=!0;if(null==this.onClick){if(t.metaKey||t.ctrlKey)i.has(e)?(i.delete(e),e===this.primarySelectedIndex&&this.setPrimarySelectedIndex(-1)):i.add(e),this.setShiftSelectionSpan(n,n);else if(t.shiftKey){t.preventDefault();const e=this.isRowWithinShiftSelectionSpan(n),r=this.shiftSelectionStartIndex,o=this.shiftSelectionEndIndex;e?this.shiftSpanAnchor===g.START?(this.selectFromRange(i,n+1,o,!1),this.shiftSelectionEndIndex=n):(this.selectFromRange(i,r,n-1,!1),this.shiftSelectionStartIndex=n):n>=o?(this.selectFromRange(i,o,n),this.setShiftSelectionSpan(r,n),this.shiftSpanAnchor=g.START):n<=r&&(this.selectFromRange(i,n,r),this.setShiftSelectionSpan(n,o),this.shiftSpanAnchor=g.END)}else i.has(e)&&1===i.size?(i=new Set,this.setPrimarySelectedIndex(-1)):i.has(e)&&e!==this.primarySelectedIndex?(this.setPrimarySelectedIndex(n),r=!1):(i=new Set([e]),this.setPrimarySelectedIndex(n)),this.setShiftSelectionSpan(n,n);r&&(this.selectedIndices=Array.from(i),this.onSelect([...this.selectedIndices]))}else this.onClick(e)}handleRowMouseEnter(t,e){this.hoveredIndex=e,null==this.onHover||this.onHover(this.hoveredIndex)}handleRowMouseLeave(t,e){e===this.hoveredIndex&&(this.hoveredIndex=null),null==this.onHover||this.onHover(this.hoveredIndex)}setPrimarySelectedIndex(t){let e=-1;if(-1!==t){const n=this.getInputIndexFromRowIndex(t);if(null==n)return;e=n}this.primarySelectedIndex=e,this.onPrimarySelect(e)}get isDefaultView(){return void 0===this.sortName&&0===this.columnSearchQueries.size}resetView(){this.columnSearchQueries.clear(),this.sortName=void 0,this.showColumnMenu=!1,this.stickySortedData=null,this.requestUpdate()}getVisibleDataIdxs(){return this.displayData.map(t=>t.inputIndex)}render(){return this.selectedIndicesSetForRender=new Set(this.selectedIndices),o.html`\n      <div class=\"holder\">\n        <table>\n          <thead>\n            ${this.columnHeaders.map(t=>this.renderColumnHeader(t))}\n          </thead>\n          <tbody>\n            ${this.pageData.map((t,e)=>this.renderRow(t,e))}\n          </tbody>\n          <tfoot>\n            ${this.renderFooter()}\n          </tfoot>\n        </table>\n      </div>\n    `}renderFooter(){if(!this.hasFooter)return null;const t=this.pageNum+1,e=t=>(t%this.totalPages+this.totalPages)%this.totalPages,n={\"icon-button\":!0,disabled:0===this.pageNum},i={\"icon-button\":!0,disabled:this.pageNum===this.totalPages-1};return o.html`\n      <tr>\n        <td colspan=${this.columnNames.length}>\n          <div class=\"footer\">\n            <mwc-icon class=${(0,c.classMap)(n)}\n              @click=${()=>{this.pageNum=0}}>\n              first_page\n            </mwc-icon>\n            <mwc-icon class='icon-button'\n              @click=${()=>{const t=e(this.pageNum-1);this.pageNum=t}}>\n              chevron_left\n            </mwc-icon>\n            <div>\n             Page\n             <span class=\"current-page-num\">${t}</span>\n             of ${this.totalPages}\n            </div>\n            <mwc-icon class='icon-button'\n               @click=${()=>{const t=e(this.pageNum+1);this.pageNum=t}}>\n              chevron_right\n            </mwc-icon>\n            <mwc-icon class=${(0,c.classMap)(i)}\n              @click=${()=>{this.pageNum=this.totalPages-1}}>\n              last_page\n            </mwc-icon>\n            <mwc-icon class='icon-button mdi-outlined button-extra-margin'\n              @click=${()=>{const t=(0,p.randInt)(0,this.totalPages);this.pageNum=t}}>\n              casino\n            </mwc-icon>\n          </div>\n        </td>\n      </tr>`}renderColumnHeader(t){var e;const n=t.name,i=t=>{t.stopPropagation(),this.sortName!==n?(this.sortName=n,this.sortAscending=!0):this.sortAscending?this.sortAscending=!1:this.sortName=void 0},r=null!==(e=this.columnSearchQueries.get(n))&&void 0!==e?e:\"\",a=(0,l.styleMap)({visibility:this.showColumnMenu&&this.columnMenuName===n?\"visible\":\"hidden\"}),s=(0,l.styleMap)({outline:(()=>!!(this.columnSearchQueries.get(n)||this.showColumnMenu&&this.columnMenuName===n))()?\"auto\":\"none\"}),d=this.sortName===n&&this.sortAscending,u=this.sortName===n&&!this.sortAscending,h=this.sortName===n&&!this.sortAscending,p=this.sortName===n&&this.sortAscending,f=(0,c.classMap)({arrow:!0,up:!0,active:d,inactive:u}),m=(0,c.classMap)({arrow:!0,down:!0,active:h,inactive:p}),g=(0,c.classMap)({\"column-header\":!0,\"right-align\":t.rightAlign});return o.html`\n        <th id=${n} @click=${t=>{this.resetView()}}>\n          <div class=${g} title=${n}>\n            <div class=\"header-holder\">\n              <div @click=${i}>${t.html}</div>\n              ${this.searchEnabled?o.html`\n                <div class=\"menu-button-container\">\n                  <mwc-icon class=\"menu-button\" style=${s}\n                   @click=${t=>{t.stopPropagation(),this.columnMenuName===n?this.showColumnMenu=!this.showColumnMenu:(this.columnMenuName=n,this.showColumnMenu=!0),this.showColumnMenu&&window.requestAnimationFrame(()=>{this.shadowRoot.querySelector(`th#${n} .togglable-menu-holder input`).focus()})}}>search</mwc-icon>\n                </div>`:null}\n              <div class=\"arrow-container\" @click=${i}>\n                <mwc-icon class=${f}>arrow_drop_up</mwc-icon>\n                <mwc-icon class=${m}>arrow_drop_down</mwc-icon>\n              </div>\n            </div>\n          </div>\n          ${this.searchEnabled?o.html`\n            <div class='togglable-menu-holder' style=${a}>\n                <input type=\"search\" class='search-input'\n                .value=${r}\n                placeholder=\"Search\" @input=${t=>{var e;this.columnSearchQueries.set(n,(null===(e=t.target)||void 0===e?void 0:e.value)||\"\")}}/>\n            </div>`:null}\n        </th>\n      `}renderRow(t,e){const n=t.inputIndex,i=e+this.pageNum*this.entriesPerPage,r=this.selectedIndicesSetForRender.has(n),a=this.primarySelectedIndex===n,d=this.referenceSelectedIndex===n,u=this.focusedIndex===n,p=(0,c.classMap)({selected:r,\"primary-selected\":a,\"reference-selected\":d,focused:u}),f=this.columnHeaders.map(t=>(0,c.classMap)({\"cell-holder\":!0,\"right-align\":t.rightAlign})),m=(0,l.styleMap)({verticalAlign:this.verticalAlignMiddle?\"middle\":\"top\"});return o.html`\n      <tr class=\"${p}\" @mousedown=${t=>{this.selectionEnabled&&this.handleRowClick(t,n,i)}} @mouseenter=${t=>{this.handleRowMouseEnter(t,n)}}\n        @mouseleave=${t=>{this.handleRowMouseLeave(t,n)}}>\n        ${t.rowData.map((t,e)=>o.html`<td style=${m}><div class=${f[e]}>${(t=>{if(null==t)return null;if(\"string\"==typeof t&&t.startsWith(\"data:image\"))return o.html`<img class='table-img' src=${t.toString()}>`;if((0,s.isTemplateResult)(t)||t.constructor===Object){const e=(0,s.isTemplateResult)(t)?t:t.template;return o.html`${e}`}return o.html`\n          <div class=\"text-cell\">${(0,h.formatForDisplay)(t,void 0,!0)}</div>`})(t)}</div></td>`)}\n      </tr>\n    `}};i.__decorate([d.observable.struct,(0,a.property)({type:Array}),i.__metadata(\"design:type\",Array)],v.prototype,\"data\",void 0),i.__decorate([d.observable.struct,(0,a.property)({type:Array}),i.__metadata(\"design:type\",Array)],v.prototype,\"columnNames\",void 0),i.__decorate([d.observable.struct,(0,a.property)({type:Array}),i.__metadata(\"design:type\",Array)],v.prototype,\"selectedIndices\",void 0),i.__decorate([d.observable,(0,a.property)({type:Number}),i.__metadata(\"design:type\",Number)],v.prototype,\"primarySelectedIndex\",void 0),i.__decorate([d.observable,(0,a.property)({type:Number}),i.__metadata(\"design:type\",Number)],v.prototype,\"referenceSelectedIndex\",void 0),i.__decorate([d.observable,(0,a.property)({type:Number}),i.__metadata(\"design:type\",Number)],v.prototype,\"focusedIndex\",void 0),i.__decorate([d.observable,(0,a.property)({type:Boolean}),i.__metadata(\"design:type\",Boolean)],v.prototype,\"selectionEnabled\",void 0),i.__decorate([d.observable,(0,a.property)({type:Boolean}),i.__metadata(\"design:type\",Boolean)],v.prototype,\"searchEnabled\",void 0),i.__decorate([d.observable,(0,a.property)({type:Boolean}),i.__metadata(\"design:type\",Boolean)],v.prototype,\"paginationEnabled\",void 0),i.__decorate([(0,a.property)({type:Boolean}),i.__metadata(\"design:type\",Boolean)],v.prototype,\"verticalAlignMiddle\",void 0),i.__decorate([(0,a.property)({type:Object}),i.__metadata(\"design:type\",Object)],v.prototype,\"onClick\",void 0),i.__decorate([(0,a.property)({type:Object}),i.__metadata(\"design:type\",Object)],v.prototype,\"onHover\",void 0),i.__decorate([(0,a.property)({type:Object}),i.__metadata(\"design:type\",Function)],v.prototype,\"onSelect\",void 0),i.__decorate([(0,a.property)({type:Object}),i.__metadata(\"design:type\",Function)],v.prototype,\"onPrimarySelect\",void 0),i.__decorate([d.observable,(0,a.property)({type:String}),i.__metadata(\"design:type\",String)],v.prototype,\"sortName\",void 0),i.__decorate([d.observable,(0,a.property)({type:Boolean}),i.__metadata(\"design:type\",Object)],v.prototype,\"sortAscending\",void 0),i.__decorate([d.observable,i.__metadata(\"design:type\",Object)],v.prototype,\"showColumnMenu\",void 0),i.__decorate([d.observable,i.__metadata(\"design:type\",Object)],v.prototype,\"columnMenuName\",void 0),i.__decorate([d.observable,i.__metadata(\"design:type\",Object)],v.prototype,\"columnSearchQueries\",void 0),i.__decorate([d.observable,i.__metadata(\"design:type\",Object)],v.prototype,\"pageNum\",void 0),i.__decorate([d.observable,i.__metadata(\"design:type\",Object)],v.prototype,\"entriesPerPage\",void 0),i.__decorate([d.observable,i.__metadata(\"design:type\",Object)],v.prototype,\"stickySortedData\",void 0),i.__decorate([d.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],v.prototype,\"sortIndex\",null),i.__decorate([d.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],v.prototype,\"columnStrings\",null),i.__decorate([d.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],v.prototype,\"columnHeaders\",null),i.__decorate([d.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],v.prototype,\"indexedData\",null),i.__decorate([d.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],v.prototype,\"rowFilteredData\",null),i.__decorate([d.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],v.prototype,\"displayData\",null),i.__decorate([d.computed,i.__metadata(\"design:type\",Number),i.__metadata(\"design:paramtypes\",[])],v.prototype,\"totalPages\",null),i.__decorate([d.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],v.prototype,\"pageData\",null),i.__decorate([d.computed,i.__metadata(\"design:type\",Boolean),i.__metadata(\"design:paramtypes\",[])],v.prototype,\"hasFooter\",null),i.__decorate([d.action,i.__metadata(\"design:type\",Function),i.__metadata(\"design:paramtypes\",[MouseEvent,Number,Number]),i.__metadata(\"design:returntype\",void 0)],v.prototype,\"handleRowClick\",null),i.__decorate([d.action,i.__metadata(\"design:type\",Function),i.__metadata(\"design:paramtypes\",[Number]),i.__metadata(\"design:returntype\",void 0)],v.prototype,\"setPrimarySelectedIndex\",null),i.__decorate([d.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],v.prototype,\"isDefaultView\",null),v=i.__decorate([(0,a.customElement)(\"lit-data-table\")],v),e.DataTable=v},function(t,e,n){\"use strict\";n.d(e,\"b\",(function(){return s})),n.d(e,\"a\",(function(){return c}));var i=n(26),r=n(14);\n/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nconst o=window.trustedTypes&&trustedTypes.createPolicy(\"lit-html\",{createHTML:t=>t}),a=` ${r.f} `;class s{constructor(t,e,n,i){this.strings=t,this.values=e,this.type=n,this.processor=i}getHTML(){const t=this.strings.length-1;let e=\"\",n=!1;for(let i=0;i<t;i++){const t=this.strings[i],o=t.lastIndexOf(\"\\x3c!--\");n=(o>-1||n)&&-1===t.indexOf(\"--\\x3e\",o+1);const s=r.e.exec(t);e+=null===s?t+(n?a:r.g):t.substr(0,s.index)+s[1]+s[2]+r.b+s[3]+r.f}return e+=this.strings[t],e}getTemplateElement(){const t=document.createElement(\"template\");let e=this.getHTML();return void 0!==o&&(e=o.createHTML(e)),t.innerHTML=e,t}}class c extends s{getHTML(){return`<svg>${super.getHTML()}</svg>`}getTemplateElement(){const t=super.getTemplateElement(),e=t.content,n=e.firstChild;return e.removeChild(n),Object(i.c)(e,n.firstChild),t}}},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.SpinnerComponent=void 0;const i=n(1),r=n(2),o=n(2),a=n(3),s=n(17),c=(t,e)=>`solid ${t}px ${e}`;let l=class extends a.LitElement{constructor(){super(...arguments),this.size=16,this.color=\"\"}static get styles(){return[a.css`\n        #spinner {\n          margin-left: 10px;\n          border-radius: 50%;\n          width: 16px;\n          height: 16px;\n          animation: spin 2s linear infinite;\n        }\n\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      `]}render(){const t=this.size+\"px\",e=this.size/8,n=\"\"===this.color?\"var(--app-primary-color)\":this.color,i=c(e,n),r=c(e,\"rgba(0,0,0,0)\"),o=(0,s.styleMap)({height:t,width:t,border:i,borderTop:r});return a.html`\n      <div id=\"spinner\" style=${o}></div>\n    `}};i.__decorate([(0,r.property)({type:Number}),i.__metadata(\"design:type\",Object)],l.prototype,\"size\",void 0),i.__decorate([(0,r.property)({type:String}),i.__metadata(\"design:type\",Object)],l.prototype,\"color\",void 0),l=i.__decorate([(0,o.customElement)(\"lit-spinner\")],l),e.SpinnerComponent=l},function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return o}));var i=n(26),r=n(14);\n/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nclass o{constructor(t,e,n){this.__parts=[],this.template=t,this.processor=e,this.options=n}update(t){let e=0;for(const n of this.__parts)void 0!==n&&n.setValue(t[e]),e++;for(const t of this.__parts)void 0!==t&&t.commit()}_clone(){const t=i.a?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),e=[],n=this.template.parts,o=document.createTreeWalker(t,133,null,!1);let a,s=0,c=0,l=o.nextNode();for(;s<n.length;)if(a=n[s],Object(r.d)(a)){for(;c<a.index;)c++,\"TEMPLATE\"===l.nodeName&&(e.push(l),o.currentNode=l.content),null===(l=o.nextNode())&&(o.currentNode=e.pop(),l=o.nextNode());if(\"node\"===a.type){const t=this.processor.handleTextExpression(this.options);t.insertAfterNode(l.previousSibling),this.__parts.push(t)}else this.__parts.push(...this.processor.handleAttributeExpressions(l,a.name,a.strings,this.options));s++}else this.__parts.push(void 0),s++;return i.a&&(document.adoptNode(t),customElements.upgrade(t)),t}}},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.ClassificationService=e.getPredictionClass=void 0;const i=n(1),r=i.__importStar(n(21)),o=n(4);n(5);const a=n(8),s=n(33),c=n(25);n(11);const l=n(32),d=new Map([[\"predictions\",\"predictions\"],[\"predictedClassIdx\",\"predicted class index\"],[\"predictionCorrect\",\"prediction correct\"]]);function u(t,e,n,i,r,o){var a;let s=0;if(null!=(null==o?void 0:o[e])){const t=function(t,e,n){if(\"\"in e)return e[\"\"];for(const i of Object.values(e)){let e=!0;for(const r of Object.keys(i.facetData.facets))if(null!=n&&n.numericalFeatureNames.includes(r)){const o={featureName:r,method:l.FacetingMethod.EQUAL_INTERVAL,numBins:0},a=n.numericalFeatureBins([o]),s=n.getNumericalBinForExample(a,t,r),c=i.facetData.facets[r].val;if(s[0]!==c[0]||s[1]!==c[1]){e=!1;break}}else if(t.data[r]!==i.facetData.facets[r].val){e=!1;break}if(e)return i}return null}(i,o[e],r);null!=t&&(s=o[e][(null===(a=t.facetData)||void 0===a?void 0:a.displayName)||\"\"].margin)}const c=n[e].null_idx;let d=-1/0,u=0;for(let e=0;e<t.length;e++){let n=Math.log(t[e]);c===e&&(n+=s),d<n&&(d=n,u=e)}return u}e.getPredictionClass=u;class h extends c.LitService{constructor(t,e,n){super(),this.apiService=t,this.appState=e,this.groupService=n,this.classificationInfo={},this.marginSettings={},this.labelNames={},(0,o.reaction)(()=>this.allMarginSettings,t=>{this.updateClassifications()}),(0,o.reaction)(()=>e.currentModels,t=>{this.reset()})}get allMarginSettings(){const t=[];for(const e of Object.values(this.marginSettings))for(const n of Object.values(e))for(const e of Object.values(n))t.push(e.margin);return t}setMarginGroups(t,e,n){null==this.marginSettings[t]&&(this.marginSettings[t]={}),this.marginSettings[t][e]={};for(const i of Object.values(n))this.marginSettings[t][e][i.displayName]={facetData:i,margin:0}}setMargin(t,e,n,i){if(console.log(\"setMargin\"),null==this.marginSettings[t]&&(this.marginSettings[t]={}),null==this.marginSettings[t][e]&&(this.marginSettings[t][e]={}),null==i)if(\"\"in this.marginSettings[t][e])this.marginSettings[t][e][\"\"]={facetData:i,margin:n};else for(const i of Object.keys(this.marginSettings[t][e]))this.marginSettings[t][e][i].margin=n;else this.marginSettings[t][e][i.displayName]={facetData:i,margin:n}}getMargin(t,e,n){return null==this.marginSettings[t]||null==this.marginSettings[t][e]?0:null==n?null==this.marginSettings[t][e][\"\"]?0:this.marginSettings[t][e][\"\"].margin:null==this.marginSettings[t][e][n.displayName]?0:this.marginSettings[t][e][n.displayName].margin}getClassificationPreds(t,e,n){return i.__awaiter(this,void 0,void 0,(function*(){const i=this.apiService.getPreds(t,e,n,[\"MulticlassPreds\"]),r=yield i;return null!=r&&r.length>0&&this.processNewPreds(t,e,r),i}))}getLabelNames(t,e){return this.labelNames[`${t}:${e}`]}getInfoFields(){return Array.from(d.keys())}getDisplayNames(){return Array.from(d.values())}updateClassifications(){for(const t of this.appState.currentInputData){const e=this.classificationInfo[t.id];if(null==e)continue;const n=Object.keys(e);for(const i of n){const n=Object.keys(e[i]);for(const r of n){const n=e[i][r];this.updateClassification(n,t,r,i)}}}}updateClassification(t,e,n,i){const r=this.appState.currentModelSpecs[i].spec.output;t.predictedClassIdx=u(t.predictions,n,r,e,this.groupService,this.marginSettings[i]);const o=`${i}:${n}`;null==this.labelNames[o]&&(this.labelNames[o]=r[n].vocab||Array.from({length:t.predictions.length},(t,e)=>\"\"+e));const a=r[n].parent;null!=a&&(t.predictionCorrect=e.data[a]===this.labelNames[o][t.predictedClassIdx])}reset(){this.classificationInfo={}}getResults(t,e,n){return i.__awaiter(this,void 0,void 0,(function*(){const i=[];t.forEach(r=>{var o,a;null==(null===(a=null===(o=this.classificationInfo[t[0]])||void 0===o?void 0:o[e])||void 0===a?void 0:a[n])&&i.push(r)}),i.length>0&&(yield this.getClassificationPreds(this.appState.getExamplesById(i),e,this.appState.currentDataset));const r=[];return t.forEach(t=>{var i,o;const a=null===(o=null===(i=this.classificationInfo[t])||void 0===i?void 0:i[e])||void 0===o?void 0:o[n];null!=a&&r.push(a)}),r}))}processNewPreds(t,e,n){const i=this.appState.currentModelSpecs[e].spec.output,r=(0,a.findSpecKeys)(i,\"MulticlassPreds\"),o=Object.keys(n[0]);for(let i=0;i<n.length;i++){const a=t[i],s=n[i];null==this.classificationInfo[a.id]&&(this.classificationInfo[a.id]={}),null==this.classificationInfo[a.id][e]&&(this.classificationInfo[a.id][e]={});for(let t=0;t<o.length;t++){const n=o[t];if(!r.includes(n))continue;const i={};i.predictions=s[n],this.updateClassification(i,a,n,e),null==this.classificationInfo[a.id][e][n]&&(this.classificationInfo[a.id][e][n]=i)}}}get colorOptions(){const t=Object.keys(this.classificationInfo);if(0===t.length)return[];const e=[],n=this.classificationInfo[t[0]],i=Object.keys(n);for(const t of i){const i=Object.keys(n[t]);for(const o of i)e.push({name:`${t}:${o} class`,getValue:e=>this.labelNames[`${t}:${o}`][this.classificationInfo[e.id][t][o].predictedClassIdx],scale:r.scaleOrdinal(s.CATEGORICAL_NORMAL).domain(this.labelNames[`${t}:${o}`])}),null!=n[t][o].predictionCorrect&&e.push({name:`${t}:${o} correct`,getValue:e=>this.classificationInfo[e.id][t][o].predictionCorrect?\"correct\":\"incorrect\",scale:r.scaleOrdinal(s.BINARY_POS_NEG).domain([\"correct\",\"incorrect\"])})}return e}}i.__decorate([o.observable,i.__metadata(\"design:type\",Object)],h.prototype,\"classificationInfo\",void 0),i.__decorate([o.observable,i.__metadata(\"design:type\",Object)],h.prototype,\"marginSettings\",void 0),i.__decorate([o.observable,i.__metadata(\"design:type\",Object)],h.prototype,\"labelNames\",void 0),i.__decorate([o.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],h.prototype,\"allMarginSettings\",null),i.__decorate([o.action,i.__metadata(\"design:type\",Function),i.__metadata(\"design:paramtypes\",[String,String,Object]),i.__metadata(\"design:returntype\",void 0)],h.prototype,\"setMarginGroups\",null),i.__decorate([o.action,i.__metadata(\"design:type\",Function),i.__metadata(\"design:paramtypes\",[String,String,Number,Object]),i.__metadata(\"design:returntype\",void 0)],h.prototype,\"setMargin\",null),i.__decorate([o.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],h.prototype,\"colorOptions\",null),e.ClassificationService=h},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(6);function r(t,e){return void 0===e&&(e=!0),t.needsUpdate=e,t.minFilter=i.LinearFilter,t.generateMipmaps=!1,t.flipY=!1,t}e.vector3DToScreenCoords=function(t,e,n,r){var o=window.devicePixelRatio,a=(new i.Vector3).copy(r).project(t);return[(a.x+1)/2*e*o,-(a.y-1)/2*n*o]},e.vector3FromPackedArray=function(t,e){var n=3*e;return new i.Vector3(t[n],t[n+1],t[n+2])},e.getNearFarPoints=function(t,e,n){for(var r=1/0,o=0,a=(new i.Vector3).copy(n).sub(e),s=(new i.Vector3).copy(a).normalize(),c=t.length/3,l=0,d=new i.Vector3,u=new i.Vector3,h=0;h<c;h++){d.x=t[l],d.y=t[l+1],d.z=t[l+2],l+=3,u.copy(d).sub(e);var p=s.dot(u);p<0||(o=p>o?p:o,r=p<r?p:r)}return[r,o]},e.createTextureFromCanvas=function(t){return r(new i.Texture(t))},e.createTextureFromImage=function(t,e){var n=new i.Texture(t);return t.complete?(n.needsUpdate=!0,e()):t.onload=function(){n.needsUpdate=!0,e()},r(n,!1)},e.hasWebGLSupport=function(){try{var t=document.createElement(\"canvas\");return null!=(t.getContext(\"webgl\")||t.getContext(\"experimental-webgl\"))}catch(t){return!1}},e.extent=function(t){for(var e=1/0,n=-1/0,i=0;i<t.length;i++){var r=t[i];r<e&&(e=r),r>n&&(n=r)}return[e,n]},e.scaleLinear=function(t,e,n){var i=e[1]-e[0],r=n[1]-n[0];return(t-e[0])/i*r+n[0]},e.scaleExponential=function(t,e,n){var i=Math.pow(e[1],Math.E)-Math.pow(e[0],Math.E),r=n[1]-n[0];return(Math.pow(t,Math.E)-e[0])/i*r+n[0]},e.packRgbIntoUint8Array=function(t,e,n,i,r){t[3*e]=n,t[3*e+1]=i,t[3*e+2]=r},e.styleRgbFromHexColor=function(t){var e=new i.Color(t);return[255*e.r|0,255*e.g|0,255*e.b|0]};var o=function(t){return 100*t+\"%\"};e.getDefaultPointInPolylineColor=function(t,e,n,r,a,s){var c=\"hsl(\"+(n+(r-n)*t/e)+\", \"+o(a)+\", \"+o(s)+\")\";return new i.Color(c)}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,\"loaded\",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,\"id\",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){(function(e){t.exports=e}).call(this,{})},function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return a})),n.d(e,\"b\",(function(){return y})),n.d(e,\"c\",(function(){return g})),n.d(e,\"d\",(function(){return l})),n.d(e,\"e\",(function(){return h})),n.d(e,\"f\",(function(){return c})),n.d(e,\"g\",(function(){return o})),n.d(e,\"h\",(function(){return d})),n.d(e,\"i\",(function(){return s})),n.d(e,\"j\",(function(){return v})),n.d(e,\"k\",(function(){return p})),n.d(e,\"l\",(function(){return m}));var i=n(22);\n/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const{H:r}=i.a,o=t=>null===t||\"object\"!=typeof t&&\"function\"!=typeof t,a={HTML:1,SVG:2},s=(t,e)=>void 0===e?void 0!==(null==t?void 0:t._$litType$):(null==t?void 0:t._$litType$)===e,c=t=>void 0!==(null==t?void 0:t._$litDirective$),l=t=>null==t?void 0:t._$litDirective$,d=t=>void 0===t.strings,u=()=>document.createComment(\"\"),h=(t,e,n)=>{var i;const o=t._$AA.parentNode,a=void 0===e?t._$AB:e._$AA;if(void 0===n){const e=o.insertBefore(u(),a),i=o.insertBefore(u(),a);n=new r(e,i,t,t.options)}else{const e=n._$AB.nextSibling,r=n._$AM,s=r!==t;if(s){let e;null===(i=n._$AQ)||void 0===i||i.call(n,t),n._$AM=t,void 0!==n._$AP&&(e=t._$AU)!==r._$AU&&n._$AP(e)}if(e!==a||s){let t=n._$AA;for(;t!==e;){const e=t.nextSibling;o.insertBefore(t,a),t=e}}}return n},p=(t,e,n=t)=>(t._$AI(e,n),t),f={},m=(t,e=f)=>t._$AH=e,g=t=>t._$AH,v=t=>{var e;null===(e=t._$AP)||void 0===e||e.call(t,!1,!0);let n=t._$AA;const i=t._$AB.nextSibling;for(;n!==i;){const t=n.nextSibling;n.remove(),n=t}},y=t=>{t._$AR()}},function(t,e,n){\"use strict\";\n/**\n * @license\n * Copyright 2019 Google Inc.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nfunction i(t){return void 0===t&&(t=window),!!function(t){void 0===t&&(t=window);var e=!1;try{var n={get passive(){return e=!0,!1}},i=function(){};t.document.addEventListener(\"test\",i,n),t.document.removeEventListener(\"test\",i,n)}catch(t){e=!1}return e}(t)&&{passive:!0}}n.d(e,\"a\",(function(){return m}));var r=n(61),o=n(64),a=n(62),s=n(9);\n/**\n@license\nCopyright 2018 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\nconst c=n(0).b`@keyframes mdc-ripple-fg-radius-in{from{animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transform:translate(var(--mdc-ripple-fg-translate-start, 0)) scale(1)}to{transform:translate(var(--mdc-ripple-fg-translate-end, 0)) scale(var(--mdc-ripple-fg-scale, 1))}}@keyframes mdc-ripple-fg-opacity-in{from{animation-timing-function:linear;opacity:0}to{opacity:var(--mdc-ripple-fg-opacity, 0)}}@keyframes mdc-ripple-fg-opacity-out{from{animation-timing-function:linear;opacity:var(--mdc-ripple-fg-opacity, 0)}to{opacity:0}}`,l=Object(a.b)(window);\n/**\n@license\nCopyright 2018 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/class d{constructor(t){this.foundation=t}startPress(){this.foundation.activate()}endPress(){this.foundation.deactivate()}startFocus(){this.foundation.handleFocus()}endFocus(){this.foundation.handleBlur()}destroy(){this.foundation.destroy()}setUnbounded(t){this.foundation.setUnbounded(t)}}const u=navigator.userAgent.match(/Safari/);let h=!1;const p=t=>{u&&!h&&(()=>{h=!0;const t=document.createElement(\"style\"),e=new s.d({templateFactory:s.i});e.appendInto(t),e.setValue(c),e.commit(),document.head.appendChild(t)})();const e=t.surfaceNode,n=t.interactionNode||e;n.getRootNode()!==e.getRootNode()&&\"\"===n.style.position&&(n.style.position=\"relative\");const a={browserSupportsCssVars:()=>l,isUnbounded:()=>void 0===t.unbounded||t.unbounded,isSurfaceActive:()=>Object(r.a)(n,\":active\"),isSurfaceDisabled:()=>Boolean(n.hasAttribute(\"disabled\")),addClass:t=>e.classList.add(t),removeClass:t=>e.classList.remove(t),containsEventTarget:t=>n.contains(t),registerInteractionHandler:(t,e)=>n.addEventListener(t,e,i()),deregisterInteractionHandler:(t,e)=>n.removeEventListener(t,e,i()),registerDocumentInteractionHandler:(t,e)=>document.documentElement.addEventListener(t,e,i()),deregisterDocumentInteractionHandler:(t,e)=>document.documentElement.removeEventListener(t,e,i()),registerResizeHandler:t=>window.addEventListener(\"resize\",t),deregisterResizeHandler:t=>window.removeEventListener(\"resize\",t),updateCssVariable:(t,n)=>e.style.setProperty(t,n),computeBoundingRect:()=>e.getBoundingClientRect(),getWindowPageOffset:()=>({x:window.pageXOffset,y:window.pageYOffset})},p=new o.a(a);return p.init(),new d(p)},f=new WeakMap,m=Object(s.f)((t={})=>e=>{const n=e.committer.element,i=t.interactionNode||n;let r=e.value;const o=f.get(r);void 0!==o&&o!==i&&(r.destroy(),r=s.h),r===s.h?(r=p(Object.assign({},t,{surfaceNode:n})),f.set(r,i),e.setValue(r)):(void 0!==t.unbounded&&r.setUnbounded(t.unbounded),void 0!==t.disabled&&r.setUnbounded(t.disabled)),!0===t.active?r.startPress():!1===t.active&&r.endPress()})},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.ModulesService=e.getModuleConstructor=void 0;const i=n(1),r=n(4);n(5);const o=n(25);function a(t){if(\"string\"==typeof t){const e=window.customElements.get(t);if(void 0===e)throw new Error(`Malformed layout; unable to find element '${t}'`);return e}return t}n(51),e.getModuleConstructor=a;class s extends o.LitService{constructor(){super(...arguments),this.declaredLayout={upper:{},lower:{},layoutSettings:{},description:\"\"},this.selectedTabUpper=\"\",this.selectedTabLower=\"\",this.renderLayout={upper:{},lower:{}},this.renderModulesCallback=()=>{},this.hiddenModuleKeys=new Set,this.allModuleKeys=new Set}setRenderModulesCallback(t){this.renderModulesCallback=t}renderModules(){this.renderModulesCallback()}initializeLayout(t,e,n,i){this.declaredLayout=t,this.updateRenderLayout(e,n,i)}clearLayout(){this.updateRenderLayout({},{},!1),this.renderModules()}quickUpdateLayout(t,e,n){this.updateRenderLayout(t,e,n),this.renderModules()}setHiddenModules(t){const e=new Set(t);this.hiddenModuleKeys=e}setUrlConfiguration(t){var e,n;this.setHiddenModules(t.hiddenModules),this.selectedTabUpper=null!==(e=t.selectedTabUpper)&&void 0!==e?e:\"\",this.selectedTabLower=null!==(n=t.selectedTabLower)&&void 0!==n?n:\"\"}isModuleGroupHidden(t){return this.hiddenModuleKeys.has(t.key)}toggleHiddenModule(t,e){e?this.hiddenModuleKeys.add(t.key):this.hiddenModuleKeys.delete(t.key)}getRenderLayout(){return this.renderLayout}getSetting(t){var e,n;return null===(n=null===(e=this.declaredLayout)||void 0===e?void 0:e.layoutSettings)||void 0===n?void 0:n[t]}computeTabGroupLayout(t,e,n,i){const r={};for(const o of Object.keys(t)){const s=t[o].map(a),c=this.getRenderConfigs(s,e,n,i,o);0!==c.length&&(r[o]=c)}return r}updateRenderLayout(t,e,n){const i={upper:this.computeTabGroupLayout(this.declaredLayout.upper,t,e,n),lower:this.computeTabGroupLayout(this.declaredLayout.lower,t,e,n)};this.updateModuleKeys(i),this.renderLayout=i}updateModuleKeys(t){const e=new Set;for(const n of[t.upper,t.lower])for(const t of Object.keys(n))for(const i of n[t])for(const t of i)e.add(t.key),t.moduleType.collapseByDefault&&this.hiddenModuleKeys.add(t.key);for(const t of[...this.hiddenModuleKeys])e.has(t)||this.hiddenModuleKeys.delete(t);this.allModuleKeys=e}getRenderConfigs(t,e,n,i,r){const o=[];for(const a of t){if(!a.shouldDisplayModule(e,n))continue;const t=[],s=i&&a.duplicateForExampleComparison,c=`${r}_${a.title}`;let l=[void 0];a.duplicateForModelComparison&&(l=Object.keys(e));for(const e of l)s?(t.push(this.makeRenderConfig(c,a,e,1)),t.push(this.makeRenderConfig(c,a,e,0))):t.push(this.makeRenderConfig(c,a,e,i?0:void 0));o.push(t)}return o}makeRenderConfig(t,e,n,i){return{key:t,moduleType:e,modelName:n,selectionServiceIndex:i}}}i.__decorate([r.observable,i.__metadata(\"design:type\",Object)],s.prototype,\"declaredLayout\",void 0),i.__decorate([r.observable,i.__metadata(\"design:type\",String)],s.prototype,\"selectedTabUpper\",void 0),i.__decorate([r.observable,i.__metadata(\"design:type\",String)],s.prototype,\"selectedTabLower\",void 0),i.__decorate([r.observable,i.__metadata(\"design:type\",Object)],s.prototype,\"renderLayout\",void 0),i.__decorate([r.observable,i.__metadata(\"design:type\",Object)],s.prototype,\"hiddenModuleKeys\",void 0),i.__decorate([r.action,i.__metadata(\"design:type\",Function),i.__metadata(\"design:paramtypes\",[]),i.__metadata(\"design:returntype\",void 0)],s.prototype,\"clearLayout\",null),i.__decorate([r.action,i.__metadata(\"design:type\",Function),i.__metadata(\"design:paramtypes\",[Object,Object,Boolean]),i.__metadata(\"design:returntype\",void 0)],s.prototype,\"quickUpdateLayout\",null),e.ModulesService=s},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.UrlService=e.UrlConfiguration=void 0;const i=n(1),r=n(4),o=n(5),a=n(8),s=n(25);class c{constructor(){this.selectedModels=[],this.selectedData=[],this.dataFields={},this.hiddenModules=[]}}e.UrlConfiguration=c;const l=t=>{const e=t.split(/_([^]*)/,2),n=e[0].replace(\"data\",\"\");return{fieldKey:e[1],dataIndex:+(n||\"0\")}};class d extends s.LitService{urlParseArray(t){if(null==t)return[];return t.split(\",\").filter(t=>\"\"!==t)}urlParseString(t){return t||void 0}urlParseBoolean(t){return\"true\"===t}parseDataFieldValue(t,e,n){var i;const r=n[t];return(0,a.isLitSubtype)(r,o.listFieldTypes)?this.urlParseArray(e):null!==(i=this.urlParseString(e))&&void 0!==i?i:(0,o.defaultValueByField)(t,n)}getConfigurationFromUrl(){const t=new c,e=new URLSearchParams(window.location.search);for(const[n,i]of e)if(\"models\"===n)t.selectedModels=this.urlParseArray(i);else if(\"selection\"===n)t.selectedData=this.urlParseArray(i);else if(\"primary\"===n)t.primarySelectedData=this.urlParseString(i);else if(\"dataset\"===n)t.selectedDataset=this.urlParseString(i);else if(\"hidden_modules\"===n)t.hiddenModules=this.urlParseArray(i);else if(\"compare_data_mode\"===n)t.compareExamplesEnabled=this.urlParseBoolean(i);else if(\"upper_tab\"===n)t.selectedTabUpper=this.urlParseString(i);else if(\"tab\"===n)t.selectedTabLower=this.urlParseString(i);else if(\"layout\"===n)t.layoutName=this.urlParseString(i);else if(\"new_dataset_path\"===n)t.newDatasetPath=this.urlParseString(i);else if(n.startsWith(\"data\")){const{fieldKey:e,dataIndex:r}=l(n);r in t.dataFields||(t.dataFields[r]={}),e in t.dataFields[r]&&console.log(`Warning, data index ${r} is set more than once.`),t.dataFields[r][e]=i}return t}setUrlParam(t,e,n){const i=n instanceof Array?n.join(\",\"):n;\"\"!==i&&null!=i&&t.set(e,i)}setDataFieldURLParams(t,e,n){const i=n.getCurrentInputDataById(e);null!==i&&i.meta.added&&Object.keys(i.data).forEach(e=>{this.setUrlParam(t,(t=>\"data_\"+t)(e),i.data[e])})}syncStateToUrl(t,e,n){const i=this.getConfigurationFromUrl();t.setUrlConfiguration(i),n.setUrlConfiguration(i);const o=i.selectedData||[];e.selectIds(o,this),e.selectedIds.length>0&&i.compareExamplesEnabled&&(t.compareExamplesEnabled=!0),(0,r.autorun)(()=>{const i=new URLSearchParams;if(this.setUrlParam(i,\"models\",t.currentModels),e.selectedIds.length<=100){this.setUrlParam(i,\"selection\",e.selectedIds);const n=e.primarySelectedId;null!=n&&(this.setUrlParam(i,\"primary\",n),this.setDataFieldURLParams(i,n,t))}if(this.setUrlParam(i,\"dataset\",t.currentDataset),this.setUrlParam(i,\"compare_data_mode\",t.compareExamplesEnabled?\"true\":\"false\"),this.setUrlParam(i,\"hidden_modules\",[...n.hiddenModuleKeys]),this.setUrlParam(i,\"layout\",t.layoutName),this.setUrlParam(i,\"upper_tab\",n.selectedTabUpper),this.setUrlParam(i,\"tab\",n.selectedTabLower),\"\"!==i.toString()){const t=`${window.location.pathname}?${i.toString()}`;window.history.replaceState({},\"\",t)}})}syncSelectedDatapointToUrl(t,e){return i.__awaiter(this,void 0,void 0,(function*(){const n=t.getUrlConfiguration(),i=n.dataFields,r=Object.values(i).map(e=>{const n={},i=t.currentDatasetSpec;Object.keys(i).forEach(t=>{n[t]=this.parseDataFieldValue(t,e[t],i)});return{data:n,id:\"\",meta:{source:\"url\",added:!0}}});if(r.length>0){const n=yield t.annotateNewData(r);t.commitNewDatapoints(n),e.selectIds(n.map(t=>t.id),this)}else{const t=n.primarySelectedData;void 0!==t&&e.setPrimarySelection(t,this)}}))}}e.UrlService=d},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.ColorService=e.SignedSalienceCmap=e.UnsignedSalienceCmap=e.SalienceCmap=void 0;const i=n(1),r=i.__importStar(n(21)),o=n(4);n(5);const a=n(33);n(44),n(32);const s=n(25);n(55),n(54);class c{constructor(t=1,e=[0,1]){this.gamma=t,this.domain=e,this.colorScale=r.scaleSequential(a.CONTINUOUS_UNSIGNED_LAB).domain(e)}textCmap(t){return this.lightness(t)<.5?\"black\":\"white\"}clamp(t){const[e,n]=this.colorScale.domain();return Math.max(e,Math.min(n,t))}lightness(t){return t=Math.abs(this.clamp(t)),1-(t=Math.pow(1-t,this.gamma))}}e.SalienceCmap=c;e.UnsignedSalienceCmap=class extends c{bgCmap(t){return this.colorScale(this.lightness(t))}};e.SignedSalienceCmap=class extends c{constructor(t=1,e=[-1,1]){super(t,e),this.colorScale=r.scaleSequential(a.CONTINUOUS_SIGNED_LAB).domain(e)}bgCmap(t){const e=t<0?-1:1;return this.colorScale(this.lightness(t)*e)}};class l extends s.LitService{constructor(t,e,n,i){super(),this.appState=t,this.groupService=e,this.classificationService=n,this.regressionService=i,this.defaultColor=a.DEFAULT,this.defaultOption={name:\"None\",getValue:t=>\"all\",scale:r.scaleOrdinal([this.defaultColor]).domain([\"all\"])},this.selectedColorOption=this.defaultOption,(0,o.reaction)(()=>this.appState.currentModels,t=>{this.reset()})}get all(){return[this.selectedColorOption,this.classificationService.allMarginSettings]}get colorableOptions(){return[...this.groupService.categoricalFeatureNames.map(t=>{const e=this.groupService.categoricalFeatures[t],n=e.length>1?a.CATEGORICAL_NORMAL:[a.DEFAULT];return{name:t,getValue:e=>e.data[t],scale:r.scaleOrdinal(n).domain(e)}}),...this.groupService.numericalFeatureNames.map(t=>{const e=this.groupService.numericalFeatureRanges[t];return{name:t,getValue:e=>e.data[t],scale:r.scaleSequential(a.MULTIHUE_CONTINUOUS).domain(e)}}),...this.classificationService.colorOptions,...this.regressionService.colorOptions,this.defaultOption]}getDatapointColor(t){if(null==this.selectedColorOption||null==t)return this.defaultColor;const e=this.selectedColorOption.getValue(t);return this.selectedColorOption.scale(e)||this.defaultColor}reset(){this.selectedColorOption=this.defaultOption}}i.__decorate([o.observable,i.__metadata(\"design:type\",Object)],l.prototype,\"selectedColorOption\",void 0),i.__decorate([o.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],l.prototype,\"all\",null),i.__decorate([o.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],l.prototype,\"colorableOptions\",null),e.ColorService=l},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.SliceService=e.STARRED_SLICE_NAME=void 0;const i=n(1),r=n(4);n(5);const o=n(8),a=n(25);n(11),e.STARRED_SLICE_NAME=\"Starred\";class s extends a.LitService{constructor(t,n){super(),this.selectionService=t,this.appState=n,this.namedSlices=new Map([[e.STARRED_SLICE_NAME,new Set]]),this.selectedSliceNameInternal=null,(0,r.reaction)(()=>t.selectedInputData,t=>{null!=this.selectedSliceName&&this.namedSlices.has(this.selectedSliceName)&&!(0,o.arrayContainsSame)(t.map(t=>t.id),this.getSliceByName(this.selectedSliceName))&&this.setSelectedSliceName(null)})}setSelectedSliceName(t){this.selectedSliceNameInternal=t}get selectedSliceName(){return this.selectedSliceNameInternal}selectNamedSlice(t,e){if(null===t)return this.setSelectedSliceName(t),void this.selectionService.selectIds([],e);const n=this.getSliceByName(t);null!==n&&(this.selectionService.selectIds(n,e),this.setSelectedSliceName(t))}addNamedSlice(t,e){this.namedSlices.set(t,new Set(e))}addIdsToSlice(t,e){const n=this.namedSlices.get(t);null!=n&&e.forEach(t=>{n.add(t)})}addOrAppendToSlice(t,e){this.namedSlices.has(t)?this.addIdsToSlice(t,e):this.addNamedSlice(t,e)}removeIdsFromSlice(t,e){const n=this.namedSlices.get(t);null!=n&&e.forEach(t=>{n.delete(t)})}deleteNamedSlice(t){this.namedSlices.delete(t)}get sliceNames(){return[...this.namedSlices.keys()]}getSliceByName(t){const e=this.namedSlices.get(t);return e?[...e]:null}getSliceDataByName(t){const e=this.getSliceByName(t);return this.appState.getExamplesById(e)}isInSlice(t,e){const n=this.namedSlices.get(t);return!!n&&n.has(e)}isSliceEmpty(t){const e=this.getSliceByName(t);return null==e||0===e.length}areAllSlicesEmpty(){for(const t of this.sliceNames)if(!this.isSliceEmpty(t))return!1;return!0}}i.__decorate([r.observable,i.__metadata(\"design:type\",Object)],s.prototype,\"namedSlices\",void 0),i.__decorate([r.observable,i.__metadata(\"design:type\",Object)],s.prototype,\"selectedSliceNameInternal\",void 0),i.__decorate([r.action,i.__metadata(\"design:type\",Function),i.__metadata(\"design:paramtypes\",[Object]),i.__metadata(\"design:returntype\",void 0)],s.prototype,\"setSelectedSliceName\",null),i.__decorate([r.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],s.prototype,\"selectedSliceName\",null),i.__decorate([r.action,i.__metadata(\"design:type\",Function),i.__metadata(\"design:paramtypes\",[Object,Object]),i.__metadata(\"design:returntype\",void 0)],s.prototype,\"selectNamedSlice\",null),i.__decorate([r.action,i.__metadata(\"design:type\",Function),i.__metadata(\"design:paramtypes\",[String,Array]),i.__metadata(\"design:returntype\",void 0)],s.prototype,\"addNamedSlice\",null),i.__decorate([r.action,i.__metadata(\"design:type\",Function),i.__metadata(\"design:paramtypes\",[String,Array]),i.__metadata(\"design:returntype\",void 0)],s.prototype,\"addIdsToSlice\",null),i.__decorate([r.action,i.__metadata(\"design:type\",Function),i.__metadata(\"design:paramtypes\",[String,Array]),i.__metadata(\"design:returntype\",void 0)],s.prototype,\"addOrAppendToSlice\",null),i.__decorate([r.action,i.__metadata(\"design:type\",Function),i.__metadata(\"design:paramtypes\",[String,Array]),i.__metadata(\"design:returntype\",void 0)],s.prototype,\"removeIdsFromSlice\",null),i.__decorate([r.action,i.__metadata(\"design:type\",Function),i.__metadata(\"design:paramtypes\",[String]),i.__metadata(\"design:returntype\",void 0)],s.prototype,\"deleteNamedSlice\",null),i.__decorate([r.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],s.prototype,\"sliceNames\",null),e.SliceService=s},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.AppState=void 0;const i=n(1),r=n(4),o=n(5),a=n(8);n(66);const s=n(25);n(11),n(51);class c extends s.LitService{constructor(t,e){super(),this.apiService=t,this.statusService=e,this.initialized=!1,this.currentModels=[],this.compareExamplesEnabled=!1,this.layouts={},this.currentDatasetInternal=\"\",this.inputData=new Map}get layout(){return this.layouts[this.layoutName]}get currentDataset(){return this.currentDatasetInternal}setCurrentDataset(t,e=!1){this.currentDatasetInternal=t,!this.currentInputDataIsLoaded&&e&&this.loadData()}get currentDatasetSpec(){return this.metadata.datasets[this.currentDataset].spec}get datasetHasImages(){return(0,a.findSpecKeys)(this.currentDatasetSpec,\"ImageBytes\").length>0}makeEmptyInputs(){return new Map}get currentInputDataById(){if(!this.currentDataset)return this.makeEmptyInputs();const t=this.inputData.get(this.currentDataset);return t||this.makeEmptyInputs()}get currentInputData(){return[...this.currentInputDataById.values()]}get currentInputDataIsLoaded(){return this.currentInputData.length>0}get currentModelRequiredInputSpecKeys(){const t=new Set;return Object.values(this.currentModelSpecs).forEach(e=>{Object.keys(e.spec.input).forEach(n=>{!0===e.spec.input[n].required&&t.add(n)})}),[...t]}get currentInputDataKeys(){return Object.keys(this.currentDatasetSpec)}get indicesById(){const t=new Map;return this.currentInputData.forEach((e,n)=>{t.set(e.id,n)}),t}getIndexById(t){if(null==t)return-1;const e=this.indicesById.get(t);return null!=e?e:-1}getCurrentInputDataById(t){const e=this.currentInputDataById.get(t);return e||null}getExamplesById(t){const e=[];return t.forEach(t=>{const n=this.currentInputDataById.get(t);n?e.push(n):console.error(`input key ${n} was not found in the currently loaded dataset.`)}),e}getAncestry(t){var e;const n=[];for(;t;)n.push(t),t=null===(e=this.getCurrentInputDataById(t))||void 0===e?void 0:e.meta.parentId;return n}setCurrentModels(t){return i.__awaiter(this,void 0,void 0,(function*(){this.currentModels=t}))}get currentModelSpecs(){const t=this.metadata.models,e={};return Object.keys(t).forEach(n=>{this.currentModels.includes(n)&&(e[n]=t[n])}),e}getModelSpec(t){return this.metadata.models[t].spec}getSpecKeysFromFieldMatcher(t,e){let n=this.currentDatasetSpec;return\"output\"===t.spec?n=this.currentModelSpecs[e].spec.output:\"input\"===t.spec&&(n=this.currentModelSpecs[e].spec.input),(0,a.findSpecKeys)(n,t.types)}annotateNewData(t){return i.__awaiter(this,void 0,void 0,(function*(){return this.apiService.annotateNewData(t,this.currentDataset)}))}commitNewDatapoints(t){t.forEach(t=>{this.currentInputDataById.has(t.id)?console.log(\"Attempted to add existing datapoint, ignoring add request.\",t):this.currentInputDataById.set(t.id,t)})}addLayouts(t){for(const e of Object.keys(t))this.layouts[e]=(0,o.canonicalizeLayout)(t[e])}initialize(){return i.__awaiter(this,void 0,void 0,(function*(){const{urlConfiguration:t}=this;console.log(\"[LIT - url configuration]\",t);const e=yield this.apiService.getInfo();console.log(\"[LIT - metadata]\",(0,r.toJS)(e)),this.metadata=e,this.addLayouts(this.metadata.layouts),this.layoutName=t.layoutName||this.metadata.defaultLayout,this.currentModels=this.determineCurrentModelsFromUrl(t),this.setCurrentDataset(yield this.determineCurrentDatasetFromUrl(t),!1),yield this.loadData(),this.initialized=!0}))}loadData(){return i.__awaiter(this,void 0,void 0,(function*(){if(!this.currentDataset)return;const t=yield this.apiService.getDataset(this.currentDataset);this.updateInputData(this.currentDataset,t)}))}updateInputData(t,e){const n=new Map;e.forEach(t=>{n.set(t.id,t)}),this.inputData.set(t,n)}determineCurrentModelsFromUrl(t){var e;const n=t.selectedModels,i=Object.keys((null===(e=this.metadata)||void 0===e?void 0:e.models)||{});let r=[];return n.length>0&&(r=n.filter(t=>i.includes(t))),r.length>0?r:i.slice(0,1)}determineCurrentDatasetFromUrl(t){var e,n;return i.__awaiter(this,void 0,void 0,(function*(){const i=t.selectedDataset||\"\",r=t.newDatasetPath,o=new Set;for(const t of this.currentModels){const i=(null===(n=null===(e=this.metadata)||void 0===e?void 0:e.models)||void 0===n?void 0:n[t].datasets)||[];for(const t of i)o.add(t)}if(o.has(i)){let t;return r&&(t=yield this.createNewDataset(i,r),t)?t:i}return 0===o.size?(this.statusService.addError(\"No dataset available for loaded models.\"),\"\"):[...o][0]}))}createNewDataset(t,e){return i.__awaiter(this,void 0,void 0,(function*(){try{const n=yield this.apiService.createDataset(t,e);return this.metadata=n[0],n[1]}catch(t){return void this.statusService.addError(`Could not load dataset from\\n        ${e}. See console for more details.`)}}))}setUrlConfiguration(t){this.urlConfiguration=Object.assign({},t)}getUrlConfiguration(){return this.urlConfiguration}}i.__decorate([r.observable,i.__metadata(\"design:type\",Object)],c.prototype,\"initialized\",void 0),i.__decorate([r.observable,i.__metadata(\"design:type\",Object)],c.prototype,\"metadata\",void 0),i.__decorate([r.observable,i.__metadata(\"design:type\",Array)],c.prototype,\"currentModels\",void 0),i.__decorate([r.observable,i.__metadata(\"design:type\",Boolean)],c.prototype,\"compareExamplesEnabled\",void 0),i.__decorate([r.observable,i.__metadata(\"design:type\",String)],c.prototype,\"layoutName\",void 0),i.__decorate([r.observable,i.__metadata(\"design:type\",Object)],c.prototype,\"layouts\",void 0),i.__decorate([r.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],c.prototype,\"layout\",null),i.__decorate([r.observable,i.__metadata(\"design:type\",String)],c.prototype,\"currentDatasetInternal\",void 0),i.__decorate([r.computed,i.__metadata(\"design:type\",String),i.__metadata(\"design:paramtypes\",[])],c.prototype,\"currentDataset\",null),i.__decorate([r.action,i.__metadata(\"design:type\",Function),i.__metadata(\"design:paramtypes\",[String,Object]),i.__metadata(\"design:returntype\",void 0)],c.prototype,\"setCurrentDataset\",null),i.__decorate([r.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],c.prototype,\"currentDatasetSpec\",null),i.__decorate([r.computed,i.__metadata(\"design:type\",Boolean),i.__metadata(\"design:paramtypes\",[])],c.prototype,\"datasetHasImages\",null),i.__decorate([r.observable,i.__metadata(\"design:type\",Object)],c.prototype,\"inputData\",void 0),i.__decorate([r.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],c.prototype,\"currentInputDataById\",null),i.__decorate([r.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],c.prototype,\"currentInputData\",null),i.__decorate([r.computed,i.__metadata(\"design:type\",Boolean),i.__metadata(\"design:paramtypes\",[])],c.prototype,\"currentInputDataIsLoaded\",null),i.__decorate([r.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],c.prototype,\"currentModelRequiredInputSpecKeys\",null),i.__decorate([r.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],c.prototype,\"currentInputDataKeys\",null),i.__decorate([r.computed,i.__metadata(\"design:type\",Map),i.__metadata(\"design:paramtypes\",[])],c.prototype,\"indicesById\",null),i.__decorate([r.action,i.__metadata(\"design:type\",Function),i.__metadata(\"design:paramtypes\",[Array]),i.__metadata(\"design:returntype\",Promise)],c.prototype,\"setCurrentModels\",null),i.__decorate([r.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],c.prototype,\"currentModelSpecs\",null),i.__decorate([r.action,i.__metadata(\"design:type\",Function),i.__metadata(\"design:paramtypes\",[Array]),i.__metadata(\"design:returntype\",void 0)],c.prototype,\"commitNewDatapoints\",null),i.__decorate([r.action,i.__metadata(\"design:type\",Function),i.__metadata(\"design:paramtypes\",[]),i.__metadata(\"design:returntype\",Promise)],c.prototype,\"initialize\",null),e.AppState=c},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.RegressionService=void 0;const i=n(1),r=i.__importStar(n(21)),o=n(4);n(5);const a=n(8),s=n(33),c=n(25);n(11);const l=new Map([[\"prediction\",\"prediction\"],[\"error\",\"error\"],[\"squaredError\",\"squared error\"]]);class d extends c.LitService{constructor(t,e){super(),this.apiService=t,this.appState=e,this.regressionInfo={},(0,o.reaction)(()=>e.currentModels,t=>{this.reset()})}getRegressionPreds(t,e,n){return i.__awaiter(this,void 0,void 0,(function*(){const i=this.apiService.getPreds(t,e,n,[\"RegressionScore\"]),r=yield i;return null!=r&&r.length>0&&this.processNewPreds(t,e,r),i}))}reset(){this.regressionInfo={}}getResults(t,e,n){return i.__awaiter(this,void 0,void 0,(function*(){const i=[];t.forEach(r=>{var o,a;null==(null===(a=null===(o=this.regressionInfo[t[0]])||void 0===o?void 0:o[e])||void 0===a?void 0:a[n])&&i.push(r)}),i.length>0&&(yield this.getRegressionPreds(this.appState.getExamplesById(i),e,this.appState.currentDataset));const r=[];return t.forEach(t=>{var i,o;const a=null===(o=null===(i=this.regressionInfo[t])||void 0===i?void 0:i[e])||void 0===o?void 0:o[n];null!=a&&r.push(a)}),r}))}processNewPreds(t,e,n){const i=this.appState.currentModelSpecs[e].spec.output,r=(0,a.findSpecKeys)(i,\"RegressionScore\"),o=Object.keys(n[0]);for(let a=0;a<n.length;a++){const s=t[a],c=n[a];null==this.regressionInfo[s.id]&&(this.regressionInfo[s.id]={}),null==this.regressionInfo[s.id][e]&&(this.regressionInfo[s.id][e]={});for(let n=0;n<o.length;n++){const l=o[n];if(!r.includes(l))continue;const d={};d.prediction=c[l];const u=i[l].parent;null!=u&&null!=t[a].data[u]&&(d.error=d.prediction-+t[a].data[u],d.squaredError=d.error*d.error),null==this.regressionInfo[s.id][e][l]&&(this.regressionInfo[s.id][e][l]=d)}}}get ranges(){const t={};return Object.values(this.regressionInfo).forEach(e=>{Object.keys(e).forEach(n=>{Object.keys(e[n]).forEach(i=>{const r=e[n][i],o=`${n}:${i}`;null==t[o]&&(t[o]={prediction:[1/0,-1/0],error:[1/0,-1/0],squaredError:[1/0,-1/0]}),t[o].prediction[0]=Math.min(t[o].prediction[0],r.prediction),t[o].prediction[1]=Math.max(t[o].prediction[1],r.prediction),t[o].error[0]=Math.min(t[o].error[0],r.error),t[o].error[1]=Math.max(t[o].error[1],r.error),t[o].squaredError[0]=Math.min(t[o].squaredError[0],r.squaredError),t[o].squaredError[1]=Math.max(t[o].squaredError[1],r.squaredError),t[o].prediction=this.adjustDomain(...t[o].prediction),t[o].error=this.adjustDomain(...t[o].error),t[o].squaredError=this.adjustDomain(...t[o].squaredError)})})}),t}get colorOptions(){const t=Object.keys(this.regressionInfo);if(0===t.length)return[];const e=[],n=this.regressionInfo[t[0]],i=Object.keys(n);for(const t of i){const i=Object.keys(n[t]);for(const n of i){const i=this.ranges[`${t}:${n}`].prediction;e.push({name:`${t}:${n} prediction`,getValue:e=>this.regressionInfo[e.id][t][n].prediction,scale:r.scaleSequential(s.MULTIHUE_CONTINUOUS).domain(i)});const o=Math.max(...this.ranges[`${t}:${n}`].error.map(t=>Math.abs(t))),a=[-o,o];e.push({name:`${t}:${n} error`,getValue:e=>this.regressionInfo[e.id][t][n].error,scale:r.scaleSequential(s.CONTINUOUS_SIGNED).domain(a)});const c=[0,Math.max(...this.ranges[`${t}:${n}`].squaredError)];e.push({name:`${t}:${n} squared error`,getValue:e=>this.regressionInfo[e.id][t][n].squaredError,scale:r.scaleSequential(s.CONTINUOUS_UNSIGNED).domain(c)})}}return e}getErrorKey(t){return t+\":error\"}getInfoFields(){return Array.from(l.keys())}getDisplayNames(){return Array.from(l.values())}adjustDomain(t,e){if(t*e>=0)return[t,e];{const n=Math.max(-t,e);return[-n,n]}}}i.__decorate([o.observable,i.__metadata(\"design:type\",Object)],d.prototype,\"regressionInfo\",void 0),i.__decorate([o.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],d.prototype,\"ranges\",null),i.__decorate([o.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],d.prototype,\"colorOptions\",null),e.RegressionService=d},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.FocusService=void 0;const i=n(1),r=n(4),o=n(25);n(57);class a extends o.LitService{constructor(t){super(),this.focusDataInternal=null,(0,r.reaction)(()=>t.primarySelectedInputData,t=>{this.clearFocus()})}get focusData(){return this.focusDataInternal}setFocusedDatapoint(t){this.focusDataInternal={datapointId:t}}setFocusedField(t,e,n,i){this.focusDataInternal={datapointId:t,io:e,fieldName:n,subField:i}}clearFocus(){this.focusDataInternal=null}}i.__decorate([r.observable,i.__metadata(\"design:type\",Object)],a.prototype,\"focusDataInternal\",void 0),i.__decorate([r.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],a.prototype,\"focusData\",null),e.FocusService=a},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.SelectionService=void 0;const i=n(1),r=n(4);n(5);const o=n(25);n(51);class a extends o.LitService{constructor(t){super(),this.appState=t,this.selectedIdsSet=new Set,this.primarySelectedIdInternal=null}get lastUser(){return this.lastUserInternal}get primarySelectedId(){return this.primarySelectedIdInternal}get selectedIds(){return[...this.selectedIdsSet.values()]}get selectedInputData(){return 0===this.selectedIds.length?[]:this.appState.currentInputData.filter(t=>this.selectedIdsSet.has(t.id))}get primarySelectedInputData(){return null!==this.primarySelectedId?this.appState.getCurrentInputDataById(this.primarySelectedId):null}setLastUser(t){this.lastUserInternal=t}setPrimarySelection(t,e){null==t||this.selectedIdsSet.has(t)?(this.primarySelectedIdInternal=t,this.setLastUser(e)):this.selectIds([t],e)}selectIds(t,e){this.selectedIdsSet.clear(),t.forEach(t=>{this.selectedIdsSet.add(t)}),null!==this.primarySelectedId&&this.selectedIdsSet.has(this.primarySelectedId)||(0===this.selectedIdsSet.size?this.primarySelectedIdInternal=null:this.primarySelectedIdInternal=t[0]),this.setLastUser(e)}selectAll(t){const e=this.appState.currentInputData.map(t=>t.id);this.selectIds(e,t)}syncFrom(t){this.selectIds(t.selectedIds),this.setPrimarySelection(t.primarySelectedId)}isIdSelected(t){return this.selectedIdsSet.has(t)}get selectedOrAllInputData(){return this.selectedInputData.length>0?this.selectedInputData:this.appState.currentInputData}}i.__decorate([r.observable,i.__metadata(\"design:type\",Object)],a.prototype,\"selectedIdsSet\",void 0),i.__decorate([r.observable,i.__metadata(\"design:type\",Object)],a.prototype,\"primarySelectedIdInternal\",void 0),i.__decorate([r.observable,i.__metadata(\"design:type\",Object)],a.prototype,\"lastUserInternal\",void 0),i.__decorate([r.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],a.prototype,\"lastUser\",null),i.__decorate([r.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],a.prototype,\"primarySelectedId\",null),i.__decorate([r.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],a.prototype,\"selectedIds\",null),i.__decorate([r.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],a.prototype,\"selectedInputData\",null),i.__decorate([r.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],a.prototype,\"primarySelectedInputData\",null),i.__decorate([r.action,i.__metadata(\"design:type\",Function),i.__metadata(\"design:paramtypes\",[Object]),i.__metadata(\"design:returntype\",void 0)],a.prototype,\"setLastUser\",null),i.__decorate([r.action,i.__metadata(\"design:type\",Function),i.__metadata(\"design:paramtypes\",[Object,Object]),i.__metadata(\"design:returntype\",void 0)],a.prototype,\"setPrimarySelection\",null),i.__decorate([r.action,i.__metadata(\"design:type\",Function),i.__metadata(\"design:paramtypes\",[Array,Object]),i.__metadata(\"design:returntype\",void 0)],a.prototype,\"selectIds\",null),i.__decorate([r.action,i.__metadata(\"design:type\",Function),i.__metadata(\"design:paramtypes\",[Object]),i.__metadata(\"design:returntype\",void 0)],a.prototype,\"selectAll\",null),i.__decorate([r.action,i.__metadata(\"design:type\",Function),i.__metadata(\"design:paramtypes\",[a]),i.__metadata(\"design:returntype\",void 0)],a.prototype,\"syncFrom\",null),i.__decorate([r.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],a.prototype,\"selectedOrAllInputData\",null),e.SelectionService=a},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=function(t,e,n,i,r,o,a){this.pointIndices=t,this.labelStrings=e,this.scaleFactors=n,this.useSceneOpacityFlags=i,this.defaultFontSize=r,this.fillColors=o,this.strokeColors=a};e.LabelRenderParams=i,function(t){t[t.Perspective=0]=\"Perspective\",t[t.Orthographic=1]=\"Orthographic\"}(e.CameraType||(e.CameraType={}));var r=function(t,e,n,i,r,o,a,s,c,l,d,u,h,p){this.camera=t,this.cameraType=e,this.cameraTarget=n,this.screenWidth=i,this.screenHeight=r,this.nearestCameraSpacePointZ=o,this.farthestCameraSpacePointZ=a,this.backgroundColor=s,this.pointColors=c,this.pointScaleFactors=l,this.labels=d,this.polylineColors=u,this.polylineOpacities=h,this.polylineWidths=p};e.RenderContext=r},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.RGB_NUM_ELEMENTS=3,e.RGBA_NUM_ELEMENTS=4,e.XYZ_NUM_ELEMENTS=3,e.UV_NUM_ELEMENTS=2,e.INDEX_NUM_ELEMENTS=1,e.SCATTER_PLOT_CUBE_LENGTH=2},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"Switch\",(function(){return f}));var i=n(1),r=n(0),o=n(24),a=n(10),s=n(49),c=n(16),l={CHECKED:\"mdc-switch--checked\",DISABLED:\"mdc-switch--disabled\"},d={ARIA_CHECKED_ATTR:\"aria-checked\",NATIVE_CONTROL_SELECTOR:\".mdc-switch__native-control\",RIPPLE_SURFACE_SELECTOR:\".mdc-switch__thumb-underlay\"},u=function(t){function e(n){return t.call(this,Object(i.__assign)(Object(i.__assign)({},e.defaultAdapter),n))||this}return Object(i.__extends)(e,t),Object.defineProperty(e,\"strings\",{get:function(){return d},enumerable:!0,configurable:!0}),Object.defineProperty(e,\"cssClasses\",{get:function(){return l},enumerable:!0,configurable:!0}),Object.defineProperty(e,\"defaultAdapter\",{get:function(){return{addClass:function(){},removeClass:function(){},setNativeControlChecked:function(){},setNativeControlDisabled:function(){},setNativeControlAttr:function(){}}},enumerable:!0,configurable:!0}),e.prototype.setChecked=function(t){this.adapter_.setNativeControlChecked(t),this.updateAriaChecked_(t),this.updateCheckedStyling_(t)},e.prototype.setDisabled=function(t){this.adapter_.setNativeControlDisabled(t),t?this.adapter_.addClass(l.DISABLED):this.adapter_.removeClass(l.DISABLED)},e.prototype.handleChange=function(t){var e=t.target;this.updateAriaChecked_(e.checked),this.updateCheckedStyling_(e.checked)},e.prototype.updateCheckedStyling_=function(t){t?this.adapter_.addClass(l.CHECKED):this.adapter_.removeClass(l.CHECKED)},e.prototype.updateAriaChecked_=function(t){this.adapter_.setNativeControlAttr(d.ARIA_CHECKED_ATTR,\"\"+!!t)},e}(c.a);\n/**\n@license\nCopyright 2018 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\nclass h extends o.a{constructor(){super(...arguments),this.checked=!1,this.disabled=!1,this.mdcFoundationClass=u}_changeHandler(t){this.mdcFoundation.handleChange(t),this.checked=this.formElement.checked}createAdapter(){return Object.assign(Object.assign({},Object(o.b)(this.mdcRoot)),{setNativeControlChecked:t=>{this.formElement.checked=t},setNativeControlDisabled:t=>{this.formElement.disabled=t},setNativeControlAttr:(t,e)=>{this.formElement.setAttribute(t,e)}})}get ripple(){return this.rippleNode.ripple}render(){return r.e`\n      <div class=\"mdc-switch\">\n        <div class=\"mdc-switch__track\"></div>\n        <div class=\"mdc-switch__thumb-underlay\" .ripple=\"${Object(s.a)({interactionNode:this})}\">\n          <div class=\"mdc-switch__thumb\">\n            <input\n              type=\"checkbox\"\n              id=\"basic-switch\"\n              class=\"mdc-switch__native-control\"\n              role=\"switch\"\n              @change=\"${this._changeHandler}\">\n          </div>\n        </div>\n      </div>`}}Object(i.__decorate)([Object(r.g)({type:Boolean}),Object(a.a)((function(t){this.mdcFoundation.setChecked(t)}))],h.prototype,\"checked\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean}),Object(a.a)((function(t){this.mdcFoundation.setDisabled(t)}))],h.prototype,\"disabled\",void 0),Object(i.__decorate)([Object(r.h)(\".mdc-switch\")],h.prototype,\"mdcRoot\",void 0),Object(i.__decorate)([Object(r.h)(\"input\")],h.prototype,\"formElement\",void 0),Object(i.__decorate)([Object(r.h)(\".mdc-switch__thumb-underlay\")],h.prototype,\"rippleNode\",void 0);\n/**\n@license\nCopyright 2018 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\nconst p=r.b`@keyframes mdc-ripple-fg-radius-in{from{animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transform:translate(var(--mdc-ripple-fg-translate-start, 0)) scale(1)}to{transform:translate(var(--mdc-ripple-fg-translate-end, 0)) scale(var(--mdc-ripple-fg-scale, 1))}}@keyframes mdc-ripple-fg-opacity-in{from{animation-timing-function:linear;opacity:0}to{opacity:var(--mdc-ripple-fg-opacity, 0)}}@keyframes mdc-ripple-fg-opacity-out{from{animation-timing-function:linear;opacity:var(--mdc-ripple-fg-opacity, 0)}to{opacity:0}}.mdc-switch__thumb-underlay{left:-18px;right:initial;top:-17px;width:48px;height:48px}[dir=rtl] .mdc-switch__thumb-underlay,.mdc-switch__thumb-underlay[dir=rtl]{left:initial;right:-18px}.mdc-switch__native-control{width:68px;height:48px}.mdc-switch{display:inline-block;position:relative;outline:none;user-select:none}.mdc-switch.mdc-switch--checked .mdc-switch__track{background-color:#018786;background-color:var(--mdc-theme-secondary, #018786)}.mdc-switch.mdc-switch--checked .mdc-switch__thumb{background-color:#018786;background-color:var(--mdc-theme-secondary, #018786);border-color:#018786;border-color:var(--mdc-theme-secondary, #018786)}.mdc-switch:not(.mdc-switch--checked) .mdc-switch__track{background-color:#000;background-color:var(--mdc-theme-on-surface, #000)}.mdc-switch:not(.mdc-switch--checked) .mdc-switch__thumb{background-color:#fff;background-color:var(--mdc-theme-surface, #fff);border-color:#fff;border-color:var(--mdc-theme-surface, #fff)}.mdc-switch__native-control{left:0;right:initial;position:absolute;top:0;margin:0;opacity:0;cursor:pointer;pointer-events:auto;transition:transform 90ms cubic-bezier(0.4, 0, 0.2, 1)}[dir=rtl] .mdc-switch__native-control,.mdc-switch__native-control[dir=rtl]{left:initial;right:0}.mdc-switch__track{box-sizing:border-box;width:32px;height:14px;border:1px solid transparent;border-radius:7px;opacity:.38;transition:opacity 90ms cubic-bezier(0.4, 0, 0.2, 1),background-color 90ms cubic-bezier(0.4, 0, 0.2, 1),border-color 90ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-switch__thumb-underlay{display:flex;position:absolute;align-items:center;justify-content:center;transform:translateX(0);transition:transform 90ms cubic-bezier(0.4, 0, 0.2, 1),background-color 90ms cubic-bezier(0.4, 0, 0.2, 1),border-color 90ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-switch__thumb{box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2),0px 2px 2px 0px rgba(0, 0, 0, 0.14),0px 1px 5px 0px rgba(0,0,0,.12);box-sizing:border-box;width:20px;height:20px;border:10px solid;border-radius:50%;pointer-events:none;z-index:1}.mdc-switch--checked .mdc-switch__track{opacity:.54}.mdc-switch--checked .mdc-switch__thumb-underlay{transform:translateX(20px)}[dir=rtl] .mdc-switch--checked .mdc-switch__thumb-underlay,.mdc-switch--checked .mdc-switch__thumb-underlay[dir=rtl]{transform:translateX(-20px)}.mdc-switch--checked .mdc-switch__native-control{transform:translateX(-20px)}[dir=rtl] .mdc-switch--checked .mdc-switch__native-control,.mdc-switch--checked .mdc-switch__native-control[dir=rtl]{transform:translateX(20px)}.mdc-switch--disabled{opacity:.38;pointer-events:none}.mdc-switch--disabled .mdc-switch__thumb{border-width:1px}.mdc-switch--disabled .mdc-switch__native-control{cursor:default;pointer-events:none}.mdc-switch:not(.mdc-switch--checked) .mdc-switch__thumb-underlay::before,.mdc-switch:not(.mdc-switch--checked) .mdc-switch__thumb-underlay::after{background-color:#9e9e9e}.mdc-switch:not(.mdc-switch--checked) .mdc-switch__thumb-underlay:hover::before{opacity:.08}.mdc-switch:not(.mdc-switch--checked) .mdc-switch__thumb-underlay.mdc-ripple-upgraded--background-focused::before,.mdc-switch:not(.mdc-switch--checked) .mdc-switch__thumb-underlay:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:.24}.mdc-switch:not(.mdc-switch--checked) .mdc-switch__thumb-underlay:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mdc-switch:not(.mdc-switch--checked) .mdc-switch__thumb-underlay:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:.24}.mdc-switch:not(.mdc-switch--checked) .mdc-switch__thumb-underlay.mdc-ripple-upgraded{--mdc-ripple-fg-opacity: 0.24}.mdc-switch__thumb-underlay{--mdc-ripple-fg-size: 0;--mdc-ripple-left: 0;--mdc-ripple-top: 0;--mdc-ripple-fg-scale: 1;--mdc-ripple-fg-translate-end: 0;--mdc-ripple-fg-translate-start: 0;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mdc-switch__thumb-underlay::before,.mdc-switch__thumb-underlay::after{position:absolute;border-radius:50%;opacity:0;pointer-events:none;content:\"\"}.mdc-switch__thumb-underlay::before{transition:opacity 15ms linear,background-color 15ms linear;z-index:1}.mdc-switch__thumb-underlay.mdc-ripple-upgraded::before{transform:scale(var(--mdc-ripple-fg-scale, 1))}.mdc-switch__thumb-underlay.mdc-ripple-upgraded::after{top:0;left:0;transform:scale(0);transform-origin:center center}.mdc-switch__thumb-underlay.mdc-ripple-upgraded--unbounded::after{top:var(--mdc-ripple-top, 0);left:var(--mdc-ripple-left, 0)}.mdc-switch__thumb-underlay.mdc-ripple-upgraded--foreground-activation::after{animation:mdc-ripple-fg-radius-in 225ms forwards,mdc-ripple-fg-opacity-in 75ms forwards}.mdc-switch__thumb-underlay.mdc-ripple-upgraded--foreground-deactivation::after{animation:mdc-ripple-fg-opacity-out 150ms;transform:translate(var(--mdc-ripple-fg-translate-end, 0)) scale(var(--mdc-ripple-fg-scale, 1))}.mdc-switch__thumb-underlay::before,.mdc-switch__thumb-underlay::after{top:calc(50% - 50%);left:calc(50% - 50%);width:100%;height:100%}.mdc-switch__thumb-underlay.mdc-ripple-upgraded::before,.mdc-switch__thumb-underlay.mdc-ripple-upgraded::after{top:var(--mdc-ripple-top, calc(50% - 50%));left:var(--mdc-ripple-left, calc(50% - 50%));width:var(--mdc-ripple-fg-size, 100%);height:var(--mdc-ripple-fg-size, 100%)}.mdc-switch__thumb-underlay.mdc-ripple-upgraded::after{width:var(--mdc-ripple-fg-size, 100%);height:var(--mdc-ripple-fg-size, 100%)}.mdc-switch__thumb-underlay::before,.mdc-switch__thumb-underlay::after{background-color:#018786;background-color:var(--mdc-theme-secondary, #018786)}.mdc-switch__thumb-underlay:hover::before{opacity:.04}.mdc-switch__thumb-underlay.mdc-ripple-upgraded--background-focused::before,.mdc-switch__thumb-underlay:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:.12}.mdc-switch__thumb-underlay:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mdc-switch__thumb-underlay:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:.12}.mdc-switch__thumb-underlay.mdc-ripple-upgraded{--mdc-ripple-fg-opacity: 0.12}:host{display:inline-flex;outline:none}`;\n/**\n@license\nCopyright 2018 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/let f=class extends h{};f.styles=p,f=Object(i.__decorate)([Object(r.c)(\"mwc-switch\")],f)},function(t,e,n){\"use strict\";function i(t,e){return(t.matches||t.webkitMatchesSelector||t.msMatchesSelector).call(t,e)}n.d(e,\"a\",(function(){return i}))},function(t,e,n){\"use strict\";var i;function r(t,e){void 0===e&&(e=!1);var n,r=t.CSS;if(\"boolean\"==typeof i&&!e)return i;if(!(r&&\"function\"==typeof r.supports))return!1;var o=r.supports(\"--css-vars\",\"yes\"),a=r.supports(\"(--css-vars: yes)\")&&r.supports(\"color\",\"#00000000\");return n=o||a,e||(i=n),n}function o(t,e,n){if(!t)return{x:0,y:0};var i,r,o=e.x,a=e.y,s=o+n.left,c=a+n.top;if(\"touchstart\"===t.type){var l=t;i=l.changedTouches[0].pageX-s,r=l.changedTouches[0].pageY-c}else{var d=t;i=d.pageX-s,r=d.pageY-c}return{x:i,y:r}}n.d(e,\"b\",(function(){return r})),n.d(e,\"a\",(function(){return o}))},function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return i}));\n/**\n@license\nCopyright 2020 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\nclass i{constructor(t){this.startPress=e=>{t().then(t=>{t&&t.startPress(e)})},this.endPress=()=>{t().then(t=>{t&&t.endPress()})},this.startFocus=()=>{t().then(t=>{t&&t.startFocus()})},this.endFocus=()=>{t().then(t=>{t&&t.endFocus()})},this.startHover=()=>{t().then(t=>{t&&t.startHover()})},this.endHover=()=>{t().then(t=>{t&&t.endHover()})}}}},function(t,e,n){\"use strict\";var i=n(1),r=n(16),o={BG_FOCUSED:\"mdc-ripple-upgraded--background-focused\",FG_ACTIVATION:\"mdc-ripple-upgraded--foreground-activation\",FG_DEACTIVATION:\"mdc-ripple-upgraded--foreground-deactivation\",ROOT:\"mdc-ripple-upgraded\",UNBOUNDED:\"mdc-ripple-upgraded--unbounded\"},a={VAR_FG_SCALE:\"--mdc-ripple-fg-scale\",VAR_FG_SIZE:\"--mdc-ripple-fg-size\",VAR_FG_TRANSLATE_END:\"--mdc-ripple-fg-translate-end\",VAR_FG_TRANSLATE_START:\"--mdc-ripple-fg-translate-start\",VAR_LEFT:\"--mdc-ripple-left\",VAR_TOP:\"--mdc-ripple-top\"},s={DEACTIVATION_TIMEOUT_MS:225,FG_DEACTIVATION_MS:150,INITIAL_ORIGIN_SCALE:.6,PADDING:10,TAP_DELAY_MS:300},c=n(62),l=[\"touchstart\",\"pointerdown\",\"mousedown\",\"keydown\"],d=[\"touchend\",\"pointerup\",\"mouseup\",\"contextmenu\"],u=[],h=function(t){function e(n){var r=t.call(this,Object(i.__assign)(Object(i.__assign)({},e.defaultAdapter),n))||this;return r.activationAnimationHasEnded_=!1,r.activationTimer_=0,r.fgDeactivationRemovalTimer_=0,r.fgScale_=\"0\",r.frame_={width:0,height:0},r.initialSize_=0,r.layoutFrame_=0,r.maxRadius_=0,r.unboundedCoords_={left:0,top:0},r.activationState_=r.defaultActivationState_(),r.activationTimerCallback_=function(){r.activationAnimationHasEnded_=!0,r.runDeactivationUXLogicIfReady_()},r.activateHandler_=function(t){return r.activate_(t)},r.deactivateHandler_=function(){return r.deactivate_()},r.focusHandler_=function(){return r.handleFocus()},r.blurHandler_=function(){return r.handleBlur()},r.resizeHandler_=function(){return r.layout()},r}return Object(i.__extends)(e,t),Object.defineProperty(e,\"cssClasses\",{get:function(){return o},enumerable:!0,configurable:!0}),Object.defineProperty(e,\"strings\",{get:function(){return a},enumerable:!0,configurable:!0}),Object.defineProperty(e,\"numbers\",{get:function(){return s},enumerable:!0,configurable:!0}),Object.defineProperty(e,\"defaultAdapter\",{get:function(){return{addClass:function(){},browserSupportsCssVars:function(){return!0},computeBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},containsEventTarget:function(){return!0},deregisterDocumentInteractionHandler:function(){},deregisterInteractionHandler:function(){},deregisterResizeHandler:function(){},getWindowPageOffset:function(){return{x:0,y:0}},isSurfaceActive:function(){return!0},isSurfaceDisabled:function(){return!0},isUnbounded:function(){return!0},registerDocumentInteractionHandler:function(){},registerInteractionHandler:function(){},registerResizeHandler:function(){},removeClass:function(){},updateCssVariable:function(){}}},enumerable:!0,configurable:!0}),e.prototype.init=function(){var t=this,n=this.supportsPressRipple_();if(this.registerRootHandlers_(n),n){var i=e.cssClasses,r=i.ROOT,o=i.UNBOUNDED;requestAnimationFrame((function(){t.adapter_.addClass(r),t.adapter_.isUnbounded()&&(t.adapter_.addClass(o),t.layoutInternal_())}))}},e.prototype.destroy=function(){var t=this;if(this.supportsPressRipple_()){this.activationTimer_&&(clearTimeout(this.activationTimer_),this.activationTimer_=0,this.adapter_.removeClass(e.cssClasses.FG_ACTIVATION)),this.fgDeactivationRemovalTimer_&&(clearTimeout(this.fgDeactivationRemovalTimer_),this.fgDeactivationRemovalTimer_=0,this.adapter_.removeClass(e.cssClasses.FG_DEACTIVATION));var n=e.cssClasses,i=n.ROOT,r=n.UNBOUNDED;requestAnimationFrame((function(){t.adapter_.removeClass(i),t.adapter_.removeClass(r),t.removeCssVars_()}))}this.deregisterRootHandlers_(),this.deregisterDeactivationHandlers_()},e.prototype.activate=function(t){this.activate_(t)},e.prototype.deactivate=function(){this.deactivate_()},e.prototype.layout=function(){var t=this;this.layoutFrame_&&cancelAnimationFrame(this.layoutFrame_),this.layoutFrame_=requestAnimationFrame((function(){t.layoutInternal_(),t.layoutFrame_=0}))},e.prototype.setUnbounded=function(t){var n=e.cssClasses.UNBOUNDED;t?this.adapter_.addClass(n):this.adapter_.removeClass(n)},e.prototype.handleFocus=function(){var t=this;requestAnimationFrame((function(){return t.adapter_.addClass(e.cssClasses.BG_FOCUSED)}))},e.prototype.handleBlur=function(){var t=this;requestAnimationFrame((function(){return t.adapter_.removeClass(e.cssClasses.BG_FOCUSED)}))},e.prototype.supportsPressRipple_=function(){return this.adapter_.browserSupportsCssVars()},e.prototype.defaultActivationState_=function(){return{activationEvent:void 0,hasDeactivationUXRun:!1,isActivated:!1,isProgrammatic:!1,wasActivatedByPointer:!1,wasElementMadeActive:!1}},e.prototype.registerRootHandlers_=function(t){var e=this;t&&(l.forEach((function(t){e.adapter_.registerInteractionHandler(t,e.activateHandler_)})),this.adapter_.isUnbounded()&&this.adapter_.registerResizeHandler(this.resizeHandler_)),this.adapter_.registerInteractionHandler(\"focus\",this.focusHandler_),this.adapter_.registerInteractionHandler(\"blur\",this.blurHandler_)},e.prototype.registerDeactivationHandlers_=function(t){var e=this;\"keydown\"===t.type?this.adapter_.registerInteractionHandler(\"keyup\",this.deactivateHandler_):d.forEach((function(t){e.adapter_.registerDocumentInteractionHandler(t,e.deactivateHandler_)}))},e.prototype.deregisterRootHandlers_=function(){var t=this;l.forEach((function(e){t.adapter_.deregisterInteractionHandler(e,t.activateHandler_)})),this.adapter_.deregisterInteractionHandler(\"focus\",this.focusHandler_),this.adapter_.deregisterInteractionHandler(\"blur\",this.blurHandler_),this.adapter_.isUnbounded()&&this.adapter_.deregisterResizeHandler(this.resizeHandler_)},e.prototype.deregisterDeactivationHandlers_=function(){var t=this;this.adapter_.deregisterInteractionHandler(\"keyup\",this.deactivateHandler_),d.forEach((function(e){t.adapter_.deregisterDocumentInteractionHandler(e,t.deactivateHandler_)}))},e.prototype.removeCssVars_=function(){var t=this,n=e.strings;Object.keys(n).forEach((function(e){0===e.indexOf(\"VAR_\")&&t.adapter_.updateCssVariable(n[e],null)}))},e.prototype.activate_=function(t){var e=this;if(!this.adapter_.isSurfaceDisabled()){var n=this.activationState_;if(!n.isActivated){var i=this.previousActivationEvent_;if(!(i&&void 0!==t&&i.type!==t.type))n.isActivated=!0,n.isProgrammatic=void 0===t,n.activationEvent=t,n.wasActivatedByPointer=!n.isProgrammatic&&(void 0!==t&&(\"mousedown\"===t.type||\"touchstart\"===t.type||\"pointerdown\"===t.type)),void 0!==t&&u.length>0&&u.some((function(t){return e.adapter_.containsEventTarget(t)}))?this.resetActivationState_():(void 0!==t&&(u.push(t.target),this.registerDeactivationHandlers_(t)),n.wasElementMadeActive=this.checkElementMadeActive_(t),n.wasElementMadeActive&&this.animateActivation_(),requestAnimationFrame((function(){u=[],n.wasElementMadeActive||void 0===t||\" \"!==t.key&&32!==t.keyCode||(n.wasElementMadeActive=e.checkElementMadeActive_(t),n.wasElementMadeActive&&e.animateActivation_()),n.wasElementMadeActive||(e.activationState_=e.defaultActivationState_())})))}}},e.prototype.checkElementMadeActive_=function(t){return void 0===t||\"keydown\"!==t.type||this.adapter_.isSurfaceActive()},e.prototype.animateActivation_=function(){var t=this,n=e.strings,i=n.VAR_FG_TRANSLATE_START,r=n.VAR_FG_TRANSLATE_END,o=e.cssClasses,a=o.FG_DEACTIVATION,s=o.FG_ACTIVATION,c=e.numbers.DEACTIVATION_TIMEOUT_MS;this.layoutInternal_();var l=\"\",d=\"\";if(!this.adapter_.isUnbounded()){var u=this.getFgTranslationCoordinates_(),h=u.startPoint,p=u.endPoint;l=h.x+\"px, \"+h.y+\"px\",d=p.x+\"px, \"+p.y+\"px\"}this.adapter_.updateCssVariable(i,l),this.adapter_.updateCssVariable(r,d),clearTimeout(this.activationTimer_),clearTimeout(this.fgDeactivationRemovalTimer_),this.rmBoundedActivationClasses_(),this.adapter_.removeClass(a),this.adapter_.computeBoundingRect(),this.adapter_.addClass(s),this.activationTimer_=setTimeout((function(){return t.activationTimerCallback_()}),c)},e.prototype.getFgTranslationCoordinates_=function(){var t,e=this.activationState_,n=e.activationEvent;return{startPoint:t={x:(t=e.wasActivatedByPointer?Object(c.a)(n,this.adapter_.getWindowPageOffset(),this.adapter_.computeBoundingRect()):{x:this.frame_.width/2,y:this.frame_.height/2}).x-this.initialSize_/2,y:t.y-this.initialSize_/2},endPoint:{x:this.frame_.width/2-this.initialSize_/2,y:this.frame_.height/2-this.initialSize_/2}}},e.prototype.runDeactivationUXLogicIfReady_=function(){var t=this,n=e.cssClasses.FG_DEACTIVATION,i=this.activationState_,r=i.hasDeactivationUXRun,o=i.isActivated;(r||!o)&&this.activationAnimationHasEnded_&&(this.rmBoundedActivationClasses_(),this.adapter_.addClass(n),this.fgDeactivationRemovalTimer_=setTimeout((function(){t.adapter_.removeClass(n)}),s.FG_DEACTIVATION_MS))},e.prototype.rmBoundedActivationClasses_=function(){var t=e.cssClasses.FG_ACTIVATION;this.adapter_.removeClass(t),this.activationAnimationHasEnded_=!1,this.adapter_.computeBoundingRect()},e.prototype.resetActivationState_=function(){var t=this;this.previousActivationEvent_=this.activationState_.activationEvent,this.activationState_=this.defaultActivationState_(),setTimeout((function(){return t.previousActivationEvent_=void 0}),e.numbers.TAP_DELAY_MS)},e.prototype.deactivate_=function(){var t=this,e=this.activationState_;if(e.isActivated){var n=Object(i.__assign)({},e);e.isProgrammatic?(requestAnimationFrame((function(){return t.animateDeactivation_(n)})),this.resetActivationState_()):(this.deregisterDeactivationHandlers_(),requestAnimationFrame((function(){t.activationState_.hasDeactivationUXRun=!0,t.animateDeactivation_(n),t.resetActivationState_()})))}},e.prototype.animateDeactivation_=function(t){var e=t.wasActivatedByPointer,n=t.wasElementMadeActive;(e||n)&&this.runDeactivationUXLogicIfReady_()},e.prototype.layoutInternal_=function(){var t=this;this.frame_=this.adapter_.computeBoundingRect();var n=Math.max(this.frame_.height,this.frame_.width);this.maxRadius_=this.adapter_.isUnbounded()?n:Math.sqrt(Math.pow(t.frame_.width,2)+Math.pow(t.frame_.height,2))+e.numbers.PADDING;var i=Math.floor(n*e.numbers.INITIAL_ORIGIN_SCALE);this.adapter_.isUnbounded()&&i%2!=0?this.initialSize_=i-1:this.initialSize_=i,this.fgScale_=\"\"+this.maxRadius_/this.initialSize_,this.updateLayoutCssVars_()},e.prototype.updateLayoutCssVars_=function(){var t=e.strings,n=t.VAR_FG_SIZE,i=t.VAR_LEFT,r=t.VAR_TOP,o=t.VAR_FG_SCALE;this.adapter_.updateCssVariable(n,this.initialSize_+\"px\"),this.adapter_.updateCssVariable(o,this.fgScale_),this.adapter_.isUnbounded()&&(this.unboundedCoords_={left:Math.round(this.frame_.width/2-this.initialSize_/2),top:Math.round(this.frame_.height/2-this.initialSize_/2)},this.adapter_.updateCssVariable(i,this.unboundedCoords_.left+\"px\"),this.adapter_.updateCssVariable(r,this.unboundedCoords_.top+\"px\"))},e}(r.a);e.a=h},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.GlobalSettingsComponent=void 0;const i=n(1);n(190),n(191),n(188),n(39);const r=n(35),o=n(3),a=n(2),s=n(13),c=n(4),l=n(7),d=n(5),u=n(8),h=n(50),p=n(11),f=n(15),m=n(85);let g=class extends r.MobxLitElement{constructor(){super(...arguments),this.isOpen=!1,this.apiService=f.app.getService(p.ApiService),this.appState=f.app.getService(p.AppState),this.settingsService=f.app.getService(p.SettingsService),this.selectedDataset=\"\",this.selectedLayout=\"\",this.modelCheckboxValues=new Map,this.selectedTab=\"Models\",this.pathForDatapoints=\"\",this.datapointsStatus=\"\",this.pathForModel=\"\",this.modelStatus=\"\",this.openModelKeys=new Set,this.openDatasetKeys=new Set,this.openLayoutKeys=new Set}static get styles(){return[l.styles,m.styles]}get selectedModels(){return[...this.modelCheckboxValues.entries()].filter(([t,e])=>e).map(([t,e])=>t)}get loadDatapointButtonsDisabled(){return\"\"===this.pathForDatapoints}get saveDatapointButtonDisabled(){return\"\"===this.pathForDatapoints||0===this.newDatapoints.length||this.appState.currentDataset!==this.selectedDataset}get newDatapoints(){return this.appState.currentInputData.filter(t=>t.meta.added)}get loadModelButtonDisabled(){return 1!==this.selectedModels.length||\"\"===this.pathForModel}open(){this.initializeLocalState(),this.requestUpdate(),this.isOpen=!0}close(){this.isOpen=!1}initializeLocalState(){this.modelCheckboxValues.clear(),Object.keys(this.appState.metadata.models).forEach(t=>{this.modelCheckboxValues.set(t,!1)}),this.appState.currentModels.forEach(t=>{this.modelCheckboxValues.set(t,!0)}),this.selectedDataset=this.appState.currentDataset,this.selectedLayout=this.appState.layoutName}submitSettings(){const t=this.selectedModels,e=this.selectedDataset,n=this.selectedLayout;this.settingsService.updateSettings({models:t,dataset:e,layoutName:n})}render(){const t=(0,s.classMap)({hide:!this.isOpen});return o.html`\n      <div id=\"global-settings-holder\">\n        <div id=\"overlay\" class=${t}\n         @click=${()=>{this.close()}}></div>\n        <div id=\"global-settings\" class=${t}>\n        <div id=\"title-bar\">Configure LIT</div>\n        <div id=\"holder\">\n          <div id=\"sidebar\">\n            ${this.renderTabs()}\n            ${this.renderLinks()}\n          </div>\n          <div id=\"main-panel\">\n            ${this.renderConfig()}\n            ${this.renderBottomBar()}\n          </div>\n        </div>\n        </div>\n      </div>\n    `}renderTabs(){const t=t=>{const e=(0,s.classMap)({tab:!0,selected:this.selectedTab===t});return o.html`<div class=${e} @click=${()=>this.selectedTab=t}>${t}</div>`};return o.html`\n    <div id=\"tabs\">\n      ${[\"Models\",\"Dataset\",\"Layout\"].map(e=>t(e))}\n    </div>\n    `}renderLinks(){return o.html`\n    <div id=\"links\">\n      <a href=${\"https://github.com/PAIR-code/lit\"} class='link-out' target=\"_blank\">\n        Github\n      </a>\n      \n      <a href=${\"https://pair-code.github.io/lit/tutorials\"} class='link-out' target=\"_blank\">\n        Help & Tutorials\n      </a>\n    </div>\n    `}renderBottomBar(){const t=0===this.selectedModels.length,e=this.settingsService.isDatasetValidForModels(this.selectedDataset,this.selectedModels),n=(0,s.classMap)({info:!0,disabled:!this.selectedModels.length,error:t}),i=this.selectedModels.length?this.selectedModels.join(\", \"):\"No models selected\",r=(0,s.classMap)({info:!0,error:!e});return o.html`\n    <div id=\"bottombar\">\n      <div id=\"state\">\n        <div> selected model(s):\n          <span class=${n}> ${i} </span>\n        </div>\n        <div> selected dataset(s):\n          <span class=${r}>\n            ${(0,d.datasetDisplayName)(this.selectedDataset)}\n          </span>\n        </div>\n      </div>\n      <div> ${this.renderButtons(t,e)} </div>\n    </div>\n  `}renderButtons(t,e){const n=t||!e;return o.html`\n      <div id=\"buttons-container\">\n        <div id=\"buttons\">\n          <button class=\"hairline-button\" @click=${()=>{this.selectedTab=\"Models\",this.close()}}>Cancel</button>\n          <button class=\"filled-button\"\n                  ?disabled=${n}\n                  @click=${()=>{this.submitSettings(),this.selectedTab=\"Models\",this.close()}}>\n            Submit\n          </button>\n        </div>\n      </div>\n    `}renderConfig(){const t=this.selectedTab,e=\"Models\"===t?this.renderModelsConfig():\"Dataset\"===t?this.renderDatasetConfig():this.renderLayoutConfig();return o.html`\n    <div id=\"config\">\n      ${e}\n    </div>\n    `}renderModelsConfig(){const t=[...this.modelCheckboxValues.keys()],e=t=>{const e=!0===this.modelCheckboxValues.get(t),n=this.openModelKeys.has(t),i=e=>{if(this.modelCheckboxValues.set(t,e.target.checked),!this.settingsService.isDatasetValidForModels(this.selectedDataset,this.selectedModels)){this.selectedDataset=d.NONE_DS_DICT_KEY;const t=Object.keys(this.appState.metadata.datasets);for(const e of t)if(this.settingsService.isDatasetValidForModels(e,this.selectedModels)){this.selectedDataset=e;break}}},r=Object.keys(this.appState.metadata.datasets),a=this.appState.getModelSpec(t).output,c=o.html`\n        <div class='info-group-title'>\n          Dataset Compatibility\n        </div>\n        ${r.map(e=>{const n=this.settingsService.isDatasetValidForModels(e,[t]),i=!n&&this.selectedDataset===e,r=(0,s.classMap)({compatible:n,error:i,\"info-line\":!0}),a=n?\"check\":i?\"warning_amber\":\"clear\";return o.html`\n            <div class=${r}>\n              <mwc-icon>${a}</mwc-icon>\n              ${(0,d.datasetDisplayName)(e)}\n            </div>`})}\n        <div class='info-group-title'>\n          Output Fields\n        </div>\n        ${Object.keys(a).map(t=>o.html`\n            <div class='info-line'>\n              ${t} (${a[t].__name__})\n            </div>`)}\n      `,l=this.appState.metadata.models[t].description;return this.renderLine(t,()=>o.html`\n          <mwc-formfield label=${t}>\n            <lit-checkbox\n              class='checkbox'\n              ?checked=${e}\n              @change=${i}></lit-checkbox>\n          </mwc-formfield>\n      `,e,!1,n,()=>{this.toggleInSet(this.openModelKeys,t)},!1,c,l)},n=t.map(t=>e(t)),r=o.html`${this.nextPrevButton(\"Dataset\",!0)}`,a=this.appState.metadata.demoMode?o.html``:o.html`\n        <div class='datapoints-line'>\n          <div class='datapoints-label-holder'>\n            <label for=\"path\">File path:</label>\n            <input type=\"text\" name=\"path\" class=\"datapoints-file-input\"\n                   value=${this.pathForModel}\n                   @input=${t=>{const e=t.target;this.pathForModel=e.value}}>\n          </div>\n          <button class=\"filled-button\"\n                  ?disabled=${this.loadModelButtonDisabled}\n                  @click=${()=>i.__awaiter(this,void 0,void 0,(function*(){const t=yield this.apiService.createModel(this.selectedModels[0],this.pathForModel);null!=t?(this.appState.metadata=t[0],this.appState.currentModels.push(t[1]),this.initializeLocalState(),this.datapointsStatus=\"New model added to models list\"):this.modelStatus=\"Unable to load model from path.\"}))}>\n            Create new model from path\n          </button>\n          <div class='datapoints-label-holder'>\n            <div>${this.modelStatus}</div>\n          </div>\n        </div>`;return this.renderConfigPage(\"Models\",\"Select models to explore in LIT.\",n,r,a)}renderDatasetConfig(){const t=Object.keys(this.appState.metadata.datasets),e=t=>{const e=(0,d.datasetDisplayName)(t),n=()=>{this.pathForDatapoints=\"\",this.datapointsStatus=\"\",this.selectedDataset=t},i=this.selectedDataset===t,r=!this.settingsService.isDatasetValidForModels(t,this.selectedModels),a=this.openDatasetKeys.has(t),c=this.appState.metadata.datasets[t].spec,l=[...this.modelCheckboxValues.keys()],u=o.html`\n        <div class='info-group-title'>\n          Features\n        </div>\n        ${Object.keys(c).map(t=>o.html`\n            <div class='info-line'>\n              ${t} (${c[t].__name__})\n            </div>`)}\n        <div class='info-group-title'>\n          Model Compatibility\n        </div>\n        ${l.map(e=>{const n=this.settingsService.isDatasetValidForModels(t,[e]),i=!n&&this.selectedModels.includes(e),r=(0,s.classMap)({compatible:n,error:i,\"info-line\":!0}),a=n?\"check\":i?\"warning_amber\":\"clear\";return o.html`\n        <div class=${r}>\n          <mwc-icon>${a}</mwc-icon>\n          ${e}\n        </div>`})}\n      `,h=this.appState.metadata.datasets[t].description;return this.renderLine(t,()=>o.html`\n            <mwc-formfield label=${e}>\n              <mwc-radio\n                name=\"dataset\"\n                class=\"select-dataset\"\n                data-dataset=${e}\n                ?checked=${i}\n                ?disabled=${r}\n                @change=${n}>\n              </mwc-radio>\n            </mwc-formfield>\n        `,i,r,a,()=>{this.toggleInSet(this.openDatasetKeys,t)},!0,u,h)},n=t.map(t=>e(t)),r=o.html`\n      ${this.nextPrevButton(\"Models\",!1)}\n      ${this.nextPrevButton(\"Layout\",!0)}\n    `,a=this.appState.metadata.demoMode?o.html``:o.html`\n        <div class='datapoints-line'>\n          <div class='datapoints-label-holder'>\n            <label for=\"path\">File path:</label>\n            <input type=\"text\" name=\"path\" class=\"datapoints-file-input\"\n                   value=${this.pathForDatapoints}\n                   @input=${t=>{const e=t.target;this.pathForDatapoints=e.value}}>\n          </div>\n          <button class=\"filled-button\"\n                  ?disabled=${this.saveDatapointButtonDisabled}\n                  @click=${()=>i.__awaiter(this,void 0,void 0,(function*(){const t=yield this.apiService.saveDatapoints(this.newDatapoints,this.appState.currentDataset,this.pathForDatapoints);this.datapointsStatus=`Saved ${this.newDatapoints.length} datapoint${1===this.newDatapoints.length?\"\":\"s\"} at ${t}`}))}>\n            Save new datapoints\n          </button>\n          <button class=\"filled-button\"\n                  ?disabled=${this.loadDatapointButtonsDisabled}\n                  @click=${()=>i.__awaiter(this,void 0,void 0,(function*(){const t=yield this.apiService.loadDatapoints(this.selectedDataset,this.pathForDatapoints);null!=t&&0!==t.length?(this.appState.commitNewDatapoints(t),this.datapointsStatus=`Loaded ${t.length} datapoint${1===t.length?\"\":\"s\"} from `+this.pathForDatapoints):this.datapointsStatus=\"No persisted datapoints found in \"+this.pathForDatapoints}))}>\n            Load additional datapoints\n          </button>\n          <button class=\"filled-button\"\n                  ?disabled=${this.loadDatapointButtonsDisabled}\n                  @click=${()=>i.__awaiter(this,void 0,void 0,(function*(){const t=yield this.apiService.createDataset(this.selectedDataset,this.pathForDatapoints);null!=t?(this.appState.metadata=t[0],this.datapointsStatus=\"New dataset added to datasets list\",this.selectedDataset=t[1]):this.datapointsStatus=\"Unable to load from path.\"}))}>\n            Create new dataset from path\n          </button>\n          <div class='datapoints-label-holder'>${this.datapointsStatus}</div>\n        </div>`;return this.renderConfigPage(\"Dataset\",\"Select a compatible dataset to use with the selected models.\",n,r,a)}renderLayoutConfig(){const t=Object.keys(this.appState.layouts),e=t=>Object.keys(t).map(e=>o.html`\n          <div class='info-group'>\n            <div class='info-group-subtitle'>\n              ${e}\n            </div>\n            ${t[e].map(t=>o.html`\n              <div class='indent-line'>\n                ${(0,h.getModuleConstructor)(t).title}\n              </div>`)}\n          </div>`),n=t=>{const n=this.selectedLayout===t,i=this.openLayoutKeys.has(t),r=this.selectedLayout===t,a=this.appState.layouts[t],s=o.html`\n            <div class='info-group-title'>Upper</div>\n            ${e(a.upper)}\n            <div class='info-group-title'>Lower</div>\n            ${e(a.lower)}\n          `,c=this.appState.layouts[t].description||\"\";return this.renderLine(t,()=>o.html`\n            <mwc-formfield label=${t}>\n              <mwc-radio\n                name=\"layouts\"\n                ?checked=${n}\n                @change=${()=>this.selectedLayout=t}>\n              </mwc-radio>\n            </mwc-formfield>\n            `,r,!1,i,()=>{this.toggleInSet(this.openLayoutKeys,t)},!1,s,c)},i=t.map(t=>n(t)),r=o.html`${this.nextPrevButton(\"Dataset\",!1)}`;return this.renderConfigPage(\"Layout\",\"Use a preset layout to optimize your workflow\",i,r)}renderStatus(t=!0,e=!1){const n=t?\"check_circle\":e?\"warning_amber\":\"check_circle_outline\",i=t?\"Selected\":e?\"Incompatible\":\"Compatible\",r=(0,s.classMap)({status:!0,selected:t,error:e});return o.html`\n    <div class=${r}>\n      <mwc-icon>\n        ${n}\n      </mwc-icon>\n      ${i}\n    </div>`}renderLine(t,e,n,i,r,a,c,l,d=\"\"){const h=r?\"expand_less\":\"expand_more\",p=(0,s.classMap)({\"config-line\":!0,selected:n,disabled:i}),f=d.split(\"\\n\")[0],m=(0,u.linkifyUrls)(d,\"_blank\"),g=(0,s.classMap)({\"expanded-info\":!0,open:r}),v=c?this.renderStatus(n,i):\"\";return o.html`\n      <div class=${p}>\n        <div class='one-col'>\n          ${e(t)}\n        </div>\n        <div class='one-col description-preview'>\n         ${(0,u.linkifyUrls)(f,\"_blank\")}\n        </div>\n        <div class='one-col col-end'>\n            ${v}\n          <div class=expander>\n            <mwc-icon @click=${a}>\n              ${h}\n            </mwc-icon>\n          </div>\n        </div>\n      </div>\n      <div class=${g}>\n        <div class='one-col'>\n          <div class='left-offset'>\n            ${l}\n          </div>\n        </div>\n        <div class='two-col'>\n          <div class=info-group-title> Description </div>\n          <div class='description-text'>${m}</div>\n        </div>\n      </div>\n    `}toggleInSet(t,e){t.has(e)?t.delete(e):t.add(e)}nextPrevButton(t,e=!0){const n=e?\"east\":\"west\",i=(0,s.classMap)({\"hairline-button\":!0,[e?\"next\":\"prev\"]:!0});return o.html`\n     <button class=${i} @click=${()=>this.selectedTab=t}>\n      <mwc-icon>${n}</mwc-icon>\n      ${t}\n    </button>\n    `}renderConfigPage(t,e,n,i,r){return o.html`\n      <div class=\"config-title\">${t}</div>\n      <div class=\"description\"> ${e} </div>\n      <div class=\"config-list\">\n        ${n}\n      </div>\n      ${r}\n      <div class='prev-next-buttons'>${i} </div>\n    `}firstUpdated(){document.addEventListener(\"keydown\",t=>{\"Escape\"===t.key&&this.close()})}};i.__decorate([(0,a.property)({type:Boolean}),i.__metadata(\"design:type\",Object)],g.prototype,\"isOpen\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",String)],g.prototype,\"selectedDataset\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",String)],g.prototype,\"selectedLayout\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",Object)],g.prototype,\"modelCheckboxValues\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",String)],g.prototype,\"selectedTab\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",String)],g.prototype,\"pathForDatapoints\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",String)],g.prototype,\"datapointsStatus\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",String)],g.prototype,\"pathForModel\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",String)],g.prototype,\"modelStatus\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",Set)],g.prototype,\"openModelKeys\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",Set)],g.prototype,\"openDatasetKeys\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",Set)],g.prototype,\"openLayoutKeys\",void 0),i.__decorate([c.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],g.prototype,\"selectedModels\",null),i.__decorate([c.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],g.prototype,\"loadDatapointButtonsDisabled\",null),i.__decorate([c.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],g.prototype,\"saveDatapointButtonDisabled\",null),i.__decorate([c.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],g.prototype,\"newDatapoints\",null),i.__decorate([c.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],g.prototype,\"loadModelButtonDisabled\",null),i.__decorate([c.action,i.__metadata(\"design:type\",Function),i.__metadata(\"design:paramtypes\",[]),i.__metadata(\"design:returntype\",void 0)],g.prototype,\"initializeLocalState\",null),i.__decorate([c.action,i.__metadata(\"design:type\",Function),i.__metadata(\"design:paramtypes\",[]),i.__metadata(\"design:returntype\",void 0)],g.prototype,\"submitSettings\",null),g=i.__decorate([(0,a.customElement)(\"lit-global-settings\")],g),e.GlobalSettingsComponent=g},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.ApiService=void 0;const i=n(1);n(5);const r=n(25);n(67);class o extends r.LitService{constructor(t){super(),this.statusService=t}getDataset(t){return i.__awaiter(this,void 0,void 0,(function*(){const e=yield this.queryServer(\"/get_dataset\",{dataset_name:t},[],\"Loading inputs\");if(null==e){const t=\"Failed to load dataset (server returned null).\";throw this.statusService.addError(t),new Error(t)}return e}))}createDataset(t,e){return i.__awaiter(this,void 0,void 0,(function*(){return this.queryServer(\"/create_dataset\",{dataset_name:t,dataset_path:e},[],\"Creating new dataset\")}))}createModel(t,e){return i.__awaiter(this,void 0,void 0,(function*(){return this.queryServer(\"/create_model\",{model_name:t,model_path:e},[],\"Loading new model\")}))}getInfo(){return i.__awaiter(this,void 0,void 0,(function*(){return this.queryServer(\"/get_info\",{},[],\"Loading metadata\")}))}getPreds(t,e,n,i,r){return r=r||\"Fetching predictions\",this.queryServer(\"/get_preds\",{model:e,dataset_name:n,requested_types:i.join(\",\")},t,r)}getGenerated(t,e,n,r,o,a){return i.__awaiter(this,void 0,void 0,(function*(){return a=null!=a?a:\"Loading generator output\",this.queryServer(\"/get_generated\",{model:e,dataset_name:n,generator:r},t,a,o)}))}annotateNewData(t,e){return this.queryServer(\"/annotate_new_data\",{dataset_name:e},t)}getInterpretations(t,e,n,i,r,o){return o=null!=o?o:\"Fetching interpretations\",this.queryServer(\"/get_interpretations\",{model:e,dataset_name:n,interpreter:i},t,o,r)}saveDatapoints(t,e,n){return this.queryServer(\"/save_datapoints\",{dataset_name:e,path:n},t,\"Saving new datapoints\")}loadDatapoints(t,e){return this.queryServer(\"/load_datapoints\",{dataset_name:t,path:e},[],\"Loading new datapoints\")}queryServer(t,e,n,r=\"\",o){return i.__awaiter(this,void 0,void 0,(function*(){const i=this.statusService.startLoading(r),a=n.map(t=>t.meta.added?t:t.id),s=Object.keys(e).map(t=>`${t}=${e[t]}`),c=encodeURI(`.${t}?${s.join(\"&\")}`),l=JSON.stringify({inputs:a,config:o});try{const t=yield fetch(c,{method:\"POST\",body:l});if(!t.ok){const e=yield t.text();throw new Error(e)}const e=yield t.json();return i(),this.statusService.removeError(c),e}catch(t){i();const e=t.message.match(\"^.*?(?=\\n\\nDetails:)\");throw e?this.statusService.addError(e[0],t.toString(),c):this.statusService.addError(\"Unknown error\",t.toString(),c),t}}))}}e.ApiService=o},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.StatusService=void 0;const i=n(1),r=n(4),o=n(8),a=n(25);class s extends a.LitService{constructor(){super(...arguments),this.loadingId=0,this.loadingEvents=new Map,this.errorEvents=new Map}get loadingMessages(){return[...this.loadingEvents.values()]}get errorMessages(){return Array.from(this.errorEvents.values(),t=>t.message)}get errorFullMessages(){return Array.from(this.errorEvents.values(),t=>t.fullMessage)}get hasMessage(){return this.isLoading||this.hasError}get isLoading(){return this.loadingMessages.length>0}get hasError(){return this.errorMessages.length>0}get errorMessage(){if(!this.hasError)return null;let t=this.errorMessages[0];const e=this.errorMessages.length-1;return e>0&&(t+=` (and ${e} other error${e>1?\"s)\":\")\"}`),t}get loadingMessage(){return this.isLoading?this.loadingMessages[0]:\"\"}startLoading(t){const e=this.loadingId;return this.loadingEvents.set(e,t),this.loadingId+=1,()=>{this.endLoading(e)}}endLoading(t){this.loadingEvents.delete(t)}addError(t,e,n){const i=null!=n?n:t,r=(0,o.hashCode)(i);null==e&&(e=t),this.errorEvents.set(r,{message:t,fullMessage:e})}removeError(t){this.errorEvents.delete((0,o.hashCode)(t))}clearErrors(){this.errorEvents.clear()}}i.__decorate([r.observable,i.__metadata(\"design:type\",Object)],s.prototype,\"loadingEvents\",void 0),i.__decorate([r.observable,i.__metadata(\"design:type\",Object)],s.prototype,\"errorEvents\",void 0),i.__decorate([r.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],s.prototype,\"loadingMessages\",null),i.__decorate([r.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],s.prototype,\"errorMessages\",null),i.__decorate([r.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],s.prototype,\"errorFullMessages\",null),i.__decorate([r.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],s.prototype,\"hasMessage\",null),i.__decorate([r.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],s.prototype,\"isLoading\",null),i.__decorate([r.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],s.prototype,\"hasError\",null),i.__decorate([r.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],s.prototype,\"errorMessage\",null),i.__decorate([r.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],s.prototype,\"loadingMessage\",null),e.StatusService=s},function(t,e){var n,i,r=t.exports={};function o(){throw new Error(\"setTimeout has not been defined\")}function a(){throw new Error(\"clearTimeout has not been defined\")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n=\"function\"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{i=\"function\"==typeof clearTimeout?clearTimeout:a}catch(t){i=a}}();var c,l=[],d=!1,u=-1;function h(){d&&c&&(d=!1,c.length?l=c.concat(l):u=-1,l.length&&p())}function p(){if(!d){var t=s(h);d=!0;for(var e=l.length;e;){for(c=l,l=[];++u<e;)c&&c[u].run();u=-1,e=l.length}c=null,d=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function m(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new f(t,e)),1!==l.length||d||s(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title=\"browser\",r.browser=!0,r.env={},r.argv=[],r.version=\"\",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(t){return[]},r.binding=function(t){throw new Error(\"process.binding is not supported\")},r.cwd=function(){return\"/\"},r.chdir=function(t){throw new Error(\"process.chdir is not supported\")},r.umask=function(){return 0}},function(t,e){var n;n=function(){return this}();try{n=n||new Function(\"return this\")()}catch(t){\"object\"==typeof window&&(n=window)}t.exports=n},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.SettingsService=void 0;const i=n(1),r=n(4),o=n(8),a=n(25);n(11);class s extends a.LitService{constructor(t,e,n){super(),this.appState=t,this.modulesService=e,this.selectionService=n,(0,r.reaction)(()=>t.compareExamplesEnabled,t=>{this.modulesService.quickUpdateLayout(this.appState.currentModelSpecs,this.appState.currentDatasetSpec,t)})}isDatasetValidForModels(t,e){return e.every(e=>this.isDatasetValidForModel(t,e))}isDatasetValidForModel(t,e){var n,i;return((null===(i=null===(n=this.appState.metadata)||void 0===n?void 0:n.models)||void 0===i?void 0:i[e].datasets)||[]).includes(t)}updateSettings(t){var e,n,r;return i.__awaiter(this,void 0,void 0,(function*(){this.modulesService.clearLayout(),yield this.raf();const i=null!==(e=t.models)&&void 0!==e?e:this.appState.currentModels,a=null!==(n=t.dataset)&&void 0!==n?n:this.appState.currentDataset,s=null!==(r=t.layoutName)&&void 0!==r?r:this.appState.layoutName,c=!(0,o.arrayContainsSame)(this.appState.currentModels,i),l=a!==this.appState.currentDataset&&a;c&&(yield this.appState.setCurrentModels(i)),l&&(this.selectionService.selectIds([]),this.appState.setCurrentDataset(a,!0)),this.appState.layoutName!==s?(this.appState.layoutName=s,this.modulesService.initializeLayout(this.appState.layout,this.appState.currentModelSpecs,this.appState.currentDatasetSpec,this.appState.compareExamplesEnabled),this.modulesService.renderModules()):this.modulesService.quickUpdateLayout(this.appState.currentModelSpecs,this.appState.currentDatasetSpec,this.appState.compareExamplesEnabled)}))}raf(){return i.__awaiter(this,void 0,void 0,(function*(){return new Promise(t=>{requestAnimationFrame(t)})}))}}i.__decorate([r.action,i.__metadata(\"design:type\",Function),i.__metadata(\"design:paramtypes\",[Object]),i.__metadata(\"design:returntype\",Promise)],s.prototype,\"updateSettings\",null),e.SettingsService=s},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.SpanGraphModuleVertical=e.SpanGraphGoldModuleVertical=e.SpanGraphModule=e.SpanGraphGoldModule=void 0;const i=n(1);n(100),n(72);const r=n(2),o=n(3);n(13);const a=n(4),s=n(12);n(72),n(5);const c=n(8),l=n(7),d=o.css`\n  .outer-container {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    position: relative;\n    overflow: hidden;\n  }\n\n  .token-group {\n    padding-top: 30pt;\n  }\n\n  .field-title {\n    padding: 4px;\n  }\n`,u=[\"SequenceTags\",\"SpanLabels\",\"EdgeLabels\"];function h(t){const e=(0,c.findSpecKeys)(t,u),n=(0,c.findSpecKeys)(t,\"Tokens\"),i={};for(const t of n)i[t]=[];for(const n of e){i[t[n].align].push(n)}return i}function p(t,e){const n=h(e),i={};for(const r of Object.keys(n)){const o=[];for(const i of n[r]){let n=t[i],r=!1;0===n.length&&(n=[]),(0,c.isLitSubtype)(e[i],\"SequenceTags\")?(n=n.map((t,e)=>({span1:[e,e+1],label:t})),r=!0):(0,c.isLitSubtype)(e[i],\"SpanLabels\")&&(n=n.map(t=>({span1:[t.start,t.end],label:t.label}))),o.push({name:i,edges:n,hideBracket:r})}let a=t[r];if(0===a.length){a=t[(0,c.findSpecKeys)(e,\"TextSegment\")[0]].split()}i[r]={tokens:a,layers:o}}return i}function f(t,e,n){const i=h(e);return o.html`${Object.keys(i).map(e=>{var i,r;const a=1===(null===(r=null===(i=t[e])||void 0===i?void 0:i.layers)||void 0===r?void 0:r.length);return o.html`\n      <div id=${e} class=\"token-group\">\n        ${a?o.html`<div class='field-title'>${t[e].layers[0].name}</div>`:null}\n        ${((t,e)=>\"vertical\"===n?o.html`<span-graph-vis-vertical .data=${t} .showLayerLabel=${e}></span-graph-vis-vertical>`:o.html`<span-graph-vis .data=${t} .showLayerLabel=${e}></span-graph-vis>`)(t[e],!a)}\n      </div>\n    `})}`}let m=class extends s.LitModule{get dataSpec(){return this.appState.currentDatasetSpec}get goldDisplayData(){const t=this.selectionService.primarySelectedInputData;return null===t?{}:p(t.data,this.dataSpec)}static get styles(){return[l.styles,d]}render(){const t=!this.appState.compareExamplesEnabled&&this.appState.currentModels.length>1;return o.html`\n      ${t?o.html`<div class='offset-for-module-header'></div>`:null}\n      <div id=\"gold-group\" class='outer-container'>\n        ${f(this.goldDisplayData,this.dataSpec,this.constructor.orientation)}\n      </div>\n    `}static shouldDisplayModule(t,e){const n=(0,c.findSpecKeys)(e,\"Tokens\").length>0,i=(0,c.findSpecKeys)(e,u).length>0;return n&&i}};m.title=\"Structured Prediction (gold)\",m.duplicateForExampleComparison=!0,m.duplicateForModelComparison=!1,m.duplicateAsRow=!1,m.numCols=4,m.template=(t=\"\",e=0)=>o.html`<span-graph-gold-module selectionServiceIndex=${e}></span-graph-gold-module>`,m.orientation=\"horizontal\",i.__decorate([a.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],m.prototype,\"dataSpec\",null),i.__decorate([a.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],m.prototype,\"goldDisplayData\",null),m=i.__decorate([(0,r.customElement)(\"span-graph-gold-module\")],m),e.SpanGraphGoldModule=m;let g=class extends s.LitModule{constructor(){super(...arguments),this.predDisplayData={}}get predSpec(){return this.appState.getModelSpec(this.model).output}updatePredDisplayData(t){return i.__awaiter(this,void 0,void 0,(function*(){if(null===t)this.predDisplayData={};else{const e=this.apiService.getPreds([t],this.model,this.appState.currentDataset,[\"Tokens\"].concat(u)),n=yield this.loadLatest(\"getPreds\",e);if(!n)return;this.predDisplayData=p(n[0],this.predSpec)}}))}static get styles(){return[l.styles,d]}firstUpdated(){this.reactImmediately(()=>this.selectionService.primarySelectedInputData,t=>{this.updatePredDisplayData(t)})}render(){return o.html`\n      <div id=\"pred-group\" class='outer-container'>\n        ${f(this.predDisplayData,this.predSpec,this.constructor.orientation)}\n      </div>\n    `}static shouldDisplayModule(t,e){const n=Object.keys(t);for(let e=0;e<n.length;e++){const i=t[n[e]].spec,r=(0,c.findSpecKeys)(i.output,\"Tokens\").length>0,o=(0,c.findSpecKeys)(i.output,u).length>0;if(r&&o)return!0}return!1}};g.title=\"Structured Prediction (model preds)\",g.duplicateForExampleComparison=!0,g.duplicateAsRow=!1,g.numCols=4,g.template=(t=\"\",e=0)=>o.html`<span-graph-module model=${t} selectionServiceIndex=${e}></span-graph-module>`,g.orientation=\"horizontal\",i.__decorate([a.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],g.prototype,\"predSpec\",null),i.__decorate([a.observable,i.__metadata(\"design:type\",Object)],g.prototype,\"predDisplayData\",void 0),g=i.__decorate([(0,r.customElement)(\"span-graph-module\")],g),e.SpanGraphModule=g;let v=class extends m{};v.duplicateAsRow=!0,v.orientation=\"vertical\",v.numCols=4,v.template=(t=\"\",e=0)=>o.html`<span-graph-gold-module-vertical selectionServiceIndex=${e}></span-graph-gold-module-vertical>`,v=i.__decorate([(0,r.customElement)(\"span-graph-gold-module-vertical\")],v),e.SpanGraphGoldModuleVertical=v;let y=class extends g{};y.duplicateAsRow=!0,y.orientation=\"vertical\",y.template=(t=\"\",e=0)=>o.html`<span-graph-module-vertical model=${t} selectionServiceIndex=${e}></span-graph-module-vertical>`,y=i.__decorate([(0,r.customElement)(\"span-graph-module-vertical\")],y),e.SpanGraphModuleVertical=y},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.SpanGraphVis=void 0;const i=n(1);n(31);const r=n(2),o=n(2),a=n(3),s=n(13),c=n(17),l=n(4),d=n(33),u=n(34);n(5);const h=n(102);function p(t){return\"number\"==typeof t?Number.isInteger(t)?t.toString():t.toFixed(3).toString():\"\"+t}let f=class extends u.ReactiveElement{constructor(){super(...arguments),this.data={tokens:[],layers:[]},this.showLayerLabel=!0,this.columnVisibility={},this.lineHeight=18,this.approxFontSize=this.lineHeight/3,this.viewPad=5}static get styles(){return h.styles}render(){if(!this.data)return\"\";this.shadowRoot.host.style.setProperty(\"--line-height\",this.lineHeight+\"pt\");const t=this.data.tokens,e=t=>(0,s.classMap)({line:!0,token:!0,selected:t===this.selectedTokIdx});return a.html`\n    <div class='holder' >\n      <div class='background-lines'>\n        ${t.map(t=>a.html`<div class=background-line></div>`)}\n      </div>\n      <div class='tokens'>\n          ${t.map((t,n)=>a.html`\n          <div class=${e(n)}\n            @mouseenter=${()=>this.selectedTokIdx=n}\n            @mouseleave=${()=>this.selectedTokIdx=void 0}>\n            ${t}\n          </div>\n          `)}\n      </div>\n      ${this.data.layers.map((t,e)=>this.renderLayer(t,e))}\n    </div>`}renderLayer(t,e){if(!t.edges.length)return a.html``;const n=(0,c.styleMap)({\"--group-color\":(0,d.getVizColor)(\"dark\",e).color}),i=Math.max(t.name.length,...t.edges.map(t=>p(t.label).length))*this.approxFontSize+2*this.viewPad,r=(0,c.styleMap)({width:i+\"pt\"}),o=this.columnVisibility[t.name],l=(0,s.classMap)({column:!0,hidden:o}),u=(0,s.classMap)({\"layer-label-vert\":!0,hidden:o});return a.html`\n    <div class=layer style=${n} @click=${()=>this.columnVisibility[t.name]=!this.columnVisibility[t.name]}>\n      ${this.showLayerLabel?a.html`\n      <div class=${u}>\n        ${t.name}\n      </div>`:null}\n      <div style=${r} class=${l}>\n        ${t.edges.map(e=>this.renderEdge(e,t,i))}\n      </div>\n    </div>\n    `}renderEdge(t,e,n){const i=\"span2\"in t,r=t.span1[0],o=t.span2?t.span2[0]:t.span1[1],l=Math.min(r,o),d=Math.max(r,o),u=(t,e)=>t>=e[0]&&t<e[1],h=void 0!==this.selectedTokIdx,f=u(this.selectedTokIdx,t.span1)||i&&u(this.selectedTokIdx,t.span2),m=i&&this.selectedTokIdx===o,g=i&&this.isChildOfSelected(e,r),v=h&&!(f||m),y=v&&!g,b=p(t.label),_=b.length*this.approxFontSize,x=(0,c.styleMap)({top:r*this.lineHeight+\"pt\",left:i?n-_-this.viewPad+\"pt\":\"\"}),w=(0,s.classMap)({child:m,parent:g,selected:f,gray:y,line:!0,edge:!0}),S=this.lineHeight/8,M=i?(l+.3)*this.lineHeight+(l===r?0:this.viewPad):l*this.lineHeight-S,E=(i?(d+.3)*this.lineHeight+(d===r?0:-this.viewPad):d*this.lineHeight-2*S)-M,T=i?Math.max(E/2,this.lineHeight/2)+\"pt\":\"\",C=i?E/2:3,A=(0,c.styleMap)({top:M+\"pt\",height:E+\"pt\",width:T,\"border-radius\":`0pt ${C}pt ${C}pt 0pt`,left:i?n+10+\"pt\":\"\",visibility:e.hideBracket?\"hidden\":\"visble\"}),O=(0,s.classMap)({\"arrow-head\":!0,bottom:l===o}),k=(0,s.classMap)({child:m,parent:f,gray:v,edge:!0,\"edge-line\":!0});return a.html`\n    <div style=${A} class='${k}'>\n      ${i?a.html`<div class=${O}></div>`:\"\"}\n    </div>\n    <div class=${w}\n      style=${x}>\n      ${b}\n    </div>\n    `}isChildOfSelected(t,e){for(let n=0;n<t.edges.length;n++){const i=t.edges[n];if(i.span2&&this.selectedTokIdx===i.span1[0]&&e===i.span2[0])return!0}return!1}};i.__decorate([(0,r.property)({type:Object}),i.__metadata(\"design:type\",Object)],f.prototype,\"data\",void 0),i.__decorate([(0,r.property)({type:Boolean}),i.__metadata(\"design:type\",Boolean)],f.prototype,\"showLayerLabel\",void 0),i.__decorate([l.observable,i.__metadata(\"design:type\",Number)],f.prototype,\"selectedTokIdx\",void 0),i.__decorate([l.observable,i.__metadata(\"design:type\",Object)],f.prototype,\"columnVisibility\",void 0),i.__decorate([(0,r.property)({type:Number}),i.__metadata(\"design:type\",Number)],f.prototype,\"lineHeight\",void 0),i.__decorate([(0,r.property)({type:Number}),i.__metadata(\"design:type\",Object)],f.prototype,\"approxFontSize\",void 0),i.__decorate([(0,r.property)({type:Number}),i.__metadata(\"design:type\",Number)],f.prototype,\"viewPad\",void 0),f=i.__decorate([(0,o.customElement)(\"span-graph-vis-vertical\")],f),e.SpanGraphVis=f},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.AnnotatedTextVis=void 0;const i=n(1),r=n(2),o=n(2),a=n(3);n(3);const s=n(13),c=n(17),l=n(4),d=n(33),u=n(34),h=n(7),p=n(5),f=n(104);function m(t,e){return e.map((n,i)=>{const r=100*(i+1)/e.length;return`linear-gradient(${t}, ${n} ${r}%, rgba(0,0,0,0) ${r}%)`}).join(\", \")}let g=class extends a.LitElement{constructor(){super(...arguments),this.text=\"\",this.spans=[],this.isURL=!1}static get styles(){return[h.styles,f.styles]}render(){var t,e;const n=new Set;for(const t of this.spans)n.add(t.start),n.add(t.end);let i=[0,...n,this.text.length];i=i.sort((t,e)=>t-e);const r=i.map(()=>[]);for(let t=0;t<this.spans.length;t++){const e=i.indexOf(this.spans[t].start),n=i.indexOf(this.spans[t].end);for(let i=e;i<n;i++)r[i].push(t)}const o=[];for(let n=0;n<i.length-1;n++){const l=this.text.slice(i[n],i[n+1]),d=r[n].map(t=>this.spans[t]),u=(0,s.classMap)({\"span-active\":d.length>0}),h={};d.length>1?h.background=m(\"0deg\",d.map(t=>{var e;return null!==(e=t.color)&&void 0!==e?e:\"#e4f7fb\"})):d.length>0&&(h.background=null!==(e=null===(t=d[0])||void 0===t?void 0:t.color)&&void 0!==e?e:\"#e4f7fb\"),o.push(a.html`<span class=${u} style=${(0,c.styleMap)(h)}>${l}</span>`)}return this.isURL?a.html`<a href=${this.text} target=\"_blank\">${o}</a>`:a.html`${o}`}};i.__decorate([(0,r.property)({type:String}),i.__metadata(\"design:type\",String)],g.prototype,\"text\",void 0),i.__decorate([(0,r.property)({type:Array}),i.__metadata(\"design:type\",Array)],g.prototype,\"spans\",void 0),i.__decorate([(0,r.property)({type:Boolean}),i.__metadata(\"design:type\",Boolean)],g.prototype,\"isURL\",void 0),g=i.__decorate([(0,o.customElement)(\"annotated-text\")],g);let v=class extends u.ReactiveElement{constructor(){super(...arguments),this.segments={},this.segmentSpec={},this.annotations={},this.annotationSpec={},this.annotationVisibility={}}get groupColors(){const t={},e=Object.keys(this.annotationSpec);for(let n=0;n<e.length;n++){t[e[n]]=(0,d.getVizColor)(\"pastel\",n).color}return t}get activeAnnotations(){const t={};for(const e of Object.keys(this.segments))t[e]=[];for(const e of Object.keys(this.annotations))this.annotations[e].forEach((n,i)=>{if(this.annotationVisibility[e].has(i))for(const i of n.spans){const r=Object.assign({},i,{label:`${n.label}${i.label?\":\":\"\"}${i.label}`,align:e,color:this.groupColors[e]});t[i.align].push(r)}});return t}static get styles(){return[h.styles,f.styles]}connectedCallback(){super.connectedCallback(),this.reactImmediately(()=>this.annotations,t=>{var e,n;this.annotationVisibility={};for(const i of Object.keys(t))if(this.annotationVisibility[i]=new Set,null===(e=this.annotationSpec[i])||void 0===e?void 0:e.background);else if(null===(n=this.annotationSpec[i])||void 0===n?void 0:n.exclusive)this.annotationVisibility[i].add(0);else for(let e=0;e<t[i].length;e++)this.annotationVisibility[i].add(e)})}renderTextSegment(t){const e=this.segments[t],n=this.activeAnnotations[t],i=\"URL\"===this.segmentSpec[t].__name__;return a.html`\n      <div class='group'>\n        <div class='group-title'>${t}</div>\n        <annotated-text .text=${e} .spans=${n} ?isURL=${i}>\n        </annotated-text>\n      </div>\n    `}renderCluster(t,e){const n=this.annotations[t][e],i=this.annotationVisibility[t].has(e);return a.html`\n      <div class=${(0,s.classMap)({\"cluster-container\":!0,\"cluster-active\":i})}\n           @click=${()=>{this.annotationVisibility[t].has(e)?this.annotationVisibility[t].delete(e):(this.annotationSpec[t].exclusive&&this.annotationVisibility[t].clear(),this.annotationVisibility[t].add(e))}}>\n        <div class='cluster-label'>${n.label}</div>\n        <div class='cluster-spans'>\n          ${n.spans.map(t=>a.html`<div class='span'>${(0,p.formatSpanLabel)(t)}</div>`)}\n        </div>\n      </div>\n    `}renderAnnotationGroup(t){var e;const n=this.groupColors[t],i=null===(e=this.annotations)||void 0===e?void 0:e[t];return a.html`\n      <div class='group' style=${(0,c.styleMap)({\"--group-color\":n})}>\n        <div class='group-title'>${t}</div>\n        ${i?i.map((e,n)=>this.renderCluster(t,n)):a.html`<span class='no-data'>(no data)</span>`}\n      </div>\n    `}render(){const t=Object.keys(this.segmentSpec).map(t=>this.renderTextSegment(t)),e=Object.keys(this.annotationSpec).map(t=>this.renderAnnotationGroup(t));return a.html`\n      <div class='main-container'>\n        <div class='segments-column'>${t}</div>\n        <div class='annotations-column'>${e}</div>\n      </div>\n    `}};i.__decorate([l.observable,(0,r.property)({type:Object}),i.__metadata(\"design:type\",Object)],v.prototype,\"segments\",void 0),i.__decorate([l.observable,(0,r.property)({type:Object}),i.__metadata(\"design:type\",Object)],v.prototype,\"segmentSpec\",void 0),i.__decorate([l.observable,(0,r.property)({type:Object}),i.__metadata(\"design:type\",Object)],v.prototype,\"annotations\",void 0),i.__decorate([l.observable,(0,r.property)({type:Object}),i.__metadata(\"design:type\",Object)],v.prototype,\"annotationSpec\",void 0),i.__decorate([l.observable,i.__metadata(\"design:type\",Object)],v.prototype,\"annotationVisibility\",void 0),i.__decorate([l.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],v.prototype,\"groupColors\",null),i.__decorate([l.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],v.prototype,\"activeAnnotations\",null),v=i.__decorate([(0,o.customElement)(\"annotated-text-vis\")],v),e.AnnotatedTextVis=v},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.ScoreBar=void 0;const i=n(1),r=n(2),o=n(2),a=n(3),s=n(17);let c=class extends a.LitElement{constructor(){super(...arguments),this.score=0,this.maxScore=1}static get styles(){return a.css`\n        .holder {\n          width: 100px;\n          height: 20px;\n          display: flex;\n          position: relative;\n        }\n\n        .bar {\n          padding-left: .75%;\n          padding-right: .75%;\n          margin-left: .35%;\n          margin-right: .35%;\n          background-color: var(--lit-cyea-300);\n        }\n\n        .text {\n          position: absolute;\n          padding-left: 4px;\n          padding-right: 2px;\n          color: var(--lit-neutral-800);\n        }\n    `}render(){const t={width:90*(this.score/this.maxScore)+\"%\"};return a.html`\n        <div class='holder'>\n          <div class='bar' style='${(0,s.styleMap)(t)}'></div>\n          <div class='text'>${this.score.toFixed(3)}</div>\n        </div>`}};i.__decorate([(0,r.property)({type:Number}),i.__metadata(\"design:type\",Object)],c.prototype,\"score\",void 0),i.__decorate([(0,r.property)({type:Number}),i.__metadata(\"design:type\",Object)],c.prototype,\"maxScore\",void 0),c=i.__decorate([(0,o.customElement)(\"score-bar\")],c),e.ScoreBar=c},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`.group-label {\n  padding: 4px;\n  text-align: start;\n  vertical-align: baseline;\n  width: 250px;\n}\n\n.group-container {\n  padding: 4px;\n  position: relative; /* to allow overlay div */\n  vertical-align: top;\n}\n\n.module-toolbar > * {\n  margin: 0px 4px;\n}\n\n.tokens-holder {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n}\n\n.tokens-group {\n  position: relative;\n}\n\n.salient-token {\n  /* color and background set individually vis styleMap */\n  font-family: 'Roboto';\n  border-radius: 2px;\n  border: 1px solid transparent; /* for spacing */\n  padding: 2px 4px; /* wider horizontally */\n  margin: 3px;\n  width: fit-content;\n}\n\n.salience-tooltip {\n  position: absolute;\n  padding: 5px;\n  margin: auto;\n  text-align: center;\n  transform: translate(-50%, 5px);\n  background-color: #f2f9ff;\n  border-radius: 7px;\n  border-style: solid;\n  border-width: 1px;\n  z-index: 10000;\n  pointer-events: none;\n  visibility: hidden;\n}\n\ntable {\n  border-collapse: collapse;\n  width: 100%;\n}\n\n.method-row {\n  border-top: 1px solid #e8eaed;\n  border-bottom: 1px solid #e8eaed;\n}\n\n.loading {\n  opacity: 0.2;\n  pointer-events: none;\n}\n\n.spinner-container {\n  opacity: 1.0;\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: center;\n}\n`},function(t,e,n){\"use strict\";var i=this&&this.__values||function(t){var e=\"function\"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&\"number\"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")};Object.defineProperty(e,\"__esModule\",{value:!0});var r=function(){function t(t,e){var n,r;void 0===e&&(e=[]),this.points=t,this.metadata=e;var o=t[0].length;if(2!==o&&3!==o)throw new Error(\"Points must be an array of either 2 or 3 dimensional number arrays\");try{for(var a=i(t),s=a.next();!s.done;s=a.next()){if(o!==s.value.length)throw new Error(\"Points must be an array of either 2 or 3 dimensional number arrays\")}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}this.dimensions=o}return t.prototype.setSpriteMetadata=function(t){this.spriteMetadata=t},t}();e.Dataset=r},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.GeneratedTextModule=e.GENERATION_TYPES=void 0;const i=n(1);n(60),n(78);const r=n(2),o=n(3),a=n(13),s=n(4),c=n(12),l=n(78),d=n(79),u=n(7);n(5);const h=n(8),p=n(146);e.GENERATION_TYPES=[\"GeneratedText\",\"GeneratedTextCandidates\"];let f=class extends c.LitModule{constructor(){super(...arguments),this.inputData=null,this.generatedText={},this.referenceScores={},this.diffMode=l.DiffMode.NONE,this.invertDiffs=!1}static get styles(){return[u.styles,d.styles,p.styles]}get referenceFields(){const t=this.appState.currentDatasetSpec,n=this.appState.getModelSpec(this.model).output,i=new Map,r=(0,h.findSpecKeys)(n,e.GENERATION_TYPES);for(const e of r){const r=n[e].parent;r&&t[r]&&i.set(e,r)}return i}get referenceScoreFields(){const t=this.appState.currentDatasetSpec,e=this.appState.getModelSpec(this.model).output,n=new Map,i=(0,h.findSpecKeys)(e,\"ReferenceScores\");for(const r of i){const i=e[r].parent;i&&t[i]&&n.set(r,i)}return n}firstUpdated(){this.reactImmediately(()=>this.selectionService.primarySelectedInputData,t=>{this.updateSelection(t)})}updateSelection(t){return i.__awaiter(this,void 0,void 0,(function*(){if(this.inputData=null,this.generatedText={},this.referenceScores={},null==t)return;const n=this.appState.currentDataset,i=this.apiService.getPreds([t],this.model,n,[...e.GENERATION_TYPES,\"ReferenceScores\"],\"Generating text\"),r=yield this.loadLatest(\"generatedText\",i);if(null===r)return;this.inputData=t.data;const o=this.appState.getModelSpec(this.model).output,a=r[0];for(const t of Object.keys(a))if((0,h.isLitSubtype)(o[t],\"GeneratedText\")&&(this.generatedText[t]=[[a[t],null]]),(0,h.isLitSubtype)(o[t],\"GeneratedTextCandidates\")&&(this.generatedText[t]=a[t]),(0,h.isLitSubtype)(o[t],\"ReferenceScores\")){const e=this.referenceScoreFields.get(t);null!=e?this.referenceScores[e]=a[t]:console.log(`Ignoring ReferenceScores field '${t}' found with no parent in the dataset.`)}}))}renderToolbar(){if(!this.referenceFields.size)return null;const t=this.diffMode!==l.DiffMode.NONE,e=t=>{this.diffMode=t.target.value};return o.html`\n      <div class='module-toolbar'>\n        <div class=\"diff-selector\">\n          Highlight comparison:\n          ${Object.values(l.DiffMode).map(t=>o.html`\n            <input type=\"radio\" name=\"diffSelect\" value=\"${t}\" id='diff${t}'\n             ?checked=${t===this.diffMode} @change=${e}>\n            <label for='diff${t}'>${t}</label>\n          `)}\n        </div>\n        <div class=${(0,a.classMap)({\"switch-container\":!0,\"switch-container-disabled\":!t})}\n          @click=${t?()=>{this.invertDiffs=!this.invertDiffs}:null}>\n          <div class=${t&&!this.invertDiffs?\"highlighted-diff\":\"\"}>\n            Diffs\n          </div>\n          <mwc-switch .checked=${this.invertDiffs} ?disabled=${!t}>\n          </mwc-switch>\n          <div class=${t&&this.invertDiffs?\"highlighted-match\":\"\"}>\n            Matches\n          </div>\n        </div>\n      </div>\n    `}renderOutputGroup(t){var e;const n=null!=t.generated?this.generatedText[t.generated]:[],i=t.reference;let r=null!=i?null===(e=this.inputData)||void 0===e?void 0:e[i]:[];if(void 0!==i){const t=this.appState.getModelSpec(this.model).input;(0,h.isLitSubtype)(t[i],\"ReferenceTexts\")||(r=[[r,null]])}const a=null!=t.referenceModelScores?this.referenceScores[t.referenceModelScores]:[];return o.html`\n      <generated-text-vis .fieldName=${t.generated}\n                          .candidates=${n}\n                          .referenceFieldName=${i}\n                          .referenceTexts=${r}\n                          .referenceModelScores=${a}\n                          .diffMode=${this.diffMode}\n                          ?highlightMatch=${this.invertDiffs}>\n      </generated-text-vis>\n    `}render(){const t=new Set(Object.keys(this.referenceScores)),e=[];for(const n of Object.keys(this.generatedText)){const i={generated:n,reference:this.referenceFields.get(n)};null!=i.reference&&null!=this.referenceScores[i.reference]&&(i.referenceModelScores=i.reference,t.delete(i.reference)),e.push(i)}for(const n of t)e.push({reference:n,referenceModelScores:n});return o.html`\n      <div class='module-container'>\n        ${this.renderToolbar()}\n        <div class=\"module-results-area\">\n          ${e.map(t=>this.renderOutputGroup(t))}\n        </div>\n      </div>\n    `}static shouldDisplayModule(t,n){return(0,h.doesOutputSpecContain)(t,e.GENERATION_TYPES)}};f.title=\"Generated Text\",f.duplicateForExampleComparison=!0,f.duplicateAsRow=!1,f.template=(t=\"\",e=0)=>o.html`\n      <generated-text-module model=${t}\n        selectionServiceIndex=${e}>\n      </generated-text-module>`,i.__decorate([s.observable,i.__metadata(\"design:type\",Object)],f.prototype,\"inputData\",void 0),i.__decorate([s.observable,i.__metadata(\"design:type\",Object)],f.prototype,\"generatedText\",void 0),i.__decorate([s.observable,i.__metadata(\"design:type\",Object)],f.prototype,\"referenceScores\",void 0),i.__decorate([s.observable,i.__metadata(\"design:type\",String)],f.prototype,\"diffMode\",void 0),i.__decorate([s.observable,i.__metadata(\"design:type\",Boolean)],f.prototype,\"invertDiffs\",void 0),i.__decorate([s.computed,i.__metadata(\"design:type\",Map),i.__metadata(\"design:paramtypes\",[])],f.prototype,\"referenceFields\",null),i.__decorate([s.computed,i.__metadata(\"design:type\",Map),i.__metadata(\"design:paramtypes\",[])],f.prototype,\"referenceScoreFields\",null),f=i.__decorate([(0,r.customElement)(\"generated-text-module\")],f),e.GeneratedTextModule=f},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.getTextDiff=e.GeneratedTextVis=e.DiffMode=void 0;const i=n(1),r=i.__importDefault(n(137)),o=n(2),a=n(2),s=n(3),c=n(13),l=n(4),d=n(34),u=n(7),h=n(79);var p;!function(t){t.NONE=\"None\",t.WORD=\"Word\",t.CHAR=\"Character\"}(p=e.DiffMode||(e.DiffMode={}));let f=class extends d.ReactiveElement{constructor(){super(...arguments),this.candidates=[],this.referenceTexts=[],this.referenceModelScores=[],this.diffMode=p.NONE,this.highlightMatch=!1,this.selectedIdx=0,this.selectedRefIdx=0}static get styles(){return[u.styles,h.styles]}get showModelScoreColumn(){return this.referenceModelScores.length>0||this.candidates.filter(t=>null!=t[1]).length>0}get showTargetScoreColumn(){return this.referenceTexts.filter(t=>null!=t[1]).length>0}get showHeader(){return this.showModelScoreColumn||this.showTargetScoreColumn}get textDiff(){if(void 0===this.referenceTexts)return;if(void 0===this.candidates[this.selectedIdx])return;if(this.diffMode===p.NONE)return;const t=this.candidates[this.selectedIdx][0],e=this.diffMode===p.WORD;return m(this.referenceTexts[this.selectedRefIdx][0],t,e)}renderDiffString(t,e){let n=t;if(this.diffMode===p.WORD){const e=t.length-1;n=t.map((t,n)=>n!==e?t.concat(\" \"):t)}return n.map((t,n)=>{const i=(0,c.classMap)({\"highlighted-diff\":!this.highlightMatch&&!e[n],\"highlighted-match\":this.highlightMatch&&e[n]});return s.html`<span class=${i}>${t}</span>`})}renderHeader(){return s.html`\n      <thead>\n      <tr class='output-row'>\n        <th class='field-name'>Field name</th>\n        <td>\n          <div class=\"candidate-row\">\n            ${this.showModelScoreColumn?s.html`\n              <div class='model-score column-header'>Model score</div>\n            `:null}\n            ${this.showTargetScoreColumn?s.html`\n              <div class='reference-score column-header'>Target score</div>\n            `:null}\n            <div class='candidate-text column-header'>Text</div>\n          </div>\n        </td>\n      </tr>\n      </thead>\n    `}renderReferences(){const t=this.referenceTexts.map((t,e)=>{var n,i,r,o;const a=void 0!==this.textDiff&&e===this.selectedRefIdx?this.renderDiffString(this.textDiff.inputStrings,this.textDiff.equal):t[0],l=(0,c.classMap)({\"token-chip-label\":!0,\"candidate-row\":!0,\"candidate-selected\":this.selectedRefIdx===e});return s.html`\n        <div class=${l} @click=${()=>{this.selectedRefIdx=e}}>\n          ${this.showModelScoreColumn?s.html`\n            <div class='model-score' title=\"Model score\">\n              ${null!==(i=null===(n=this.referenceModelScores[e])||void 0===n?void 0:n.toFixed(3))&&void 0!==i?i:null}\n            </div>\n          `:null}\n          ${this.showTargetScoreColumn?s.html`\n            <div class='reference-score' title=\"Reference score\">\n              ${null!==(o=null===(r=t[1])||void 0===r?void 0:r.toFixed(3))&&void 0!==o?o:null}\n            </div>\n          `:null}\n          <div class='candidate-text'>${a}</div>\n        </div>\n      `});return s.html`\n      <tr class='output-row'>\n        <th class='field-name'>${this.referenceFieldName}</th>\n        <td><div class='candidates'>${t}</div></td>\n      </tr>\n    `}renderCandidates(){const t=this.candidates.map((t,e)=>{var n,i;const r=void 0!==this.textDiff&&e===this.selectedIdx?this.renderDiffString(this.textDiff.outputStrings,this.textDiff.equal):t[0],o=(0,c.classMap)({\"token-chip-label\":!0,\"candidate-row\":!0,\"candidate-selected\":this.selectedIdx===e});return s.html`\n        <div class=${o} @click=${()=>{this.selectedIdx=e}}>\n          ${this.showModelScoreColumn?s.html`\n            <div class='model-score'>\n              ${null!==(i=null===(n=t[1])||void 0===n?void 0:n.toFixed(3))&&void 0!==i?i:null}\n            </div>\n          `:null}\n          ${this.showTargetScoreColumn?s.html`\n            <div class='reference-score' title=\"Reference score\">\n            </div>\n          `:null}\n          <div class='candidate-text'>${r}</div>\n        </div>\n      `});return s.html`\n      <tr class='output-row'>\n        <th class='field-name'>${this.fieldName}</th>\n        <td><div class='candidates'>${t}</div></td>\n      </tr>\n    `}render(){return s.html`\n      <div class='output'>\n        <table class='output-table'>\n          ${this.showHeader?this.renderHeader():null}\n          <tbody>\n            ${null!=this.referenceFieldName?this.renderReferences():null}\n            ${null!=this.fieldName?this.renderCandidates():null}\n          </tbody>\n        </table>\n      </div>\n    `}};function m(t,e,n){const i=t.split(\" \"),o=e.split(\" \"),a=(n?new r.default.SequenceMatcher(()=>!1,i,o):new r.default.SequenceMatcher(()=>!1,t,e)).getOpcodes(),s=[],c=[],l=[];for(const r of a){const a=r[0],d=Number(r[1]),u=Number(r[2]),h=Number(r[3]),p=Number(r[4]);l.push(\"equal\"===a),n?(s.push(i.slice(d,u).join(\" \")),c.push(o.slice(h,p).join(\" \"))):(s.push(t.slice(d,u)),c.push(e.slice(h,p)))}return{inputStrings:s,outputStrings:c,equal:l}}i.__decorate([l.observable,(0,o.property)({type:String}),i.__metadata(\"design:type\",String)],f.prototype,\"fieldName\",void 0),i.__decorate([l.observable,(0,o.property)({type:Array}),i.__metadata(\"design:type\",Array)],f.prototype,\"candidates\",void 0),i.__decorate([l.observable,(0,o.property)({type:String}),i.__metadata(\"design:type\",String)],f.prototype,\"referenceFieldName\",void 0),i.__decorate([l.observable,(0,o.property)({type:Array}),i.__metadata(\"design:type\",Array)],f.prototype,\"referenceTexts\",void 0),i.__decorate([l.observable,(0,o.property)({type:Array}),i.__metadata(\"design:type\",Array)],f.prototype,\"referenceModelScores\",void 0),i.__decorate([l.observable,(0,o.property)({type:String}),i.__metadata(\"design:type\",String)],f.prototype,\"diffMode\",void 0),i.__decorate([l.observable,(0,o.property)({type:Boolean}),i.__metadata(\"design:type\",Boolean)],f.prototype,\"highlightMatch\",void 0),i.__decorate([l.observable,(0,o.property)({type:Number}),i.__metadata(\"design:type\",Object)],f.prototype,\"selectedIdx\",void 0),i.__decorate([l.observable,(0,o.property)({type:Number}),i.__metadata(\"design:type\",Object)],f.prototype,\"selectedRefIdx\",void 0),i.__decorate([l.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],f.prototype,\"showModelScoreColumn\",null),i.__decorate([l.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],f.prototype,\"showTargetScoreColumn\",null),i.__decorate([l.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],f.prototype,\"showHeader\",null),i.__decorate([l.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],f.prototype,\"textDiff\",null),f=i.__decorate([(0,a.customElement)(\"generated-text-vis\")],f),e.GeneratedTextVis=f,e.getTextDiff=m},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`.output {\n  margin-bottom: 8px;\n}\n\n.output-table {\n  border-spacing: 0;\n  width: 100%;\n  --score-col-width: 80px;\n}\n\n.output-table thead {\n  position: sticky;\n  top: 0;\n\n  background: #f5fcfc;\n}\n\n.output-table tr {\n  text-align: left;\n  vertical-align: initial;\n}\n\n.output-table tr > * {\n  padding: 4px;\n}\n\n.output-table tbody th {\n  vertical-align: top;\n}\n\n.candidate-row {\n  display: flex;\n  flex-direction: row;\n  width: 100%;\n  box-sizing: border-box;\n  color: var(--lit-gray-800);\n  font-family: 'Roboto', sans;\n\n  padding: 0 2px; /* align with content row hpad */\n}\n\n.candidate-row > * {\n  padding: 4px;\n}\n\n.field-name {\n  width: 100px;\n}\n\n.model-score {\n  margin-right: 8px;\n  width: var(--score-col-width);\n  min-width: var(--score-col-width);\n}\n\n.candidate-text {\n  flex-grow: 1;\n}\n\n.reference-score {\n  margin-right: 8px;\n  width: var(--score-col-width);\n  min-width: var(--score-col-width);\n}\n\n/* use this style instead of .token-chip-label.selected */\n.candidate-selected {\n  border: 1px solid #80868b;\n}\n\n.highlighted-diff {\n  color: #a93d00;\n  font-weight: bold;\n}\n\n.highlighted-match {\n  color: #129eaf;\n  font-weight: bold;\n}\n`},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"IconButtonToggle\",(function(){return f}));var i=n(1),r=n(0);\n/**\n@license\nCopyright 2018 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\nconst o=r.b`.material-icons{font-family:var(--mdc-icon-font, \"Material Icons\");font-weight:normal;font-style:normal;font-size:var(--mdc-icon-size, 24px);line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;font-feature-settings:\"liga\"}.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:transparent;fill:currentColor;color:inherit;font-size:24px;text-decoration:none;cursor:pointer;user-select:none;width:48px;height:48px;padding:12px}.mdc-icon-button svg,.mdc-icon-button img{width:24px;height:24px}.mdc-icon-button:disabled{color:rgba(0,0,0,.38);color:var(--mdc-theme-text-disabled-on-light, rgba(0, 0, 0, 0.38))}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}@keyframes mdc-ripple-fg-radius-in{from{animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transform:translate(var(--mdc-ripple-fg-translate-start, 0)) scale(1)}to{transform:translate(var(--mdc-ripple-fg-translate-end, 0)) scale(var(--mdc-ripple-fg-scale, 1))}}@keyframes mdc-ripple-fg-opacity-in{from{animation-timing-function:linear;opacity:0}to{opacity:var(--mdc-ripple-fg-opacity, 0)}}@keyframes mdc-ripple-fg-opacity-out{from{animation-timing-function:linear;opacity:var(--mdc-ripple-fg-opacity, 0)}to{opacity:0}}.mdc-icon-button{--mdc-ripple-fg-size: 0;--mdc-ripple-left: 0;--mdc-ripple-top: 0;--mdc-ripple-fg-scale: 1;--mdc-ripple-fg-translate-end: 0;--mdc-ripple-fg-translate-start: 0;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mdc-icon-button::before,.mdc-icon-button::after{position:absolute;border-radius:50%;opacity:0;pointer-events:none;content:\"\"}.mdc-icon-button::before{transition:opacity 15ms linear,background-color 15ms linear;z-index:1}.mdc-icon-button.mdc-ripple-upgraded::before{transform:scale(var(--mdc-ripple-fg-scale, 1))}.mdc-icon-button.mdc-ripple-upgraded::after{top:0;left:0;transform:scale(0);transform-origin:center center}.mdc-icon-button.mdc-ripple-upgraded--unbounded::after{top:var(--mdc-ripple-top, 0);left:var(--mdc-ripple-left, 0)}.mdc-icon-button.mdc-ripple-upgraded--foreground-activation::after{animation:mdc-ripple-fg-radius-in 225ms forwards,mdc-ripple-fg-opacity-in 75ms forwards}.mdc-icon-button.mdc-ripple-upgraded--foreground-deactivation::after{animation:mdc-ripple-fg-opacity-out 150ms;transform:translate(var(--mdc-ripple-fg-translate-end, 0)) scale(var(--mdc-ripple-fg-scale, 1))}.mdc-icon-button::before,.mdc-icon-button::after{top:calc(50% - 50%);left:calc(50% - 50%);width:100%;height:100%}.mdc-icon-button.mdc-ripple-upgraded::before,.mdc-icon-button.mdc-ripple-upgraded::after{top:var(--mdc-ripple-top, calc(50% - 50%));left:var(--mdc-ripple-left, calc(50% - 50%));width:var(--mdc-ripple-fg-size, 100%);height:var(--mdc-ripple-fg-size, 100%)}.mdc-icon-button.mdc-ripple-upgraded::after{width:var(--mdc-ripple-fg-size, 100%);height:var(--mdc-ripple-fg-size, 100%)}.mdc-icon-button::before,.mdc-icon-button::after{background-color:#000}.mdc-icon-button:hover::before{opacity:.04}.mdc-icon-button.mdc-ripple-upgraded--background-focused::before,.mdc-icon-button:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:.12}.mdc-icon-button:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mdc-icon-button:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:.12}.mdc-icon-button.mdc-ripple-upgraded{--mdc-ripple-fg-opacity: 0.12}:host{display:inline-block;outline:none}:host([disabled]){pointer-events:none}:host,.mdc-icon-button{vertical-align:top}.mdc-icon-button{width:var(--mdc-icon-button-size, 48px);height:var(--mdc-icon-button-size, 48px);padding:calc((var(--mdc-icon-button-size, 48px) - var(--mdc-icon-size, 24px)) / 2)}.mdc-icon-button>i{position:absolute;top:0;padding-top:inherit}.mdc-icon-button i,.mdc-icon-button svg,.mdc-icon-button img,.mdc-icon-button ::slotted(*){display:block;width:var(--mdc-icon-size, 24px);height:var(--mdc-icon-size, 24px)}.mdc-ripple-upgraded:focus::before,.mdc-ripple-upgraded:focus::after{background-color:currentColor;background-color:var(--mdc-theme-on-primary, currentColor);opacity:.12;opacity:var(--mdc-icon-button-ripple-opacity, 0.12)}`;var a=n(16),s={ICON_BUTTON_ON:\"mdc-icon-button--on\",ROOT:\"mdc-icon-button\"},c={ARIA_LABEL:\"aria-label\",ARIA_PRESSED:\"aria-pressed\",DATA_ARIA_LABEL_OFF:\"data-aria-label-off\",DATA_ARIA_LABEL_ON:\"data-aria-label-on\",CHANGE_EVENT:\"MDCIconButtonToggle:change\"},l=function(t){function e(n){var r=t.call(this,Object(i.__assign)(Object(i.__assign)({},e.defaultAdapter),n))||this;return r.hasToggledAriaLabel=!1,r}return Object(i.__extends)(e,t),Object.defineProperty(e,\"cssClasses\",{get:function(){return s},enumerable:!0,configurable:!0}),Object.defineProperty(e,\"strings\",{get:function(){return c},enumerable:!0,configurable:!0}),Object.defineProperty(e,\"defaultAdapter\",{get:function(){return{addClass:function(){},hasClass:function(){return!1},notifyChange:function(){},removeClass:function(){},getAttr:function(){return null},setAttr:function(){}}},enumerable:!0,configurable:!0}),e.prototype.init=function(){var t=this.adapter_.getAttr(c.DATA_ARIA_LABEL_ON),e=this.adapter_.getAttr(c.DATA_ARIA_LABEL_OFF);if(t&&e){if(null!==this.adapter_.getAttr(c.ARIA_PRESSED))throw new Error(\"MDCIconButtonToggleFoundation: Button should not set `aria-pressed` if it has a toggled aria label.\");this.hasToggledAriaLabel=!0}else this.adapter_.setAttr(c.ARIA_PRESSED,String(this.isOn()))},e.prototype.handleClick=function(){this.toggle(),this.adapter_.notifyChange({isOn:this.isOn()})},e.prototype.isOn=function(){return this.adapter_.hasClass(s.ICON_BUTTON_ON)},e.prototype.toggle=function(t){if(void 0===t&&(t=!this.isOn()),t?this.adapter_.addClass(s.ICON_BUTTON_ON):this.adapter_.removeClass(s.ICON_BUTTON_ON),this.hasToggledAriaLabel){var e=t?this.adapter_.getAttr(c.DATA_ARIA_LABEL_ON):this.adapter_.getAttr(c.DATA_ARIA_LABEL_OFF);this.adapter_.setAttr(c.ARIA_LABEL,e||\"\")}else this.adapter_.setAttr(c.ARIA_PRESSED,\"\"+t)},e}(a.a),d=n(18),u=n(10),h=n(49);\n/**\n * @license\n * Copyright 2018 Google Inc.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n/**\n@license\nCopyright 2019 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\nclass p extends d.a{constructor(){super(...arguments),this.mdcFoundationClass=l,this.label=\"\",this.disabled=!1,this.onIcon=\"\",this.offIcon=\"\",this.on=!1}createAdapter(){return Object.assign(Object.assign({},Object(d.b)(this.mdcRoot)),{getAttr:t=>this.mdcRoot.getAttribute(t),setAttr:(t,e)=>{this.mdcRoot.setAttribute(t,e)},notifyChange:t=>{this.dispatchEvent(new CustomEvent(\"MDCIconButtonToggle:change\",{detail:t,bubbles:!0}))}})}handleClick(){this.on=!this.on,this.mdcFoundation.handleClick()}focus(){this.mdcRoot.focus()}render(){return r.e`\n      <button\n        .ripple=\"${Object(h.a)()}\"\n        class=\"mdc-icon-button\"\n        @click=\"${this.handleClick}\"\n        aria-hidden=\"true\"\n        aria-label=\"${this.label}\"\n        ?disabled=\"${this.disabled}\">\n        <span class=\"mdc-icon-button__icon\">\n          <slot name=\"offIcon\">\n            <i class=\"material-icons\">${this.offIcon}</i>\n          </slot>\n        </span>\n        <span class=\"mdc-icon-button__icon mdc-icon-button__icon--on\">\n          <slot name=\"onIcon\">\n            <i class=\"material-icons\">${this.onIcon}</i>\n          </slot>\n        </span>\n      </button>`}}Object(i.__decorate)([Object(r.h)(\".mdc-icon-button\")],p.prototype,\"mdcRoot\",void 0),Object(i.__decorate)([Object(r.g)({type:String})],p.prototype,\"label\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean,reflect:!0})],p.prototype,\"disabled\",void 0),Object(i.__decorate)([Object(r.g)({type:String})],p.prototype,\"onIcon\",void 0),Object(i.__decorate)([Object(r.g)({type:String})],p.prototype,\"offIcon\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean,reflect:!0}),Object(u.a)((function(t){this.mdcFoundation.toggle(t)}))],p.prototype,\"on\",void 0);\n/**\n@license\nCopyright 2019 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\nlet f=class extends p{};f.styles=o,f=Object(i.__decorate)([Object(r.c)(\"mwc-icon-button-toggle\")],f)},function(t,e,n){\"use strict\";var i=n(1),r=n(0),o=n(18),a=n(64),s=n(29),c=n(9);\n/**\n * @license\n * Copyright (c) 2018 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nconst l=new WeakMap,d=Object(c.f)(t=>e=>{if(!(e instanceof c.a)||e instanceof c.e||\"style\"!==e.committer.name||e.committer.parts.length>1)throw new Error(\"The `styleMap` directive must be used in the style attribute and must be the only part in the attribute.\");const{committer:n}=e,{style:i}=n.element;let r=l.get(e);void 0===r&&(i.cssText=n.strings.join(\" \"),l.set(e,r=new Set)),r.forEach(e=>{e in t||(r.delete(e),-1===e.indexOf(\"-\")?i[e]=null:i.removeProperty(e))});for(const e in t)r.add(e),-1===e.indexOf(\"-\")?i[e]=t[e]:i.setProperty(e,t[e])});\n/**\n@license\nCopyright 2018 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\nclass u extends o.a{constructor(){super(...arguments),this.primary=!1,this.accent=!1,this.unbounded=!1,this.disabled=!1,this.activated=!1,this.selected=!1,this.hovering=!1,this.bgFocused=!1,this.fgActivation=!1,this.fgDeactivation=!1,this.fgScale=\"\",this.fgSize=\"\",this.translateStart=\"\",this.translateEnd=\"\",this.leftPos=\"\",this.topPos=\"\",this.mdcFoundationClass=a.a}get isActive(){return(this.parentElement||this).matches(\":active\")}createAdapter(){return{browserSupportsCssVars:()=>!0,isUnbounded:()=>this.unbounded,isSurfaceActive:()=>this.isActive,isSurfaceDisabled:()=>this.disabled,addClass:t=>{switch(t){case\"mdc-ripple-upgraded--background-focused\":this.bgFocused=!0;break;case\"mdc-ripple-upgraded--foreground-activation\":this.fgActivation=!0;break;case\"mdc-ripple-upgraded--foreground-deactivation\":this.fgDeactivation=!0}},removeClass:t=>{switch(t){case\"mdc-ripple-upgraded--background-focused\":this.bgFocused=!1;break;case\"mdc-ripple-upgraded--foreground-activation\":this.fgActivation=!1;break;case\"mdc-ripple-upgraded--foreground-deactivation\":this.fgDeactivation=!1}},containsEventTarget:()=>!0,registerInteractionHandler:()=>{},deregisterInteractionHandler:()=>{},registerDocumentInteractionHandler:()=>{},deregisterDocumentInteractionHandler:()=>{},registerResizeHandler:()=>{},deregisterResizeHandler:()=>{},updateCssVariable:(t,e)=>{switch(t){case\"--mdc-ripple-fg-scale\":this.fgScale=e;break;case\"--mdc-ripple-fg-size\":this.fgSize=e;break;case\"--mdc-ripple-fg-translate-end\":this.translateEnd=e;break;case\"--mdc-ripple-fg-translate-start\":this.translateStart=e;break;case\"--mdc-ripple-left\":this.leftPos=e;break;case\"--mdc-ripple-top\":this.topPos=e}},computeBoundingRect:()=>(this.parentElement||this).getBoundingClientRect(),getWindowPageOffset:()=>({x:window.pageXOffset,y:window.pageYOffset})}}startPress(t){this.waitForFoundation(()=>{this.mdcFoundation.activate(t)})}endPress(){this.waitForFoundation(()=>{this.mdcFoundation.deactivate()})}startFocus(){this.waitForFoundation(()=>{this.mdcFoundation.handleFocus()})}endFocus(){this.waitForFoundation(()=>{this.mdcFoundation.handleBlur()})}startHover(){this.hovering=!0}endHover(){this.hovering=!1}waitForFoundation(t){this.mdcFoundation?t():this.updateComplete.then(t)}render(){const t={\"mdc-ripple-upgraded--unbounded\":this.unbounded,\"mdc-ripple-upgraded--background-focused\":this.bgFocused,\"mdc-ripple-upgraded--foreground-activation\":this.fgActivation,\"mdc-ripple-upgraded--foreground-deactivation\":this.fgDeactivation,hover:this.hovering,primary:this.primary,accent:this.accent,disabled:this.disabled,activated:this.activated,selected:this.selected};return r.e`\n        <div class=\"mdc-ripple-surface mdc-ripple-upgraded ${Object(s.a)(t)}\"\n          style=\"${d({\"--mdc-ripple-fg-scale\":this.fgScale,\"--mdc-ripple-fg-size\":this.fgSize,\"--mdc-ripple-fg-translate-end\":this.translateEnd,\"--mdc-ripple-fg-translate-start\":this.translateStart,\"--mdc-ripple-left\":this.leftPos,\"--mdc-ripple-top\":this.topPos})}\"></div>`}}Object(i.__decorate)([Object(r.h)(\".mdc-ripple-surface\")],u.prototype,\"mdcRoot\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],u.prototype,\"primary\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],u.prototype,\"accent\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],u.prototype,\"unbounded\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],u.prototype,\"disabled\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],u.prototype,\"activated\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],u.prototype,\"selected\",void 0),Object(i.__decorate)([Object(r.f)()],u.prototype,\"hovering\",void 0),Object(i.__decorate)([Object(r.f)()],u.prototype,\"bgFocused\",void 0),Object(i.__decorate)([Object(r.f)()],u.prototype,\"fgActivation\",void 0),Object(i.__decorate)([Object(r.f)()],u.prototype,\"fgDeactivation\",void 0),Object(i.__decorate)([Object(r.f)()],u.prototype,\"fgScale\",void 0),Object(i.__decorate)([Object(r.f)()],u.prototype,\"fgSize\",void 0),Object(i.__decorate)([Object(r.f)()],u.prototype,\"translateStart\",void 0),Object(i.__decorate)([Object(r.f)()],u.prototype,\"translateEnd\",void 0),Object(i.__decorate)([Object(r.f)()],u.prototype,\"leftPos\",void 0),Object(i.__decorate)([Object(r.f)()],u.prototype,\"topPos\",void 0);\n/**\n@license\nCopyright 2018 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\nconst h=r.b`@keyframes mdc-ripple-fg-radius-in{from{animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transform:translate(var(--mdc-ripple-fg-translate-start, 0)) scale(1)}to{transform:translate(var(--mdc-ripple-fg-translate-end, 0)) scale(var(--mdc-ripple-fg-scale, 1))}}@keyframes mdc-ripple-fg-opacity-in{from{animation-timing-function:linear;opacity:0}to{opacity:var(--mdc-ripple-fg-opacity, 0)}}@keyframes mdc-ripple-fg-opacity-out{from{animation-timing-function:linear;opacity:var(--mdc-ripple-fg-opacity, 0)}to{opacity:0}}:host{display:block;position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%;pointer-events:none}.primary{--mdc-ripple-color: var(--mdc-theme-primary, #6200ee)}.accent{--mdc-ripple-color: var(--mdc-theme-secondary, #018786)}.mdc-ripple-surface{top:0;bottom:0;left:0;right:0;width:100%;height:100%;pointer-events:none;--mdc-ripple-fg-size: 0;--mdc-ripple-left: 0;--mdc-ripple-top: 0;--mdc-ripple-fg-scale: 1;--mdc-ripple-fg-translate-end: 0;--mdc-ripple-fg-translate-start: 0;-webkit-tap-highlight-color:rgba(0,0,0,0);position:relative;outline:none;overflow:hidden;--mdc-ripple-fg-opacity: var(--mdc-ripple-press-opacity, 0.12)}.mdc-ripple-surface::before,.mdc-ripple-surface::after{position:absolute;border-radius:50%;opacity:0;pointer-events:none;content:\"\"}.mdc-ripple-surface::before{transition:opacity 15ms linear,background-color 15ms linear;z-index:1}.mdc-ripple-surface.mdc-ripple-upgraded::before{transform:scale(var(--mdc-ripple-fg-scale, 1))}.mdc-ripple-surface.mdc-ripple-upgraded::after{top:0;left:0;transform:scale(0);transform-origin:center center}.mdc-ripple-surface.mdc-ripple-upgraded--unbounded::after{top:var(--mdc-ripple-top, 0);left:var(--mdc-ripple-left, 0)}.mdc-ripple-surface.mdc-ripple-upgraded--foreground-activation::after{animation:mdc-ripple-fg-radius-in 225ms forwards,mdc-ripple-fg-opacity-in 75ms forwards}.mdc-ripple-surface.mdc-ripple-upgraded--foreground-deactivation::after{animation:mdc-ripple-fg-opacity-out 150ms;transform:translate(var(--mdc-ripple-fg-translate-end, 0)) scale(var(--mdc-ripple-fg-scale, 1))}.mdc-ripple-surface::before,.mdc-ripple-surface::after{top:calc(50% - 100%);left:calc(50% - 100%);width:200%;height:200%}.mdc-ripple-surface.mdc-ripple-upgraded::after{width:var(--mdc-ripple-fg-size, 100%);height:var(--mdc-ripple-fg-size, 100%)}.mdc-ripple-surface.mdc-ripple-upgraded--unbounded{overflow:visible}.mdc-ripple-surface.mdc-ripple-upgraded--unbounded::before,.mdc-ripple-surface.mdc-ripple-upgraded--unbounded::after{top:calc(50% - 50%);left:calc(50% - 50%);width:100%;height:100%}.mdc-ripple-surface.mdc-ripple-upgraded--unbounded.mdc-ripple-upgraded::before,.mdc-ripple-surface.mdc-ripple-upgraded--unbounded.mdc-ripple-upgraded::after{top:var(--mdc-ripple-top, calc(50% - 50%));left:var(--mdc-ripple-left, calc(50% - 50%));width:var(--mdc-ripple-fg-size, 100%);height:var(--mdc-ripple-fg-size, 100%)}.mdc-ripple-surface.mdc-ripple-upgraded--unbounded.mdc-ripple-upgraded::after{width:var(--mdc-ripple-fg-size, 100%);height:var(--mdc-ripple-fg-size, 100%)}.mdc-ripple-surface.hover::before{opacity:.04;opacity:var(--mdc-ripple-hover-opacity, 0.04)}.mdc-ripple-surface.mdc-ripple-upgraded--background-focused::before{opacity:.12;opacity:var(--mdc-ripple-focus-opacity, 0.12)}.mdc-ripple-surface::before,.mdc-ripple-surface::after{background-color:#000;background-color:var(--mdc-ripple-color, #000)}.mdc-ripple-surface.activated::before{opacity:.12;opacity:var(--mdc-ripple-activated-opacity, 0.12)}.mdc-ripple-surface.activated.hover::before{opacity:.16;opacity:calc(var(--mdc-ripple-hover-opacity, 0.04) + var(--mdc-ripple-activated-opacity, 0.12))}.mdc-ripple-surface.activated.mdc-ripple-upgraded--background-focused::before{opacity:.24;opacity:calc(var(--mdc-ripple-focus-opacity, 0.12) + var(--mdc-ripple-activated-opacity, 0.12))}.mdc-ripple-surface.activated{--mdc-ripple-press-opacity: calc(var(--mdc-ripple-press-opacity, 0.12) + 0.12)}.mdc-ripple-surface.selected::before{opacity:.08;opacity:var(--mdc-ripple-selected-opacity, 0.08)}.mdc-ripple-surface.selected.hover::before{opacity:.12;opacity:calc(var(--mdc-ripple-hover-opacity, 0.04) + var(--mdc-ripple-selected-opacity, 0.08))}.mdc-ripple-surface.selected.mdc-ripple-upgraded--background-focused::before{opacity:.2;opacity:calc(var(--mdc-ripple-focus-opacity, 0.12) + var(--mdc-ripple-selected-opacity, 0.08))}.mdc-ripple-surface.selected{--mdc-ripple-press-opacity: calc(var(--mdc-ripple-press-opacity, 0.12) + 0.08)}.mdc-ripple-surface.disabled{--mdc-ripple-color: transparent}`;\n/**\n@license\nCopyright 2018 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/let p=class extends u{};p.styles=h,p=Object(i.__decorate)([Object(r.c)(\"mwc-ripple\")],p)},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),n(83);const i=n(15),r=n(99);i.app.initialize(r.LAYOUTS)},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.AppComponent=void 0;const i=n(1);n(84),n(87),n(93);const r=n(35),o=n(2),a=n(3),s=n(11),c=n(15),l=n(98);let d=class extends r.MobxLitElement{constructor(){super(...arguments),this.appState=c.app.getService(s.AppState)}static get styles(){return[l.styles]}render(){return a.html`\n      <lit-app-toolbar></lit-app-toolbar>\n      <!-- Main content -->\n      ${this.appState.initialized?a.html`<lit-modules></lit-modules>`:null}\n      <lit-app-statusbar></lit-app-statusbar>\n    `}};d=i.__decorate([(0,o.customElement)(\"lit-app\")],d),e.AppComponent=d},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.StatusbarComponent=void 0;const i=n(1);n(31),n(65),n(42);const r=n(35),o=n(2),a=n(3),s=n(13),c=n(4),l=n(7),d=n(11),u=n(15),h=n(86);let p=class extends r.MobxLitElement{constructor(){super(...arguments),this.statusService=u.app.getService(d.StatusService),this.renderFullMessages=!1}static get styles(){return[l.styles,h.styles]}render(){const t=(0,s.classMap)({\"progress-line\":this.statusService.isLoading,\"no-progress-line\":!this.statusService.isLoading});return a.html`\n      <div id=\"at-bottom\">\n        <div class=\"toolbar\">\n          <div class=\"text-line\">\n            <div class=\"status-info\">\n              ${this.statusService.hasMessage?this.renderMessages():null}\n            </div>\n            <div class=\"signature\">\n              <div>Made with <img src=\"static/favicon.png\" class=\"emoji\"> by the LIT team</div>\n              <div title=\"Send feedback\" id=\"feedback\">\n                <a href=\"https://github.com/PAIR-code/lit/issues/new\" target=\"_blank\">\n                  <mwc-icon class=\"icon-button\">\n                    feedback\n                  </mwc-icon>\n                </a>\n              </div>\n            </div>\n          </div>\n          <div class=${t}></div>\n        </div>\n      </div>\n      ${this.renderFullMessages?this.renderPopup():null}\n    `}renderMessages(){return a.html`\n      ${this.statusService.hasError?this.renderError():this.renderLoading()}\n    `}renderPopup(){const t=()=>{this.renderFullMessages=!1};return a.html`\n      <div class='modal-container'>\n        <div class=\"model-overlay\" @click=${()=>{t()}}></div>\n        <div class='modal'>\n          <div class='error-message-header'>Error Details</div>\n          <div class='error-message-holder'>\n            ${this.statusService.errorFullMessages.map(t=>a.html`<div class=\"error-message\">${t}</div>`)}\n          </div>\n          <div class='close-button-holder'>\n            <button class='hairline-button' @click=${()=>{t()}}>\n              Close\n            </button>\n          </div>\n        </div>\n      </div>`}renderError(){const t=()=>{this.renderFullMessages=!0};return a.html`\n     <div class=\"error\" @click=${t}>\n        ${this.statusService.errorMessage}\n      </div>\n      <mwc-icon class=\"icon-button error\" @click=${t}>\n        info\n      </mwc-icon>\n      <mwc-icon class=\"icon-button error\" @click=${()=>{this.statusService.clearErrors()}}>\n        clear\n      </mwc-icon>\n    `}renderLoading(){return a.html`\n      <div>${this.statusService.loadingMessage}</div>\n    `}};i.__decorate([c.observable,i.__metadata(\"design:type\",Object)],p.prototype,\"renderFullMessages\",void 0),p=i.__decorate([(0,o.customElement)(\"lit-app-statusbar\")],p),e.StatusbarComponent=p},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`#global-settings-holder {\n  width: 0;\n  height: 0;\n  z-index: 4;\n  position: fixed;\n}\n\n#overlay {\n  background: rgba(4, 29, 51, .47);\n  width: 100vw;\n  height: 100vh;\n  top: 0;\n  left: 0;\n  transition: opacity 250ms;\n}\n\n#overlay.hide {\n  opacity: 0;\n  visibility: hidden;\n}\n\n#global-settings {\n  position: absolute;\n  top: 12vh;\n  left: 10vw;\n  height: 80vh;\n  width: 80vw;\n  box-sizing: border-box;\n  background-color: white;\n  box-shadow: 0 2px 2px 0 rgba(0, 0, 0, .14), 0 3px 1px -2px rgba(0, 0, 0, .2), 0 1px 5px 0 rgba(0, 0, 0, .12);\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n}\n\n#global-settings.hide {\n  display: none;\n}\n\n#holder {\n  display: flex;\n  height: calc(100% - 48pt);\n}\n\n#title-bar {\n  font-family: 'Google Sans', sans;\n  border-bottom: 1px solid #dadce0;\n  font-size: 18pt;\n  line-height: 24pt;\n  padding: 12pt;\n}\n\n#sidebar {\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  width: 220pt;\n  border-right: 1px solid #dadce0;\n}\n\n#links {\n  font-family: 'Google Sans', sans;\n  display: flex;\n  justify-content: center;\n  color: grey;\n  border-top: 1px solid #dadce0;\n  height: 60px;\n  align-items: center;\n}\n\na {\n  color: var(--app-dark-text-color);\n  text-decoration: none;\n}\n\na.link-out {\n  color: #888;\n  padding: 0 5pt;\n}\n\nmwc-icon {\n  padding-right: 5pt;\n}\n\na:hover {\n  opacity: 0.5;\n}\n\n.tab{\n  font-family: 'Google Sans', sans;\n  padding: 12pt;\n  height: 12pt;\n  border-top-right-radius: 24pt;\n  border-bottom-right-radius: 24pt;\n  margin: 6pt;\n  margin-left: 0;\n  cursor: pointer;\n}\n.tab:hover {\n  background: #f4fcfe;\n  color: #129eaf;\n}\n.tab.selected {\n  background: #e4f7fb;\n  color: #129eaf\n}\n\n#main-panel {\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  width: 100%;\n  min-width: 0;\n}\n\n#bottombar {\n  display: flex;\n  justify-content: space-between;\n  border-top: 1px solid #dadce0;\n  height: 60px;\n  align-items: center;\n  padding: 0 24pt;\n}\n\n#state {\n  font-size: 9pt;\n  color: #888;\n}\n.info {\n  color: #098591;\n}\n\n#buttons-container,\n#buttons {\n  display: flex;\n  align-items: center;\n}\n\n.checkbox {\n  width: 48px;\n  height: 48px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n#bottom-message {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 5pt;\n}\n\n#config {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  flex: 1;\n  min-height: 0;\n}\n\n.config-list {\n  border: 1px solid #dadce0;\n  margin: 12pt;\n  overflow: auto;\n  height: 100%;\n}\n\n.config-line {\n  width: 100%;\n  min-width: max-content;\n  border-bottom: 1px solid #dadce0;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  min-width: 0;\n}\n\n.config-line.selected {\n  background: #e4f7fb;\n}\n.config-line.disabled mwc-formfield,\n.config-line.disabled .description-preview,\n.config-line.disabled .status{\n  opacity: 0.5;\n}\n.config-line:hover {\n  background: #f4fcfe;\n}\n\n.rows-title {\n  display: flex;\n}\n\n.expander {\n  cursor: pointer;\n  padding-right: 5pt;\n}\n\n.left-offset {\n  margin-left: 40pt;\n}\n\n.expanded-info {\n  display: flex;\n  max-height: 0;\n  background: #f8f9fa;\n  overflow: hidden;\n  font-size: 8pt;\n  color: #3c4043;\n  box-sizing: border-box;\n}\n\n.datapoints-line {\n  width: 100%;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-between;\n}\n\n.datapoints-label-holder {\n  flex: 1;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-between;\n  margin-left: 16px;\n}\n\n.datapoints-file-input {\n  flex: 1;\n  height: 22px;\n  margin-left: 8px;\n  margin-right: 4px;\n}\n\n.expanded-info.open {\n  padding: 6px 6px 6px 0;\n  max-height: 25vh;\n  overflow: auto;\n  border-bottom: 1px solid #dadce0;\n}\n\n.expanded-info mwc-icon {\n  font-size: 10pt !important;\n}\n\n.info-group-title {\n  text-transform: uppercase;\n  padding-top: 8px;\n  padding-bottom: 4px;\n}\n\n.info-group-title:first-child {\n  padding-top: 0px;\n}\n\n.info-group-subtitle {\n  font-style: italic;\n}\n\n.info-line {\n  align-items: center;\n  display: flex;\n}\n\n.indent-line {\n  padding-left: 5pt;\n  border-left: 1px solid #dadce0;\n}\n\n.error {\n  color: #c5221f !important;\n}\n\n.config-title {\n  font-family: 'Google Sans', sans;\n  font-size: 1.5rem;\n  padding: 12pt 12pt 0 12pt;\n  margin-bottom: 4px;\n}\n\n.description {\n  padding: 0 12pt 0 12pt;\n  color: #888;\n}\n\n.description-text {\n  white-space: pre-wrap; /* preserve newlines */\n}\n\n.status {\n  padding: 0 12pt;\n  color: #888;\n  display: flex;\n  align-items: center;\n}\n\n.status.selected {\n  color: #129eaf;\n}\n.status mwc-icon {\n}\n\n.prev-next-buttons {\n  margin: 16px 12px; /* 12px acounts for .hairline-button margin */\n}\n\nbutton mwc-icon {\n  font-size: 12pt;\n}\n\nbutton.next {\n  float: right;\n}\n\nbutton.prev {\n  float: left;\n}\n\n.one-col {\n  width: 33%;\n  flex: 1;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.two-col {\n  width: 66%;\n  flex: 2;\n  display: flex;\n  flex-direction: column;\n}\n\n.col-end {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: flex-end;\n}\n`},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`:host {\n  height: 24px;\n}\n\n#at-bottom {\n  bottom: 0;\n  position: sticky;\n  z-index: 1;\n}\n\n.text-line {\n  display: flex;\n  justify-content: space-between;\n  height: 20px;\n  padding-top:2px\n}\n\n.toolbar {\n  border-top: 1px solid var(--lit-cyea-300);\n  background-color: var(--lit-majtonal-p-50);\n  width: 100vw;\n  color: var(--lit-cyea-700);\n  font-size: 10pt;\n}\n\n.status-info {\n  display: flex;\n  padding-left: 10px;\n}\n\n.status-info > * {\n  margin: 0 2px;\n}\n\n.error {\n  color: red;\n  cursor: pointer;\n}\n\n.icon-button.error {\n  color: red;\n}\n\nmwc-icon.icon-button {\n  height: 18px;\n  width: 18px;\n  min-width: 18px;\n  --mdc-icon-size: 18px;\n  cursor: pointer;\n  color: var(--lit-cyea-800);\n}\n\nmwc-icon.icon-button:hover {\n  color: var(--lit-cyea-600);\n}\n\n.emoji {\n  height: 10pt;\n  margin-bottom: -5px;\n  padding: 2pt 0;\n}\n\n.signature {\n  font-family: 'Google Sans', sans;\n  padding-right: 10px;\n  display: flex;\n}\n\n#feedback {\n  margin-left: 8px;\n}\n\n.no-progress-line {\n  height: 2px;\n  width: 100%;\n  margin: 0;\n  background-color: #e4f7fb;\n}\n\n.progress-line, .progress-line:before {\n  height: 2px;\n  width: 100%;\n  margin: 0;\n}\n\n.progress-line {\n  background-color: #2f8c9b;\n  display: -webkit-flex;\n  display: flex;\n}\n\n.progress-line:before {\n  background-color: #e4f7fb;\n  content: '';\n  -webkit-animation: running-progress 2s cubic-bezier(0.4, 0, 0.2, 1) infinite;\n  animation: running-progress 2s cubic-bezier(0.4, 0, 0.2, 1) infinite;\n}\n\n.modal-container {\n  width: 100%;\n  height: 100%;\n  top: 0;\n  z-index: 4;\n  position: fixed;\n}\n\n.modal {\n  position: absolute;\n  top: 12vh;\n  left: 10vw;\n  height: 80vh;\n  width: 80vw;\n  box-sizing: border-box;\n  background-color: white;\n  box-shadow: 0 2px 2px 0 rgba(0, 0, 0, .14), 0 3px 1px -2px rgba(0, 0, 0, .2), 0 1px 5px 0 rgba(0, 0, 0, .12);\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n}\n\n.model-overlay {\n  background: rgba(4, 29, 51, .47);\n  width: 100vw;\n  height: 100vh;\n  top: 0;\n  left: 0;\n  transition: opacity 250ms;\n}\n\n.close-button-holder {\n  display: flex;\n  justify-content: flex-end;\n  margin: 10px;\n}\n\n.error-message-header {\n  font-family: 'Google Sans', sans;\n  font-size: 1.5rem;\n  margin: 16px 8px;\n}\n\n.error-message-holder {\n  margin: 0 8px;\n  height: 100%;\n  overflow: auto;\n}\n\n.error-message {\n  font-family: monospace;\n  white-space: pre;\n}\n\n@-webkit-keyframes running-progress {\n  0% { margin-left: 0; margin-right: 100%; }\n  50% { margin-left: 25%; margin-right: 0%; }\n  100% { margin-left: 100%; margin-right: 0; }\n}\n\n@keyframes running-progress {\n  0% { margin-left: 0; margin-right: 100%; }\n  50% { margin-left: 25%; margin-right: 0%; }\n  100% { margin-left: 100%; margin-right: 0; }\n}\n`},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.ToolbarComponent=void 0;const i=n(1);n(31),n(65),n(88);const r=n(35),o=n(2),a=n(2),s=n(3),c=n(13),l=n(7),d=n(5),u=n(8),h=n(11),p=n(15),f=n(92),m=n(65);let g=class extends r.MobxLitElement{constructor(){super(...arguments),this.appState=p.app.getService(h.AppState),this.settingsService=p.app.getService(h.SettingsService),this.statusService=p.app.getService(h.StatusService),this.modulesService=p.app.getService(h.ModulesService)}static get styles(){return[l.styles,f.styles]}toggleGlobalSettings(){void 0!==this.globalSettingsElement&&(this.globalSettingsElement.isOpen?this.globalSettingsElement.close():this.globalSettingsElement.open())}jumpToSettingsTab(t){void 0!==this.globalSettingsElement&&(this.globalSettingsElement.isOpen&&this.globalSettingsElement.selectedTab===t?this.globalSettingsElement.close():(this.globalSettingsElement.selectedTab=t,this.globalSettingsElement.open()))}renderStatusAndTitle(){let t=\"Language Interpretability Tool\";return this.appState.initialized&&this.appState.metadata.pageTitle&&(t=this.appState.metadata.pageTitle),s.html`\n      <div id=\"title-group\">\n        <a href=\"https://github.com/PAIR-code/lit/issues/new\" target=\"_blank\">\n          ${this.statusService.hasError?s.html`<img src=\"static/potato.svg\" class=\"status-emoji\">`:s.html`<img src=\"static/favicon.png\" class=\"status-emoji\">`}\n        </a>\n        ${t}\n      </div>\n    `}renderModelInfo(){const t=Object.keys(this.appState.metadata.models).filter(t=>this.settingsService.isDatasetValidForModels(this.appState.currentDataset,[t]));if(2<=t.length&&t.length<=4){const e=t.map(t=>{const e=this.appState.currentModels.includes(t),n={\"headline-button\":!0,unselected:!e,selected:e},i=e?\"check_box\":\"check_box_outline_blank\";return s.html`\n          <button class=${(0,c.classMap)(n)} title=\"${t}\"\n            @click=${()=>{const e=new Set(this.appState.currentModels);e.has(t)?e.delete(t):e.add(t),this.settingsService.updateSettings({models:[...e]}),this.requestUpdate()}}>\n            <span class='material-icon'>${i}</span>\n            &nbsp;${t}\n          </button>\n        `});return s.html`\n        ${e}\n        <button class='headline-button' title=\"Select model(s)\"\n          @click=${()=>{this.jumpToSettingsTab(\"Models\")}}>\n          <span class='material-icon-outlined'>smart_toy</span>\n          &nbsp;<span class='material-icon'>arrow_drop_down</span>\n        </button>\n      `}return s.html`\n        <button class='headline-button' title=\"Select model(s)\"\n          @click=${()=>{this.jumpToSettingsTab(\"Models\")}}>\n          <span class='material-icon-outlined'>smart_toy</span>\n          &nbsp;${this.appState.currentModels.join(\", \")}&nbsp;\n          <span class='material-icon'>arrow_drop_down</span>\n        </button>\n      `}renderDatasetInfo(){return s.html`\n      <div class='vertical-separator'></div>\n      <button class='headline-button' title=\"Select dataset\"\n        @click=${()=>{this.jumpToSettingsTab(\"Dataset\")}}>\n        <span class='material-icon'>storage</span>\n        &nbsp;${(0,d.datasetDisplayName)(this.appState.currentDataset)}&nbsp;\n        <span class='material-icon'>arrow_drop_down</span>\n      </button>\n    `}renderLayoutInfo(){const t=Object.keys(this.appState.layouts),e=this.appState.layoutName;if(2<=t.length&&t.length<=4){const n=t.map(t=>{const n=t===e,i={\"headline-button\":!0,unselected:!n,selected:n},r=n?\"material-icon\":\"material-icon-outlined\",o=\"Change layout to \"+t;return s.html`\n          <button class=${(0,c.classMap)(i)} title=${o}\n            @click=${()=>{this.settingsService.updateSettings({layoutName:t}),this.requestUpdate()}}>\n            <span class=${r}>view_compact</span>\n            &nbsp;${t}\n          </button>\n        `});return s.html`${n}`}return s.html`\n        <button class='headline-button' title=\"Select UI layout.\"\n          @click=${()=>{this.jumpToSettingsTab(\"Layout\")}}>\n          <span class='material-icon'>view_compact</span>\n          &nbsp;${e}&nbsp;\n          <span class='material-icon'>arrow_drop_down</span>\n        </button>\n      `}renderConfigControls(){return s.html`\n      ${this.appState.initialized?this.renderModelInfo():null}\n      ${this.appState.initialized?this.renderDatasetInfo():null}\n      <div class='vertical-separator'></div>\n      ${this.renderLayoutInfo()}\n      <div class='vertical-separator'></div>\n      <div title=\"Configure models, dataset, and UI.\" id=\"config\">\n        <mwc-icon class=\"icon-button\"\n          @click=${this.toggleGlobalSettings}>\n          settings\n        </mwc-icon>\n      </div>\n    `}onClickCopyLink(){const t=this.appState.metadata.canonicalURL||window.location.host;(0,u.copyToClipboard)(t+window.location.search)}renderRightCorner(){return s.html`\n      <button class='headline-button unbordered' title=\"Copy link to this page\"\n        @click=${this.onClickCopyLink}>\n        <span class='material-icon'>link</span>\n        &nbsp;Share\n      </button>\n    `}render(){const t=this.appState.initialized&&!this.modulesService.getSetting(\"hideToolbar\");return s.html`\n      ${this.appState.initialized?s.html`<lit-global-settings></lit-global-settings>`:null}\n      <div id=\"at-top\">\n        <div id=\"headline\">\n          <div class=\"headline-section\">\n            ${this.renderStatusAndTitle()}\n          </div>\n          <div class=\"headline-section\">\n            ${this.renderConfigControls()}\n          </div>\n          <div class=\"headline-section\">\n            ${this.renderRightCorner()}\n          </div>\n        </div>\n        ${t?s.html`<lit-main-toolbar></lit-main-toolbar>`:null}\n      </div>\n    `}};i.__decorate([(0,o.query)(\"lit-global-settings\"),i.__metadata(\"design:type\",m.GlobalSettingsComponent)],g.prototype,\"globalSettingsElement\",void 0),g=i.__decorate([(0,a.customElement)(\"lit-app-toolbar\")],g),e.ToolbarComponent=g},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.LitMainToolbar=e.LitMainMenu=void 0;const i=n(1);n(31),n(60);const r=n(35),o=n(2),a=n(3),s=n(13),c=n(17),l=n(4);n(89);const d=n(7),u=n(8),h=n(11),p=n(53),f=n(15),m=n(91);let g=class extends r.MobxLitElement{constructor(){super(...arguments),this.appState=f.app.getService(h.AppState),this.selectionService=f.app.getService(h.SelectionService),this.sliceService=f.app.getService(h.SliceService),this.colorService=f.app.getService(h.ColorService)}static get styles(){return[d.styles,m.styles]}findAllParents(){return(0,u.flatten)(this.selectionService.selectedIds.map(t=>this.appState.getAncestry(t)))}findAllChildren(){const t=new Set(this.selectionService.selectedIds);for(const e of this.appState.currentInputData)for(const n of this.appState.getAncestry(e.id))this.selectionService.isIdSelected(n)&&t.add(e.id);return[...t]}selectRelated(){this.selectionService.selectIds([...this.findAllParents(),...this.findAllChildren()])}getSelectItems(){const t=()=>{},e=this.findAllParents().length>1,n=this.findAllChildren().length>1,i=e||n,r=this.selectionService.selectedIds.length>0;return[{itemText:\"Random\",displayIcon:!1,menu:[],onClick:()=>{const t=(0,u.randInt)(0,this.appState.currentInputData.length),e=this.appState.currentInputData[t].id;this.selectionService.selectIds([e])},disabled:!1},{itemText:\"All related\",displayIcon:!1,menu:[],onClick:i?()=>{this.selectRelated()}:t,disabled:!i},{itemText:\"Parents\",displayIcon:!1,menu:[],onClick:e?()=>{this.selectionService.selectIds([...this.findAllParents()])}:t,disabled:!e},{itemText:\"Children\",displayIcon:!1,menu:[],onClick:n?()=>{this.selectionService.selectIds([...this.findAllChildren()])}:t,disabled:!n},this.getSliceItem(),{itemText:\"Clear selection\",displayIcon:!1,menu:[],onClick:()=>{this.selectionService.selectIds([])},disabled:!r}]}getColorOptionItems(){return this.colorService.colorableOptions.map(t=>{const e=t.name===this.colorService.selectedColorOption.name;return{itemText:t.name,displayIcon:e,menu:[],onClick:()=>{this.colorService.selectedColorOption=t},disabled:!1}})}getSliceItem(){return{itemText:\"Slices\",displayIcon:!1,menu:Array.from(this.sliceService.namedSlices.keys()).map(t=>{const e=this.sliceService.selectedSliceName===t;return{itemText:t,displayIcon:e,menu:[],onClick:()=>{this.sliceService.selectNamedSlice(t)},disabled:!1}}),onClick:()=>{},disabled:!1}}getMenuData(){const t=new Map;return t.set(\"Select datapoint\",this.getSelectItems()),t.set(\"Color by\",this.getColorOptionItems()),t}render(){return a.html`<lit-menu-toolbar .menuData=${this.getMenuData()}></lit-menu-toolbar>`}};g=i.__decorate([(0,o.customElement)(\"lit-main-menu\")],g),e.LitMainMenu=g;let v=class extends r.MobxLitElement{constructor(){super(...arguments),this.appState=f.app.getService(h.AppState),this.selectionService=f.app.getService(h.SelectionService),this.sliceService=f.app.getService(h.SliceService),this.displayTooltip=!1}static get styles(){return[d.styles,m.styles]}get selectedIdPairs(){return this.selectionService.selectedOrAllInputData.filter(t=>t.meta.parentId).map(t=>[t.id,t.meta.parentId])}isStarred(t){return null!==t&&this.sliceService.isInSlice(p.STARRED_SLICE_NAME,t)}toggleStarred(){const t=this.selectionService.primarySelectedId;null!=t&&(this.isStarred(t)?this.sliceService.removeIdsFromSlice(p.STARRED_SLICE_NAME,[t]):this.sliceService.addIdsToSlice(p.STARRED_SLICE_NAME,[t]))}renderLuckyButton(){return a.html`\n      <button id='select-random-button' class='hairline-button xl'\n        @click=${()=>{const t=(0,u.randInt)(0,this.appState.currentInputData.length),e=this.appState.currentInputData[t].id;this.selectionService.selectIds([e])}}>\n        <span id='select-random-text'>Select random</span>\n      </button>\n    `}renderSelectionDisplay(t,e){const n=this.selectionService.primarySelectedId,i=this.appState.currentInputData.findIndex(t=>t.id===n),r=this.appState.currentInputData.length,o=t=>{const e=(i+t+r)%r,n=this.appState.currentInputData[e].id;this.selectionService.selectIds([n])},c=0===t,l=(0,s.classMap)({\"icon-button\":!0,disabled:c});return a.html`\n      <mwc-icon class=${l} id='ds-select-prev'\n        @click=${c?null:()=>{o(-1)}}>\n        chevron_left\n      </mwc-icon>\n      <div id='number-selected'>\n        <span id='num-selected-text'>${t}</span> of <span>${e}</span> selected\n      </div>\n      <mwc-icon class=${l} id='ds-select-next'\n        @click=${c?null:()=>{o(1)}}>\n        chevron_right\n      </mwc-icon>\n    `}renderPrimarySelectControls(){const t=this.selectionService.selectedIds.length,e=this.selectionService.primarySelectedId;if(null==e)return;const n=(0,u.shortenId)(e),i=this.appState.indicesById.get(e),r=this.selectionService.selectedIds.findIndex(t=>t===e),o=e=>{const n=(r+e+t)%t,i=this.selectionService.selectedIds[n];this.selectionService.setPrimarySelection(i)};return a.html`\n      <div id='primary-selection-status' class='selection-status-group'>\n        (${t>1?a.html`\n          <mwc-icon class='icon-button' id='select-prev'\n            @click=${()=>{o(-1)}}>\n            chevron_left\n          </mwc-icon>\n        `:null}\n        <span id='primary-text'>\n          primary:&nbsp;<span class='monospace'> ${n}</span>\n          ... [<span class='monospace'>${i}</span>]\n        </span>\n        ${t>1?a.html`\n          <mwc-icon class='icon-button' id='select-next'\n            @click=${()=>{o(1)}}>\n            chevron_right\n          </mwc-icon>\n        `:null})\n      </div>\n    `}renderPairControls(){const t=this.selectedIdPairs;if(0===t.length)return null;const e=f.app.getServiceArray(h.SelectionService)[1],n=[this.selectionService.primarySelectedId,e.primarySelectedId],i=n.map(t=>null!=t?this.appState.indicesById.get(t):null),r=n.includes(null)?-1:t.findIndex(t=>0===(0,u.compareArrays)(t,n)),o=-1!==r,s=t.length,c=n=>{this.appState.compareExamplesEnabled=!0;const i=t[((o?r:0)+n+s)%s];0===this.selectionService.selectedIds.length&&this.selectionService.selectIds((0,u.flatten)(t)),this.selectionService.setPrimarySelection(i[0]),e.setPrimarySelection(i[1])};return a.html`\n      <div id='pair-controls' class='selection-status-group'>\n        ${s} ${1===s?\"pair\":\"pairs\"} available\n        <mwc-icon class='icon-button' id='select-prev'\n          @click=${()=>{c(-1)}}>\n          chevron_left\n        </mwc-icon>\n        <mwc-icon class='icon-button mdi-outlined' id='select-random'\n          @click=${()=>{c((0,u.randInt)(1,s))}}>\n          casino\n        </mwc-icon>\n        <mwc-icon class='icon-button' id='select-next'\n          @click=${()=>{c(1)}}>\n          chevron_right\n        </mwc-icon>\n        ${o?a.html`[${i[1]}, ${i[0]}] selected`:null}\n      </div>\n    `}renderStarButton(t){const e=this.isStarred(this.selectionService.primarySelectedId),n=0===t,i=(0,s.classMap)({\"icon-button\":!0,disabled:n});return a.html`\n      <mwc-icon class=${i} id='star-button' @click=${()=>{this.toggleStarred()}}>\n        ${e?\"star\":\"star_border\"}\n      </mwc-icon>`}render(){const t=this.selectionService.selectedIds.length,e=this.appState.currentInputData.length,n=this.selectionService.primarySelectedId,i=!this.appState.compareExamplesEnabled&&0===t,r=(0,s.classMap)({\"toggle-example-comparison\":!0,\"text-disabled\":i}),o=(0,c.styleMap)({visibility:this.displayTooltip?\"visible\":\"hidden\"});return a.html`\n    <div class='toolbar main-toolbar'>\n      <div id='left-container'>\n        <lit-main-menu></lit-main-menu>\n        <div class='compare-container'\n          @click=${i?null:()=>{this.appState.compareExamplesEnabled=!this.appState.compareExamplesEnabled}}\n          @mouseover=${i?()=>{this.displayTooltip=!0}:null}\n          @mouseout=${i?()=>{this.displayTooltip=!1}:null}>\n          <div class=${r}>\n            Compare datapoints\n          </div>\n          <mwc-switch id='compare-switch'\n            ?disabled='${i}'\n            .checked=${this.appState.compareExamplesEnabled}\n          >\n          </mwc-switch>\n        </div>\n        <div class='compare-tooltip tooltip' style=${o}>\n          <mwc-icon class='tooltip-icon'>error_outline</mwc-icon>\n          <span class='tooltip-text'>\n            Select a datapoint to use this feature.\n          </span>\n        </div>\n        ${this.renderPairControls()}\n      </div>\n      <div id='right-container'>\n        ${null!==n?this.renderPrimarySelectControls():null}\n        ${this.renderStarButton(t)}\n        ${this.renderSelectionDisplay(t,e)}\n        <button id=\"clear-selection\" class=\"hairline-button xl\"\n          @click=${()=>{this.selectionService.selectIds([])}}\n          ?disabled=\"${0===t}\">\n          Clear selection\n        </button>\n        ${this.renderLuckyButton()}\n      </div>\n    </div>\n    `}};i.__decorate([l.observable,i.__metadata(\"design:type\",Boolean)],v.prototype,\"displayTooltip\",void 0),i.__decorate([l.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],v.prototype,\"selectedIdPairs\",null),v=i.__decorate([(0,o.customElement)(\"lit-main-toolbar\")],v),e.LitMainToolbar=v},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.LitMenu=e.MenuToolbar=void 0;const i=n(1);n(194);const r=n(35),o=n(189),a=n(2),s=n(2),c=n(2),l=n(3),d=n(13),u=n(17),h=n(4),p=n(90);let f=class extends r.MobxLitElement{constructor(){super(...arguments),this.menuData=new Map}static get styles(){return[p.styles]}get menuNames(){return Array.from(this.menuData.keys())}render(){return l.html`\n      <div class=\"toolbar\" id=\"menu-toolbar\">\n        ${this.menuNames.map(t=>{const e=this.menuData.get(t);if(null!=e)return l.html`\n              <lit-menu .items=${e} .name=${t}>\n              </lit-menu>\n              `})}\n      </div>\n    `}};i.__decorate([(0,s.property)({type:Object}),i.__metadata(\"design:type\",Object)],f.prototype,\"menuData\",void 0),i.__decorate([h.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],f.prototype,\"menuNames\",null),f=i.__decorate([(0,c.customElement)(\"lit-menu-toolbar\")],f),e.MenuToolbar=f;let m=class extends l.LitElement{constructor(){super(...arguments),this.items=[],this.name=\"\",this.menuId=\"menu\",this.buttonId=\"menu_button\",this.openSubmenus=new Set,this.menuOpen=!1}static get styles(){return[p.styles]}getItemId(t,e){return`${t}_item_${e}`}getSubmenuId(t){return t+\"_menu\"}anchorSubmenus(t,e){t.forEach((t,n)=>{const i=this.getItemId(e,n),r=this.getSubmenuId(i),o=this.shadowRoot.querySelector(\"#\"+i),a=this.shadowRoot.querySelector(\"#\"+r);null!=a&&null!=o&&(a.anchor=o,t.menu.length>0&&this.anchorSubmenus(t.menu,r))})}updated(){null!=this.menu&&null!=this.button&&(this.menu.anchor=this.button,this.anchorSubmenus(this.items,this.menuId))}renderItem(t,e,n){const i=t.menu.length>0,r=(0,u.styleMap)({visibility:t.displayIcon||i?\"visible\":\"hidden\"}),o=(0,d.classMap)({item:!0,disabled:t.disabled}),a=(0,d.classMap)({\"item-text\":!0,\"text-disabled\":t.disabled});return l.html`\n      <div class=${o} graphic='icon' id=${n} @click=${i?null:t.onClick}\n        @mouseover=${i?()=>{for(const t of Array.from(this.openSubmenus.keys())){const e=this.shadowRoot.querySelector(\"#\"+t);if(null==e)return;e.close()}this.openSubmenus.clear();const t=this.shadowRoot.querySelector(\"#\"+e);null!=t&&(t.show(),this.openSubmenus.add(e))}:null}>\n          <mwc-icon slot='graphic' class='check' style=${r}>\n            ${i?\"arrow_right\":\"check\"}\n          </mwc-icon>\n          <span title=${t.itemText} class=${a}>\n            ${t.itemText.slice(0,25)+(t.itemText.length>25?\"...\":\"\")}\n          </span>\n      </div>\n    `}renderMenu(t,e,n){const i=null==n?(0,u.styleMap)({}):(0,u.styleMap)({\"--submenu-index\":\"\"+n});return l.html`\n      <mwc-menu class='menu' style=${i} id=${e}\n        corner=${null==n?\"TOP_START\":\"TOP_END\"}\n        @click=${()=>{this.shadowRoot.querySelector(\"#\"+e).close()}} @opened=${null==n?()=>{window.requestAnimationFrame(()=>{this.menuOpen=!0,this.requestUpdate()})}:null}\n        @closed=${null==n?()=>{window.requestAnimationFrame(()=>{this.menuOpen=!1,this.requestUpdate()})}:null} quick>\n        ${t.map((t,n)=>{const i=this.getItemId(e,n),r=this.getSubmenuId(i);return this.renderItem(t,r,i)})}\n      </mwc-menu>\n      ${t.map((t,n)=>{const i=this.getItemId(e,n),r=this.getSubmenuId(i);return t.menu.length>0?this.renderMenu(t.menu,r,n):\"\"})}\n    `}render(){const t=(0,d.classMap)({\"button-focus\":this.menuOpen}),e=(0,d.classMap)({\"icon-focus\":this.menuOpen,\"dropdown-icon\":!0});return l.html`\n        <div class='menu-container'>\n          <button id=${this.buttonId} class=${t} @click=${()=>{if(null!=this.menu)if(this.menuOpen){if(null==this.button)return;this.button.blur()}else this.menu.show(),this.button.focus()}}>\n            ${this.name}\n            <span class=${e} data-icon=${this.menuOpen?\"arrow_drop_up\":\"arrow_drop_down\"}></span>\n          </button>\n          <div id='menu-holder'>\n            ${this.renderMenu(this.items,this.menuId)}\n          </div>\n        </div>\n    `}};i.__decorate([(0,s.property)({type:Array}),i.__metadata(\"design:type\",Array)],m.prototype,\"items\",void 0),i.__decorate([(0,s.property)({type:String}),i.__metadata(\"design:type\",String)],m.prototype,\"name\",void 0),i.__decorate([(0,a.query)(\"#menu\"),i.__metadata(\"design:type\",o.Menu)],m.prototype,\"menu\",void 0),i.__decorate([(0,a.query)(\"#menu_button\"),i.__metadata(\"design:type\",HTMLElement)],m.prototype,\"button\",void 0),m=i.__decorate([(0,c.customElement)(\"lit-menu\")],m),e.LitMenu=m},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`:host {\n  --item-top-padding: 5px;\n  --item-bottom-padding: 0px;\n  --item-height: 32px;\n  --item-vertical-offset:\n      calc(var(--item-top-padding) +\n        var(--item-bottom-padding) +\n        var(--item-height));\n}\n\n#menu-toolbar {\n  display: flex;\n}\n\n.item {\n  background: white;\n  height: var(--item-height);\n  width: 260px;\n  padding:var(--item-top-padding) 5px var(--item-bottom-padding) 7px;\n  font-size: 14px;\n  overflow: hidden;\n  cursor: default;\n  user-select: none;\n}\n\n.item-text{\n  font-family: Roboto;\n  font-style: normal;\n  font-weight: normal;\n  font-size: 14px;\n}\n\n.check{\n  vertical-align: middle;\n  padding: 0 6px;\n  color: #5F6368;\n}\n\n.item:hover{\n  background: #E4F7FB;\n}\n\n.disabled:hover{\n  background: white;\n}\n\n.text-disabled{\n  color: #aaa;\n}\n\n\nbutton {\n  background: white;\n  border: white;\n  border-radius: 3px;\n  padding: 2px 5px;\n  margin-right: 4.5px;\n  font-family: Roboto;\n  font-style: normal;\n  font-weight: normal;\n  font-size: 14px;\n  line-height: 20px;\n  color: #3C4043;\n\n}\n\nbutton:focus {\n  outline: none;\n  background: #F1F3F4;\n  color: #098591;\n}\n\n.button-focus{\n  outline: none;\n  background: #F1F3F4;\n  color: #098591;\n}\n\nbutton:hover {\n  background: #F1F3F4;\n}\n\n/* For in-line icons in a <span> */\n[data-icon] {\n  margin: 0;\n}\n\n[data-icon]:before {\n  font-family: 'Material Icons';\n  content: attr(data-icon);\n  vertical-align: middle;\n}\n\n.dropdown-icon {\n  font-size: 18px;\n  color: #5F6368;\n}\n\n.icon-focus {\n  color: #098591;\n}\n\n#menu-holder {\n  position: absolute;\n}\n\n.menu-container {\n  position: relative;\n}\n\n.menu {\n  position: absolute;\n  top: calc(var(--submenu-index) * var(--item-vertical-offset));\n}\n\n/* Only displays icons (e.g. checkmark) where the element is selected. */\n[mwc-list-item][group]:not([selected]) [slot=\"graphic\"] {\n  display: none;\n}\n\nul.mdc-list {\n  padding: 4px 0;\n}\n`},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`/**\n * Padding and margins attempt to match the offsets of the left-\n * and right-most visual elements in the main app toolbar.\n */\n.toolbar {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  align-items: center;\n  justify-content: space-between;\n  padding-left: 4pt;\n  padding-right: 4pt;\n}\n\n.toolbar button {\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.main-toolbar {\n  box-shadow: 0 2px 2px 0 rgba(0, 0, 0, .14), 0 3px 1px -2px rgba(0, 0, 0, .2), 0 1px 5px 0 rgba(0, 0, 0, .12);\n  background-color: white;\n  border-bottom: 1px solid #dadce0;\n  min-height: 36px;\n}\n\n.togglable-toolbar-holder {\n  background-color: white;\n  width: fit-content; /* set to 100% to span page */\n  border: 1px solid;\n  border-radius: 2pt;\n  border-color: rgb(218, 220, 224);\n  position: absolute;\n}\n\n#slice-toolbar-container {\n  right: 0; /* remove to span page */\n}\n\n#left-container {\n  display: flex;\n  font-family: Roboto;\n  font-size: 14px;\n}\n\n#right-container {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  margin: 4px;\n  max-height: 24px; /** To avoid page jumps when selections happen. **/\n  font-family: Roboto;\n  font-size: 14px;\n}\n\n#button-holder-right {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: flex-end;\n  flex-grow: 2;\n  margin: 4px;\n}\n\n.selection-status-group {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n}\n\n#primary-selection-status {\n  margin-right: 4pt;\n}\n\n/* For in-line icons in a <span> */\n[data-icon] {\n  margin: 0;\n}\n\n[data-icon]:before {\n  font-family: 'Material Icons';\n  content: attr(data-icon);\n  vertical-align: middle;\n}\n\n#star-button {\n  margin-top: -4px;\n  margin-right: 6pt;\n  --mdc-icon-size: 20px;\n}\n\n#legend-container {\n  right: 0;\n  min-width: 150px;\n  top: 100%;\n  margin-left: -8pt; /* To account for button padding */\n  margin-top: 6px;\n  cursor: default;\n}\n\n.toolbar-holder {\n  position: relative;\n}\n\n.toggle-example-comparison {\n  font-family: Roboto;\n  font-size: 14px;\n  color: #3C4043;\n  cursor: pointer;\n  padding: 3px 8px;\n  user-select: none;\n}\n\n.text-disabled {\n  color: rgba(60, 64, 67, 0.38);\n}\n\n.compare-container {\n  display: flex;\n  width: 200px;\n  height:100%;\n}\n\n.compare-tooltip {\n  position: absolute;\n  left: 372px;\n  width: 256px;\n  top: 75px;\n  font-family: Roboto;\n  font-size: 12px;\n  background: rgba(32, 33, 36, 0.9);\n  border-radius: 4px;\n  font-size: 12px;\n  color: #FFFFFF;\n  display: flex;\n}\n\n.tooltip-icon {\n  --mdc-icon-size: 20px;\n  margin-top: 6px;\n  margin-left: 10px;\n}\n\n.tooltip-text {\n  margin: 8px 12px;\n}\n\n#compare-switch {\n  margin-top: 6px;\n}\n\n#primary-text {\n  text-align: right;\n}\n\n#number-selected {\n}\n\n#select-random-icon {\n  vertical-align: middle;\n}\n\n#select-random-text {\n  vertical-align: middle;\n}\n\n#num-selected-text {\n  min-width: 10px;\n  text-align: right;\n  display: inline-block;\n}\n\n`},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`#at-top {\n  top: 0;\n  position: sticky;\n  z-index: 3;\n}\n\n#headline {\n  width: 100vw;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  background-color: var(--lit-cyea-500);\n  font-family: 'Google Sans' !important;\n  color: white;\n  font-size: 18px;\n  line-height: 24px;\n  letter-spacing: +0.1;\n  height: 40px;\n}\n\n.headline-section {\n  display: flex;\n  align-items: center;\n}\n\n.headline-section > * {\n  padding: 4px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n#title-group {\n  font-family: 'Google Sans', sans;\n}\n\n.icon-button {\n  height: 24px;\n  width: 24px;\n  min-width: 24px;\n  --mdc-icon-size: 24px;\n  cursor: pointer;\n  margin: 0pt 2pt;\n  color: var(--lit-neutral-100);\n}\n\n.icon-button:hover {\n  color: var(--lit-neutral-400);\n}\n\n.status-emoji {\n  width: 20px;\n  height: 20px;\n  padding-right: 4px;\n  display: block;\n}\n\n.vertical-separator {\n  background: #098591;\n  width: 2px;\n  height: 1.2rem;\n  padding: 0;\n  margin: 0 8px;\n}\n\n/* Custom button style to work with the dark background */\nbutton {\n  font-size: 16px;\n  color: white;\n}\n\n/* disabled, unselected, default, focus, hover, selected */\n\n.headline-button {\n  margin: 0 4px;\n  background: transparent;\n  border-radius: 4px;\n  border: 1px solid #098591;\n  font-family: Roboto;\n  color: #E4F7FB; /* Cyan/50 */\n}\n\n.headline-button.unbordered {\n  border: 1px solid transparent;\n}\n\n.headline-button.unselected {\n  color: #A1E4F2; /* Cyan/200 */\n}\n\n.headline-button.selected {\n  border: 1px solid #E4F7FB; /* Cyan/50 */\n}\n\n.headline-button:focus {\n  background: rgba(138, 180, 248, 0.12);\n  outline: none;\n}\n\n.headline-button:hover {\n  background: rgba(26, 115, 232, 0.04);\n  opacity: .7;\n  border: 1px solid var(--lit-neutral-400);\n}\n\n.headline-button:active {\n  background: #E8F0FE;\n  box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3),\n    0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n  opacity: .4;\n}\n\n.headline-button:disabled {\n  color: rgba(60, 64, 67, 0.38);\n}\n`},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.LitModules=void 0;const i=n(1);n(31);const r=n(3),o=n(2),a=n(13),s=n(17),c=n(4),l=n(34);n(50);const d=n(11),u=n(15),h=n(12),p=n(94),f=n(95);let m=class extends l.ReactiveElement{constructor(){super(...arguments),this.modulesService=u.app.getService(d.ModulesService),this.mainSectionHeight=this.modulesService.getSetting(\"mainHeight\")||45,this.upperLayoutWidths={},this.lowerLayoutWidths={}}static get styles(){return p.styles}firstUpdated(){this.modulesService.setRenderModulesCallback(()=>{this.requestUpdate()});const t=this.shadowRoot.querySelector(\".outer-container\");this.resizeObserver=new ResizeObserver(()=>{const e=this.modulesService.getRenderLayout();this.calculateAllWidths(e);const n=t.getBoundingClientRect();t.style.setProperty(\"--top-toolbar-offset\",n.top+\"px\"),t.style.setProperty(\"--modules-area-height\",n.height+\"px\")}),this.resizeObserver.observe(t),this.reactImmediately(()=>this.modulesService.getRenderLayout(),t=>{this.calculateAllWidths(t)}),document.addEventListener(\"keydown\",t=>{if(\"Escape\"===t.key)for(const t of this.shadowRoot.querySelectorAll(\"lit-widget-group[maximized]\"))t.removeAttribute(\"maximized\")})}calculateAllWidths(t){this.calculateWidths(t.upper,this.upperLayoutWidths),this.calculateWidths(t.lower,this.lowerLayoutWidths)}calculateWidths(t,e){for(const n of Object.keys(t))e[n]=[],this.calculatePanelWidths(n,t[n],e)}calculatePanelWidths(t,e,n){let i=0;for(const t of e)this.modulesService.isModuleGroupHidden(t[0])&&(i+=1);const r=this.shadowRoot.querySelector(\".outer-container\").getBoundingClientRect().width-4-42*i;let o=0;for(const t of e){if(this.modulesService.isModuleGroupHidden(t[0]))continue;const e=t.map(t=>t.moduleType.numCols);o+=Math.max(...e)}for(let i=0;i<e.length;i++){const a=e[i].map(t=>t.moduleType.numCols),s=Math.max(...a)/o*r;n[t][i]=s}}disconnectedCallback(){super.disconnectedCallback(),this.modulesService.setRenderModulesCallback(()=>{})}updated(){this.shadowRoot.querySelectorAll(\"lit-widget\").forEach(t=>{const e=t.children[0];e instanceof h.LitModule&&(e.setIsLoading=e=>{t.isLoading=e})})}render(){const t=this.modulesService.getRenderLayout(),e=Object.keys(t.upper),n=Object.keys(t.lower),i=(0,a.classMap)({\"outer-container\":!0,\"outer-container-centered\":Boolean(this.modulesService.getSetting(\"centerPage\"))});\"\"===this.modulesService.selectedTabUpper&&(this.modulesService.selectedTabUpper=e[0]),\"\"===this.modulesService.selectedTabLower&&(this.modulesService.selectedTabLower=n[0]);const o=e.indexOf(this.modulesService.selectedTabUpper),c=-1===o?e[0]:e[o],l=n.indexOf(this.modulesService.selectedTabLower),d=-1===l?n[0]:n[l],u=t=>{this.modulesService.selectedTabUpper=t},h=Object.keys(t.upper).length>1,p=Object.keys(t.lower).length>0,f=p?this.mainSectionHeight+\"vh\":\"100%\",m=(0,s.styleMap)({\"--upper-height\":f,\"--num-tab-bars\":\"\"+(h?2:1)});return r.html`\n      <div id='outer-container' class=${i} style=${m}>\n        ${h?(()=>r.html`\n        <div class='tab-bar'>\n          <div class='tabs-container'>\n            ${this.renderTabs(e,c,u)}\n          </div>\n          </div>\n        </div>\n      `)():null}\n        <div id='upper-group-area'>\n          ${this.renderComponentGroups(t.upper,c,this.upperLayoutWidths)}\n        </div>\n        ${p?r.html`\n          <div class='tab-bar' id='center-bar'>\n            <div class='tabs-container'>\n              ${this.renderTabs(n,d,t=>{this.modulesService.selectedTabLower=t})}\n            </div>\n            <div id='drag-container'>\n              <mwc-icon class=\"drag-icon\">drag_handle</mwc-icon>\n              <div id='drag-handler' draggable='true'\n                  @drag=${t=>{this.onBarDragged(t)}}>\n              </div>\n            </div>\n          </div>\n          <div id='lower-group-area'>\n            ${this.renderComponentGroups(t.lower,d,this.lowerLayoutWidths)}\n          </div>\n        `:null}\n      </div>\n    `}onBarDragged(t){const e=this.shadowRoot.getElementById(\"upper-group-area\").getBoundingClientRect().top,n=this.shadowRoot.getElementById(\"drag-handler\").getBoundingClientRect();t.clientY+-10<e||t.clientY<=n.top-30||t.clientY>=n.bottom+30?console.log(\"Anomalous drag event; skipping resize\",t):this.mainSectionHeight=Math.floor((t.clientY+-10-e)/window.innerHeight*100)}renderComponentGroups(t,e,n){return Object.keys(t).map(i=>{const o=t[i],s=e===i,c=(0,a.classMap)({selected:s,\"components-group-holder\":!0});return r.html`\n        <div class=${c}>\n          ${this.renderWidgetGroups(o,i,n)}\n        </div>`})}renderTabs(t,e,n){return t.map(t=>{const i=e===t,o=(0,a.classMap)({selected:i,tab:!0});return r.html`<div class=${o} @click=${e=>{n(t),e.preventDefault(),this.requestUpdate()}}>${t}</div>`})}renderWidgetGroups(t,e,n){const i=i=>{this.calculatePanelWidths(e,t,n)};return t.map((o,a)=>{const s=n[e]?n[e][a]:0;return r.html`<lit-widget-group .configGroup=${o}\n          @widget-group-minimized-changed=${i} @widget-group-drag=${i=>{const r=i.detail.dragWidth;if(a<t.length-1){const i=t[a+1];if(!this.modulesService.isModuleGroupHidden(i[0])){const t=r-n[e][a],i=n[e][a+1];n[e][a+1]=Math.max(f.MIN_GROUP_WIDTH_PX,i-t)}}n[e][a]=r,this.requestUpdate()}}\n          .width=${s}></lit-widget-group>`})}};i.__decorate([(0,o.property)({type:Number}),i.__metadata(\"design:type\",Object)],m.prototype,\"mainSectionHeight\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",Object)],m.prototype,\"upperLayoutWidths\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",Object)],m.prototype,\"lowerLayoutWidths\",void 0),m=i.__decorate([(0,o.customElement)(\"lit-modules\")],m),e.LitModules=m},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`:host {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  background: #f5f9fa;\n  --tab-bar-height: 30px;\n}\n\n.outer-container {\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  height: 100%;\n  /* full-width, overflow if window is < 1000px */\n  min-width: 1000px;\n  max-width: 100vw;\n}\n\n.outer-container-centered {\n  align-self: center;\n  /* 1000px wide unless window is narrower */\n  width: 100vw;\n  min-width: unset;\n  max-width: 1000px;\n}\n\n#upper-group-area {\n  position: relative;\n  height: var(--upper-height);\n}\n\n#lower-group-area {\n  position: relative;\n  flex: 1;\n  max-height: calc(100% - var(--upper-height) - var(--num-tab-bars) * var(--tab-bar-height));\n}\n\n.components-group-holder {\n  position: absolute;\n  overflow: auto;\n  display: flex;\n  visibility: hidden;\n  height: 100%;\n  width: 100%;\n  padding: 2px;\n  box-sizing: border-box;\n}\n\n.components-group-holder.selected {\n  visibility: visible;\n}\n\nlit-widget-group {\n  padding: 0 2px; /* gives 4px between adjacent groups */\n  box-sizing: border-box;\n}\n\nlit-widget-group[maximized] {\n  padding: 0;\n}\n\n.tab-bar {\n  padding: 0 40px;\n  color: #5f6368;\n  background: white;\n  display: flex;\n  align-items: center;\n  height: var(--tab-bar-height);\n}\n\n/* If in centered mode, tab bars should align to modules */\n.outer-container-centered .tab-bar {\n  margin: 0 4px;\n  border: 1px solid rgb(218, 220, 224);\n  box-sizing: border-box;\n}\n\n#drag-container{\n  position:relative;\n  width: 50%;\n  height: 100%;\n  margin-left:auto;\n  display: flex;\n  align-items: center;\n}\n\n#drag-handler {\n  width: 100%;\n  height: 100%;\n  cursor: ns-resize;\n  opacity: 0;\n}\n\n.tabs-container {\n  align-items: end; /* bottom */\n  display: flex;\n  font-size: 12px;\n  height: 100%;\n  margin-right: 38px;\n  max-width: 100%;\n  padding: 2px 0;\n}\n\n.tab {\n  font-family: 'Google Sans', sans;\n  border-bottom: 2px solid #dadce0;\n  box-sizing: border-box;\n  padding: 4px;\n  text-align: center;\n  white-space: nowrap;\n  width: 150px;\n}\n.tab:hover{\n  background: #eee;\n}\n.tab.selected {\n  font-weight: bold;\n  border-bottom: 2px solid rgb(47, 140, 155);\n  color: rgb(47, 140, 155);\n}\n.drag-icon {\n  pointer-events: none;\n  position: absolute;\n  left: 0%;\n}\n`},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.LitWidget=e.WidgetGroup=e.MIN_GROUP_WIDTH_PX=void 0;const i=n(1);n(39),n(42),n(80),n(31);const r=n(35),o=n(2),a=n(2),s=n(3),c=n(13),l=n(17),d=n(5);n(50);const u=n(11),h=n(15);n(12);const p=n(96),f=n(97),m=n(7);e.MIN_GROUP_WIDTH_PX=100;let g=class extends s.LitElement{constructor(){super(...arguments),this.modulesService=h.app.getService(u.ModulesService),this.configGroup=[],this.minimized=!1,this.maximized=!1,this.dragging=!1,this.width=0,this.widgetScrollTop=0,this.widgetScrollLeft=0,this.syncScrolling=!0}static get styles(){return[m.styles,f.styles]}firstUpdated(){this.minimized=this.initMinimized()}render(){return this.renderModules(this.configGroup)}renderHeader(t){const e=t[0].moduleType.title;return s.html`\n      <div class=header>\n        <div class=\"title\" @click=${()=>{this.minimized&&(this.setMinimized(!1),this.maximized=!1)}}>${e}</div>\n        ${this.minimized||t.length<2?null:(()=>{const t=()=>{this.syncScrolling=!this.syncScrolling,this.requestUpdate()};return s.html`\n        <mwc-icon-button-toggle class=\"icon-button scroll-toggle\"\n          title=\"Toggle scroll sync\"\n          onIcon=\"sync_disabled\" offIcon=\"sync\"\n          ?on=\"${!this.syncScrolling}\"\n          @MDCIconButtonToggle:change=\"${t}\"\n          @icon-button-toggle-change=\"${t}\">\n        </mwc-icon-button-toggle>`})()}\n        <mwc-icon class=\"icon-button min-button\" @click=${()=>{this.setMinimized(!this.minimized),this.maximized=!1}} title=\"Minimize\">\n          ${this.minimized?\"maximize\":\"minimize\"}\n        </mwc-icon>\n        <mwc-icon class=\"icon-button\" @click=${()=>{this.maximized=!this.maximized,this.setMinimized(!1)}} title=\"Maximize\">\n          ${this.maximized?\"fullscreen_exit\":\"fullscreen\"}\n        </mwc-icon>\n      </div>`}renderModules(t){const e=t.length>1,n=t[0].moduleType.duplicateAsRow,i=this.shadowRoot.host,r=this.width+\"px\";i.style.setProperty(\"--width\",r),i.style.setProperty(\"--min-width\",r);const o=(0,c.classMap)({wrapper:!0,dragging:this.dragging}),a=(0,c.classMap)({\"component-row\":e&&n,\"component-column\":e&&!n,holder:!0}),l={width:\"100%\",height:\"100%\"};n?l.width=100/t.length+\"%\":l.height=100/t.length+\"%\";const d=t.length>1;return s.html`\n      <div class='outside' @click=${()=>{this.maximized=!1}}>\n        <div class=${o} @click=${t=>{t.stopPropagation()}} >\n          ${this.renderHeader(t)}\n          <div class=${a}>\n            ${t.map(t=>this.renderModule(t,l,d))}\n            ${this.renderExpander()}\n          </div>\n        </div>\n       </div>\n    `}renderModule(t,e,n){const i=t.moduleType,r=t.modelName,o=t.selectionServiceIndex;let a=null!=r?r:\"\";void 0!==o&&i.duplicateForExampleComparison&&(a=a.concat(`${a?\" - \":\"\"} ${o?\"Reference\":\"Main\"}`));return s.html`\n      <lit-widget\n        displayTitle=${i.title}\n        subtitle=${n?a:\"\"}\n        ?highlight=${1===o}\n        @widget-scroll=\"${t=>{this.syncScrolling&&(this.widgetScrollLeft=t.detail.scrollLeft,this.widgetScrollTop=t.detail.scrollTop,this.requestUpdate())}}\"\n        widgetScrollLeft=${this.widgetScrollLeft}\n        widgetScrollTop=${this.widgetScrollTop}\n        style=${(0,l.styleMap)(e)}\n      >\n        ${i.template(r,o)}\n      </lit-widget>\n    `}renderExpander(){const t=t=>{const n=this.shadowRoot.querySelector(\".holder\").getBoundingClientRect().left,i=t.clientX-n;if(i>e.MIN_GROUP_WIDTH_PX&&Math.abs(i-this.width)>10){const t=new CustomEvent(\"widget-group-drag\",{detail:{dragWidth:i}});this.dispatchEvent(t)}},n=()=>{this.dragging=!0};return this.maximized||this.minimized?s.html``:s.html`\n        <div class=\"expander\">\n          <div class=\"expander-drag-target\" draggable='true'\n            @drag=${e=>{t(e)}}\n            @dragstart=${()=>{n()}}\n            @dragend=${()=>{this.dragging=!1}}>\n          </div>\n        </div>\n      `}initMinimized(){const t=this.configGroup[0];return this.modulesService.isModuleGroupHidden(t)}setMinimized(t){const e=this.configGroup[0];this.modulesService.toggleHiddenModule(e,t),this.minimized=t;const n=new CustomEvent(\"widget-group-minimized-changed\",{detail:{isMinimized:t}});this.dispatchEvent(n)}};i.__decorate([(0,o.property)({type:Array}),i.__metadata(\"design:type\",Array)],g.prototype,\"configGroup\",void 0),i.__decorate([(0,o.property)({type:Boolean,reflect:!0}),i.__metadata(\"design:type\",Object)],g.prototype,\"minimized\",void 0),i.__decorate([(0,o.property)({type:Boolean,reflect:!0}),i.__metadata(\"design:type\",Object)],g.prototype,\"maximized\",void 0),i.__decorate([(0,o.property)({type:Boolean,reflect:!0}),i.__metadata(\"design:type\",Object)],g.prototype,\"dragging\",void 0),i.__decorate([(0,o.property)({type:Number}),i.__metadata(\"design:type\",Object)],g.prototype,\"width\",void 0),g=i.__decorate([(0,a.customElement)(\"lit-widget-group\")],g),e.WidgetGroup=g;let v=class extends r.MobxLitElement{constructor(){super(...arguments),this.displayTitle=\"\",this.subtitle=\"\",this.isLoading=!1,this.highlight=!1,this.widgetScrollTop=0,this.widgetScrollLeft=0}static get styles(){return[m.styles,p.styles]}updated(){return i.__awaiter(this,void 0,void 0,(function*(){yield this.updateComplete;const t=this.children[0],e=t.shadowRoot.querySelectorAll(\".\"+d.SCROLL_SYNC_CSS_CLASS);if(e.length>0)e.forEach(e=>{const n=e;n.scrollTop=this.widgetScrollTop,n.scrollLeft=this.widgetScrollLeft;t.onSyncScroll=()=>{const t=new CustomEvent(\"widget-scroll\",{detail:{scrollTop:n.scrollTop,scrollLeft:n.scrollLeft}});this.dispatchEvent(t)},t.requestUpdate()});else{const t=this.shadowRoot.querySelector(\".content\");if(null==t)return;t.scrollTop=this.widgetScrollTop,t.scrollLeft=this.widgetScrollLeft}}))}render(){const t=(0,c.classMap)({content:!0,loading:this.isLoading}),e=(0,c.classMap)({holder:!0,highlight:this.highlight});return s.html`\n      <div class=${e}>\n        ${this.subtitle?this.renderHeader():\"\"}\n        <div class=\"container\">\n          ${this.isLoading?this.renderSpinner():null}\n          <div class=${t} @scroll=${()=>{const t=this.shadowRoot.querySelector(\".content\"),e=new CustomEvent(\"widget-scroll\",{detail:{scrollTop:t.scrollTop,scrollLeft:t.scrollLeft}});this.dispatchEvent(e)}}>\n            <slot></slot>\n          </div>\n        </div>\n      </div>\n    `}renderSpinner(){return s.html`\n      <div class=\"spinner-container\">\n        <lit-spinner size=${36} color=\"var(--app-secondary-color)\">\n        </lit-spinner>\n      </div>\n    `}renderHeader(){return s.html`\n    <div class=header>\n      <span class=\"subtitle\">${this.subtitle}</span>\n    </div>\n    `}};i.__decorate([(0,o.property)({type:String}),i.__metadata(\"design:type\",Object)],v.prototype,\"displayTitle\",void 0),i.__decorate([(0,o.property)({type:String}),i.__metadata(\"design:type\",Object)],v.prototype,\"subtitle\",void 0),i.__decorate([(0,o.property)({type:Boolean}),i.__metadata(\"design:type\",Object)],v.prototype,\"isLoading\",void 0),i.__decorate([(0,o.property)({type:Boolean}),i.__metadata(\"design:type\",Object)],v.prototype,\"highlight\",void 0),i.__decorate([(0,o.property)({type:Number}),i.__metadata(\"design:type\",Object)],v.prototype,\"widgetScrollTop\",void 0),i.__decorate([(0,o.property)({type:Number}),i.__metadata(\"design:type\",Object)],v.prototype,\"widgetScrollLeft\",void 0),v=i.__decorate([(0,a.customElement)(\"lit-widget\")],v),e.LitWidget=v},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`:host {\n  display: flex;\n  position: relative;\n  box-sizing: border-box;\n  height: 100%;\n  background: white;\n  --lit-widget-header-height: 24px;\n}\n\n.holder {\n  display: flex;\n  flex-direction: column;\n  position: relative;\n  border: 1px solid rgb(218, 220, 224);\n  border-top: 0px;\n  width: 100%;\n  box-sizing: border-box;\n}\n\n.container {\n  position: relative;\n  display: flex;\n  flex: 1;\n  height: calc(100% - var(--lit-widget-header-height));\n}\n\n.content {\n  overflow-y: auto;\n  width: 100%;\n}\n\n.content.loading {\n  opacity: 0.2;\n  pointer-events: none;\n}\n\n.header {\n  font-family: 'Google Sans', sans;\n  min-height: var(--lit-widget-header-height);\n  color: rgb(32, 33, 36);\n  line-height: 16pt;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-between;\n  padding: 0pt 4pt;\n  border-bottom: 1px solid rgb(218, 220, 224);\n  box-sizing: border-box;\n}\n\n.holder.highlight {\n  border: 1px solid #2f8c9b;\n  box-sizing: border-box;\n}\n\n.subtitle {\n  font-size: 8pt;\n  color: gray;\n}\n\n.spinner-container {\n  position: absolute;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: center;\n}\n`},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`:host{\n  flex: var(--flex);\n  min-width: var(--width);\n  width: var(--width);\n  --lit-group-header-height: 36px;\n}\n\n.outside {\n  width: 100%;\n  height: 100%;\n}\n\n.wrapper {\n  height: 100%;\n  box-sizing: border-box;\n  background-color: white;\n  background-clip: content-box;\n}\n\n.header {\n  height: var(--lit-group-header-height);\n  display: flex;\n  padding: 0 8px;\n  line-height: 20pt;\n  align-items: center;\n  justify-content: space-between;\n  border: 1px solid rgb(218, 220, 224);\n  box-sizing: border-box;\n}\n\n.title {\n  font-size: 14px;\n  font-family: 'Google Sans', sans;\n  white-space: nowrap;\n  overflow: hidden;\n  flex: 1;\n  display: flex;\n}\n\n.min-button {\n  text-align: right;\n}\n\n.scroll-toggle {\n  --mdc-icon-button-size: 24px;\n}\n\n.icon-button {\n  height: 24px;\n  width: 24px;\n  min-width: 24px;\n  --mdc-icon-size: 24px;\n}\n\n.holder {\n  height: calc(100% - var(--lit-group-header-height));\n  display: flex;\n  flex-direction: column;\n  position: relative;\n  flex: 1;\n}\n\n.component-row {\n  display: flex;\n  flex-direction: row;\n  overflow-x: auto;\n}\n\n.component-column {\n  display: flex;\n  flex-direction: column;\n}\n\nlit-widget {\n  min-height: 128px;\n}\n\n.expander {\n  position: absolute;\n  bottom: 0px;\n  right: 0px;\n  height: 90%;\n  width: 10px;\n  cursor: ew-resize;\n}\n\n.expander-drag-target{\n  position: absolute;\n  width: 100%;\n  height:100%;\n  opacity: 0;\n}\n\n/**\n * Maximized state\n */\n:host([maximized]) {\n  margin: 0;\n  padding: 0;\n  --lit-maximized-vpad: 15px;\n  --lit-maximized-hpad: 45px;\n  /* Override whatever size this would have been in-line. */\n  width: calc(100vw - 2*var(--lit-maximized-hpad)) !important;\n  min-width: calc(100vw - 2*var(--lit-maximized-hpad)) !important;\n  position: fixed;\n  z-index: 2;\n  /* Fix size to fill the main modules area, but not cover toolbars. */\n  /* --top-toolbar-offset and --modules-area-height are set by modules.ts. */\n  top: var(--top-toolbar-offset);\n  height: calc(var(--modules-area-height) - 2*var(--lit-maximized-vpad));\n  left: 0px;\n}\n\n:host([maximized]) .outside {\n  padding: var(--lit-maximized-vpad) var(--lit-maximized-hpad);\n  background: rgba(4, 29, 51, .47);\n}\n\n:host([maximized]) .wrapper {\n  padding: 0;\n}\n\n/**\n * Minimized state\n */\n:host([minimized]) {\n  min-width: calc(var(--lit-group-header-height) + 6px);\n  width: calc(var(--lit-group-header-height) + 6px);\n}\n\n:host([minimized]) .outside {\n  width: calc(var(--lit-group-header-height) + 2px);\n}\n\n:host([minimized]) .wrapper {\n  width: calc(var(--lit-group-header-height) + 2px);\n}\n\n:host([minimized]) .header {\n  padding-top: 8px;\n  padding-bottom: 2px; /* top icon should align with horizontal toolbar */\n  padding-left: 0;\n  padding-right: 0;\n  height: 100%;\n  width: calc(var(--lit-group-header-height) + 2px);\n  writing-mode: vertical-lr;\n  transform: rotate(180deg);\n}\n\n:host([minimized]) .header > * {\n  margin: 2px 0;\n}\n\n:host([minimized]) mwc-icon {\n  /* Undo outer rotation, so these are oriented normally. */\n  transform: rotate(90deg);\n}\n\n:host([minimized]) .title {\n  text-align: right;\n  cursor: pointer;\n}\n\n:host([minimized]) .holder {\n  height: 0;\n}\n\n:host([minimized]) lit-widget{\n  display: none;\n}\n`},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`:host {\n  height: 100vh;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  --app-drawer-width: 256px;\n  --app-primary-color: rgb(171, 241, 248);\n  --app-secondary-color: rgb(7, 163, 186);\n  --app-dark-color: rgb(5, 30, 37);\n  --app-dark-text-color: var(--app-secondary-color);\n  --app-light-text-color: white;\n  --app-section-even-color: #f7f7f7;\n  --app-section-odd-color: white;\n}\n\n.page {\n  display: none;\n}\n\n.page[active] {\n  display: block;\n}\n`},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.LAYOUTS=void 0,n(71),n(12),n(5);const i=n(103),r=n(105),o=n(106),a=n(110),s=n(112),c=n(116),l=n(117),d=n(119),u=n(121),h=n(136),p=n(77),f=n(147),m=n(151),g=n(153),v=n(155),y=n(157),b=n(163),_=n(165),x=n(166),w=n(177),S=n(181),M=n(71),E=n(183),T=n(186),C=[M.SpanGraphGoldModuleVertical,M.SpanGraphModuleVertical,o.ClassificationModule,v.MultilabelModule,b.RegressionModule,m.LanguageModelPredictionModule,p.GeneratedTextModule,i.AnnotatedTextGoldModule,i.AnnotatedTextModule,h.GeneratedImageModule],A=[l.DataTableModule,d.DatapointEditorModule,S.SliceModule,a.ColorModule];e.LAYOUTS={simple:{upper:{Editor:[d.SimpleDatapointEditorModule],Examples:[l.SimpleDataTableModule]},lower:{Predictions:[...C],Salience:[_.SalienceMapModule,w.SequenceSalienceModule]},layoutSettings:{hideToolbar:!0,mainHeight:30,centerPage:!0},description:\"A basic layout just containing a datapoint creator/editor, the predictions, and the data table. There are also some visual simplifications: the toolbar is hidden, and the modules are centered on the page rather than being full width.\"},default:{components:{Main:[u.EmbeddingsModule,...A],Predictions:[...C,x.ScalarModule,y.PdpModule],Explanations:[...C,_.SalienceMapModule,w.SequenceSalienceModule,r.AttentionModule],Metrics:[g.MetricsModule,s.ConfusionMatrixModule,T.ThresholderModule],Counterfactuals:[f.GeneratorModule,c.CounterfactualExplainerModule],TCAV:[E.TCAVModule]},description:\"The default LIT layout, which includes the data table and data point editor, the performance and metrics, predictions, explanations, and counterfactuals.\"}}},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.SpanGraphVis=void 0;const i=n(1),r=i.__importStar(n(21)),o=n(3),a=n(2),s=n(13),c=n(17),l=n(33);n(5);const d=n(101);function u(t,e,n){return[[0,0],[n,e],[t-n,e],[t,0]]}function h(t,e,n,i,r){const o=Math.min(e,n),a=Math.max(e,n);let s=`M ${o} ${t} `;if(a-o>2*r*i){const e=r*i;s+=`A ${e} ${i} 0 0 1 ${o+e} ${t-i} `,s+=`L ${a-e} ${t-i} `,s+=`A ${e} ${i} 0 0 1 ${a} ${t} `}else s+=`A ${(a-o)/2} ${i=(a-o)/(2*r)} 0 0 1 ${a} ${t} `;return s}function p(t,e,n){let i=`M ${e-n} ${t-1.5*n} `;return i+=`L ${e+n} ${t-1.5*n} `,i+=`L ${e} ${t} Z`,i}let f=class extends o.LitElement{constructor(){super(...arguments),this.data={tokens:[],layers:[]},this.showLayerLabel=!0,this.lineHeight=18,this.bracketHeight=5.5,this.yPad=5,this.arcBaseHeight=20,this.arcMaxHeight=40,this.arcAspect=1.2,this.arcArrowSize=4,this.viewPad=5,this.svgScaling=1.2,this.tokenXBounds=[]}static get styles(){return d.styles}renderTokens(t){return o.svg`\n      <g id='token-group'>\n        <text class='token-text' height=${this.lineHeight}>\n          ${t.map(t=>o.svg`<tspan>${o.svg`${t+\" \"}`}</tspan>`)}\n        </text>\n      </g>`}getTokenGroup(){return this.shadowRoot.querySelector(\"g#token-group\")}renderEdge(t,e){const n=this.lineHeight,i=-(this.bracketHeight+this.lineHeight);let r=t.label,a=!1;\"number\"==typeof t.label&&(r=t.label.toFixed(3),a=t.label<.5);const l=(0,s.classMap)({\"arc-path\":!0,\"arc-neg\":a}),d=(0,s.classMap)({\"arc-arrow\":!0,\"arc-neg\":a});return e=a?\"gray\":e,o.svg`\n      <g class='edge-group' style=${(0,c.styleMap)({\"--group-color\":e})}\n        data-color=${e}>\n        ${t.span2?o.svg`\n          <path class=${l}></path>\n          <path class=${d}></path>\n          `:\"\"}\n        <g class='at-span1'>\n          <polyline class='span-bracket'></polyline>\n          <foreignObject class='span-label' height=${n} y=${i}>\n            ${o.html`<div>${r}</div>`}\n          </foreignObject>\n          <rect class='mousebox'></rect>\n        </g>\n        ${t.span2?o.svg`<g class='at-span2'>\n            <polyline class='span-bracket'></polyline>\n          </g>`:\"\"}\n      </g>\n    `}renderLayer(t,e){const n=(0,l.getVizColor)(\"deep\",e).color,i=-(this.bracketHeight+.5*this.lineHeight),r=this.sortEdges(t.edges);return o.svg`\n      <g id='layer-group-${t.name}' data-color=${n}>\n        ${this.showLayerLabel?o.svg`\n          <g class='layer-label'>\n            <text x=${-10} y=${i} fill=${n}>\n              ${o.svg`${t.name}`}\n            </text>\n          </g>`:null}\n        ${r.map(t=>this.renderEdge(t,n))}\n      </g>\n    `}getLayerGroup(t){return this.shadowRoot.querySelector(\"g#layer-group-\"+t)}render(){return o.svg`\n      <svg id='svg' xmlns='http://www.w3.org/2000/svg'><g id='all'>\n        ${this.data?this.renderTokens(this.data.tokens):\"\"}\n        ${this.data?this.data.layers.map(this.renderLayer.bind(this)):\"\"}\n      </g></svg>`}findTokenBounds(){const t=this.getTokenGroup().querySelectorAll(\"tspan\"),e=[];return t.forEach(t=>{const n=t.getBBox();e.push([n.x,n.x+n.width])}),e}sortEdges(t){return t.slice().sort((t,e)=>r.descending(t.span1[1],e.span1[1]))}getStartX(t){return this.tokenXBounds[t[0]][0]}getEndX(t){return this.tokenXBounds[t[1]-1][1]}findAvailableWidths(t,e){const n=e.map(()=>0);for(let t=1;t<e.length;t++){const i=e[t],r=e[t-1];n[t]=this.getStartX(r.span1)-this.getStartX(i.span1)}const i=t.querySelector(\"g.edge-group foreignObject div\");return null!==i&&(i.style.width=\"fit-content\",n[0]=i.getBoundingClientRect().width),n}setMouseovers(t,e){const n=t.dataset.color,i=(0,l.getVizColor)(\"deep\",\"other\").color,o=r.select(t).selectAll(\"g.edge-group\").data(e),a=r.select(this.getTokenGroup()).selectAll(\"tspan\");o.each((function(t,e){const s=(t,r)=>e===r?n:i,c=(e,i)=>{const r=t.span1[0]<=i&&i<t.span1[1],o=!!t.span2&&(t.span2[0]<=i&&i<t.span2[1]);return r||o?n:\"black\"},l=r.select(this).select(\"rect.mousebox\");l.on(\"mouseover\",()=>{o.style(\"--group-color\",s),a.attr(\"fill\",c),r.select(this).classed(\"selected\",!0)}),l.on(\"mouseout\",()=>{o.style(\"--group-color\",(function(t){return this.dataset.color})),a.attr(\"fill\",\"black\"),r.select(this).classed(\"selected\",!1)})}))}positionLayers(){let t=this.getTokenGroup().getBBox().y-this.yPad/2;for(let e=0;e<this.data.layers.length;e++){const n=this.getLayerGroup(this.data.layers[e].name);n.setAttribute(\"transform\",`translate(0, ${t})`),t-=n.getBBox().height+this.yPad}}setSVGViewport(){const t=this.shadowRoot.querySelector(\"g#all\").getBBox(),e=this.shadowRoot.getElementById(\"svg\"),n=[t.x-this.viewPad,t.y-this.viewPad,t.width+2*this.viewPad,t.height+2*this.viewPad];e.setAttribute(\"viewBox\",\"\"+n),e.setAttribute(\"height\",\"\"+this.svgScaling*(t.height+2*this.viewPad))}updated(){if(null!=this.data){this.tokenXBounds=this.findTokenBounds();for(const t of this.data.layers){const e=this.sortEdges(t.edges),n=this.getLayerGroup(t.name),i=this.findAvailableWidths(n,e);n.querySelectorAll(\"g.edge-group\").forEach((t,n)=>{const r=e[n],o=t.querySelector(\"g.at-span1\");o.setAttribute(\"transform\",`translate(${this.getStartX(r.span1)}, 0)`);const a=this.getEndX(r.span1)-this.getStartX(r.span1),s=u(a,-1*(this.bracketHeight-1),1);o.querySelector(\"polyline\").setAttribute(\"points\",\"\"+s);const c=Math.max(a,i[n]-5);if(t.querySelector(\"foreignObject\").setAttribute(\"width\",\"\"+c),r.span2){const e=t.querySelector(\"g.at-span2\");e.setAttribute(\"transform\",`translate(${this.getStartX(r.span2)}, 0)`);const n=u(this.getEndX(r.span2)-this.getStartX(r.span2),-1*(this.bracketHeight-1),1);e.querySelector(\"polyline\").setAttribute(\"points\",\"\"+n);const i=-1*(this.bracketHeight+this.lineHeight+1),o=(this.getEndX(r.span1)+this.getStartX(r.span1))/2;let a=(this.getEndX(r.span2)+this.getStartX(r.span2))/2;a>o?a-=this.arcArrowSize+2:a+=this.arcArrowSize+2;const s=(r.span1[1]+r.span1[0])/2,c=(r.span2[1]+r.span2[0])/2,l=Math.min(30,Math.abs(c-s)),d=Math.min(this.arcBaseHeight+Math.round((10-l/6)*l),this.arcMaxHeight);t.querySelector(\"path.arc-path\").setAttribute(\"d\",\"\"+h(i,o,a,d,this.arcAspect)),t.querySelector(\"path.arc-arrow\").setAttribute(\"d\",\"\"+p(i,o,this.arcArrowSize))}}),this.setMouseovers(n,e)}this.shadowRoot.querySelectorAll(\"g.edge-group\").forEach(t=>{!function(t,e){const n=t.getBBox();e.setAttribute(\"x\",\"\"+n.x),e.setAttribute(\"y\",\"\"+n.y),e.setAttribute(\"width\",\"\"+n.width),e.setAttribute(\"height\",\"\"+n.height)}(t.querySelector(\"foreignObject\"),t.querySelector(\"rect.mousebox\"))}),this.positionLayers(),this.setSVGViewport()}else this.tokenXBounds=[]}};i.__decorate([(0,a.property)({type:Object}),i.__metadata(\"design:type\",Object)],f.prototype,\"data\",void 0),i.__decorate([(0,a.property)({type:Boolean}),i.__metadata(\"design:type\",Boolean)],f.prototype,\"showLayerLabel\",void 0),i.__decorate([(0,a.property)({type:Number}),i.__metadata(\"design:type\",Number)],f.prototype,\"lineHeight\",void 0),i.__decorate([(0,a.property)({type:Number}),i.__metadata(\"design:type\",Number)],f.prototype,\"bracketHeight\",void 0),i.__decorate([(0,a.property)({type:Number}),i.__metadata(\"design:type\",Number)],f.prototype,\"yPad\",void 0),i.__decorate([(0,a.property)({type:Number}),i.__metadata(\"design:type\",Number)],f.prototype,\"arcBaseHeight\",void 0),i.__decorate([(0,a.property)({type:Number}),i.__metadata(\"design:type\",Number)],f.prototype,\"arcMaxHeight\",void 0),i.__decorate([(0,a.property)({type:Number}),i.__metadata(\"design:type\",Number)],f.prototype,\"arcAspect\",void 0),i.__decorate([(0,a.property)({type:Number}),i.__metadata(\"design:type\",Number)],f.prototype,\"arcArrowSize\",void 0),i.__decorate([(0,a.property)({type:Number}),i.__metadata(\"design:type\",Number)],f.prototype,\"viewPad\",void 0),i.__decorate([(0,a.property)({type:Number}),i.__metadata(\"design:type\",Number)],f.prototype,\"svgScaling\",void 0),f=i.__decorate([(0,a.customElement)(\"span-graph-vis\")],f),e.SpanGraphVis=f},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`text.token-text {\n  alignment-baseline: middle;\n  dominant-baseline: central;\n}\n\npolyline.span-bracket {\n  fill: none;\n  stroke-width: 1.2px;\n  stroke: var(--group-color);\n}\n\n.selected polyline.span-bracket {\n  stroke-width: 1.8px;\n}\n\npath.arc-path {\n  stroke-width: 1.2px;\n  stroke: var(--group-color);\n  fill: none;\n}\n\npath.arc-path.arc-neg {\n  stroke-dasharray: 3,1;\n  stroke: gray;\n}\n\n.selected path.arc-path {\n  stroke-width: 1.8px;\n}\n\npath.arc-arrow {\n  stroke-width: 1.2px;\n  stroke: var(--group-color);\n  fill: var(--group-color);\n}\n\npath.arc-arrow.arc-neg {\n  stroke: gray;\n  fill: gray;\n}\n\n\n.layer-label text {\n  font-family: 'Share Tech Mono', monospace;\n  dominant-baseline: middle;\n  text-anchor: end;\n}\n\nforeignObject.span-label {\n  overflow: visible;\n}\n\n.span-label div {\n  background-color: white;\n  font-family: 'Share Tech Mono', monospace;\n  line-height: 1.0;\n  padding: 1px;\n  padding-right: 3px; /* for occluding labels on mouseover */\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  color: var(--group-color);\n}\n\ng.selected .span-label div {\n  background-color: white;\n  overflow-x: visible;\n  width: fit-content;  /* needed to include background when expanding */\n}\n\n.mousebox {\n  fill: white;\n  fill-opacity: 0.0;\n}\n`},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`.holder {\n  display: flex;\n  font-family: 'Share Tech Mono', monospace;\n  position: relative;\n  color: #555;\n}\n.layer {\n  cursor: pointer;\n  color: var(--group-color);\n}\n.layer-label-vert {\n  top: calc(0px - var(--line-height));\n  position: absolute;\n  padding-left: 5pt;\n  display: flex;\n  transform: rotate(0deg);\n  transition: .25s transform;\n  transform-origin: 10px 10px;\n  color: var(--group-color);\n}\n.layer-label-vert.hidden {\n  transform: rotate(-90deg);\n}\n.column {\n  position: relative;\n  height: 100%;\n  transition: .25s width;\n}\n.column.hidden {\n  width: 10pt !important;\n  opacity: 0;\n}\n.tokens {\n  z-index: 1;\n}\n.line {\n  height: var(--line-height);\n  box-sizing: border-box;\n  padding: 0 5pt;\n  text-align: right;\n  white-space: nowrap;\n}\n.token.selected{\n  color: black;\n}\n.child {\n  font-weight: bold;\n  filter: hue-rotate(-40deg);\n  border-width: 2pt\n}\n.parent {\n  font-weight: bold;\n  filter: hue-rotate(40deg);\n  border-width: 2pt;\n}\n.selected {\n  font-weight: bold;\n  border-width: 2pt;\n}\n\n.gray {\n  border-color: #ddd !important;\n  color: #ddd\n}\n\n.edge {\n  position: absolute;\n}\n.edge-line {\n  border: 1pt solid var(--group-color);\n  border-left: 0;\n  width: 2pt;\n  left: -2pt;\n}\n.arrow-head {\n  border: 5px solid transparent;\n  border-right: 5px solid var(--group-color);\n  width: 0;\n  height: 0;\n  top: -4pt;\n  left: -4pt;\n  position: absolute;\n}\n.gray .arrow-head{\n  border-right-color: #ddd;\n}\n.arrow-head.bottom{\n  bottom: -4pt;\n  top: unset;\n}\n.background-lines{\n  position: absolute;\n  width: 100%;\n  top: -2pt;\n}\n.background-line {\n  height: var(--line-height);\n  width: 100%;\n  padding: 0 5pt;\n}\n.background-line:nth-child(odd){\n  background: #f5f5f5;\n}\n`},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.AnnotatedTextModule=e.AnnotatedTextGoldModule=void 0;const i=n(1);n(73);const r=n(2),o=n(3),a=n(4),s=n(12);n(73),n(5);const c=n(8),l=n(7);let d=class extends s.LitModule{static get styles(){return l.styles}render(){const t=this.selectionService.primarySelectedInputData;if(!t)return null;const e=this.appState.currentDatasetSpec,n=(0,c.findSpecKeys)(e,\"TextSegment\"),i=(0,c.filterToKeys)(t.data,n),r=(0,c.filterToKeys)(e,n),a=(0,c.findSpecKeys)(e,\"MultiSegmentAnnotations\"),s=(0,c.filterToKeys)(t.data,a),l=(0,c.filterToKeys)(e,a),d=!this.appState.compareExamplesEnabled&&this.appState.currentModels.length>1;return o.html`\n      ${d?o.html`<div class='offset-for-module-header'></div>`:null}\n      <annotated-text-vis .segments=${i}\n                          .segmentSpec=${r}\n                          .annotations=${s}\n                          .annotationSpec=${l}>\n      </annotated-text-vis>`}static shouldDisplayModule(t,e){return(0,c.findSpecKeys)(e,\"MultiSegmentAnnotations\").length>0}};d.title=\"Annotated Text (gold)\",d.duplicateForExampleComparison=!0,d.duplicateForModelComparison=!1,d.numCols=4,d.template=(t=\"\",e=0)=>o.html`\n      <annotated-text-gold-module\n        selectionServiceIndex=${e}>\n      </annotated-text-gold-module>`,d=i.__decorate([(0,r.customElement)(\"annotated-text-gold-module\")],d),e.AnnotatedTextGoldModule=d;let u=class extends s.LitModule{constructor(){super(...arguments),this.currentPreds={}}static get styles(){return l.styles}firstUpdated(){this.reactImmediately(()=>this.selectionService.primarySelectedInputData,t=>{this.updateToSelection(t)})}updateToSelection(t){return i.__awaiter(this,void 0,void 0,(function*(){if(null==t)return this.currentData=void 0,void(this.currentPreds={});this.currentData=t,this.currentPreds={};const e=this.apiService.getPreds([t],this.model,this.appState.currentDataset,[\"MultiSegmentAnnotations\"],\"Retrieving annotations\"),n=yield this.loadLatest(\"answers\",e);null!==n&&(this.currentData=t,this.currentPreds=n[0])}))}render(){if(!this.currentData)return null;const t=(0,c.findSpecKeys)(this.appState.currentDatasetSpec,\"TextSegment\"),e=(0,c.filterToKeys)(this.currentData.data,t),n=(0,c.filterToKeys)(this.appState.currentDatasetSpec,t),i=this.appState.getModelSpec(this.model).output,r=(0,c.filterToKeys)(i,(0,c.findSpecKeys)(i,\"MultiSegmentAnnotations\"));return o.html`\n      <annotated-text-vis .segments=${e}\n                          .segmentSpec=${n}\n                          .annotations=${this.currentPreds}\n                          .annotationSpec=${r}>\n      </annotated-text-vis>`}static shouldDisplayModule(t,e){return(0,c.doesOutputSpecContain)(t,\"MultiSegmentAnnotations\")}};u.title=\"Annotated Text (predicted)\",u.duplicateForExampleComparison=!0,u.duplicateForModelComparison=!0,u.numCols=4,u.template=(t=\"\",e=0)=>o.html`\n      <annotated-text-module model=${t}\n       selectionServiceIndex=${e}>\n      </annotated-text-module>`,i.__decorate([a.observable,i.__metadata(\"design:type\",Object)],u.prototype,\"currentData\",void 0),i.__decorate([a.observable,i.__metadata(\"design:type\",Object)],u.prototype,\"currentPreds\",void 0),u=i.__decorate([(0,r.customElement)(\"annotated-text-module\")],u),e.AnnotatedTextModule=u},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`.main-container {\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  padding: 5px;\n}\n\n.group {\n  margin-bottom: 5px;\n}\n\n.group-title {\n  font-weight: bold;\n  margin-bottom: 3px;\n}\n\n.segments-column {\n  margin-right: 20px;\n}\n\n.annotations-column {\n  min-width: 20%;\n}\n\n.cluster-container {\n  display: flex;\n  flex-direction: row;\n  margin-bottom: 2px;\n  padding-left: 3px;\n  padding-right: 3px;\n  border-bottom: 1px solid white;\n}\n\n.cluster-label {\n  min-width: 10%;\n  max-width: 30%;\n  margin-right: 10px;\n}\n\n.cluster-spans {\n  padding-right: 5px;\n}\n\n.cluster-active {\n  background: var(--group-color);\n  border-bottom: 1px solid black; /* underline-like, but cleaner */\n}\n\n.span-active {\n  border-bottom: 1px solid black; /* underline-like, but cleaner */\n}\n\n.no-data {\n  color: #5f6368;\n}\n`},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.AttentionModule=void 0;const i=n(1),r=n(2),o=n(3),a=n(13),s=n(4),c=n(15),l=n(12),d=n(5),u=n(8),h=n(11),p=n(7),f=n(33);let m=class extends l.LitModule{constructor(){super(...arguments),this.focusService=c.app.getService(h.FocusService),this.selectedHeadIndex=0}static get styles(){const t=o.css`\n        .head-selector-chip {\n          margin: 0px 1px;\n          width: 1rem;\n          text-align: center;\n        }\n\n        .head-selector-chip.selected {\n          color: var(--lit-cyea-600);\n          border-color: var(--lit-cyea-600);\n        }\n\n        .head-selector-chip:hover {\n          background: var(--lit-cyea-100);\n          cursor: pointer;\n        }\n\n        .padded-container {\n          padding: 4px 8px;\n        }\n    `;return[p.styles,t]}firstUpdated(){this.reactImmediately(()=>this.selectionService.primarySelectedInputData,t=>{this.updateSelection(t)})}updateSelection(t){return i.__awaiter(this,void 0,void 0,(function*(){if(this.preds=void 0,null===t)return;const e=this.appState.currentDataset,n=this.apiService.getPreds([t],this.model,e,[\"Tokens\",\"AttentionHeads\"],\"Fetching attention\"),i=yield this.loadLatest(\"attentionAndTokens\",n);if(null===i)return;this.preds=i[0];const r=null!=this.preds[this.selectedLayer]?this.preds[this.selectedLayer].length:0;this.selectedHeadIndex>=r&&(this.selectedHeadIndex=0)}))}render(){if(this.preds)return o.html`\n      <div class='module-container'>\n        <div class='module-toolbar'>\n          ${this.renderLayerSelector()}\n          ${this.renderHeadSelector()}\n        </div>\n        <div class='module-results-area padded-container ${d.SCROLL_SYNC_CSS_CLASS}'>\n          ${this.renderAttnHead()}\n        </div>\n      </div>\n    `}renderAttnHead(){const t=this.appState.currentModelSpecs[this.model].spec.output[this.selectedLayer],e=this.preds[t.align_in],n=this.preds[t.align_out],i=\"12px 'Share Tech Mono', monospace\",r=e.map(t=>(0,u.getTextWidth)(t,i,6.5)),a=n.map(t=>(0,u.getTextWidth)(t,i,6.5)),s=(0,u.getTextWidth)(\" \",i,6.5),c=(0,u.sumArray)(r)+(e.length-1)*s,l=(0,u.sumArray)(a)+(n.length-1)*s,d=Math.max(c,l),h=(0,u.getTokOffsets)(r,s),p=(0,u.getTokOffsets)(a,s),f=this.focusService.focusData;let m=null,g=null;const v=null!=f&&f.datapointId===this.selectionService.primarySelectedInputData.id;!v||f.fieldName!==t.align_out&&f.fieldName!==t.align_in||(m=f.fieldName===t.align_in?f.subField:-1,g=f.fieldName===t.align_out?f.subField:-1);const y=()=>{null!=this.clearFocusTimer&&clearTimeout(this.clearFocusTimer),this.clearFocusTimer=setTimeout(()=>{this.focusService.clearFocus()},500)},b=(e,n,i)=>{const r=i?t.align_in:t.align_out,a=i?h[n]:p[n],s=o.svg`${e}`;let c=1;v&&f.fieldName===r&&f.subField!==n&&(c=.2);const l=i?140:20;return o.svg`<text y=${l} x=${a} opacity=${c}\n          @mouseover=${()=>{clearTimeout(this.clearFocusTimer),this.focusService.setFocusedField(this.selectionService.primarySelectedInputData.id,\"input\",r,n)}} @mouseout=${()=>{y()}}> ${s}</text>`};return o.svg`\n    <svg width=${d} height=${164}\n      font-family=\"${\"'Share Tech Mono', monospace\"}\"\n      font-size=\"${12}px\">\n      ${n.map((t,e)=>b(t,e,!1))}\n      ${this.renderAttnLines(100,s,25,r,a,m,g)}\n      ${e.map((t,e)=>b(t,e,!0))}\n    </svg>\n    `}renderAttnLines(t,e,n,i,r,a,s){const c=(0,u.getTokOffsets)(i,e),l=(0,u.getTokOffsets)(r,e),d=n,h=n+t;return this.preds[this.selectedLayer][this.selectedHeadIndex].map((t,e)=>o.svg`\n            ${t.map((t,n)=>null!=a&&null!=s&&e!==a&&n!==s?null:o.svg`\n                  <line\n                    x1=${(t=>l[t]+r[t]/2)(e)}\n                    y1=${d}\n                    x2=${(t=>c[t]+i[t]/2)(n)}\n                    y2=${h}\n                    stroke=\"${(0,f.getBrandColor)(\"cyea\",\"600\").color}\"\n                    stroke-opacity=\"${t}\"\n                    stroke-width=2>\n                  </line>`)}`)}renderLayerSelector(){const t=this.appState.currentModelSpecs[this.model].spec.output,e=(0,u.findSpecKeys)(t,\"AttentionHeads\");void 0===this.selectedLayer&&(this.selectedLayer=e[0]);return o.html`\n      <select class=\"dropdown\" @change=${t=>{this.selectedLayer=t.target.value}}>\n        ${e.map(t=>o.html`<option value=${t}>${t}</option>`)}\n      </select>\n    `}renderHeadSelector(){const t=this.preds[this.selectedLayer].length,e=Array.from({length:t},(t,e)=>e);return o.html`\n        <label class=\"head-selector-label\">Head:</label>\n        ${e.map(t=>{const e=(0,a.classMap)({\"head-selector-chip\":!0,\"token-chip-function\":!0,selected:t===this.selectedHeadIndex});return o.html`<div class=${e} @click=${()=>{this.selectedHeadIndex=t}}>${t}</div>`})}\n    `}static shouldDisplayModule(t,e){return(0,u.doesOutputSpecContain)(t,\"AttentionHeads\")}};m.title=\"Attention\",m.numCols=3,m.duplicateForExampleComparison=!0,m.template=(t=\"\",e=0)=>o.html`<attention-module model=${t} selectionServiceIndex=${e}></attention-module>`,i.__decorate([s.observable,i.__metadata(\"design:type\",String)],m.prototype,\"selectedLayer\",void 0),i.__decorate([s.observable,i.__metadata(\"design:type\",Number)],m.prototype,\"selectedHeadIndex\",void 0),i.__decorate([s.observable,i.__metadata(\"design:type\",Object)],m.prototype,\"preds\",void 0),m=i.__decorate([(0,r.customElement)(\"attention-module\")],m),e.AttentionModule=m},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.ClassificationModule=void 0;const i=n(1),r=n(2),o=n(3),a=n(4),s=n(15),c=n(12);n(40),n(74);const l=n(5),d=n(8);n(44);const u=n(11),h=n(109),p=n(7);let f=class extends c.LitModule{constructor(){super(...arguments),this.classificationService=s.app.getService(u.ClassificationService),this.labeledPredictions={}}static get styles(){return[p.styles,h.styles]}firstUpdated(){this.react(()=>this.selectionService.primarySelectedInputData,t=>{this.updateSelection()});this.react(()=>this.classificationService.allMarginSettings,t=>{this.updateSelection()}),this.updateSelection()}updateSelection(){return i.__awaiter(this,void 0,void 0,(function*(){const t=this.selectionService.primarySelectedInputData;if(null===t)return void(this.labeledPredictions={});const e=this.classificationService.getClassificationPreds([t],this.model,this.appState.currentDataset),n=yield this.loadLatest(\"multiclassPreds\",e);null!==n&&(this.labeledPredictions=yield this.parseResult(n[0],t))}))}parseResult(t,e){return i.__awaiter(this,void 0,void 0,(function*(){const n=this.appState.currentModelSpecs[this.model].spec.output,i=(0,d.findSpecKeys)(n,\"MulticlassPreds\"),r=Object.keys(t),o={};for(let a=0;a<r.length;a++){const s=r[a];if(!i.includes(s))continue;const c=n[s].parent,l=t[s],d=(yield this.classificationService.getResults([e.id],this.model,s))[0],u=this.classificationService.getLabelNames(this.model,s),h=l.map((t,n)=>{const i={value:t,label:u[n].toString(),i:n,isPredicted:n===d.predictedClassIdx};return null!=c&&e.data[c]===u[n]&&(i.isGroundTruth=!0),i});o[s]=h}return o}))}render(){const t=Object.keys(this.labeledPredictions);return o.html`\n        ${t.map(t=>this.renderRow(t,this.labeledPredictions[t]))}\n    `}renderRow(t,e){var n;const i=e.map(t=>[t.label,(0,l.formatBoolean)(t.isGroundTruth),(0,l.formatBoolean)(t.isPredicted),{template:o.html`\n            <score-bar score=${t.value} maxScore=${1}></score-bar>`,value:t.value}]),r=null===(n=this.appState.currentModelSpecs[this.model].spec.output.preds)||void 0===n?void 0:n.autosort;return o.html`\n        <div class='classification-row-holder'>\n          <div class='field-name row-title'>${t}</div>\n          <lit-data-table\n            .columnNames=${[\"Class\",\"Label\",\"Predicted\",\"Score\"]}\n            .data=${i}\n            .sortName=${r?\"Score\":void 0}\n            .sortAscending=${!r}\n          ></lit-data-table>\n        </div>`}static shouldDisplayModule(t,e){return(0,d.doesOutputSpecContain)(t,\"MulticlassPreds\")}};f.title=\"Classification Results\",f.duplicateForExampleComparison=!0,f.numCols=3,f.template=(t=\"\",e=0)=>o.html`<classification-module model=${t} selectionServiceIndex=${e}></classification-module>`,i.__decorate([a.observable,i.__metadata(\"design:type\",Object)],f.prototype,\"labeledPredictions\",void 0),f=i.__decorate([(0,r.customElement)(\"classification-module\")],f),e.ClassificationModule=f},function(t,e,n){\"use strict\";n.r(e);var i=n(48);n.d(e,\"TemplateResultType\",(function(){return i.a})),n.d(e,\"clearPart\",(function(){return i.b})),n.d(e,\"getCommittedValue\",(function(){return i.c})),n.d(e,\"getDirectiveClass\",(function(){return i.d})),n.d(e,\"insertPart\",(function(){return i.e})),n.d(e,\"isDirectiveResult\",(function(){return i.f})),n.d(e,\"isPrimitive\",(function(){return i.g})),n.d(e,\"isSingleExpression\",(function(){return i.h})),n.d(e,\"isTemplateResult\",(function(){return i.i})),n.d(e,\"removePart\",(function(){return i.j})),n.d(e,\"setChildPartValue\",(function(){return i.k})),n.d(e,\"setCommittedValue\",(function(){return i.l}))},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`:host {\n  --table-header-height: 40px;\n  --table-footer-height: 26px;\n  --table-cell-padding: 4px 8px;\n}\n\n.holder {\n  height: 100%;\n  padding: 0px 1px; /* avoid spurious horizontal scrollbar */\n}\n\n.holder table {\n  width: 100%;\n  min-width: 100%;\n  border-spacing: 0;\n  color: var(--lit-gray-800);\n  position: relative;\n  z-index: 0;\n}\n\n/**\n * Header styles\n */\n.holder table > thead {\n  position: sticky;\n  top: 0;\n  height: var(--table-header-height);\n  z-index: 1;\n  background: #f5fcfc;\n}\n\n.holder table > thead > th {\n  font-weight: 400;\n  color: #04394b;\n  border-bottom: solid 1px #dadce0;\n}\n\n.column-header {\n  cursor: pointer;\n  display: flex;\n  flex-grow: 1;\n  flex-direction: row;\n  align-items: center;\n  position: relative;\n  box-sizing: border-box;\n}\n\n.column-header.right-align {\n  justify-content: flex-end;\n}\n\n.header-holder {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: var(--table-cell-padding);\n}\n\n.header-text {\n  flex: 1;\n  text-align: center;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  max-height: 100%;\n}\n\n.arrow-container {\n  width: 16px;\n  height: 20px;\n  right: 8px;\n  position: relative;\n  user-select: none;\n}\n\n.arrow {\n  position: absolute;\n  --mdc-icon-size: 24px;\n  color: rgba(0,0,0,0.1);\n}\n\n.arrow.up {\n  top: -6px;\n}\n\n.arrow.down {\n  top: 2px;\n}\n\n.arrow.active {\n  color: var(--app-dark-color);\n}\n\n.arrow.inactive {\n  color: rgba(0,0,0,0);\n}\n\n.menu-button-container {\n  width: 20px;\n  height: 20px;\n  user-select: none;\n  padding-left: 4px;\n}\n\n.menu-button {\n  --mdc-icon-size: 20px;\n}\n\n.menu-button:hover {\n  opacity: .7;\n}\n\n.togglable-menu-holder {\n  background-color: #eff6f8; /* light gray-blue */\n  border: 1px solid;\n  border-radius: 2pt;\n  border-color: rgb(218, 220, 224);\n  position: absolute;\n}\n\n.search-input {\n  width:100%;\n}\n\n/**\n * Body styles\n */\ntbody tr:hover {\n  background: var(--lit-mage-200);\n}\n\ntbody tr.selected {\n  background: var(--lit-cyea-100);\n  color: var(--lit-gray-800);\n  transition-duration: 0.2s;\n  transition-property: background-color;\n}\n\ntbody tr.primary-selected {\n  background: var(--lit-cyea-300);\n  color: black;\n  transition-duration: 0.2s;\n  transition-property: background-color;\n}\n\ntbody tr.focused {\n  background: rgba(255, 0, 0, 0.2);\n  transition-duration: 0.2s;\n  transition-property: background-color;\n}\n\ntbody tr.reference-selected {\n  outline: 1px solid #2f8c9b;\n}\n\ntbody td {\n  vertical-align: top;\n  min-width: 80px;\n  box-sizing: border-box;\n}\n\n.n-rows {\n  margin-left: 20px;\n}\n\n.cell-holder {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: var(--table-cell-padding);\n}\n\n.cell-holder.right-align {\n  justify-content: flex-end;\n}\n\n.text-cell {\n  max-height: 150px;\n  overflow: auto;\n  white-space: pre-wrap;\n}\n\n/* TODO(lit-dev): Make the table image width configurable. */\n.table-img {\n  width: 100px;\n}\n\n\n/**\n * Footer styles\n */\n.holder table > tfoot {\n  position: sticky;\n  bottom: 0;\n  height: var(--table-footer-height);\n\n  background: #f5fcfc;\n}\n\n.footer {\n  color: #04394b;\n  font-weight: 400;\n  font-size: 10pt;\n  line-height: 12pt;\n  padding: 3px;\n\n  display: flex;\n  flex-direction: row;\n}\n\n.current-page-num {\n  display: inline-block;\n  text-align: center;\n  min-width: 16px;\n}\n\n/**\n * For standalone MWC icons as buttons. We don't use mwc-icon-button because it\n * adds a large backdrop and extra whitespace.\n */\n.icon-button:hover {\n  color: var(--lit-neutral-900);\n}\n.button-extra-margin {\n  margin-left: 4px;\n}\n`},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`.field-name {\n  font-weight: bold;\n  color: var(--lit-bold-label-color);\n}\n\n.row-title {\n  padding: 4px 8px;\n}\n\n.classification-row-holder {\n  padding-bottom: 10px;\n}\n`},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.ColorModule=void 0;const i=n(1),r=n(2),o=n(3),a=n(17),s=n(15),c=n(12);n(5),n(5);const l=n(8),d=n(11),u=n(111),h=n(7);let p=class extends c.LitModule{constructor(){super(...arguments),this.colorService=s.app.getService(d.ColorService)}static get styles(){return[h.styles,u.styles]}render(){const t=this.colorService.colorableOptions.map((t,e)=>{const n=this.colorService.selectedColorOption.name===t.name;return o.html`<option value=${e} ?selected=${n}>\n          ${t.name}</option>`}),e=\"number\"==typeof this.colorService.selectedColorOption.scale.domain()[0];return o.html`\n      <div class=\"top-holder\">\n        <div class=\"dropdown-container\">\n          <label class=\"dropdown-label\">Color by:</label>\n          <select class=\"dropdown color-dropdown\" @change=${t=>{const e=t.target,n=(null==e?void 0:e.selectedIndex)||0;this.colorService.selectedColorOption=this.colorService.colorableOptions[n]}}>\n            ${t}\n          </select>\n        </div>\n        ${(()=>e?this.renderNumericScale(this.colorService.selectedColorOption.scale):this.renderCategoricalScale())()}\n      </div>\n      `}renderCategoricalScale(){const t=t=>{const e=this.colorService.selectedColorOption.scale(t),n=(0,a.styleMap)({background:e});return o.html`\n        <div class='legend-line'>\n          <div class='legend-box' style=${n}></div>\n          <div class='dropdown-label'>${t}</div>\n        </div>\n      `},e=this.colorService.selectedColorOption.scale.domain();return o.html`\n        <div class=\"line-holder\">\n          ${e.map(e=>t(e))}\n        </div>\n        `}renderNumericScale(t){const e=(0,l.range)(200),n=(0,l.range)(5),i=t.domain(),r=i[1]-i[0];return o.html`\n      <div class='numeric-legend-holder'>\n        <div class='numeric-legend'>\n          ${e.map(e=>{const n=t(i[0]+e/200*r),s=(0,a.styleMap)({background:n});return o.html`<div class='legend-pixel' style=${s}></div>`})}\n        </div>\n        <div class='tick-legend'>\n        ${n.map(t=>{const e=t/4*200,n=(0,a.styleMap)({top:e+\"px\",position:\"absolute\"}),s=i[0]+t/4*r;return o.html`\n              <div class='tick-holder' style=${n}>\n                <div class='tick'></div>\n                <div class='tick-label'>${s.toFixed(2)}</div>\n              </div>`})}\n        </div>\n      </div>`}static shouldDisplayModule(t,e){return!0}};p.title=\"Color\",p.numCols=1,p.collapseByDefault=!0,p.duplicateForModelComparison=!1,p.template=()=>o.html`<color-module></color-module>`,p=i.__decorate([(0,r.customElement)(\"color-module\")],p),e.ColorModule=p},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`/**\n * Padding and margins attempt to match the offsets of the left-\n * and right-most visual elements in the main app toolbar.\n */\n.toolbar {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  align-items: center;\n  justify-content: space-between;\n  padding-left: 4pt;\n  padding-right: 4pt;\n}\n\n.toolbar button {\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.main-toolbar {\n  background-color: #dcecef; /* light gray-blue */\n}\n\n.togglable-toolbar-holder {\n  background-color: #eff6f8; /* light gray-blue */\n  width: fit-content; /* set to 100% to span page */\n  border: 1px solid;\n  border-radius: 2pt;\n  border-color: rgb(218, 220, 224);\n  position: absolute;\n}\n\n#slice-toolbar-container {\n  right: 0; /* remove to span page */\n}\n\n#status-group-left {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  margin: 4pt;\n}\n\n#button-holder-right {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: flex-end;\n  flex-grow: 2;\n  margin: 4pt;\n}\n\n#primary-selection-status {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  margin-left: 4pt;\n}\n\n/* For in-line icons in a <span> */\n[data-icon] {\n  margin: 0;\n}\n\n[data-icon]:before {\n  font-family: 'Material Icons';\n  content: attr(data-icon);\n  vertical-align: middle;\n}\n\n#favorite-button {\n  margin-left: 5pt;\n}\n\n#legend-container {\n  top: 100%;\n  margin-left: -8pt; /* To account for button padding */\n  cursor: default;\n}\n\n.dropdown-container {\n  margin-top: 5px;\n}\n\n.dropdown-label {\n  margin-left: 3px;\n  margin-right: 2px;\n}\n\n.legend-line {\n  display: flex;\n  align-items: center;\n}\n.legend-box{\n  width: 10pt;\n  height: 10pt;\n  margin: 5px;\n}\n.legend-pixel {\n  height: 1px;\n  width: 10px;\n  border-left: 1px solid black;\n}\n.numeric-legend {\n  display: flex;\n  flex-direction: column;\n}\n.numeric-legend-holder {\n  display: flex;\n  margin-top: 25px;\n  margin-left: 50px;\n}\n.tick {\n  width: 8px;\n  border-top: 1px solid black;\n  height: 1px;\n  margin-left: -19px;\n}\n.tick-legend {\n  position: relative;\n  height: 22px;\n  width: fit-content;\n}\n.tick-label {\n  font-size: 8pt;\n  margin-left: -50px;\n  margin-top: -8px;\n}\n.color-dropdown {\n  min-width: 60px;\n  margin-left: 3px;\n}\n.top-holder {\n  display: flex;\n  flex-direction: column;\n}\n.line-holder {\n  margin-top: 20px;\n}\n`},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.ConfusionMatrixModule=void 0;const i=n(1),r=n(2),o=n(3),a=n(4),s=n(15),c=n(12);n(113),n(5);const l=n(8);n(44);const d=n(32),u=n(11),h=n(115),p=n(7);let f=class extends c.LitModule{constructor(){super(),this.classificationService=s.app.getService(u.ClassificationService),this.groupService=s.app.getService(d.GroupService),this.verticalColumnLabels=!1,this.hideEmptyLabels=!1,this.updateOnSelection=!0,this.selectedRowOption=0,this.selectedColOption=0,this.lastSelectedRow=-1,this.lastSelectedCol=-1,this.MAX_ENTRIES=50,this.matrices={},this.setInitialOptions()}static get styles(){return[p.styles,h.styles]}firstUpdated(){this.react(()=>this.appState.currentInputData,t=>{this.matrices={},this.calculateMatrix(this.selectedRowOption,this.selectedColOption)});this.react(()=>this.classificationService.allMarginSettings,t=>{this.updateMatrices()});this.react(()=>this.updateOnSelection,t=>{this.updateMatrices()});this.react(()=>this.selectionService.selectedInputData,t=>i.__awaiter(this,void 0,void 0,(function*(){if(this.selectionService.lastUser!==this&&this.updateOnSelection&&(yield this.updateMatrices()),this.selectionService.lastUser===this)for(const t of Object.keys(this.matrices)){const[e,n]=this.getOptionsFromMatrixId(t);e===this.lastSelectedRow&&n===this.lastSelectedCol||(yield this.calculateMatrix(e,n))}}))),this.calculateMatrix(this.selectedRowOption,this.selectedColOption)}setInitialOptions(){for(let t=0;t<this.options.length;t++){const e=this.options[t].parent;if(void 0!==e){for(let t=0;t<this.options.length;t++)if(this.options[t].name===e){this.selectedRowOption=t;break}this.selectedColOption=t;break}}}get options(){const t=this.appState.currentModels,e=[],n=this.groupService.categoricalFeatures;for(const t of Object.keys(n)){const r=n[t];if(r.length>this.MAX_ENTRIES)continue;const o=this.groupService.numericalFeatureBins([{featureName:t,method:d.FacetingMethod.DISCRETE}]),a=(e,n)=>this.groupService.getFeatureValForInput(o,e,t),s=t=>i.__awaiter(this,void 0,void 0,(function*(){return t.map(a)}));e.push({name:t,labelList:r,runner:s})}for(const n of t){const t=this.appState.getModelSpec(n).output;for(const r of(0,l.findSpecKeys)(t,\"MulticlassPreds\")){const o=t[r].parent,a=t[r].vocab;if(a.length>this.MAX_ENTRIES)continue;const s=t=>i.__awaiter(this,void 0,void 0,(function*(){const e=(yield this.classificationService.getClassificationPreds(t,n,this.appState.currentDataset)).map((e,o)=>i.__awaiter(this,void 0,void 0,(function*(){return this.classificationService.getResults([t[o].id],n,r)})));return(yield Promise.all(e)).map(t=>a[t[0].predictedClassIdx])}));e.push({name:`${n}:${r}`,labelList:a,runner:s,parent:o})}}return e}updateMatrices(){return i.__awaiter(this,void 0,void 0,(function*(){for(const t of Object.keys(this.matrices)){const[e,n]=this.getOptionsFromMatrixId(t);yield this.calculateMatrix(e,n)}}))}calculateMatrix(t,e){return i.__awaiter(this,void 0,void 0,(function*(){const n=this.options[t],i=this.options[e],r=n.labelList,o=i.labelList,a=n.name,s=i.name,c=this.updateOnSelection?this.selectionService.selectedOrAllInputData:this.appState.currentInputData;if(0===c.length)return;const u=n.runner(c),h=i.runner(c),p=Promise.all([u,h]),f=yield this.loadLatest(\"rowAndColIdxs\",p);if(null===f)return;const m={[a]:f[0],[s]:f[1]},g=this.groupService.numericalFeatureBins([{featureName:a,method:d.FacetingMethod.DISCRETE},{featureName:s,method:d.FacetingMethod.DISCRETE}]),v=this.groupService.groupExamplesByFeatures(g,c,[a,s],(t,e,n,i)=>m[i][n]),y=this.getMatrixId(t,e),b=r.map(t=>o.map(e=>{if(s===a&&e!==t)return{ids:[],selected:!1};const n={[s]:{val:e,displayVal:e},[a]:{val:t,displayVal:t}},i=v[(0,l.facetMapToDictKey)(n)];return{ids:i?i.data.map(t=>t.id):[],selected:!1}}));this.matrices[y]=b}))}getMatrixId(t,e){return`${t}:${e}`}getOptionsFromMatrixId(t){return t.split(\":\").map(t=>+t)}canCreateMatrix(t,e){if(t===e)return!1;const n=this.getMatrixId(t,e);return null==this.matrices[n]}get matrixCreateTooltip(){return this.selectedRowOption===this.selectedColOption?\"Must set different row and column options\":null!=this.matrices[this.getMatrixId(this.selectedRowOption,this.selectedColOption)]?\"Matrix for current row and column options already exists\":\"\"}render(){return o.html`\n      <div class='module-container'>\n        <div class='module-toolbar'>\n          ${this.renderControls()}\n        </div>\n        <div class='module-results-area matrices-holder'>\n          ${(()=>Object.keys(this.matrices).map(t=>{const[e,n]=this.getOptionsFromMatrixId(t);return this.renderMatrix(e,n,this.matrices[t])}))()}\n        </div>\n      </div>\n    `}renderControls(){return o.html`\n      <div class=\"flex\">\n        <lit-checkbox\n          label=\"Update on selection\"\n          ?checked=${this.updateOnSelection}\n          @change=${()=>{this.updateOnSelection=!this.updateOnSelection}}>\n        </lit-checkbox>\n        <lit-checkbox\n          label=\"Hide empty labels\"\n          ?checked=${this.hideEmptyLabels}\n          @change=${()=>{this.hideEmptyLabels=!this.hideEmptyLabels}}>\n        </lit-checkbox>\n      </div>\n      <div class=\"flex\">\n        <div>\n          <div class=\"dropdown-holder\">\n            <label class=\"dropdown-label\">Rows:</label>\n            <select class=\"dropdown\" @change=${t=>{this.selectedRowOption=+t.target.value}}>\n              ${this.options.map((t,e)=>o.html`\n                <option ?selected=${this.selectedRowOption===e} value=${e}>\n                  ${t.name}\n                </option>`)}\n            </select>\n          </div>\n          <div class=\"dropdown-holder\">\n            <label class=\"dropdown-label\">Columns:</label>\n            <select class=\"dropdown\" @change=${t=>{this.selectedColOption=+t.target.value}}>\n              ${this.options.map((t,e)=>o.html`\n                <option ?selected=${this.selectedColOption===e} value=${e}>\n                  ${t.name}\n                 </option>`)}\n            </select>\n          </div>\n        </div>\n        <button class='hairline-button' id='create-button' @click=${()=>{this.calculateMatrix(this.selectedRowOption,this.selectedColOption)}}\n          ?disabled=\"${!this.canCreateMatrix(this.selectedRowOption,this.selectedColOption)}\"\n          title=${this.matrixCreateTooltip}>\n          Create matrix\n        </button>\n      </div>\n    `}renderColumnRotateButton(){const t=()=>{this.verticalColumnLabels=!this.verticalColumnLabels};return o.html`\n      <mwc-icon-button-toggle class=\"icon-button\"\n        title=\"Rotate column labels\"\n        onIcon=\"text_rotate_up\" offIcon=\"text_rotation_none\"\n        ?on=\"${this.verticalColumnLabels}\"\n        @MDCIconButtonToggle:change=\"${t}\"\n        @icon-button-toggle-change=\"${t}\">\n      </mwc-icon-button-toggle>\n    `}renderMatrix(t,e,n){const i=this.options[t],r=this.options[e],a=i.labelList,s=r.labelList,c=i.name,l=r.name;return o.html`\n        <data-matrix\n          class='matrix'\n          .matrixCells=${n}\n          ?hideEmptyLabels=${this.hideEmptyLabels}\n          .rowTitle=${c}\n          .rowLabels=${a}\n          .colTitle=${l}\n          .colLabels=${s}\n          @matrix-selection=${n=>{const i=n.detail.ids;this.lastSelectedRow=t,this.lastSelectedCol=e,this.selectionService.selectIds(i,this)}}\n          @delete-matrix=${n=>{delete this.matrices[this.getMatrixId(t,e)]}}\n        >\n        </data-matrix>\n        `}static shouldDisplayModule(t,e){return(0,l.doesOutputSpecContain)(t,\"MulticlassPreds\")}};f.title=\"Confusion Matrix\",f.template=(t=\"\")=>o.html`\n      <confusion-matrix-module model=${t}>\n      </confusion-matrix-module>`,f.numCols=3,f.duplicateForModelComparison=!1,i.__decorate([a.observable,i.__metadata(\"design:type\",Object)],f.prototype,\"verticalColumnLabels\",void 0),i.__decorate([a.observable,i.__metadata(\"design:type\",Object)],f.prototype,\"hideEmptyLabels\",void 0),i.__decorate([a.observable,i.__metadata(\"design:type\",Object)],f.prototype,\"updateOnSelection\",void 0),i.__decorate([a.observable,i.__metadata(\"design:type\",Object)],f.prototype,\"selectedRowOption\",void 0),i.__decorate([a.observable,i.__metadata(\"design:type\",Object)],f.prototype,\"selectedColOption\",void 0),i.__decorate([a.observable,i.__metadata(\"design:type\",Object)],f.prototype,\"matrices\",void 0),i.__decorate([a.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],f.prototype,\"options\",null),i.__decorate([a.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],f.prototype,\"matrixCreateTooltip\",null),f=i.__decorate([(0,r.customElement)(\"confusion-matrix-module\"),i.__metadata(\"design:paramtypes\",[])],f),e.ConfusionMatrixModule=f},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.DataMatrix=void 0;const i=n(1),r=i.__importStar(n(21));n(80);const o=n(2),a=n(2),s=n(3),c=n(13),l=n(17),d=n(4),u=n(114),h=n(7),p=n(33),f=Math.floor(6/7*100),m=(0,p.ramp)([...p.MAJOR_TONAL_COLORS.primary.slice(0,8).map(t=>t.color)]);let g=class extends s.LitElement{constructor(){super(...arguments),this.verticalColumnLabels=!1,this.hideEmptyLabels=!1,this.matrixCells=[],this.colTitle=\"\",this.rowTitle=\"\",this.colLabels=[],this.rowLabels=[]}static get styles(){return[h.styles,u.styles]}get totalIds(){let t=0;for(let e=0;e<this.matrixCells.length;e++){const n=this.matrixCells[e];for(let e=0;e<n.length;e++){t+=n[e].ids.length}}return t}get colorScale(){return r.scaleSequential(m).domain([0,this.totalIds])}updateSelection(){let t=[];for(const e of this.matrixCells.flat())e.selected&&(t=t.concat(e.ids));const e=new CustomEvent(\"matrix-selection\",{detail:{ids:t}});this.dispatchEvent(e)}renderColHeader(t,e,n){if(this.hideEmptyLabels&&!n.has(t))return null;const i=(0,c.classMap)({\"header-cell\":!0,\"align-bottom\":this.verticalColumnLabels,\"label-vertical\":this.verticalColumnLabels});return s.html`\n      <th class=${i} @click=${()=>{const t=this.matrixCells.map(t=>t[e]),n=t.every(t=>t.selected);for(const e of t)e.selected=!n;this.updateSelection(),this.requestUpdate()}}>\n        <div>${t}</div>\n      </th>\n    `}renderCell(t,e,n){var i;if(null==(null===(i=this.matrixCells[t])||void 0===i?void 0:i[e]))return null;const r=this.matrixCells[t][e];if(this.hideEmptyLabels&&!n.has(this.colLabels[e]))return null;const o=this.colorScale(r.ids.length),a=r.ids.length/this.totalIds*100,c=a>f?\"white\":\"black\",d=r.selected?\"2px solid #12B5CB\":\"2px solid transparent\",u=(0,l.styleMap)({background:\"\"+o,color:\"\"+c,border:d});return s.html`\n        <td class=\"cell\" style=${u} @click=${()=>{r.selected=!r.selected,this.updateSelection(),this.requestUpdate()}}>\n          <div class=\"cell-container\">\n            <div class=\"percentage\">${a.toFixed(1)}%</div>\n            <div class=\"val\">(${r.ids.length})</div>\n          </div>\n        </td>`}renderRow(t,e,n,i){if(this.hideEmptyLabels&&!n.has(t))return null;let r=0;for(const t of this.matrixCells[e])r+=t.ids.length;return s.html`\n      <tr>\n        <th class=\"header-cell align-right\" @click=${()=>{const t=this.matrixCells[e],n=t.every(t=>t.selected);for(const e of t)e.selected=!n;this.updateSelection(),this.requestUpdate()}}>\n          ${t}\n        </th>\n        ${this.colLabels.map((t,n)=>this.renderCell(e,n,i))}\n        ${this.renderTotalCell(r)}\n      </tr>`}renderTotalCell(t){const e=(t/this.totalIds*100).toFixed(1);return s.html`\n        <td class=\"total-cell\">\n          <div class=\"cell-container\">\n            <div class=\"percentage\">${e}%</div>\n            <div class=\"val\">(${t})</div>\n          </div>\n        </td>`}renderColTotalCell(t){let e=0;for(const n of this.matrixCells)e+=n[t].ids.length;return this.renderTotalCell(e)}renderTotalRow(t){return s.html`\n      <tr>\n        <th class=\"total-title-cell align-right\">Total</th>\n        ${this.colLabels.map((e,n)=>this.hideEmptyLabels&&!t.has(this.colLabels[n])?null:this.renderColTotalCell(n))}\n        <td class=\"total-cell\"></td>\n      </tr>`}renderColumnRotateButton(){const t=()=>{this.verticalColumnLabels=!this.verticalColumnLabels,this.requestUpdate()};return s.html`\n      <mwc-icon-button-toggle class=\"icon-button\"\n        title=\"Rotate column labels\"\n        onIcon=\"text_rotate_up\" offIcon=\"text_rotation_none\"\n        ?on=\"${this.verticalColumnLabels}\"\n        @MDCIconButtonToggle:change=\"${t}\"\n        @icon-button-toggle-change=\"${t}\">\n      </mwc-icon-button-toggle>\n    `}renderDeleteButton(){return s.html`\n      <mwc-icon class=\"icon-button\" @click=${()=>{const t=new CustomEvent(\"delete-matrix\",{});this.dispatchEvent(t)}}>\n        delete_outline\n      </mwc-icon>\n    `}render(){if(0===this.matrixCells.length)return null;const t=new Set,e=new Set;for(let n=0;n<this.matrixCells.length;n++){const i=this.matrixCells[n];for(let r=0;r<i.length;r++){i[r].ids.length>0&&(t.add(this.rowLabels[n]),e.add(this.colLabels[r]))}}const n=(0,c.classMap)({\"total-title-cell\":!0,\"align-bottom\":this.verticalColumnLabels}),i=this.hideEmptyLabels?e.size:this.colLabels.length,r=(this.hideEmptyLabels?t.size:this.rowLabels.length)+2;return s.html`\n      <table>\n        <tr>\n          <th>${this.renderColumnRotateButton()}</th>\n          <td></td>\n          <td class='axis-title' colspan=${i}>\n            ${this.colTitle}\n          </td>\n          <th class=\"delete-cell\">${this.renderDeleteButton()}</th>\n        </tr>\n        <tr>\n          <td class='axis-title label-vertical' rowspan=${r}>\n            <div>${this.rowTitle}</div>\n          </td>\n          <td></td>\n          ${this.colLabels.map((t,n)=>this.renderColHeader(t,n,e))}\n          <th class=${n}><div>Total</div></th>\n        </tr>\n        ${this.rowLabels.map((n,i)=>this.renderRow(n,i,t,e))}\n        ${this.renderTotalRow(e)}\n      </table>\n    `}};i.__decorate([d.observable,i.__metadata(\"design:type\",Object)],g.prototype,\"verticalColumnLabels\",void 0),i.__decorate([(0,o.property)({type:Boolean}),i.__metadata(\"design:type\",Object)],g.prototype,\"hideEmptyLabels\",void 0),i.__decorate([(0,o.property)({type:Array}),i.__metadata(\"design:type\",Array)],g.prototype,\"matrixCells\",void 0),i.__decorate([(0,o.property)({type:String}),i.__metadata(\"design:type\",Object)],g.prototype,\"colTitle\",void 0),i.__decorate([(0,o.property)({type:String}),i.__metadata(\"design:type\",Object)],g.prototype,\"rowTitle\",void 0),i.__decorate([(0,o.property)({type:Array}),i.__metadata(\"design:type\",Array)],g.prototype,\"colLabels\",void 0),i.__decorate([(0,o.property)({type:Array}),i.__metadata(\"design:type\",Array)],g.prototype,\"rowLabels\",void 0),i.__decorate([d.computed,i.__metadata(\"design:type\",Number),i.__metadata(\"design:paramtypes\",[])],g.prototype,\"totalIds\",null),i.__decorate([d.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],g.prototype,\"colorScale\",null),g=i.__decorate([(0,a.customElement)(\"data-matrix\")],g),e.DataMatrix=g},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`.cell {\n  font-family: 'Roboto Mono', monospace;\n  cursor: pointer;\n  padding: 2px 4px;\n  border-radius: 2px;\n  border: 2px solid transparent;\n}\n\n.cell-container {\n  display: flex;\n  min-width: 90px;\n}\n\n.percentage {\n  width: 50%;\n  min-width: 50%;\n  max-width: 50%;\n  text-align: end;\n  padding-right: 6px;\n}\n\n.val {\n  width: 50%;\n  text-align: end;\n}\n\n.header-cell {\n  cursor: pointer;\n  padding: 2px 4px;\n}\n\n.align-bottom {\n  vertical-align: bottom;\n}\n\n.align-right {\n  text-align: end;\n}\n\n.total-title-cell {\n  padding: 2px 4px;\n  color: #5f6368;\n}\n\n.total-cell {\n  padding: 2px 4px;\n  font-family: 'Roboto Mono', monospace;\n  color: #5f6368;\n}\n\n.axis-title {\n  font-size: 11px;\n  text-align: center;\n}\n\n/* Need to style the div inside a th/td to set width and height correctly. */\n.label-vertical > div {\n  transform: rotate(180deg);\n  text-align: center;\n  writing-mode: vertical-lr;\n}\n\n.icon-button {\n  height: 24px;\n  width: 24px;\n  min-width: 24px;\n  --mdc-icon-size: 24px;\n  --mdc-icon-button-size: 24px;\n}\n\n.delete-cell {\n  display: flex;\n  justify-content: flex-end\n}\n`},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`.dropdown {\n  max-width: fit-content;\n}\n\n.matrices-holder {\n  display: flex;\n  flex-flow: wrap;\n  padding: 4px;\n}\n\n.matrix {\n  margin-right: 16px;\n  margin-bottom: 16px;\n}\n\n.flex {\n  display: flex;\n}\n\n#create-button {\n  margin-top: 28px;\n  pointer-events: auto;\n}\n\n/* Make the \"Rows\" and \"Columns\" labels the same width */\n.dropdown-label {\n  display: inline-block;\n  width: 55px;\n}\n`},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.CounterfactualExplainerModule=void 0;const i=n(1);n(39),n(42);const r=n(2),o=n(2),a=n(3),s=n(13),c=n(17),l=n(4),d=n(12);n(5);const u=n(8),h=n(52),p=n(75),f=n(7);let m=class extends d.LitModule{constructor(){super(...arguments),this.model=\"\",this.selectionServiceIndex=0,this.selectedClass=0,this.selectedPredKey=\"\",this.state={autorun:!1,isLoading:!1,salience:{},cmap:new h.SignedSalienceCmap(4)}}static get styles(){return[f.styles,p.styles,a.css`\n        .options-dropdown {\n          margin-right: 10px;\n          margin-top: 10px;\n          margin-bottom: 10px;\n          min-width: 100px;\n      }\n      `]}firstUpdated(){this.react(()=>this.selectionService.primarySelectedInputData,t=>{this.state.autorun?this.runInterpreter():this.state.salience={}});this.react(()=>this.selectionService.selectedInputData,t=>{this.state.autorun?this.runInterpreter():this.state.salience={}});this.react(()=>this.state.autorun,t=>{t&&this.runInterpreter()});this.react(()=>this.selectedClass,t=>{this.state.autorun&&this.runInterpreter()});this.react(()=>this.selectedPredKey,t=>{this.state.autorun&&this.runInterpreter()}),this.state.autorun&&this.runInterpreter()}runInterpreter(){return i.__awaiter(this,void 0,void 0,(function*(){const t=\"counterfactual explainer\",e=this.selectionService.primarySelectedInputData;if(null==e)return void(this.state.salience={});const n=this.selectionService.selectedInputData.filter(t=>t.id!==e.id);if(\"\"===this.selectedPredKey)return;const i={class_to_explain:this.selectedClass,lowercase_tokens:!0,pred_key:this.selectedPredKey};this.state.isLoading=!0;const r=this.apiService.getInterpretations([e,...n],this.model,this.appState.currentDataset,t,i,\"Running \"+t),o=yield this.loadLatest(\"interpretations-\"+t,r);this.state.isLoading=!1,null!==o&&(this.state.salience=o[0])}))}updated(){super.updated(),this.shadowRoot.querySelectorAll(\".tokens-group\").forEach(t=>{const e=t.querySelector(\".salience-tooltip\");t.querySelectorAll(\".salient-token\").forEach(t=>{t.onmouseover=function(){e.innerText=this.dataset.tooltip,e.style.visibility=\"visible\";const t=this.getBoundingClientRect();e.style.left=(t.left+t.right)/2+\"px\",e.style.top=t.bottom+\"px\"},t.onmouseout=function(){e.style.visibility=\"hidden\"}})})}renderToken(t,e,n){const i=(0,c.styleMap)({color:n.textCmap(e),\"background-color\":n.bgCmap(e)});return a.html`\n      <div class=\"salient-token\" style=${i}\n        data-tooltip=${e.toPrecision(3)}>\n        ${t}\n      </div>`}renderGroup(t,e,n){const i=t[e].tokens,r=t[e].salience,o=i.map((t,e)=>this.renderToken(t,r[e],n));return a.html`\n      <div class=\"tokens-group\">\n        <div class=\"tokens-group-title\">\n          ${e}\n        </div>\n        <div class=\"tokens-holder\">\n          ${o}\n        </div>\n        <div class=\"salience-tooltip\">\n        </div>\n      </div>\n    `}renderSpinner(){return a.html`\n      <div class=\"spinner-container\">\n        <lit-spinner size=${24} color=\"var(--app-secondary-color)\">\n        </lit-spinner>\n      </div>\n    `}render(){const t=this.state.salience,e=this.state.cmap,n=this.appState.currentModelSpecs[this.model].spec.output,i=(0,u.findSpecKeys)(n,\"MulticlassPreds\");if(!i.length)return;i.includes(this.selectedPredKey)||(this.selectedPredKey=i[0]);const r=n[this.selectedPredKey].vocab,o=null==r?[]:(0,u.range)(r.length);o.includes(this.selectedClass)||(this.selectedClass=o[o.length-1]);const c=i.map((t,e)=>a.html`<option value=${e}>\n              ${t}</option>`),l=o.map((t,e)=>a.html`<option value=${e} >\n              ${t}</option>`);return a.html`\n      <div class='config'>\n        <label class=\"dropdown-label\">Class to explain:</label>\n        <select class=\"dropdown options-dropdown\" @change=${t=>{const e=t.target;null!=e&&(this.selectedClass=+e.options[e.selectedIndex].value)}}>\n          ${l}\n        </select>\n        <label class=\"dropdown-label\">Model head:</label>\n        <select class=\"dropdown options-dropdown\" @change=${t=>{const e=t.target;null!=e&&(this.selectedPredKey=e.options[e.selectedIndex].value)}}>\n          ${c}\n        </select>\n        <div class='group-label'>\n          <lit-checkbox label=\"autorun\"\n            ?checked=${this.state.autorun}\n            @change=${()=>{this.state.autorun=!this.state.autorun}}\n          ></lit-checkbox>\n        </div>\n      </div>\n      <table>\n        <tr>\n          <td class=${(0,s.classMap)({\"group-container\":!0,loading:this.state.isLoading})}>\n            ${Object.keys(t).map(n=>this.renderGroup(t,n,e))}\n            ${this.state.isLoading?this.renderSpinner():null}\n          </td>\n        </tr>\n      </table>\n    `}static shouldDisplayModule(t,e){for(const e of Object.keys(t)){const n=t[e].spec.input,i=t[e].spec.output;if((0,u.findSpecKeys)(n,\"TextSegment\").length&&(0,u.findSpecKeys)(i,\"MulticlassPreds\").length)return!0}return!1}};m.title=\"Counterfactual Explanation\",m.numCols=10,m.collapseByDefault=!0,m.duplicateForExampleComparison=!0,m.template=(t=\"\",e=0)=>a.html`<counterfactual-explainer-module model=${t} selectionServiceIndex=${e}></counterfactual-explainer-module>`,i.__decorate([(0,r.property)({type:String}),i.__metadata(\"design:type\",Object)],m.prototype,\"model\",void 0),i.__decorate([(0,r.property)({type:Number}),i.__metadata(\"design:type\",Object)],m.prototype,\"selectionServiceIndex\",void 0),i.__decorate([l.observable,i.__metadata(\"design:type\",Object)],m.prototype,\"selectedClass\",void 0),i.__decorate([l.observable,i.__metadata(\"design:type\",Object)],m.prototype,\"selectedPredKey\",void 0),i.__decorate([l.observable,i.__metadata(\"design:type\",Object)],m.prototype,\"state\",void 0),m=i.__decorate([(0,o.customElement)(\"counterfactual-explainer-module\")],m),e.CounterfactualExplainerModule=m},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.SimpleDataTableModule=e.DataTableModule=void 0;const i=n(1);n(60),n(39);const r=n(3),o=n(2),a=n(4),s=n(15),c=n(12),l=n(40),d=n(7),u=n(5),h=n(8);n(44),n(55);const p=n(11),f=n(118);let m=class extends c.LitModule{constructor(){super(...arguments),this.showControls=!0,this.classificationService=s.app.getService(p.ClassificationService),this.regressionService=s.app.getService(p.RegressionService),this.focusService=s.app.getService(p.FocusService),this.columnVisibility=new Map,this.modelPredToClassificationInfo=new Map,this.modelPredToRegressionInfo=new Map,this.searchText=\"\",this.onlyShowSelected=!1,this.columnDropdownVisible=!1}static get styles(){return[d.styles,f.styles]}get dataSpec(){return this.appState.currentDatasetSpec}get keys(){return this.appState.currentInputDataKeys.filter(t=>\"meta\"!==t)}get defaultColumns(){return[\"index\",...this.keys]}get filteredData(){return this.onlyShowSelected?this.selectionService.selectedInputData:this.appState.currentInputData}get sortedData(){return this.filteredData.slice().sort((t,e)=>(0,h.compareArrays)(this.reversedAncestorIndices(t),this.reversedAncestorIndices(e)))}get selectedRowIndices(){return this.sortedData.map((t,e)=>this.selectionService.isIdSelected(t.id)?e:-1).filter(t=>-1!==t)}get keysToTableEntry(){const t=this.appState.currentModels,e=new Map;return t.forEach(t=>{const n=this.appState.currentModelSpecs[t].spec.output,i=(0,h.findSpecKeys)(n,[\"MulticlassPreds\"]),r=(0,h.findSpecKeys)(n,[\"RegressionScore\"]);this.addTableEntries(e,t,i,this.modelPredToClassificationInfo,this.classificationService.getDisplayNames()),this.addTableEntries(e,t,r,this.modelPredToRegressionInfo,this.regressionService.getDisplayNames())}),e}reversedAncestorIndices(t){return this.appState.getAncestry(t.id).map(t=>this.appState.indicesById.get(t)).reverse()}get tableData(){return this.sortedData.map(t=>{let e=(0,h.shortenId)(t.id);e=e?e+\"...\":\"\",e=t.meta.added?\"*\"+e:e;const n=this.appState.indicesById.get(t.id);if(null==n)return[];const i=[];if(this.keysToTableEntry.size>0){const e=t.id;Array.from(this.columnVisibility.keys()).filter(t=>!this.defaultColumns.includes(t)&&this.columnVisibility.get(t)).forEach(t=>{const n=this.keysToTableEntry.get(this.getTableKey(e,t));i.push(null==n?\"-\":n)})}const r=this.keys.filter(t=>this.columnVisibility.get(t)).map(e=>(0,u.formatForDisplay)(t.data[e],this.dataSpec[e])),o=[n];return this.columnVisibility.get(\"id\")&&o.push(e),[...o,...r,...i]})}firstUpdated(){this.reactImmediately(()=>this.appState.currentInputData,t=>{null!=t&&this.updatePredictionInfo(t)});this.react(()=>this.appState.currentModels,t=>{this.updateColumns()});this.react(()=>this.appState.currentDataset,t=>{this.updateColumns()});this.react(()=>this.keys,t=>{this.updateColumns()}),this.updateColumns()}updatePredictionInfo(t){return i.__awaiter(this,void 0,void 0,(function*(){const e=new Map,n=new Map,i=this.appState.currentModels,r=t.map(t=>t.id);for(const t of i){const i=this.appState.currentModelSpecs[t].spec.output,o=(0,h.findSpecKeys)(i,[\"RegressionScore\"]),a=(0,h.findSpecKeys)(i,[\"MulticlassPreds\"]);for(const n of a){const i=yield this.classificationService.getResults(r,t,n);e.set(this.getTableKey(t,n),i)}for(const e of o){const i=yield this.regressionService.getResults(r,t,e);n.set(this.getTableKey(t,e),i)}}this.modelPredToClassificationInfo=e,this.modelPredToRegressionInfo=n}))}updateColumns(){const t=new Map;this.defaultColumns.forEach(e=>{t.set(e,!0)}),t.set(\"id\",!1);const e=this.classificationService.getDisplayNames(),n=this.regressionService.getDisplayNames();this.appState.currentModels.forEach(i=>{const r=this.appState.currentModelSpecs[i].spec.output,o=(0,h.findSpecKeys)(r,[\"RegressionScore\"]);this.setColumnNames(i,t,o,n);const a=(0,h.findSpecKeys)(r,[\"MulticlassPreds\"]);this.setColumnNames(i,t,a,e)}),this.columnVisibility=t}setColumnNames(t,e,n,i){n.forEach(n=>{i.forEach(i=>{e.set(this.formatColumnName(t,n,i),!1)})})}addTableEntries(t,e,n,i,r){const o=this.appState.currentInputData.map(t=>t.id);n.forEach(n=>{const a=i.get(this.getTableKey(e,n));null!=a&&a.forEach((i,a)=>{const s=Object.entries(i),c=o[a];s.forEach((i,o)=>{const a=r[o],s=(0,u.formatForDisplay)(i[1]);null!=a&&t.set(this.getTableKey(c,this.formatColumnName(e,n,a)),s)})})})}formatColumnName(t,e,n){return`${t}:${e}:${n}`}getTableKey(t,e){return`${t}:${e}`}getIdFromTableIndex(t){var e;return null===(e=this.sortedData[t])||void 0===e?void 0:e.id}onSelect(t){const e=t.map(t=>this.getIdFromTableIndex(t)).filter(t=>null!=t);this.selectionService.selectIds(e,this)}onPrimarySelect(t){const e=this.getIdFromTableIndex(t);this.selectionService.setPrimarySelection(e,this)}onHover(t){const e=null!=t?this.getIdFromTableIndex(t):null;null==e?this.focusService.clearFocus():this.focusService.setFocusedDatapoint(e)}renderDropdownItem(t){const e=this.columnVisibility.get(t);if(null==e)return;return r.html`\n      <div>\n        <lit-checkbox label=${t} ?checked=${e}\n                      @change=${()=>{this.columnVisibility.set(t,!e)}}>\n        </lit-checkbox>\n      </div>\n    `}renderColumnDropdown(){const t=[...this.columnVisibility.keys()].filter(t=>\"index\"!==t),e=this.columnDropdownVisible?\"column-dropdown\":\"column-dropdown-hide\";return r.html`\n      <div class='${e}'>\n        ${t.map(t=>this.renderDropdownItem(t))}\n      </div>\n    `}renderControls(){var t,e;return r.html`\n      <div class='switch-container' @click=${()=>{this.onlyShowSelected=!this.onlyShowSelected}}>\n        <div>Hide unselected</div>\n        <mwc-switch .checked=${this.onlyShowSelected}></mwc-switch>\n      </div>\n      <div id=\"toolbar-buttons\">\n        <button class='hairline-button' @click=${()=>{this.table.resetView()}}\n          ?disabled=\"${null===(e=null===(t=this.table)||void 0===t?void 0:t.isDefaultView)||void 0===e||e}\">\n          Reset view\n        </button>\n        <button class='hairline-button' @click=${()=>{this.onSelect(this.table.getVisibleDataIdxs())}}>\n          Select all\n        </button>\n        <button class='hairline-button' @click=${()=>{this.columnDropdownVisible=!this.columnDropdownVisible}}>\n          Columns&nbsp;\n          <span class='material-icon'>\n            ${this.columnDropdownVisible?\"expand_less\":\"expand_more\"}\n          </span>\n        </button>\n      </div>\n      ${this.renderColumnDropdown()}\n    `}renderTable(){const t=this.sortedData.map(t=>t.id),e=e=>null!=e?t.indexOf(e):-1,n=e(this.selectionService.primarySelectedId),i=this.focusService.focusData,o=null==i||null!=i.io?-1:e(i.datapointId);let a=-1;if(this.appState.compareExamplesEnabled){a=e(s.app.getServiceArray(p.SelectionService)[1].primarySelectedId)}const c=[...this.columnVisibility.keys()].filter(t=>this.columnVisibility.get(t));return r.html`\n      <lit-data-table\n        .data=${this.tableData}\n        .columnNames=${c}\n        .selectedIndices=${this.selectedRowIndices}\n        .primarySelectedIndex=${n}\n        .referenceSelectedIndex=${a}\n        .focusedIndex=${o}\n        .onSelect=${t=>{this.onSelect(t)}}\n        .onPrimarySelect=${t=>{this.onPrimarySelect(t)}}\n        .onHover=${t=>{this.onHover(t)}}\n        searchEnabled\n        selectionEnabled\n        paginationEnabled\n      ></lit-data-table>\n    `}render(){return r.html`\n      <div class='module-container'>\n        ${this.showControls?r.html`\n          <div class='module-toolbar'>\n            ${this.renderControls()}\n          </div>\n        `:null}\n        <div class='module-results-area'>\n          ${this.renderTable()}\n        </div>\n      </div>\n    `}static shouldDisplayModule(t,e){return!0}};m.title=\"Data Table\",m.template=()=>r.html`<data-table-module></data-table-module>`,m.numCols=4,m.duplicateForModelComparison=!1,i.__decorate([a.observable,i.__metadata(\"design:type\",Object)],m.prototype,\"columnVisibility\",void 0),i.__decorate([a.observable,i.__metadata(\"design:type\",Object)],m.prototype,\"modelPredToClassificationInfo\",void 0),i.__decorate([a.observable,i.__metadata(\"design:type\",Object)],m.prototype,\"modelPredToRegressionInfo\",void 0),i.__decorate([a.observable,i.__metadata(\"design:type\",Object)],m.prototype,\"searchText\",void 0),i.__decorate([a.observable,i.__metadata(\"design:type\",Boolean)],m.prototype,\"onlyShowSelected\",void 0),i.__decorate([a.observable,i.__metadata(\"design:type\",Boolean)],m.prototype,\"columnDropdownVisible\",void 0),i.__decorate([(0,o.query)(\"lit-data-table\"),i.__metadata(\"design:type\",l.DataTable)],m.prototype,\"table\",void 0),i.__decorate([a.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],m.prototype,\"dataSpec\",null),i.__decorate([a.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],m.prototype,\"keys\",null),i.__decorate([a.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],m.prototype,\"defaultColumns\",null),i.__decorate([a.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],m.prototype,\"filteredData\",null),i.__decorate([a.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],m.prototype,\"sortedData\",null),i.__decorate([a.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],m.prototype,\"selectedRowIndices\",null),i.__decorate([a.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],m.prototype,\"keysToTableEntry\",null),i.__decorate([a.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],m.prototype,\"tableData\",null),m=i.__decorate([(0,o.customElement)(\"data-table-module\")],m),e.DataTableModule=m;let g=class extends m{constructor(){super(...arguments),this.showControls=!1}};g.template=()=>r.html`<simple-data-table-module></simple-data-table-module>`,g=i.__decorate([(0,o.customElement)(\"simple-data-table-module\")],g),e.SimpleDataTableModule=g},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`.module-toolbar {\n  justify-content: space-between;\n}\n\n#toolbar-buttons{\n  display: flex;\n  flex-direction: row;\n}\n\n/* Column settings */\n.column-dropdown-hide {\n  display:none;\n}\n\n/* TODO(b/173445400): align this with rest of UI spec */\n.column-dropdown {\n  top: 32px;\n  right: 4px;\n  padding: 10px;\n  background: white;\n  border: 1px solid gray;\n  position: absolute;\n  visibility: visible;\n  z-index: 1000;\n  max-height: calc(100% - 48px);\n  overflow: auto;\n}\n`},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.SimpleDatapointEditorModule=e.DatapointEditorModule=void 0;const i=n(1);n(39);const r=i.__importStar(n(21)),o=n(2),a=n(3),s=n(13),c=n(17),l=n(4),d=n(15),u=n(12),h=n(7),p=n(5),f=n(8),m=n(32),g=n(57),v=n(120);let y=class extends u.LitModule{constructor(){super(...arguments),this.groupService=d.app.getService(m.GroupService),this.isShiftPressed=!1,this.addButtonText=\"Add\",this.showAddAndCompare=!0,this.editedData={},this.datapointEdited=!1,this.inputHeights={},this.maximizedImageFields=new Set}static get styles(){return[h.styles,v.styles]}get dataTextLengths(){var t;const e={},n=this.appState.currentDatasetSpec;for(const i of this.appState.currentInputDataKeys){if(this.groupService.categoricalFeatureNames.includes(i))continue;if(this.groupService.numericalFeatureNames.includes(i))continue;const o=n[i],a=(0,f.isLitSubtype)(o,[\"SparseMultilabel\",\"Tokens\",\"SequenceTags\"]),s=this.appState.currentInputData.map(t=>{var e;const n=t.data[i];return a?null==n?void 0:n.join(null!==(e=o.separator)&&void 0!==e?e:\",\").length:null==n?void 0:n.length});e[i]=null!==(t=r.quantile(s,.8))&&void 0!==t?t:1;const c=Math.max(...s);.8*c<=e[i]&&(e[i]=c)}return e}firstUpdated(){const t=this.shadowRoot.querySelector(\".module-container\");this.resizeObserver=new ResizeObserver(()=>{this.resize()}),this.resizeObserver.observe(t);this.reactImmediately(()=>this.appState.currentDataset,()=>{(0,l.when)(()=>this.appState.currentInputDataIsLoaded,()=>{this.resize()})});this.reactImmediately(()=>this.selectionService.primarySelectedInputData,t=>{this.resetEditedData(null==t?null:t.data)})}updated(){super.updated();const t=Array.from(this.shadowRoot.querySelectorAll(\"textarea\"));for(const e of t)e.value=e.textContent}resize(){const t=this.shadowRoot.querySelectorAll(\".input-box\")[0];if(null==t)return;const e=Array.from(Object.keys(this.dataTextLengths));for(const n of e){const e=this.dataTextLengths[n];if(e===-1/0)continue;const i=8.3,r=Math.ceil(i*e/t.clientWidth),o=1;this.inputHeights[n]=2*r+o+\"ex\"}}resetEditedData(t){this.datapointEdited=!1;const e={},n=null==t?this.appState.currentInputDataKeys:Object.keys(t),i=this.appState.currentDatasetSpec;for(const r of n)e[r]=null==t?(0,p.defaultValueByField)(r,i):t[r];this.editedData=e}render(){return a.html`\n      <div class='module-container'>\n        <div class=\"${p.SCROLL_SYNC_CSS_CLASS} module-results-area\">\n          ${this.renderEditText()}\n        </div>\n        <div class=\"module-footer\">\n          ${this.renderButtons()}\n        </div>\n      </div>\n    `}get allRequiredInputsFilledOut(){const t=Object.keys(this.editedData);let e=!0;for(let n=0;n<t.length;n++)if(this.appState.currentModelRequiredInputSpecKeys.includes(t[n])&&\"\"===this.editedData[t[n]]){e=!1;break}return e}renderButtons(){const t=this.datapointEdited&&this.allRequiredInputsFilledOut,e=t&&!this.appState.compareExamplesEnabled,n=this.datapointEdited,r=!!this.selectionService.primarySelectedInputData,o=()=>i.__awaiter(this,void 0,void 0,(function*(){const t={data:this.editedData,id:\"\",meta:{source:\"manual\",added:!0,parentId:this.selectionService.primarySelectedId}},e=yield this.appState.annotateNewData([t]);this.appState.commitNewDatapoints(e),this.selectionService.selectIds(e.map(t=>t.id))})),s=a.html`\n      <button id=\"make\" class='hairline-button'\n        @click=${o} ?disabled=\"${!t}\">\n        ${this.addButtonText}\n      </button>\n    `,c=a.html`\n      <button id=\"compare\" class='hairline-button'\n        @click=${()=>i.__awaiter(this,void 0,void 0,(function*(){const t=this.selectionService.primarySelectedId;yield o(),this.appState.compareExamplesEnabled=!0,d.app.getServiceArray(g.SelectionService)[1].selectIds([t])}))} ?disabled=\"${!e}\">\n        Add and compare\n      </button>\n    `,l=a.html`\n      <button id=\"reset\" class='hairline-button'\n        @click=${()=>{this.resetEditedData(this.selectionService.primarySelectedInputData.data)}}  ?disabled=\"${!n}\">\n        Reset\n      </button>\n    `,u=a.html`\n      <button id=\"clear\" class='hairline-button'\n        @click=${()=>{this.selectionService.selectIds([])}}  ?disabled=\"${!r}\">\n        Clear\n      </button>\n    `;return a.html`\n      ${s}\n      ${this.showAddAndCompare?c:null}\n      ${l}\n      ${u}\n    `}renderEditText(){const t=Object.keys(this.appState.currentDatasetSpec);return a.html`\n      <div id=\"edit-table\">\n       ${t.map(t=>this.renderEntry(t,this.editedData[t],!0))}\n      </div>\n    `}renderEntry(t,e,n){var i;const r=(e,n=(t=>t))=>{this.datapointEdited=!0,this.editedData[t]=n(e.target.value)},o=()=>{const n=this.maximizedImageFields.has(t),i=(0,s.classMap)({\"image-min\":!n}),r=null==e?\"\":e.toString();return a.html`\n        <div class=\"image-holder\">\n          <img class=${i} src=${r}>\n          <mwc-icon class=\"image-toggle\" @click=${()=>{this.maximizedImageFields.has(t)?this.maximizedImageFields.delete(t):this.maximizedImageFields.add(t)}}\n                    title=\"Toggle full size\">\n            ${n?\"close_fullscreen\":\"open_in_full\"}\n          </mwc-icon>\n        </div>\n      `},l={height:this.inputHeights[t]},d=()=>a.html`\n      <input type=\"text\" class=\"input-short\" @input=${r}\n        ?readonly=\"${!n}\" .value=${e}></input>`,u=()=>a.html`\n      <input type=\"text\" class=\"input-short\" @input=${t=>{r(t,t=>+t)}}\n        ?readonly=\"${!n}\" .value=${e}></input>`,h=()=>{const t=e?e.join(\" \"):\"\";return a.html`\n      <textarea class=\"input-box\" style=\"${(0,c.styleMap)(l)}\" @input=${t=>{r(t,t=>t?t.split(\" \"):[])}}\n        ?readonly=\"${!n}\">${t}</textarea>`},m=()=>a.html`<div>${e?e.map(t=>a.html`<div class=\"span-label\">${(0,p.formatSpanLabel)(t)}</div>`):null}</div>`,g=()=>a.html`<div>${e?e.map(t=>a.html`<div class=\"edge-label\">${(0,p.formatEdgeLabel)(t)}</div>`):null}</div>`,v=()=>a.html`\n      <lit-checkbox\n        ?checked=${e}\n        @change=${t=>{r(t,()=>!!t.target.checked)}}\n      ></lit-checkbox>`;let y=()=>a.html`\n      <textarea class=\"input-box\" style=\"${(0,c.styleMap)(l)}\" @input=${r}\n        ?readonly=\"${!n}\">${e}</textarea>`;const b={\"entry-content\":!0,\"entry-content-long\":!1},_=this.appState.currentDatasetSpec[t],x=null==_?void 0:_.vocab;var w;null!=x?y=()=>{return t=x,a.html`\n      <select class=\"dropdown\"\n        @change=${r}>\n        <option value=\"\" selected></option>\n        ${t.map(t=>a.html`\n            <option\n              value=\"${t}\"\n              ?selected=${t===e}\n              >\n              ${t}\n            </option>`)}\n      </select>`;var t}:this.groupService.categoricalFeatureNames.includes(t)?y=d:this.groupService.numericalFeatureNames.includes(t)?y=u:(0,f.isLitSubtype)(_,[\"Tokens\",\"SequenceTags\"])?(y=h,b[\"entry-content-long\"]=!0):(0,f.isLitSubtype)(_,\"SpanLabels\")?y=m:(0,f.isLitSubtype)(_,\"EdgeLabels\")?y=g:(0,f.isLitSubtype)(_,\"SparseMultilabel\")?(w=null!==(i=_.separator)&&void 0!==i?i:\",\",y=()=>{const t=e?e.join(w):\"\";return a.html`\n        <textarea class=\"input-box\" style=\"${(0,c.styleMap)(l)}\" @input=${t=>{r(t,t=>t?t.split(w):[])}}\n          ?readonly=\"${!n}\">${t}</textarea>`},b[\"entry-content-long\"]=!0):(0,f.isLitSubtype)(_,\"ImageBytes\")?y=o:(0,f.isLitSubtype)(_,\"Boolean\")?y=v:b[\"entry-content-long\"]=!0;const S=t=>{\"Shift\"===t.key&&(this.isShiftPressed=!1)},M=t=>{\"Shift\"===t.key&&(this.isShiftPressed=!0),\"Enter\"===t.key&&(this.isShiftPressed||(t.preventDefault(),this.shadowRoot.getElementById(\"make\").click()))},E=this.appState.currentModelRequiredInputSpecKeys.includes(t);let T=a.html`${E?\"*\":\"\"}${t}`;if((0,f.isLitSubtype)(_,\"URL\"))T=a.html`\n        <a href=${e} target=\"_blank\">\n          ${T}\n          <mwc-icon class=\"icon-button\">open_in_new</mwc-icon>\n        </a>`;else if((0,f.isLitSubtype)(_,\"SearchQuery\")){const t=new URLSearchParams;t.set(\"q\",e),T=a.html`\n        <a href=\"https://www.google.com/search?${t.toString()}\" target=\"_blank\">\n          ${T}\n          <mwc-icon class=\"icon-button\">search</mwc-icon>\n        </a>`}return a.html`\n      <div class=\"entry\"\n        @keyup=${t=>{S(t)}}\n        @keydown=${t=>{M(t)}}\n        >\n        <div class='field-header'>\n          <div class='field-name'>${T}</div>\n          <div class='field-type'>${_.__name__}</div>\n        </div>\n        <div class=${(0,s.classMap)(b)}>\n          ${y()}\n        </div>\n      </div>\n    `}static shouldDisplayModule(t,e){return!0}};y.title=\"Datapoint Editor\",y.numCols=2,y.template=(t=\"\",e=0)=>a.html`<datapoint-editor-module selectionServiceIndex=${e}></datapoint-editor-module>`,y.duplicateForExampleComparison=!0,y.duplicateForModelComparison=!1,i.__decorate([l.observable,i.__metadata(\"design:type\",Object)],y.prototype,\"editedData\",void 0),i.__decorate([l.observable,i.__metadata(\"design:type\",Boolean)],y.prototype,\"datapointEdited\",void 0),i.__decorate([l.observable,i.__metadata(\"design:type\",Object)],y.prototype,\"inputHeights\",void 0),i.__decorate([l.observable,i.__metadata(\"design:type\",Object)],y.prototype,\"maximizedImageFields\",void 0),i.__decorate([l.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],y.prototype,\"dataTextLengths\",null),i.__decorate([l.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],y.prototype,\"allRequiredInputsFilledOut\",null),y=i.__decorate([(0,o.customElement)(\"datapoint-editor-module\")],y),e.DatapointEditorModule=y;let b=class extends y{constructor(){super(...arguments),this.addButtonText=\"Analyze\",this.showAddAndCompare=!1}};b.template=(t=\"\",e=0)=>a.html`<simple-datapoint-editor-module selectionServiceIndex=${e}></simple-datapoint-editor-module>`,b=i.__decorate([(0,o.customElement)(\"simple-datapoint-editor-module\")],b),e.SimpleDatapointEditorModule=b},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`.staged-text {\n  margin-bottom: 10px;\n}\n\n.module-footer {\n  justify-content: flex-end;\n}\n\n.module-footer button {\n  margin: 4px;\n}\n\n.field-header {\n  align-items: center;\n  display: flex;\n  flex-flow: row wrap;\n  gap: .5em;\n  justify-content: space-between;\n}\n\n.field-name a {\n  /* don't apply standard link style, it's distracting */\n  text-decoration: unset;\n  color: unset;\n}\n\n.field-type {\n  color: var(--lit-light-label-color);\n  font-size: 8pt;\n}\n\n.field-header mwc-icon {\n  font-size: 10pt;\n  line-height: 0;\n  vertical-align: middle;\n  padding-right: 10px; /* for a larger click target */\n}\n\n.input-box {\n  width: 95%;\n  /* Fill available up to outer margin, if supported. */\n  width: -moz-available;\n  width: -webkit-fill-available;\n}\n\n.input-short {\n  width: 95%;\n  /* Fill available up to outer margin, if supported. */\n  width: -moz-available;\n  width: -webkit-fill-available;\n}\n\nselect.dropdown {\n  margin-right: 4px;\n  min-width: 50px;\n}\n\n.entry {\n  align-items: center;\n  box-sizing: border-box;\n  display: flex;\n  flex-flow: row wrap;\n  justify-content: space-between;\n  margin: 8px;\n}\n\n/* right-align content, particularly dropdowns */\n.entry-content {\n  display: flex;\n  justify-content: flex-end;\n}\n\n.entry-content-long {\n  flex-grow: 1;\n  flex-basis: 100%;\n}\n\ninput {\n  font-family: 'Roboto', sans;\n  color: var(--lit-gray-800);\n}\n\ntextarea {\n  resize: vertical;\n  height: 100px;\n  font-family: 'Roboto', sans;\n  line-height: 18px;\n  color: var(--lit-gray-800);\n}\n\n.span-label {\n  font-family: Monospace;\n}\n\n.edge-label {\n  font-family: Monospace;\n}\n\n.image-holder {\n  position: relative;\n}\n\n.image-min {\n  max-width: 200px;\n  max-height: 200px;\n}\n\n.image-toggle {\n  position: absolute;\n  top: 0;\n  left: 0;\n  margin: 5px;\n  cursor: pointer;\n  background: rgb(211,211,211, 0.5);\n  border-radius: 4px;\n  height: 20px;\n  width: 20px;\n  min-width: 20px;\n  --mdc-icon-size: 20px;\n  color: rgb(95, 99, 104);\n}\n\n.image-toggle:hover {\n  opacity: .8;\n  background: rgb(211,211,211, 0.8);\n}\n\n`},function(t,e,n){\"use strict\";var i;Object.defineProperty(e,\"__esModule\",{value:!0}),e.EmbeddingsModule=void 0;const r=n(1),o=r.__importStar(n(21)),a=n(122),s=n(2),c=n(3);n(3);const l=n(4),d=n(15),u=n(12),h=n(134),p=n(33);n(5);const f=n(8),m=n(11),g=n(135),v=n(7);let y=i=class extends u.LitModule{constructor(){super(),this.projectorName=\"umap\",this.projectedPoints=[],this.colorService=d.app.getService(m.ColorService),this.focusService=d.app.getService(m.FocusService),this.embeddingCache=new Map,this.selectedEmbeddingsIndex=0,this.selectedLabelIndex=0,this.selectedSpriteIndex=0,this.appState.currentInputData.length>1e3&&(this.projectorName=\"pca\")}static get styles(){return[v.styles,g.styles]}get projector(){return i.projectorChoices[this.projectorName]}get currentInputIndicesById(){const t=new Map;return this.appState.currentInputData.forEach((e,n)=>{t.set(e.id,n)}),t}get embeddingOptions(){return this.appState.currentModels.flatMap(t=>{const e=this.appState.metadata.models[t].spec;return(0,f.findSpecKeys)(e.output,\"Embeddings\").map(e=>({modelName:t,fieldName:e}))})}get embeddingOptionNames(){return this.embeddingOptions.map(t=>`${t.modelName}:${t.fieldName}`)}get displayLabels(){const t=this.getLabelByFields();return this.appState.currentInputData.map(e=>{let n=\"\";if(this.selectedLabelIndex<t.length){const i=t[this.selectedLabelIndex];n=e.data[i]}return{label:n,added:e.meta.added?1:0}})}get scatterGLDataset(){if(0===this.projectedPoints.length)return null;const t=this.displayLabels.slice(0,this.projectedPoints.length),e=new a.Dataset(this.projectedPoints,t);return this.spriteImage&&e.setSpriteMetadata({spriteImage:this.spriteImage,singleSpriteSize:[48,48]}),e}getEmbeddingCache(t,e,n,i){const o=`${t}:${e}:${n}:${JSON.stringify(i)}`;if(!this.embeddingCache.has(o)){const a=t=>t.id,s=o=>r.__awaiter(this,void 0,void 0,(function*(){return this.apiService.getInterpretations(o,e,t,n,i,\"Fetching projections\")})),c=new h.BatchRequestCache(s,a);this.embeddingCache.set(o,c)}return this.embeddingCache.get(o)}getNearestNeighbors(t,e=10){return r.__awaiter(this,void 0,void 0,(function*(){const{modelName:n,fieldName:i}=this.embeddingOptions[this.selectedEmbeddingsIndex],r={dataset_name:this.appState.currentDataset,embedding_name:i,num_neighbors:e},o=yield this.apiService.getInterpretations([t],n,this.appState.currentDataset,\"nearest neighbors\",r,\"Running nearest neighbors\");if(null===o)return;const a=o[0].nearest_neighbors.map(t=>t.id);this.selectionService.selectIds(a)}))}firstUpdated(){const t=this.shadowRoot.getElementById(\"scatter-gl-container\");this.scatterGL=new a.ScatterGL(t,{pointColorer:(t,e,n)=>this.pointColorer(t,e,n),onSelect:this.onSelect.bind(this),onHover:this.onHover.bind(this),styles:{fog:{threshold:4}},rotateOnStart:!1}),this.setupReactions();const e=this.shadowRoot.getElementById(\"scatter-gl-container\");this.resizeObserver=new ResizeObserver(()=>{this.handleResize()}),this.resizeObserver.observe(e)}handleResize(){this.shadowRoot.getElementById(\"scatter-gl-container\").offsetWidth>0&&this.scatterGL.resize()}setupReactions(){this.react(()=>this.colorService.all,t=>{this.updateScatterGL()}),this.react(()=>this.focusService.focusData,t=>{this.updateScatterGL()}),this.react(()=>this.selectionService.primarySelectedId,t=>{this.updateScatterGL()}),this.react(()=>this.selectedSpriteIndex,t=>{this.computeSpriteMap()});this.reactImmediately(()=>[this.appState.currentInputData,this.selectedEmbeddingsIndex,this.projectorName],()=>{this.computeProjectedEmbeddings()},{delay:.2}),this.reactImmediately(()=>this.scatterGLDataset,t=>{this.updateScatterGL()}),this.reactImmediately(()=>this.selectionService.selectedIds,t=>{const e=this.uniqueIdsToIndices(t);this.scatterGL.select(e)})}updateScatterGL(){this.scatterGLDataset&&(this.scatterGL.render(this.scatterGLDataset),this.spriteImage?this.scatterGL.setSpriteRenderMode():this.scatterGL.setPointRenderMode())}uniqueIdsToIndices(t){return t.map(t=>this.currentInputIndicesById.get(t)).filter(t=>void 0!==t)}computeProjectedEmbeddings(){return r.__awaiter(this,void 0,void 0,(function*(){if(!this.appState.currentInputData.length)return void(this.projectedPoints=[]);const t=this.embeddingOptions[this.selectedEmbeddingsIndex];if(!t)return;const{modelName:e,fieldName:n}=t,i=this.appState.currentDataset,r={dataset_name:i,model_name:e,field_name:n,proj_kw:{n_components:3}},o=this.getEmbeddingCache(i,e,this.projector.interpreterName,r).call(this.appState.currentInputData),a=yield this.loadLatest(\"proj-\"+JSON.stringify(r),o);null!==a&&(this.appState.datasetHasImages?this.computeSpriteMap():this.spriteImage=void 0,this.projectedPoints=a.map(t=>t.z))}))}getLabelByFields(){const t=this.appState.currentInputData;let e=null===t||0===t.length?[]:Object.keys(t[0].data);return e=e.filter(t=>!this.getImageFields().includes(t)),e}getImageFields(){return(0,f.findSpecKeys)(this.appState.currentDatasetSpec,\"ImageBytes\")}computeSpriteMap(){if(this.selectedSpriteIndex>=this.getImageFields().length)return void(this.spriteImage=void 0);const t=this.getImageFields()[this.selectedSpriteIndex],e=document.createElement(\"canvas\"),n=Math.ceil(Math.sqrt(this.appState.currentInputData.length));e.width=48*n,e.height=48*n;const i=e.getContext(\"2d\");for(let r=0;r<this.appState.currentInputData.length;r++){const o=this.appState.currentInputData[r],a=r%n,s=Math.floor(r/n),c=new Image;c.onload=()=>{if(i.drawImage(c,48*a,48*s,48,48),r===this.appState.currentInputData.length-1){const t=document.createElement(\"img\");t.src=e.toDataURL(\"image/jpeg\"),this.spriteImage=t}};const l=o.data[t];null!=l&&(c.src=l)}}pointColorer(t,e,n){const i=this.appState.currentInputData[t];let r=this.colorService.getDatapointColor(i);const a=null!=i&&this.selectionService.isIdSelected(i.id),s=null!=i&&this.selectionService.primarySelectedId===i.id,c=null!=this.focusService.focusData&&this.focusService.focusData.datapointId===i.id&&null==this.focusService.focusData.io;if(c&&(r=(0,p.getBrandColor)(\"mage\",\"300\").color),this.spriteImage&&!c&&!a)return\"\";const l=o.color(r);return c||s?l.opacity=1:a&&!s?l.opacity=.8:this.selectionService.selectedInputData.length?l.opacity=.25:l.opacity=.8,l.toString()}onSelect(t){const e=this.appState.currentInputData.filter((e,n)=>t.includes(n)).map(t=>t.id);this.selectionService.selectIds(e)}onHover(t){null==t?this.focusService.clearFocus():this.focusService.setFocusedDatapoint(this.appState.currentInputData[t].id)}render(){const t=1!==this.selectionService.selectedIds.length;return c.html`\n      <div class=\"container\">\n        <div class=\"toolbar-container flex-row\">\n          ${this.renderProjectorSelect()}\n          ${this.renderEmbeddingsSelect()}\n          ${this.renderLabelBySelect()}\n          ${this.renderSpriteBySelect()}\n        </div>\n        <div class=\"toolbar-container flex-row\" id=\"select-button-container\">\n          <button class=\"hairline-button selected-nearest-button\"\n            ?disabled=${t}\n            @click=${()=>{null!=this.selectionService.primarySelectedInputData&&this.getNearestNeighbors(this.selectionService.primarySelectedInputData)}}\n            title=${t?\"Select a single point to use this feature\":\"\"}\n          >Select ${10} nearest neighbors</button>\n        </div>\n        <div id=\"scatter-gl-container\"></div>\n      </div>\n    `}renderSpinner(){return c.html`\n      <div class=\"spinner-container\">\n        <lit-spinner size=${36} color=\"var(--app-dark-color)\"></lit-spinner>\n      </div>`}renderProjectorSelect(){const t=i.projectorChoices,e=Object.keys(t).map(e=>c.html`\n        <option value=${e} ?selected=${e===this.projectorName}>\n          ${t[e].displayName}\n        </option>\n      `);return this.renderSelect(\"Projector\",e,e=>{const n=e.target,i=(null==n?void 0:n.selectedIndex)||0;this.projectorName=Object.keys(t)[i]},this.projectorName)}renderEmbeddingsSelect(){const t=this.embeddingOptionNames,e=t.map((t,e)=>c.html`\n        <option value=${e}>${t}</option>\n      `);return this.renderSelect(\"Embedding\",e,t=>{const e=t.target;this.selectedEmbeddingsIndex=(null==e?void 0:e.selectedIndex)||0},t[0])}renderLabelBySelect(){var t;const e=this.getLabelByFields(),n=e.map((t,e)=>c.html`<option value=${e}>${t}</option>`);return this.renderSelect(\"Label by\",n,t=>{const e=t.target;this.selectedLabelIndex=(null==e?void 0:e.selectedIndex)||0},null!==(t=e[0])&&void 0!==t?t:\"\")}renderSpriteBySelect(){var t;const e=this.getImageFields();if(0===e.length)return null;e.push(\"none\");const n=e.map((t,e)=>c.html`<option value=${e}>${t}</option>`);return this.renderSelect(\"Thumbnail by\",n,t=>{const e=t.target;this.selectedSpriteIndex=(null==e?void 0:e.selectedIndex)||0},null!==(t=e[0])&&void 0!==t?t:\"\")}renderSelect(t,e,n,i){return c.html`\n      <div class=\"dropdown-container\">\n        <label class=\"dropdown-label\">${t}:</label>\n        <select class=\"dropdown\" @change=${n} .value=${i}>\n          ${e}\n        </select>\n      </div>\n    `}static shouldDisplayModule(t,e){if(!(0,f.doesOutputSpecContain)(t,\"Embeddings\"))return!1;for(const e of Object.values(t))if(-1!==e.interpreters.indexOf(\"umap\")||-1!==e.interpreters.indexOf(\"pca\"))return!0;return!1}};y.title=\"Embeddings\",y.template=()=>c.html`<embeddings-module></embeddings-module>`,y.duplicateForModelComparison=!1,y.projectorChoices={pca:{displayName:\"PCA\",interpreterName:\"pca\"},umap:{displayName:\"UMAP\",interpreterName:\"umap\"}},y.numCols=3,r.__decorate([l.observable,r.__metadata(\"design:type\",String)],y.prototype,\"projectorName\",void 0),r.__decorate([l.computed,r.__metadata(\"design:type\",Object),r.__metadata(\"design:paramtypes\",[])],y.prototype,\"projector\",null),r.__decorate([l.observable,r.__metadata(\"design:type\",Array)],y.prototype,\"projectedPoints\",void 0),r.__decorate([l.observable,r.__metadata(\"design:type\",Object)],y.prototype,\"spriteImage\",void 0),r.__decorate([l.observable,r.__metadata(\"design:type\",Object)],y.prototype,\"selectedEmbeddingsIndex\",void 0),r.__decorate([l.observable,r.__metadata(\"design:type\",Object)],y.prototype,\"selectedLabelIndex\",void 0),r.__decorate([l.observable,r.__metadata(\"design:type\",Object)],y.prototype,\"selectedSpriteIndex\",void 0),r.__decorate([l.computed,r.__metadata(\"design:type\",Map),r.__metadata(\"design:paramtypes\",[])],y.prototype,\"currentInputIndicesById\",null),r.__decorate([l.computed,r.__metadata(\"design:type\",Object),r.__metadata(\"design:paramtypes\",[])],y.prototype,\"embeddingOptions\",null),r.__decorate([l.computed,r.__metadata(\"design:type\",Object),r.__metadata(\"design:paramtypes\",[])],y.prototype,\"embeddingOptionNames\",null),r.__decorate([l.computed,r.__metadata(\"design:type\",Object),r.__metadata(\"design:paramtypes\",[])],y.prototype,\"displayLabels\",null),r.__decorate([l.computed,r.__metadata(\"design:type\",Object),r.__metadata(\"design:paramtypes\",[])],y.prototype,\"scatterGLDataset\",null),y=i=r.__decorate([(0,s.customElement)(\"embeddings-module\"),r.__metadata(\"design:paramtypes\",[])],y),e.EmbeddingsModule=y},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(123);e.ScatterGL=i.ScatterGL;var r=n(76);e.Dataset=r.Dataset},function(t,e,n){\"use strict\";var i=this&&this.__read||function(t,e){var n=\"function\"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a},r=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t},o=this&&this.__values||function(t){var e=\"function\"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&\"number\"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")};Object.defineProperty(e,\"__esModule\",{value:!0});var a=n(124),s=n(127),c=n(76),l=n(58),d=n(128),u=n(45),h=n(59),p=n(129),f=n(130),m=n(131),g=n(133),v=function(){function t(t,e){var n=this;void 0===e&&(e={}),this.pointColorer=null,this.sequences=[],this.renderMode=\"POINT\",this.rotateOnStart=!0,this.selectEnabled=!0,this.showLabelsOnHover=!0,this.hoverPointIndex=null,this.selectedPointIndices=new Set,this.clickCallback=function(){},this.hoverCallback=function(){},this.selectCallback=function(){},this.cameraMoveCallback=function(){},this.onHover=function(t){n.hoverCallback(t),n.hoverPointIndex=t,n.updateScatterPlotAttributes(),n.renderScatterPlot()},this.onClick=function(t){n.clickCallback(t)},this.select=function(t){n.selectEnabled&&(n.selectedPointIndices=new Set(t),n.updateScatterPlotAttributes(),n.renderScatterPlot())},this.onSelect=function(t){n.selectEnabled&&(n.selectCallback(t),n.select(t))},this.containerElement=t,this.styles=d.makeStyles(e.styles),this.setParameters(e),this.scatterPlot=new a.ScatterPlot(t,{camera:e.camera,onClick:this.onClick,onHover:this.onHover,onSelect:this.onSelect,selectEnabled:this.selectEnabled,styles:this.styles,orbitControlParams:e.orbitControls}),this.scatterPlot.onCameraMove(this.cameraMoveCallback)}return t.prototype.setParameters=function(t){void 0!==t.onClick&&(this.clickCallback=t.onClick),void 0!==t.onHover&&(this.hoverCallback=t.onHover),void 0!==t.onSelect&&(this.selectCallback=t.onSelect),void 0!==t.onCameraMove&&(this.cameraMoveCallback=t.onCameraMove),void 0!==t.pointColorer&&(this.pointColorer=t.pointColorer),void 0!==t.renderMode&&(this.renderMode=t.renderMode),void 0!==t.rotateOnStart&&(this.rotateOnStart=t.rotateOnStart),void 0!==t.selectEnabled&&(this.selectEnabled=t.selectEnabled),void 0!==t.showLabelsOnHover&&(this.showLabelsOnHover=t.showLabelsOnHover)},t.prototype.render=function(t){this.updateDataset(t),this.clearVisualizers(),this.setVisualizers(),this.rotateOnStart&&this.scatterPlot.startOrbitAnimation()},t.prototype.clearVisualizers=function(){this.canvasLabelsVisualizer=void 0,this.labels3DVisualizer=void 0,this.pointVisualizer=void 0,this.polylineVisualizer=void 0,this.spritesheetVisualizer=void 0,this.scatterPlot.disposeAllVisualizers()},t.prototype.renderScatterPlot=function(){this.dataset&&this.scatterPlot.render()},t.prototype.setRenderMode=function(t){this.renderMode=t,this.setVisualizers(),this.updateScatterPlotAttributes(),this.updateScatterPlotPositions()},t.prototype.setTextRenderMode=function(){this.setRenderMode(\"TEXT\"),this.renderScatterPlot()},t.prototype.setPointRenderMode=function(){this.setRenderMode(\"POINT\"),this.renderScatterPlot()},t.prototype.setSpriteRenderMode=function(){this.dataset&&this.dataset.spriteMetadata&&(this.setRenderMode(\"SPRITE\"),this.renderScatterPlot())},t.prototype.setSequences=function(t){this.sequences=t,this.updatePolylineAttributes(),this.setVisualizers(),this.renderScatterPlot()},t.prototype.setPanMode=function(){this.scatterPlot.setInteractionMode(\"PAN\")},t.prototype.setSelectMode=function(){this.scatterPlot.setInteractionMode(\"SELECT\")},t.prototype.setDimensions=function(t){var e=t<2||t>3,n=this.dataset&&t>this.dataset.dimensions;if(e||n)throw new RangeError(\"Setting invalid dimensionality\");this.scatterPlot.setDimensions(t),this.renderScatterPlot()},t.prototype.setPointColorer=function(t){this.pointColorer=t,this.updateScatterPlotAttributes(),this.renderScatterPlot()},t.prototype.callPointColorer=function(t,e){return t(e,this.selectedPointIndices,this.hoverPointIndex)},t.prototype.setHoverPointIndex=function(t){this.hoverPointIndex=t,this.updateScatterPlotAttributes(),this.scatterPlot.orbitIsAnimating()||this.renderScatterPlot()},t.prototype.resize=function(){this.scatterPlot.resize()},t.prototype.updateDataset=function(t){this.setDataset(t),this.scatterPlot.setDimensions(t.dimensions),this.updateScatterPlotAttributes(),this.updateScatterPlotPositions(),this.renderScatterPlot()},t.prototype.isOrbiting=function(){return this.scatterPlot.orbitIsAnimating()},t.prototype.startOrbitAnimation=function(){this.scatterPlot.startOrbitAnimation()},t.prototype.stopOrbitAnimation=function(){this.scatterPlot.stopOrbitAnimation()},t.prototype.setDataset=function(t){this.dataset=t,this.labels3DVisualizer&&this.labels3DVisualizer.setLabelStrings(this.generate3DLabelsArray())},t.prototype.updateScatterPlotPositions=function(){var t=this.dataset;if(t){var e=this.generatePointPositionArray(t);this.scatterPlot.setPointPositions(e)}},t.prototype.updateScatterPlotAttributes=function(){var t=this.dataset;if(t){var e=this.generatePointColorArray(t),n=this.generatePointScaleFactorArray(t),i=this.generateVisibleLabelRenderParams();this.scatterPlot.setPointColors(e),this.scatterPlot.setPointScaleFactors(n),this.scatterPlot.setLabels(i)}},t.prototype.updatePolylineAttributes=function(){var t=this.dataset;if(t){var e=this.generateLineSegmentColorMap(t),n=this.generateLineSegmentOpacityArray(t),i=this.generateLineSegmentWidthArray(t);this.scatterPlot.setPolylineColors(e),this.scatterPlot.setPolylineOpacities(n),this.scatterPlot.setPolylineWidths(i)}},t.prototype.generatePointPositionArray=function(t){var e,n,i=[0,0];e=u.extent(t.points.map((function(t){return t[0]}))),n=u.extent(t.points.map((function(t){return t[1]}))),3===t.dimensions&&(i=u.extent(t.points.map((function(t){return t[2]}))));var r=function(t){return Math.abs(t[1]-t[0])},o=r(e),a=r(n),s=r(i),c=Math.max(o,a,s),l=h.SCATTER_PLOT_CUBE_LENGTH/2,d=function(t,e){return[t/c*-e,e*(t/c)]},p=d(o,l),f=d(a,l),m=d(s,l),g=new Float32Array(3*t.points.length),v=0;return t.points.forEach((function(r,o){var a=t.points[o];g[v++]=u.scaleLinear(a[0],e,p),g[v++]=u.scaleLinear(a[1],n,f),3===t.dimensions?g[v++]=u.scaleLinear(a[2],i,m):g[v++]=0})),g},t.prototype.generateVisibleLabelRenderParams=function(){var t=this.hoverPointIndex,e=this.selectedPointIndices,n=this.styles,i=null!==t?1:0,o=new Uint32Array(i),a=new Float32Array(i),s=new Int8Array(i),c=new Uint8Array(3*i),d=new Uint8Array(3*i),h=[];a.fill(n.label.scaleDefault),s.fill(1);var p=0;if(null!==t){h.push(this.getLabelText(t)),o[p]=t,a[p]=n.label.scaleLarge,s[p]=0;var f=u.styleRgbFromHexColor(n.label.fillColorHover);u.packRgbIntoUint8Array(c,p,f[0],f[1],f[2]);var m=u.styleRgbFromHexColor(n.label.strokeColorHover);u.packRgbIntoUint8Array(d,p,m[0],m[1],m[1]),++p}f=u.styleRgbFromHexColor(n.label.fillColorSelected),m=u.styleRgbFromHexColor(n.label.strokeColorSelected);if(1===e.size){var g=r(e)[0];h.push(this.getLabelText(g)),o[p]=g,a[p]=n.label.scaleLarge,s[p]=0,u.packRgbIntoUint8Array(c,p,f[0],f[1],f[2]),u.packRgbIntoUint8Array(d,p,m[0],m[1],m[2])}return new l.LabelRenderParams(new Float32Array(o),h,a,s,n.label.fontSize,c,d)},t.prototype.generatePointScaleFactorArray=function(t){var e,n,i=this.hoverPointIndex,r=this.selectedPointIndices,a=this.styles.point,s=a.scaleDefault,c=a.scaleSelected,l=a.scaleHover,d=new Float32Array(t.points.length);d.fill(s);r.size;try{for(var u=o(r.values()),h=u.next();!h.done;h=u.next()){d[h.value]=c}}catch(t){e={error:t}}finally{try{h&&!h.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}return null!=i&&(d[i]=l),d},t.prototype.generatePointColorArray=function(t){var e,n,i=this.hoverPointIndex,r=this.pointColorer,a=this.selectedPointIndices,c=this.styles.point,l=c.colorHover,d=c.colorNoSelection,u=c.colorSelected,p=c.colorUnselected,f=new Float32Array(t.points.length*h.RGBA_NUM_ELEMENTS),m=p,g=d;\"TEXT\"===this.renderMode&&(m=this.styles.label3D.colorUnselected,g=this.styles.label3D.colorNoSelection),\"SPRITE\"===this.renderMode&&(m=this.styles.sprites.colorUnselected,g=this.styles.sprites.colorNoSelection);var v=t.points.length,y=this.selectedPointIndices.size;if(r)for(var b=0,_=0;_<v;++_){var x=s.parseColor(this.callPointColorer(r,_)||g);f[b++]=x.r,f[b++]=x.g,f[b++]=x.b,f[b++]=x.opacity}else{for(b=0,x=y>0?s.parseColor(m):s.parseColor(g),_=0;_<v;++_)f[b++]=x.r,f[b++]=x.g,f[b++]=x.b,f[b++]=x.opacity;x=s.parseColor(u);try{for(var w=o(a.values()),S=w.next();!S.done;S=w.next()){var M=S.value*h.RGBA_NUM_ELEMENTS;f[M++]=x.r,f[M++]=x.g,f[M++]=x.b,f[M++]=x.opacity}}catch(t){e={error:t}}finally{try{S&&!S.done&&(n=w.return)&&n.call(w)}finally{if(e)throw e.error}}if(null!=i){var E=s.parseColor(l),T=i*h.RGBA_NUM_ELEMENTS;f[T++]=E.r,f[T++]=E.g,f[T++]=E.b,f[T++]=E.opacity}}return f},t.prototype.generate3DLabelsArray=function(){var t=this.dataset;if(!t)return[];for(var e=[],n=t.points.length,i=0;i<n;++i)e.push(this.getLabelText(i));return e},t.prototype.generateLineSegmentColorMap=function(t){for(var e=this.pointColorer,n=this.styles,i={},r=0;r<this.sequences.length;r++){var o=this.sequences[r],a=new Float32Array(2*(o.indices.length-1)*3),c=0;if(e)for(var l=0;l<o.indices.length-1;l++){var d=s.parseColor(this.callPointColorer(e,o.indices[l])),h=s.parseColor(this.callPointColorer(e,o.indices[l+1]));a[c++]=d.r,a[c++]=d.g,a[c++]=d.b,a[c++]=h.r,a[c++]=h.g,a[c++]=h.b}else for(l=0;l<o.indices.length-1;l++){d=u.getDefaultPointInPolylineColor(l,o.indices.length,n.polyline.startHue,n.polyline.endHue,n.polyline.saturation,n.polyline.lightness),h=u.getDefaultPointInPolylineColor(l+1,o.indices.length,n.polyline.startHue,n.polyline.endHue,n.polyline.saturation,n.polyline.lightness);a[c++]=d.r,a[c++]=d.g,a[c++]=d.b,a[c++]=h.r,a[c++]=h.g,a[c++]=h.b}i[r]=a}return i},t.prototype.generateLineSegmentOpacityArray=function(t){var e=this.selectedPointIndices,n=this.styles,i=new Float32Array(this.sequences.length);if(e.size>0){i.fill(n.polyline.deselectedOpacity);var o=this.polylineVisualizer.getPointSequenceIndex(r(e)[0]);void 0!==o&&(i[o]=n.polyline.selectedOpacity)}else i.fill(n.polyline.defaultOpacity);return i},t.prototype.generateLineSegmentWidthArray=function(t){var e=this.selectedPointIndices,n=this.styles,i=new Float32Array(this.sequences.length);if(i.fill(n.polyline.defaultLineWidth),e.size>0){var o=this.polylineVisualizer.getPointSequenceIndex(r(e)[0]);void 0!==o&&(i[o]=n.polyline.selectedLineWidth)}return i},t.prototype.getLabelText=function(t){var e=this.dataset;if(!e)return\"\";var n=e.metadata[t];return n&&null!=n.label?\"\"+n.label:\"\"},t.prototype.initializeCanvasLabelsVisualizer=function(){return this.canvasLabelsVisualizer||(this.canvasLabelsVisualizer=new m.ScatterPlotVisualizerCanvasLabels(this.containerElement,this.styles)),this.canvasLabelsVisualizer},t.prototype.initialize3DLabelsVisualizer=function(){return this.labels3DVisualizer||(this.labels3DVisualizer=new p.ScatterPlotVisualizer3DLabels(this.styles)),this.labels3DVisualizer.setLabelStrings(this.generate3DLabelsArray()),this.labels3DVisualizer},t.prototype.initializePointVisualizer=function(){return this.pointVisualizer||(this.pointVisualizer=new f.ScatterPlotVisualizerSprites(this.styles)),this.pointVisualizer},t.prototype.initializeSpritesheetVisualizer=function(){var t=this,e=this.styles,n=this.dataset,i=n.spriteMetadata;if(!this.spritesheetVisualizer&&i){if(!i.spriteImage||!i.singleSpriteSize)return;var r=n.points.length,o=void 0;if(i.spriteIndices)o=new Float32Array(i.spriteIndices);else{o=new Float32Array(r);for(var a=0;a<r;++a)o[a]=a}var s=new f.ScatterPlotVisualizerSprites(e,{spritesheetImage:i.spriteImage,spriteDimensions:i.singleSpriteSize,spriteIndices:o,onImageLoad:function(){return t.renderScatterPlot()}});s.id=\"SPRITE_SHEET_VISUALIZER\",this.spritesheetVisualizer=s}return this.spritesheetVisualizer},t.prototype.initializePolylineVisualizer=function(){return this.polylineVisualizer||(this.polylineVisualizer=new g.ScatterPlotVisualizerPolylines),this.polylineVisualizer.setSequences(this.sequences),this.polylineVisualizer},t.prototype.setVisualizers=function(){var t=this.dataset,e=this.renderMode,n=[];if(\"TEXT\"===e){var i=this.initialize3DLabelsVisualizer();n.push(i)}else if(\"POINT\"===e){i=this.initializePointVisualizer();n.push(i)}else if(\"SPRITE\"===e&&t.spriteMetadata){(i=this.initializeSpritesheetVisualizer())&&n.push(i)}if(this.sequences.length>0){i=this.initializePolylineVisualizer();n.push(i)}if((\"POINT\"===e||\"SPRITE\"===e)&&this.showLabelsOnHover){i=this.initializeCanvasLabelsVisualizer();n.push(i)}this.scatterPlot.setActiveVisualizers(n)},t.Dataset=c.Dataset,t}();e.ScatterGL=v},function(t,e,n){\"use strict\";var i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},r=this&&this.__read||function(t,e){var n=\"function\"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a},o=this&&this.__values||function(t){var e=\"function\"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&\"number\"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")};Object.defineProperty(e,\"__esModule\",{value:!0});var a=n(6),s=n(125),c=n(58),l=n(45),d=n(126),u=new a.Vector3(.45,.9,1.6),h=new a.Vector3(0,0,0),p=new a.Vector3(0,0,4),f=new a.Vector3(0,0,0),m={mouseRotateSpeed:1,autoRotateSpeed:2,zoomSpeed:.125},g=function(){function t(t,e){var n=this;this.clickCallback=function(){},this.hoverCallback=function(){},this.selectCallback=function(){},this.selectEnabled=!0,this.visualizers=new Map,this.onCameraMoveListeners=[],this.height=0,this.width=0,this.dimensions=3,this.interactionMode=\"PAN\",this.pickingTexture=new a.WebGLRenderTarget(0,0),this.orbitAnimationOnNextCameraCreation=!1,this.orbitAnimationId=null,this.worldSpacePointPositions=new Float32Array(0),this.pointColors=new Float32Array(0),this.pointScaleFactors=new Float32Array(0),this.polylineColors={},this.polylineOpacities=new Float32Array(0),this.polylineWidths=new Float32Array(0),this.selecting=!1,this.nearestPoint=null,this.mouseIsDown=!1,this.isDragSequence=!1,this.lastHovered=null,this.container=t,this.styles=e.styles,this.setParameters(e),this.computeLayoutValues(),this.scene=new a.Scene,this.renderer=new a.WebGLRenderer({alpha:!0,premultipliedAlpha:!1,antialias:!1}),this.renderer.setClearColor(this.styles.backgroundColor,1),this.container.appendChild(this.renderer.domElement),this.light=new a.PointLight(16772287,1,0),this.scene.add(this.light),this.orbitControlParams=i(i({},m),e.orbitControlParams),this.rectangleSelector=new d.ScatterPlotRectangleSelector(this.container,(function(t){n.selectBoundingBox(t)}),this.styles),this.addInteractionListeners(),this.setDimensions(3),this.makeCamera(e.camera),this.resize()}return t.prototype.setParameters=function(t){void 0!==t.onClick&&(this.clickCallback=t.onClick),void 0!==t.onHover&&(this.hoverCallback=t.onHover),void 0!==t.onSelect&&(this.selectCallback=t.onSelect),void 0!==t.selectEnabled&&(this.selectEnabled=t.selectEnabled)},t.prototype.addInteractionListeners=function(){this.container.addEventListener(\"pointermove\",this.onMouseMove.bind(this)),this.container.addEventListener(\"pointerdown\",this.onMouseDown.bind(this)),this.container.addEventListener(\"pointerup\",this.onMouseUp.bind(this)),this.container.addEventListener(\"click\",this.onClick.bind(this)),window.addEventListener(\"keydown\",this.onKeyDown.bind(this),!1),window.addEventListener(\"keyup\",this.onKeyUp.bind(this),!1)},t.prototype.addCameraControlsEventListeners=function(t){var e=this;t.addEventListener(\"start\",(function(){e.stopOrbitAnimation(),e.onCameraMoveListeners.forEach((function(n){return n(e.camera.position,t.target)}))})),t.addEventListener(\"change\",(function(){e.render()})),t.addEventListener(\"end\",(function(){}))},t.prototype.makeOrbitControls=function(t,e){null!=this.orbitCameraControls&&this.orbitCameraControls.dispose();var n=new s.OrbitControls(t,this.renderer.domElement);n.zoomSpeed=this.orbitControlParams.zoomSpeed,n.enableRotate=e,n.autoRotate=!1,n.enableKeys=!1,n.rotateSpeed=this.orbitControlParams.mouseRotateSpeed,e?(n.mouseButtons.LEFT=a.MOUSE.LEFT,n.mouseButtons.RIGHT=a.MOUSE.RIGHT):(n.mouseButtons.LEFT=a.MOUSE.RIGHT,n.mouseButtons.RIGHT=a.MOUSE.LEFT),n.reset(),this.camera=t,this.orbitCameraControls=n,this.addCameraControlsEventListeners(this.orbitCameraControls)},t.prototype.makeCamera=function(t){void 0===t&&(t={});var e=this.makeDefaultCameraDef(this.dimensions,t);this.recreateCamera(e),3===this.dimensions&&this.styles.axesVisible?this.add3dAxes():this.remove3dAxesFromScene()},t.prototype.makeCamera3D=function(t,e,n){var i,r=e/n;(i=new a.PerspectiveCamera(70,r,.01,100)).position.set(t.position[0],t.position[1],t.position[2]);var o=new a.Vector3(t.target[0],t.target[1],t.target[2]);i.lookAt(o),i.zoom=t.zoom,i.updateProjectionMatrix(),this.camera=i,this.makeOrbitControls(i,!0)},t.prototype.makeCamera2D=function(t,e,n){var i,r=new a.Vector3(t.target[0],t.target[1],t.target[2]),o=e/n,s=-1.2,c=1.2,l=-1.2,d=1.2;o>1?(s*=o,c*=o):(d/=o,l/=o),(i=new a.OrthographicCamera(s,c,d,l,-1e3,1e3)).position.set(t.position[0],t.position[1],t.position[2]),i.up=new a.Vector3(0,0,1),i.lookAt(r),i.zoom=t.zoom,i.updateProjectionMatrix(),this.camera=i,this.makeOrbitControls(i,!1)},t.prototype.makeDefaultCameraDef=function(t,e){void 0===e&&(e={});var n=2===t,i=n?p:u,r=n?f:h,o={orthographic:n,zoom:1,position:[i.x,i.y,i.z],target:[r.x,r.y,r.z]};return e.zoom&&(o.zoom=e.zoom),e.position&&(o.position=e.position),e.target&&(o.target=e.target),o},t.prototype.recreateCamera=function(t){t.orthographic?this.makeCamera2D(t,this.width,this.height):this.makeCamera3D(t,this.width,this.height),this.orbitCameraControls.minDistance=.05,this.orbitCameraControls.maxDistance=10,this.orbitCameraControls.update(),this.orbitAnimationOnNextCameraCreation&&this.startOrbitAnimation()},t.prototype.setInteractionMode=function(t){this.interactionMode=t,\"SELECT\"===t?(this.selecting=!0,this.container.style.cursor=\"crosshair\",this.orbitCameraControls.enabled=!1):(this.selecting=!1,this.container.style.cursor=\"default\",this.orbitCameraControls.enabled=!0)},t.prototype.onClick=function(t,e){if(void 0===e&&(e=!0),!t||!this.selecting){if(!this.isDragSequence&&e){if(this.selectEnabled){var n=null!=this.nearestPoint?[this.nearestPoint]:[];this.selectCallback(n)}this.clickCallback(this.nearestPoint)}this.isDragSequence=!1,this.render()}},t.prototype.onMouseDown=function(t){this.isDragSequence=!1,this.mouseIsDown=!0,this.selecting?(this.rectangleSelector.onMouseDown(t.offsetX,t.offsetY),this.setNearestPointToMouse(t)):!t.ctrlKey&&this.sceneIs3D()&&this.orbitCameraControls.mouseButtons.ORBIT===a.MOUSE.RIGHT?(this.orbitCameraControls.mouseButtons.ORBIT=a.MOUSE.LEFT,this.orbitCameraControls.mouseButtons.PAN=a.MOUSE.RIGHT):t.ctrlKey&&this.sceneIs3D()&&this.orbitCameraControls.mouseButtons.ORBIT===a.MOUSE.LEFT&&(this.orbitCameraControls.mouseButtons.ORBIT=a.MOUSE.RIGHT,this.orbitCameraControls.mouseButtons.PAN=a.MOUSE.LEFT)},t.prototype.onMouseUp=function(t){this.selecting&&(this.rectangleSelector.onMouseUp(),this.render()),this.mouseIsDown=!1},t.prototype.onMouseMove=function(t){this.isDragSequence=this.mouseIsDown,this.selecting&&this.mouseIsDown?(this.rectangleSelector.onMouseMove(t.offsetX,t.offsetY),this.render()):this.mouseIsDown||(this.setNearestPointToMouse(t),this.nearestPoint!=this.lastHovered&&(this.lastHovered=this.nearestPoint,this.hoverCallback(this.nearestPoint)))},t.prototype.onKeyDown=function(t){\"Control\"===t.key&&this.sceneIs3D()&&(this.orbitCameraControls.mouseButtons.ORBIT=a.MOUSE.RIGHT,this.orbitCameraControls.mouseButtons.PAN=a.MOUSE.LEFT),\"Shift\"===t.key&&this.selectEnabled&&(this.selecting=!0,this.orbitCameraControls.enabled=!1,this.container.style.cursor=\"crosshair\")},t.prototype.onKeyUp=function(t){\"Control\"===t.key&&this.sceneIs3D()&&(this.orbitCameraControls.mouseButtons.ORBIT=a.MOUSE.LEFT,this.orbitCameraControls.mouseButtons.PAN=a.MOUSE.RIGHT),\"Shift\"===t.key&&this.selectEnabled&&(this.selecting=!1,this.orbitCameraControls.enabled=!0,this.container.style.cursor=\"default\",this.render())},t.prototype.getPointIndicesFromBoundingBox=function(t){if(null==this.worldSpacePointPositions)return[];this.camera.updateMatrixWorld();var e=window.devicePixelRatio||1,n=Math.floor(t.x*e),i=Math.floor(t.y*e),o=Math.max(Math.floor(t.width*e),1),s=Math.max(Math.floor(t.height*e),1);if(o<=2&&s<=2)return this.getPointIndicesFromBoundingBoxPickingTexture(t);for(var c=this.renderer.domElement,l=c.width,d=c.height,u=[],h=new a.Vector3,p=0;p<this.worldSpacePointPositions.length;p++){var f=3*p,m=r(this.worldSpacePointPositions.slice(f,f+3),3),g=m[0],v=m[1],y=m[2];h.x=g,h.y=v,h.z=y;var b=h.project(this.camera),_=(b.x+1)*l/2,x=-(b.y-1)*d/2;_>=n&&_<=n+o&&x<=i&&x>=i-s&&u.push(p)}return u},t.prototype.getPointIndicesFromBoundingBoxPickingTexture=function(t){if(null==this.worldSpacePointPositions)return[];var e=this.worldSpacePointPositions.length/3,n=window.devicePixelRatio||1,i=Math.floor(t.x*n),r=Math.floor(t.y*n),o=Math.max(Math.floor(t.width*n),1),a=Math.max(Math.floor(t.height*n),1),s=new Uint8Array(o*a*4);this.renderer.readRenderTargetPixels(this.pickingTexture,i,this.pickingTexture.height-r,o,a,s);for(var c=new Uint8Array(this.worldSpacePointPositions.length),l=0;l<o*a;l++){var d=s[4*l]<<16|s[4*l+1]<<8|s[4*l+2];16777215!==d&&d<e&&(c[d]=1)}var u=[];for(l=0;l<c.length;l++)1===c[l]&&u.push(l);return u},t.prototype.selectBoundingBox=function(t){var e=this.getPointIndicesFromBoundingBox(t);this.selectCallback(e)},t.prototype.setNearestPointToMouse=function(t){if(null!=this.pickingTexture){var e={x:t.offsetX,y:t.offsetY,width:1,height:1},n=this.getPointIndicesFromBoundingBoxPickingTexture(e);this.nearestPoint=n.length?n[0]:null}else this.nearestPoint=null},t.prototype.computeLayoutValues=function(){return this.width=this.container.offsetWidth,this.height=Math.max(1,this.container.offsetHeight),[this.width,this.height]},t.prototype.sceneIs3D=function(){return 3===this.dimensions},t.prototype.remove3dAxesFromScene=function(){var t=this.scene.getObjectByName(\"axes\");return null!=t&&this.scene.remove(t),t},t.prototype.add3dAxes=function(){var t=new a.AxesHelper;t.name=\"axes\",this.scene.add(t)},t.prototype.setDimensions=function(t){if(2!==t&&3!==t)throw new RangeError(\"dimensions must be 2 or 3\");this.dimensions!==t&&(this.dimensions=t,this.makeCamera())},t.prototype.getCameraPosition=function(){var t=this.camera.position;return[t.x,t.y,t.z]},t.prototype.getCameraTarget=function(){var t=this.orbitCameraControls.target;return[t.x,t.y,t.z]},t.prototype.setCameraPositionAndTarget=function(t,e){this.stopOrbitAnimation(),this.camera.position.set(t[0],t[1],t[2]),this.orbitCameraControls.target.set(e[0],e[1],e[2]),this.orbitCameraControls.update(),this.render()},t.prototype.startOrbitAnimation=function(){this.sceneIs3D()&&(null!=this.orbitAnimationId&&this.stopOrbitAnimation(),this.orbitCameraControls.autoRotate=!0,this.orbitCameraControls.autoRotateSpeed=this.orbitControlParams.autoRotateSpeed,this.updateOrbitAnimation())},t.prototype.orbitIsAnimating=function(){return null!=this.orbitAnimationId},t.prototype.updateOrbitAnimation=function(){var t=this;this.orbitCameraControls.update(),this.orbitAnimationId=requestAnimationFrame((function(){return t.updateOrbitAnimation()}))},t.prototype.stopOrbitAnimation=function(){this.orbitCameraControls.autoRotate=!1,this.orbitCameraControls.rotateSpeed=this.orbitControlParams.mouseRotateSpeed,null!=this.orbitAnimationId&&(cancelAnimationFrame(this.orbitAnimationId),this.orbitAnimationId=null)},t.prototype.setActiveVisualizers=function(t){var e,n,i,r,a=new Set(t.map((function(t){return t.id})));try{for(var s=o(this.visualizers.values()),c=s.next();!c.done;c=s.next()){var l=c.value;a.has(l.id)||(l.dispose(),this.visualizers.delete(l.id))}}catch(t){e={error:t}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}try{for(var d=o(t),u=d.next();!u.done;u=d.next()){l=u.value;this.visualizers.set(l.id,l),l.setScene(this.scene),l.onResize(this.width,this.height),this.worldSpacePointPositions&&l.onPointPositionsChanged(this.worldSpacePointPositions)}}catch(t){i={error:t}}finally{try{u&&!u.done&&(r=d.return)&&r.call(d)}finally{if(i)throw i.error}}},t.prototype.disposeAllVisualizers=function(){this.visualizers.forEach((function(t){return t.dispose()})),this.visualizers.clear()},t.prototype.setPointPositions=function(t){this.worldSpacePointPositions=t,this.visualizers.forEach((function(e){return e.onPointPositionsChanged(t)}))},t.prototype.render=function(){var t=this.camera.position.clone();t.x+=1,t.y+=1,this.light.position.set(t.x,t.y,t.z);var e=this.camera instanceof a.PerspectiveCamera?c.CameraType.Perspective:c.CameraType.Orthographic,n=[0,0];null!=this.worldSpacePointPositions&&(n=l.getNearFarPoints(this.worldSpacePointPositions,this.camera.position,this.orbitCameraControls.target));var i=new c.RenderContext(this.camera,e,this.orbitCameraControls.target,this.width,this.height,n[0],n[1],this.styles.backgroundColor,this.pointColors,this.pointScaleFactors,this.labels,this.polylineColors,this.polylineOpacities,this.polylineWidths);this.visualizers.forEach((function(t){return t.onPickingRender(i)}));var r=this.remove3dAxesFromScene();this.renderer.setRenderTarget(this.pickingTexture),this.renderer.render(this.scene,this.camera),null!=r&&this.scene.add(r),this.visualizers.forEach((function(t){return t.onRender(i)})),this.renderer.setRenderTarget(null),this.renderer.render(this.scene,this.camera)},t.prototype.setPointColors=function(t){this.pointColors=t},t.prototype.setPointScaleFactors=function(t){this.pointScaleFactors=t},t.prototype.setLabels=function(t){this.labels=t},t.prototype.setPolylineColors=function(t){this.polylineColors=t},t.prototype.setPolylineOpacities=function(t){this.polylineOpacities=t},t.prototype.setPolylineWidths=function(t){this.polylineWidths=t},t.prototype.resetZoom=function(){this.recreateCamera(this.makeDefaultCameraDef(this.dimensions)),this.render()},t.prototype.setDayNightMode=function(t){for(var e=this.container.querySelectorAll(\"canvas\"),n=t?\"invert(100%)\":\"\",i=0;i<e.length;i++)e[i].style.filter=n},t.prototype.resize=function(t){void 0===t&&(t=!0);var e=r([this.width,this.height],2),n=e[0],i=e[1],o=r(this.computeLayoutValues(),2),s=o[0],c=o[1];if(3===this.dimensions){(l=this.camera).aspect=s/c,l.updateProjectionMatrix()}else{var l=this.camera,d=s/n,u=c/i,h=(l.right-l.left)*d/2,p=(l.top-l.bottom)*u/2;l.top=p,l.bottom=-p,l.left=-h,l.right=h,l.updateProjectionMatrix()}var f=window.devicePixelRatio||1;this.renderer.setPixelRatio(f),this.renderer.setSize(s,c);var m=new a.Vector2;this.renderer.getSize(m);var g=this.renderer.getPixelRatio();this.pickingTexture=new a.WebGLRenderTarget(m.width*g,m.height*g),this.pickingTexture.texture.minFilter=a.LinearFilter,this.visualizers.forEach((function(t){return t.onResize(s,c)})),t&&this.render()},t.prototype.onCameraMove=function(t){this.onCameraMoveListeners.push(t)},t.prototype.clickOnPoint=function(t){this.nearestPoint=t,this.onClick(null,!1)},t}();e.ScatterPlot=g},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"OrbitControls\",(function(){return r})),n.d(e,\"MapControls\",(function(){return o}));var i=n(6),r=function(t,e){var n,r,o,a,s,c;void 0===e&&console.warn('THREE.OrbitControls: The second parameter \"domElement\" is now mandatory.'),e===document&&console.error('THREE.OrbitControls: \"document\" should not be used as the target \"domElement\". Please use \"renderer.domElement\" instead.'),this.object=t,this.domElement=e,this.enabled=!0,this.target=new i.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:i.MOUSE.ROTATE,MIDDLE:i.MOUSE.DOLLY,RIGHT:i.MOUSE.PAN},this.touches={ONE:i.TOUCH.ROTATE,TWO:i.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return g.phi},this.getAzimuthalAngle=function(){return g.theta},this.listenToKeyEvents=function(t){t.addEventListener(\"keydown\",Z),this._domElementKeyEvents=t},this.saveState=function(){l.target0.copy(l.target),l.position0.copy(l.object.position),l.zoom0=l.object.zoom},this.reset=function(){l.target.copy(l.target0),l.object.position.copy(l.position0),l.object.zoom=l.zoom0,l.object.updateProjectionMatrix(),l.dispatchEvent(d),l.update(),f=p.NONE},this.update=(n=new i.Vector3,r=(new i.Quaternion).setFromUnitVectors(t.up,new i.Vector3(0,1,0)),o=r.clone().invert(),a=new i.Vector3,s=new i.Quaternion,c=2*Math.PI,function(){var t=l.object.position;n.copy(t).sub(l.target),n.applyQuaternion(r),g.setFromVector3(n),l.autoRotate&&f===p.NONE&&L(2*Math.PI/60/60*l.autoRotateSpeed),l.enableDamping?(g.theta+=v.theta*l.dampingFactor,g.phi+=v.phi*l.dampingFactor):(g.theta+=v.theta,g.phi+=v.phi);var e=l.minAzimuthAngle,i=l.maxAzimuthAngle;return isFinite(e)&&isFinite(i)&&(e<-Math.PI?e+=c:e>Math.PI&&(e-=c),i<-Math.PI?i+=c:i>Math.PI&&(i-=c),g.theta=e<=i?Math.max(e,Math.min(i,g.theta)):g.theta>(e+i)/2?Math.max(e,g.theta):Math.min(i,g.theta)),g.phi=Math.max(l.minPolarAngle,Math.min(l.maxPolarAngle,g.phi)),g.makeSafe(),g.radius*=y,g.radius=Math.max(l.minDistance,Math.min(l.maxDistance,g.radius)),!0===l.enableDamping?l.target.addScaledVector(b,l.dampingFactor):l.target.add(b),n.setFromSpherical(g),n.applyQuaternion(o),t.copy(l.target).add(n),l.object.lookAt(l.target),!0===l.enableDamping?(v.theta*=1-l.dampingFactor,v.phi*=1-l.dampingFactor,b.multiplyScalar(1-l.dampingFactor)):(v.set(0,0,0),b.set(0,0,0)),y=1,!!(_||a.distanceToSquared(l.object.position)>m||8*(1-s.dot(l.object.quaternion))>m)&&(l.dispatchEvent(d),a.copy(l.object.position),s.copy(l.object.quaternion),_=!1,!0)}),this.dispose=function(){l.domElement.removeEventListener(\"contextmenu\",et),l.domElement.removeEventListener(\"pointerdown\",q),l.domElement.removeEventListener(\"wheel\",K),l.domElement.removeEventListener(\"touchstart\",J),l.domElement.removeEventListener(\"touchend\",tt),l.domElement.removeEventListener(\"touchmove\",Q),l.domElement.ownerDocument.removeEventListener(\"pointermove\",X),l.domElement.ownerDocument.removeEventListener(\"pointerup\",Y),null!==l._domElementKeyEvents&&l._domElementKeyEvents.removeEventListener(\"keydown\",Z)};var l=this,d={type:\"change\"},u={type:\"start\"},h={type:\"end\"},p={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},f=p.NONE,m=1e-6,g=new i.Spherical,v=new i.Spherical,y=1,b=new i.Vector3,_=!1,x=new i.Vector2,w=new i.Vector2,S=new i.Vector2,M=new i.Vector2,E=new i.Vector2,T=new i.Vector2,C=new i.Vector2,A=new i.Vector2,O=new i.Vector2;function k(){return Math.pow(.95,l.zoomSpeed)}function L(t){v.theta-=t}function I(t){v.phi-=t}var R,P=(R=new i.Vector3,function(t,e){R.setFromMatrixColumn(e,0),R.multiplyScalar(-t),b.add(R)}),D=function(){var t=new i.Vector3;return function(e,n){!0===l.screenSpacePanning?t.setFromMatrixColumn(n,1):(t.setFromMatrixColumn(n,0),t.crossVectors(l.object.up,t)),t.multiplyScalar(e),b.add(t)}}(),N=function(){var t=new i.Vector3;return function(e,n){var i=l.domElement;if(l.object.isPerspectiveCamera){var r=l.object.position;t.copy(r).sub(l.target);var o=t.length();o*=Math.tan(l.object.fov/2*Math.PI/180),P(2*e*o/i.clientHeight,l.object.matrix),D(2*n*o/i.clientHeight,l.object.matrix)}else l.object.isOrthographicCamera?(P(e*(l.object.right-l.object.left)/l.object.zoom/i.clientWidth,l.object.matrix),D(n*(l.object.top-l.object.bottom)/l.object.zoom/i.clientHeight,l.object.matrix)):(console.warn(\"WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.\"),l.enablePan=!1)}}();function F(t){l.object.isPerspectiveCamera?y/=t:l.object.isOrthographicCamera?(l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom*t)),l.object.updateProjectionMatrix(),_=!0):(console.warn(\"WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.\"),l.enableZoom=!1)}function j(t){l.object.isPerspectiveCamera?y*=t:l.object.isOrthographicCamera?(l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom/t)),l.object.updateProjectionMatrix(),_=!0):(console.warn(\"WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.\"),l.enableZoom=!1)}function B(t){x.set(t.clientX,t.clientY)}function z(t){M.set(t.clientX,t.clientY)}function U(t){if(1==t.touches.length)x.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),n=.5*(t.touches[0].pageY+t.touches[1].pageY);x.set(e,n)}}function H(t){if(1==t.touches.length)M.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),n=.5*(t.touches[0].pageY+t.touches[1].pageY);M.set(e,n)}}function $(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,i=Math.sqrt(e*e+n*n);C.set(0,i)}function G(t){if(1==t.touches.length)w.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),n=.5*(t.touches[0].pageY+t.touches[1].pageY);w.set(e,n)}S.subVectors(w,x).multiplyScalar(l.rotateSpeed);var i=l.domElement;L(2*Math.PI*S.x/i.clientHeight),I(2*Math.PI*S.y/i.clientHeight),x.copy(w)}function V(t){if(1==t.touches.length)E.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),n=.5*(t.touches[0].pageY+t.touches[1].pageY);E.set(e,n)}T.subVectors(E,M).multiplyScalar(l.panSpeed),N(T.x,T.y),M.copy(E)}function W(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,i=Math.sqrt(e*e+n*n);A.set(0,i),O.set(0,Math.pow(A.y/C.y,l.zoomSpeed)),F(O.y),C.copy(A)}function q(t){if(!1!==l.enabled)switch(t.pointerType){case\"mouse\":case\"pen\":!function(t){var e;switch(t.preventDefault(),l.domElement.focus?l.domElement.focus():window.focus(),t.button){case 0:e=l.mouseButtons.LEFT;break;case 1:e=l.mouseButtons.MIDDLE;break;case 2:e=l.mouseButtons.RIGHT;break;default:e=-1}switch(e){case i.MOUSE.DOLLY:if(!1===l.enableZoom)return;!function(t){C.set(t.clientX,t.clientY)}(t),f=p.DOLLY;break;case i.MOUSE.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===l.enablePan)return;z(t),f=p.PAN}else{if(!1===l.enableRotate)return;B(t),f=p.ROTATE}break;case i.MOUSE.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===l.enableRotate)return;B(t),f=p.ROTATE}else{if(!1===l.enablePan)return;z(t),f=p.PAN}break;default:f=p.NONE}f!==p.NONE&&(l.domElement.ownerDocument.addEventListener(\"pointermove\",X),l.domElement.ownerDocument.addEventListener(\"pointerup\",Y),l.dispatchEvent(u))}(t)}}function X(t){if(!1!==l.enabled)switch(t.pointerType){case\"mouse\":case\"pen\":!function(t){if(!1===l.enabled)return;switch(t.preventDefault(),f){case p.ROTATE:if(!1===l.enableRotate)return;!function(t){w.set(t.clientX,t.clientY),S.subVectors(w,x).multiplyScalar(l.rotateSpeed);var e=l.domElement;L(2*Math.PI*S.x/e.clientHeight),I(2*Math.PI*S.y/e.clientHeight),x.copy(w),l.update()}(t);break;case p.DOLLY:if(!1===l.enableZoom)return;!function(t){A.set(t.clientX,t.clientY),O.subVectors(A,C),O.y>0?F(k()):O.y<0&&j(k()),C.copy(A),l.update()}(t);break;case p.PAN:if(!1===l.enablePan)return;!function(t){E.set(t.clientX,t.clientY),T.subVectors(E,M).multiplyScalar(l.panSpeed),N(T.x,T.y),M.copy(E),l.update()}(t)}}(t)}}function Y(t){switch(t.pointerType){case\"mouse\":case\"pen\":!function(t){if(l.domElement.ownerDocument.removeEventListener(\"pointermove\",X),l.domElement.ownerDocument.removeEventListener(\"pointerup\",Y),!1===l.enabled)return;l.dispatchEvent(h),f=p.NONE}()}}function K(t){!1===l.enabled||!1===l.enableZoom||f!==p.NONE&&f!==p.ROTATE||(t.preventDefault(),t.stopPropagation(),l.dispatchEvent(u),function(t){t.deltaY<0?j(k()):t.deltaY>0&&F(k()),l.update()}(t),l.dispatchEvent(h))}function Z(t){!1!==l.enabled&&!1!==l.enablePan&&function(t){var e=!1;switch(t.keyCode){case l.keys.UP:N(0,l.keyPanSpeed),e=!0;break;case l.keys.BOTTOM:N(0,-l.keyPanSpeed),e=!0;break;case l.keys.LEFT:N(l.keyPanSpeed,0),e=!0;break;case l.keys.RIGHT:N(-l.keyPanSpeed,0),e=!0}e&&(t.preventDefault(),l.update())}(t)}function J(t){if(!1!==l.enabled){switch(t.preventDefault(),t.touches.length){case 1:switch(l.touches.ONE){case i.TOUCH.ROTATE:if(!1===l.enableRotate)return;U(t),f=p.TOUCH_ROTATE;break;case i.TOUCH.PAN:if(!1===l.enablePan)return;H(t),f=p.TOUCH_PAN;break;default:f=p.NONE}break;case 2:switch(l.touches.TWO){case i.TOUCH.DOLLY_PAN:if(!1===l.enableZoom&&!1===l.enablePan)return;!function(t){l.enableZoom&&$(t),l.enablePan&&H(t)}(t),f=p.TOUCH_DOLLY_PAN;break;case i.TOUCH.DOLLY_ROTATE:if(!1===l.enableZoom&&!1===l.enableRotate)return;!function(t){l.enableZoom&&$(t),l.enableRotate&&U(t)}(t),f=p.TOUCH_DOLLY_ROTATE;break;default:f=p.NONE}break;default:f=p.NONE}f!==p.NONE&&l.dispatchEvent(u)}}function Q(t){if(!1!==l.enabled)switch(t.preventDefault(),t.stopPropagation(),f){case p.TOUCH_ROTATE:if(!1===l.enableRotate)return;G(t),l.update();break;case p.TOUCH_PAN:if(!1===l.enablePan)return;V(t),l.update();break;case p.TOUCH_DOLLY_PAN:if(!1===l.enableZoom&&!1===l.enablePan)return;!function(t){l.enableZoom&&W(t),l.enablePan&&V(t)}(t),l.update();break;case p.TOUCH_DOLLY_ROTATE:if(!1===l.enableZoom&&!1===l.enableRotate)return;!function(t){l.enableZoom&&W(t),l.enableRotate&&G(t)}(t),l.update();break;default:f=p.NONE}}function tt(t){!1!==l.enabled&&(l.dispatchEvent(h),f=p.NONE)}function et(t){!1!==l.enabled&&t.preventDefault()}l.domElement.addEventListener(\"contextmenu\",et),l.domElement.addEventListener(\"pointerdown\",q),l.domElement.addEventListener(\"wheel\",K),l.domElement.addEventListener(\"touchstart\",J),l.domElement.addEventListener(\"touchend\",tt),l.domElement.addEventListener(\"touchmove\",Q),this.update()};r.prototype=Object.create(i.EventDispatcher.prototype),r.prototype.constructor=r;var o=function(t,e){r.call(this,t,e),this.screenSpacePanning=!1,this.mouseButtons.LEFT=i.MOUSE.PAN,this.mouseButtons.RIGHT=i.MOUSE.ROTATE,this.touches.ONE=i.TOUCH.PAN,this.touches.TWO=i.TOUCH.DOLLY_ROTATE};o.prototype=Object.create(i.EventDispatcher.prototype),o.prototype.constructor=o},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=function(){function t(t,e,n){this.startCoordinates=[0,0],this.svgElement=document.createElementNS(\"http://www.w3.org/2000/svg\",\"svg\"),this.svgElement.style.display=\"none\",this.svgElement.style.height=\"100%\",this.svgElement.style.width=\"100%\",this.svgElement.style.position=\"absolute\",t.insertAdjacentElement(\"afterbegin\",this.svgElement),this.rectElement=document.createElementNS(\"http://www.w3.org/2000/svg\",\"rect\"),this.rectElement.style.stroke=n.select.stroke,this.rectElement.style.strokeDasharray=n.select.strokeDashArray,this.rectElement.style.strokeWidth=\"\"+n.select.strokeWidth,this.rectElement.style.fill=n.select.fill,this.rectElement.style.fillOpacity=\"\"+n.select.fillOpacity,this.svgElement.appendChild(this.rectElement),this.selectionCallback=e,this.isMouseDown=!1}return t.prototype.onMouseDown=function(t,e){this.isMouseDown=!0,this.rectElement.style.display=\"block\",this.svgElement.style.display=\"block\",this.startCoordinates=[t,e],this.lastBoundingBox={x:this.startCoordinates[0],y:this.startCoordinates[1],width:1,height:1}},t.prototype.onMouseMove=function(t,e){this.isMouseDown&&(this.lastBoundingBox.x=Math.min(t,this.startCoordinates[0]),this.lastBoundingBox.y=Math.max(e,this.startCoordinates[1]),this.lastBoundingBox.width=Math.max(t,this.startCoordinates[0])-this.lastBoundingBox.x,this.lastBoundingBox.height=this.lastBoundingBox.y-Math.min(e,this.startCoordinates[1]),this.rectElement.setAttribute(\"x\",\"\"+this.lastBoundingBox.x),this.rectElement.setAttribute(\"y\",\"\"+(this.lastBoundingBox.y-this.lastBoundingBox.height)),this.rectElement.setAttribute(\"width\",\"\"+this.lastBoundingBox.width),this.rectElement.setAttribute(\"height\",\"\"+this.lastBoundingBox.height))},t.prototype.onMouseUp=function(){this.isMouseDown=!1,this.svgElement.style.display=\"none\",this.rectElement.style.display=\"none\",this.rectElement.setAttribute(\"width\",\"0\"),this.rectElement.setAttribute(\"height\",\"0\"),this.selectionCallback(this.lastBoundingBox)},t}();e.ScatterPlotRectangleSelector=i},function(t,e,n){\"use strict\";var i=this&&this.__read||function(t,e){var n=\"function\"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a};Object.defineProperty(e,\"__esModule\",{value:!0});var r=n(6),o=new Map,a=/^(rgba|hsla)\\((\\d+),\\s*(\\d+%?),\\s*(\\d+%?)(?:,\\s*(\\d+(?:\\.\\d+)?))?\\)$/;e.parseColor=function(t){if(o.has(t))return o.get(t);var e=function(t){var e=a.exec(t);if(e){var n=i(e,6),r=(n[0],n[1]),o=n[2],s=n[3],c=n[4],l=n[5];return{colorString:r.replace(\"a\",\"\")+\"(\"+o+\",\"+s+\",\"+c+\")\",opacity:parseFloat(l)}}return{colorString:t,opacity:1}}(t),n=e.colorString,s=e.opacity,c=new r.Color(n),l={r:c.r,g:c.g,b:c.b,opacity:s};return o.set(t,l),l}},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});e.makeStyles=function(t){var e={backgroundColor:\"#ffffff\",axesVisible:!0,fog:{color:\"#ffffff\",enabled:!0,threshold:5e3},label:{fontSize:10,scaleDefault:1,scaleLarge:2,fillColorSelected:\"#000000\",fillColorHover:\"#000000\",strokeColorSelected:\"#ffffff\",strokeColorHover:\"#ffffff\",strokeWidth:3,fillWidth:6},label3D:{fontSize:80,scale:2.2,color:\"black\",backgroundColor:\"#ffffff\",colorUnselected:\"#ffffff\",colorNoSelection:\"#ffffff\"},point:{colorUnselected:\"rgba(227, 227, 227, 0.7)\",colorNoSelection:\"rgba(117, 117, 217, 0.7)\",colorSelected:\"rgba(250, 102, 102, 0.7)\",colorHover:\"rgba(118, 11, 79, 0.7)\",scaleDefault:1,scaleSelected:1.2,scaleHover:1.2},polyline:{startHue:60,endHue:360,saturation:1,lightness:.3,defaultOpacity:.2,defaultLineWidth:2,selectedOpacity:.9,selectedLineWidth:3,deselectedOpacity:.05},select:{fill:\"#dddddd\",fillOpacity:.2,stroke:\"#aaaaaa\",strokeWidth:2,strokeDashArray:\"10 5\"},sprites:{minPointSize:5,imageSize:30,colorUnselected:\"#ffffff\",colorNoSelection:\"#ffffff\"}};if(void 0===t)return e;for(var n in e){var i=n;\"object\"==typeof e[i]&&\"object\"==typeof t[i]?e[i]=Object.assign(e[i],t[i]):void 0!==t[i]&&(e[i]=t[i])}return e}},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(6),r=n(45),o=n(59),a=function(t,e){return\"\\n      attribute vec2 posObj;\\n      attribute vec4 color;\\n      varying vec2 vUv;\\n      varying vec4 vColor;\\n\\n      void main() {\\n        vUv = uv;\\n        vColor = color;\\n\\n        // Rotate label to face camera.\\n\\n        vec4 vRight = vec4(\\n          modelViewMatrix[0][0], modelViewMatrix[1][0], modelViewMatrix[2][0], 0);\\n\\n        vec4 vUp = vec4(\\n          modelViewMatrix[0][1], modelViewMatrix[1][1], modelViewMatrix[2][1], 0);\\n\\n        vec4 vAt = -vec4(\\n          modelViewMatrix[0][2], modelViewMatrix[1][2], modelViewMatrix[2][2], 0);\\n\\n        mat4 pointToCamera = mat4(vRight, vUp, vAt, vec4(0, 0, 0, 1));\\n\\n        vec2 scaledPos = posObj * \"+1/t+\" * \"+e+\";\\n\\n        vec4 posRotated = pointToCamera * vec4(scaledPos, 0, 1);\\n        vec4 mvPosition = modelViewMatrix * (vec4(position, 0) + posRotated);\\n        gl_Position = projectionMatrix * mvPosition;\\n      }\"},s=function(){function t(t){this.styles=t,this.id=\"3D_LABELS\",this.labelStrings=[],this.worldSpacePointPositions=new Float32Array(0),this.pickingColors=new Float32Array(0),this.renderColors=new Float32Array(0),this.uniforms={},this.totalVertexCount=0,this.labelVertexMap=[]}return t.prototype.createGlyphTexture=function(){var t=this.styles.label3D,e=t.fontSize,n=t.backgroundColor,i=t.color,o=document.createElement(\"canvas\");o.width=8192,o.height=e;var a=o.getContext(\"2d\");a.font=\"bold \"+e+\"px roboto\",a.textBaseline=\"top\",a.fillStyle=n,a.rect(0,0,o.width,o.height),a.fill(),a.fillStyle=i;for(var s=a.measureText(\" \").width,c=new Float32Array(256),l=new Float32Array(256),d=0,u=0;u<256;u++){var h=\" \"+String.fromCharCode(u),p=a.measureText(h).width;c[u]=p-s,l[u]=d,a.fillText(h,d-s,0),d+=p}return{texture:r.createTextureFromCanvas(o),lengths:c,offsets:l}},t.prototype.processLabelVerts=function(t){var e=0;this.labelVertexMap=[];for(var n=0;n<t;n++){for(var i=this.labelStrings[n],r=[],o=0;o<i.length;o++){for(var a=0;a<6;a++)r.push(6*e+a);e++}this.labelVertexMap.push(r)}this.totalVertexCount=6*e},t.prototype.createColorBuffers=function(t){var e=this;this.pickingColors=new Float32Array(this.totalVertexCount*o.RGB_NUM_ELEMENTS),this.renderColors=new Float32Array(this.totalVertexCount*o.RGB_NUM_ELEMENTS);for(var n=function(t){var n=new i.Color(t);r.labelVertexMap[t].forEach((function(t){e.pickingColors[o.RGB_NUM_ELEMENTS*t]=n.r,e.pickingColors[o.RGB_NUM_ELEMENTS*t+1]=n.g,e.pickingColors[o.RGB_NUM_ELEMENTS*t+2]=n.b,e.renderColors[o.RGB_NUM_ELEMENTS*t]=1,e.renderColors[o.RGB_NUM_ELEMENTS*t+1]=1,e.renderColors[o.RGB_NUM_ELEMENTS*t+2]=1}))},r=this,a=0;a<t;a++)n(a)},t.prototype.createLabels=function(){var t=this,e=this.styles.label3D,n=e.fontSize,s=e.scale;if(null!=this.labelStrings&&null!=this.worldSpacePointPositions){var c=this.worldSpacePointPositions.length/o.XYZ_NUM_ELEMENTS;if(c===this.labelStrings.length){this.glyphTexture=this.createGlyphTexture(),this.uniforms={glyphTexture:{value:null},picking:{value:!1}},this.material=new i.ShaderMaterial({uniforms:this.uniforms,transparent:!0,vertexShader:a(n,s),fragmentShader:\"\\n      uniform sampler2D glyphTexture;\\n      uniform bool picking;\\n      varying vec2 vUv;\\n      varying vec4 vColor;\\n\\n      void main() {\\n        if (picking) {\\n          gl_FragColor = vColor;\\n        } else {\\n          vec4 fromTexture = texture(glyphTexture, vUv);\\n          gl_FragColor = vColor * fromTexture;\\n        }\\n      }\"}),this.processLabelVerts(c),this.createColorBuffers(c);var l=new Float32Array(this.totalVertexCount*o.XYZ_NUM_ELEMENTS);this.positions=new i.BufferAttribute(l,o.XYZ_NUM_ELEMENTS);var d=new Float32Array(this.totalVertexCount*o.XYZ_NUM_ELEMENTS),u=new Float32Array(this.totalVertexCount*o.UV_NUM_ELEMENTS),h=new Float32Array(this.totalVertexCount*o.RGB_NUM_ELEMENTS),p=new i.BufferAttribute(d,2),f=new i.BufferAttribute(u,o.UV_NUM_ELEMENTS),m=new i.BufferAttribute(h,o.RGB_NUM_ELEMENTS);this.geometry=new i.BufferGeometry,this.geometry.setAttribute(\"posObj\",p),this.geometry.setAttribute(\"position\",this.positions),this.geometry.setAttribute(\"uv\",f),this.geometry.setAttribute(\"color\",m);for(var g=0,v=0;v<c;v++){for(var y=this.labelStrings[v],b=0,_=0;_<y.length;_++){var x=y.charCodeAt(_);b+=this.glyphTexture.lengths[x]}b/=-2;for(_=0;_<y.length;_++){x=y.charCodeAt(_);var w=this.glyphTexture.lengths[x],S=(b+w)/n,M=b/n,E=n/n;p.setXY(6*g+0,M,0),p.setXY(6*g+1,S,0),p.setXY(6*g+2,M,E),p.setXY(6*g+3,M,E),p.setXY(6*g+4,S,0),p.setXY(6*g+5,S,E);var T=this.glyphTexture.offsets[x],C=this.glyphTexture.offsets[x]+w;T/=8192,C/=8192;f.setXY(6*g+0,T,1),f.setXY(6*g+1,C,1),f.setXY(6*g+2,T,0),f.setXY(6*g+3,T,0),f.setXY(6*g+4,C,1),f.setXY(6*g+5,C,0),g++,b+=w}}var A=function(e){var n=r.vector3FromPackedArray(O.worldSpacePointPositions,e);O.labelVertexMap[e].forEach((function(e){t.positions.setXYZ(e,n.x,n.y,n.z)}))},O=this;for(v=0;v<c;v++)A(v);this.labelsMesh=new i.Mesh(this.geometry,this.material),this.labelsMesh.frustumCulled=!1,this.scene.add(this.labelsMesh)}}},t.prototype.colorLabels=function(t){if(null!=this.labelStrings&&null!=this.geometry&&null!=t){var e=this.geometry.getAttribute(\"color\");e.array=this.renderColors;for(var n=t.length/o.RGBA_NUM_ELEMENTS,r=0,a=0;a<n;++a){for(var s=new i.Color(t[r],t[r+1],t[r+2]),c=this.labelVertexMap[a].length,l=0;l<c;++l)e.setXYZ(this.labelVertexMap[a][l],s.r,s.g,s.b);r+=o.RGBA_NUM_ELEMENTS}e.needsUpdate=!0}},t.prototype.setScene=function(t){this.scene=t},t.prototype.dispose=function(){this.labelsMesh&&(this.scene&&this.scene.remove(this.labelsMesh),this.labelsMesh=null),this.geometry&&(this.geometry.dispose(),this.geometry=null),null!=this.glyphTexture&&null!=this.glyphTexture.texture&&(this.glyphTexture.texture.dispose(),this.glyphTexture.texture=null)},t.prototype.onPickingRender=function(t){if(null!=this.geometry){this.material.uniforms.glyphTexture.value=this.glyphTexture.texture,this.material.uniforms.picking.value=!0;var e=this.geometry.getAttribute(\"color\");e.array=this.pickingColors,e.needsUpdate=!0}else this.createLabels()},t.prototype.onRender=function(t){if(null!=this.geometry){this.colorLabels(t.pointColors),this.material.uniforms.glyphTexture.value=this.glyphTexture.texture,this.material.uniforms.picking.value=!1;var e=this.geometry.getAttribute(\"color\");e.array=this.renderColors,e.needsUpdate=!0}else this.createLabels()},t.prototype.onPointPositionsChanged=function(t){this.worldSpacePointPositions=t,this.dispose()},t.prototype.setLabelStrings=function(t){this.labelStrings=t,this.dispose()},t.prototype.onResize=function(t,e){},t}();e.ScatterPlotVisualizer3DLabels=s},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(6),r=n(58),o=n(45),a=n(59),s=function(t){return\"\\n    // Index of the specific vertex (passed in as bufferAttribute), and the\\n    // variable that will be used to pass it to the fragment shader.\\n    attribute float spriteIndex;\\n    attribute vec4 color;\\n    attribute float scaleFactor;\\n\\n    varying vec2 xyIndex;\\n    varying vec4 vColor;\\n\\n    uniform bool sizeAttenuation;\\n    uniform float pointSize;\\n    uniform float spritesPerRow;\\n    uniform float spritesPerColumn;\\n\\n    varying float fogDepth;\\n\\n    void main() {\\n      // Pass index and color values to fragment shader.\\n      vColor = color;\\n      xyIndex = vec2(mod(spriteIndex, spritesPerRow),\\n                floor(spriteIndex / spritesPerColumn));\\n\\n      // Transform current vertex by modelViewMatrix (model world position and\\n      // camera world position matrix).\\n      vec4 cameraSpacePos = modelViewMatrix * vec4(position, 1.0);\\n\\n      // Project vertex in camera-space to screen coordinates using the camera's\\n      // projection matrix.\\n      gl_Position = projectionMatrix * cameraSpacePos;\\n\\n      // Create size attenuation (if we're in 3D mode) by making the size of\\n      // each point inversly proportional to its distance to the camera.\\n      float outputPointSize = pointSize;\\n      if (sizeAttenuation) {\\n        outputPointSize = -pointSize / cameraSpacePos.z;\\n        fogDepth = pointSize / outputPointSize * 1.2;\\n      } else {  // Create size attenuation (if we're in 2D mode)\\n        const float PI = 3.1415926535897932384626433832795;\\n        const float minScale = 0.1;  // minimum scaling factor\\n        const float outSpeed = 2.0;  // shrink speed when zooming out\\n        const float outNorm = (1. - minScale) / atan(outSpeed);\\n        const float maxScale = 15.0;  // maximum scaling factor\\n        const float inSpeed = 0.02;  // enlarge speed when zooming in\\n        const float zoomOffset = 0.3;  // offset zoom pivot\\n        float zoom = projectionMatrix[0][0] + zoomOffset;  // zoom pivot\\n        float scale = zoom < 1. ? 1. + outNorm * atan(outSpeed * (zoom - 1.)) :\\n                      1. + 2. / PI * (maxScale - 1.) * atan(inSpeed * (zoom - 1.));\\n        outputPointSize = pointSize * scale;\\n      }\\n\\n      gl_PointSize =\\n        max(outputPointSize * scaleFactor, \"+t.toFixed(1)+\");\\n    }\"},c=\"\\n    bool point_in_unit_circle(vec2 spriteCoord) {\\n      vec2 centerToP = spriteCoord - vec2(0.5, 0.5);\\n      return dot(centerToP, centerToP) < (0.5 * 0.5);\\n    }\\n\\n    bool point_in_unit_equilateral_triangle(vec2 spriteCoord) {\\n      vec3 v0 = vec3(0, 1, 0);\\n      vec3 v1 = vec3(0.5, 0, 0);\\n      vec3 v2 = vec3(1, 1, 0);\\n      vec3 p = vec3(spriteCoord, 0);\\n      float p_in_v0_v1 = cross(v1 - v0, p - v0).z;\\n      float p_in_v1_v2 = cross(v2 - v1, p - v1).z;\\n      return (p_in_v0_v1 > 0.0) && (p_in_v1_v2 > 0.0);\\n    }\\n\\n    bool point_in_unit_square(vec2 spriteCoord) {\\n      return true;\\n    }\\n  \",l=\"\\n    varying vec2 xyIndex;\\n    varying vec4 vColor;\\n\\n    uniform sampler2D spriteTexture;\\n    uniform float spritesPerRow;\\n    uniform float spritesPerColumn;\\n    uniform bool isImage;\\n\\n    \"+i.ShaderChunk.common+\"\\n    \"+c+\"\\n    uniform vec3 fogColor;\\n    varying float fogDepth;\\n\\t\\tuniform float fogNear;\\n    uniform float fogFar;\\n\\n    void main() {\\n      if (isImage) {\\n        // Coordinates of the vertex within the entire sprite image.\\n        vec2 coords =\\n          (gl_PointCoord + xyIndex) / vec2(spritesPerRow, spritesPerColumn);\\n        gl_FragColor = vColor * texture(spriteTexture, coords);\\n      } else {\\n        bool inside = point_in_unit_circle(gl_PointCoord);\\n        if (!inside) {\\n          discard;\\n        }\\n        gl_FragColor = vColor;\\n      }\\n      float fogFactor = smoothstep( fogNear, fogFar, fogDepth );\\n      gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\\n    }\",d=function(){function t(t,e){this.styles=t,this.id=\"SPRITES\",this.isSpriteSheetMode=!1,this.spritesPerRow=0,this.spritesPerColumn=0,this.spriteDimensions=[0,0],this.worldSpacePointPositions=new Float32Array(0),this.pickingColors=new Float32Array(0),this.renderColors=new Float32Array(0),this.standinTextureForPoints=o.createTextureFromCanvas(document.createElement(\"canvas\")),e&&(this.spriteSheetParams=e,this.setSpriteSheet(e),this.isSpriteSheetMode=!0),this.renderMaterial=this.createRenderMaterial(),this.pickingMaterial=this.createPickingMaterial()}return t.prototype.createUniforms=function(){return{spriteTexture:{type:\"t\"},spritesPerRow:{type:\"f\"},spritesPerColumn:{type:\"f\"},fogColor:{type:\"c\"},fogNear:{type:\"f\"},fogFar:{type:\"f\"},isImage:{type:\"bool\"},sizeAttenuation:{type:\"bool\"},pointSize:{type:\"f\"}}},t.prototype.createRenderMaterial=function(){this.isSpriteSheetMode;var t=this.createUniforms();return new i.ShaderMaterial({uniforms:t,vertexShader:s(this.styles.sprites.minPointSize),fragmentShader:l,transparent:!0,depthFunc:i.LessDepth,fog:this.styles.fog.enabled,blending:i.NormalBlending})},t.prototype.createPickingMaterial=function(){var t=this.createUniforms();return new i.ShaderMaterial({uniforms:t,vertexShader:s(this.styles.sprites.minPointSize),fragmentShader:\"\\n    varying vec2 xyIndex;\\n    varying vec4 vColor;\\n    uniform bool isImage;\\n\\n    \\n    bool point_in_unit_circle(vec2 spriteCoord) {\\n      vec2 centerToP = spriteCoord - vec2(0.5, 0.5);\\n      return dot(centerToP, centerToP) < (0.5 * 0.5);\\n    }\\n\\n    bool point_in_unit_equilateral_triangle(vec2 spriteCoord) {\\n      vec3 v0 = vec3(0, 1, 0);\\n      vec3 v1 = vec3(0.5, 0, 0);\\n      vec3 v2 = vec3(1, 1, 0);\\n      vec3 p = vec3(spriteCoord, 0);\\n      float p_in_v0_v1 = cross(v1 - v0, p - v0).z;\\n      float p_in_v1_v2 = cross(v2 - v1, p - v1).z;\\n      return (p_in_v0_v1 > 0.0) && (p_in_v1_v2 > 0.0);\\n    }\\n\\n    bool point_in_unit_square(vec2 spriteCoord) {\\n      return true;\\n    }\\n  \\n\\n    varying float fogDepth;\\n\\n    void main() {\\n      xyIndex; // Silence 'unused variable' warning.\\n      fogDepth; // Silence 'unused variable' warning.\\n      if (isImage) {\\n        gl_FragColor = vColor;\\n      } else {\\n        bool inside = point_in_unit_circle(gl_PointCoord);\\n        if (!inside) {\\n          discard;\\n        }\\n        gl_FragColor = vColor;\\n      }\\n    }\",transparent:!0,depthTest:!0,depthWrite:!0,fog:!1,blending:i.NormalBlending})},t.prototype.createPointSprites=function(t,e){var n=null!=e?e.length/a.XYZ_NUM_ELEMENTS:0,r=this.createGeometry(n);this.fog=new i.Fog(16777215),this.points=new i.Points(r,this.renderMaterial),this.points.frustumCulled=!1,null!=this.spriteIndexBufferAttribute&&this.points.geometry.setAttribute(\"spriteIndex\",this.spriteIndexBufferAttribute),t.add(this.points)},t.prototype.calculatePointSize=function(t){var e=this.styles.sprites.imageSize;if(this.texture)return t?e:this.spriteDimensions[0];var n=null!=this.worldSpacePointPositions?this.worldSpacePointPositions.length/a.XYZ_NUM_ELEMENTS:1,i=200/Math.log(n)/Math.log(8);return t?i:i/1.5},t.prototype.createGeometry=function(t){var e=t;this.pickingColors=new Float32Array(e*a.RGBA_NUM_ELEMENTS);for(var n=0,r=0;r<e;r++){var o=new i.Color(r);this.pickingColors[n++]=o.r,this.pickingColors[n++]=o.g,this.pickingColors[n++]=o.b,this.pickingColors[n++]=1}var s=new i.BufferGeometry;return s.setAttribute(\"position\",new i.BufferAttribute(new Float32Array([]),a.XYZ_NUM_ELEMENTS)),s.setAttribute(\"color\",new i.BufferAttribute(new Float32Array([]),a.RGBA_NUM_ELEMENTS)),s.setAttribute(\"scaleFactor\",new i.BufferAttribute(new Float32Array([]),a.INDEX_NUM_ELEMENTS)),s.computeVertexNormals(),s},t.prototype.setFogDistances=function(t,e,n){var i=this.styles.fog,r=i.threshold,o=i.enabled;if(t&&o){this.fog.near=e;var a=e-n;this.fog.far=e-r*a}else this.fog.near=1/0,this.fog.far=1/0},t.prototype.dispose=function(){this.disposeGeometry(),this.disposeSpriteSheet()},t.prototype.disposeGeometry=function(){null!=this.points&&(this.scene.remove(this.points),this.points.geometry.dispose(),this.points=null,this.worldSpacePointPositions=null)},t.prototype.disposeSpriteSheet=function(){this.texture&&this.texture.dispose(),this.texture=null,this.renderMaterial=null,this.pickingMaterial=null,this.spriteSheetImage=null},t.prototype.setScene=function(t){this.scene=t},t.prototype.setSpriteSheet=function(t){var e=this,n=t.spriteDimensions,i=t.onImageLoad,r=t.spritesheetImage;if(\"string\"==typeof r){var a=r;(r=new Image).src=a}this.spriteSheetImage=r,this.texture=o.createTextureFromImage(this.spriteSheetImage,(function(){e.spritesPerRow=e.spriteSheetImage.width/n[0],e.spritesPerColumn=e.spriteSheetImage.height/n[1],i()})),this.spriteDimensions=n,this.setSpriteIndexBuffer()},t.prototype.setSpriteIndexBuffer=function(){var t=this.spriteSheetParams.spriteIndices;this.spriteIndexBufferAttribute=new i.BufferAttribute(t,a.INDEX_NUM_ELEMENTS),null!=this.points&&this.points.geometry.setAttribute(\"spriteIndex\",this.spriteIndexBufferAttribute)},t.prototype.onPointPositionsChanged=function(t){null!=this.points&&this.worldSpacePointPositions.length!==t.length&&this.disposeGeometry(),this.worldSpacePointPositions=t,null==this.points&&this.createPointSprites(this.scene,t),this.spriteSheetParams&&this.setSpriteIndexBuffer(),this.renderMaterial=this.createRenderMaterial(),this.pickingMaterial=this.createPickingMaterial();var e=this.points.geometry.getAttribute(\"position\");e.array=t,e.count=t.length/a.XYZ_NUM_ELEMENTS,e.needsUpdate=!0},t.prototype.onPickingRender=function(t){var e=t.cameraType===r.CameraType.Perspective;this.pickingMaterial.uniforms.spritesPerRow.value=this.spritesPerRow,this.pickingMaterial.uniforms.spritesPerRow.value=this.spritesPerColumn,this.pickingMaterial.uniforms.sizeAttenuation.value=e,this.pickingMaterial.uniforms.pointSize.value=this.calculatePointSize(e),this.points.material=this.pickingMaterial;var n=this.points.geometry.getAttribute(\"color\");n.array=this.pickingColors,n.count=this.pickingColors.length/a.RGBA_NUM_ELEMENTS,n.needsUpdate=!0;var i=this.points.geometry.getAttribute(\"scaleFactor\");i.array=t.pointScaleFactors,i.count=t.pointScaleFactors.length,i.count=t.pointScaleFactors.length/a.INDEX_NUM_ELEMENTS,i.needsUpdate=!0},t.prototype.onRender=function(t){var e=t.camera instanceof i.PerspectiveCamera;this.setFogDistances(e,t.nearestCameraSpacePointZ,t.farthestCameraSpacePointZ),this.scene.fog=this.fog,this.scene.fog.color=new i.Color(t.backgroundColor),this.renderMaterial.uniforms.fogColor.value=this.scene.fog.color,this.renderMaterial.uniforms.fogNear.value=this.fog.near,this.renderMaterial.uniforms.fogFar.value=this.fog.far,this.renderMaterial.uniforms.spritesPerRow.value=this.spritesPerRow,this.renderMaterial.uniforms.spritesPerColumn.value=this.spritesPerColumn,this.renderMaterial.uniforms.isImage.value=null!=this.texture,this.renderMaterial.uniforms.spriteTexture.value=null!=this.texture?this.texture:this.standinTextureForPoints,this.renderMaterial.uniforms.sizeAttenuation.value=e,this.renderMaterial.uniforms.pointSize.value=this.calculatePointSize(e),this.points.material=this.renderMaterial;var n=this.points.geometry.getAttribute(\"color\");this.renderColors=t.pointColors,n.array=this.renderColors,n.count=this.renderColors.length/a.RGBA_NUM_ELEMENTS,n.needsUpdate=!0;var r=this.points.geometry.getAttribute(\"scaleFactor\");r.array=t.pointScaleFactors,r.count=t.pointScaleFactors.length/a.INDEX_NUM_ELEMENTS,r.needsUpdate=!0},t.prototype.onResize=function(t,e){},t}();e.ScatterPlotVisualizerSprites=d},function(t,e,n){\"use strict\";var i=this&&this.__read||function(t,e){var n=\"function\"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a};Object.defineProperty(e,\"__esModule\",{value:!0});var r=n(6),o=n(58),a=n(132),s=n(45),c=function(){function t(t,e){this.styles=e,this.id=\"CANVAS_LABELS\",this.worldSpacePointPositions=new Float32Array(0),this.labelsActive=!0,this.canvas=document.createElement(\"canvas\"),t.appendChild(this.canvas),this.gc=this.canvas.getContext(\"2d\"),this.canvas.style.position=\"absolute\",this.canvas.style.left=\"0\",this.canvas.style.top=\"0\",this.canvas.style.pointerEvents=\"none\"}return t.prototype.removeAllLabels=function(){var t=this.canvas.width*window.devicePixelRatio,e=this.canvas.height*window.devicePixelRatio;this.gc.clearRect(0,0,t,e)},t.prototype.makeLabels=function(t){if(null!=t.labels&&0!==t.labels.pointIndices.length&&null!=this.worldSpacePointPositions){var e,n=t.labels,c=t.cameraType===o.CameraType.Perspective,l=parseInt(this.gc.font,10),d=window.devicePixelRatio,u=this.canvas.width*d,h=this.canvas.height*d,p={loX:0,hiX:u,loY:0,hiY:h};e=new a.CollisionGrid(p,u/25,h/50);var f=[t.farthestCameraSpacePointZ,t.nearestCameraSpacePointZ],m=function(t){return s.scaleExponential(t,f,[.1,1])},g=t.camera.position,v=g.clone().sub(t.cameraTarget),y=new r.Vector3;this.gc.textBaseline=\"middle\",this.gc.miterLimit=2;for(var b=Math.min(1e4,n.pointIndices.length),_=0;_<b;++_){var x,w=n.pointIndices[_];if(x=s.vector3FromPackedArray(this.worldSpacePointPositions,w),y.copy(g).sub(x),!(v.dot(y)<0)){var S=i(s.vector3DToScreenCoords(t.camera,t.screenWidth,t.screenHeight,x),2),M=S[0],E=S[1],T={loX:(M+=4)-2,hiX:M+1+2,loY:E-l/2-2,hiY:E+l/2+2};if(e.insert(T,!0)){var C=n.labelStrings[_],A=n.defaultFontSize*n.scaleFactors[_]*d;if(this.gc.font=A+\"px roboto\",T.hiX+=this.gc.measureText(C).width-1,e.insert(T)){var O=1;c&&1===n.useSceneOpacityFlags[_]&&(O=m(y.length())),this.gc.fillStyle=this.styleStringFromPackedRgba(n.fillColors,_,O),this.gc.strokeStyle=this.styleStringFromPackedRgba(n.strokeColors,_,O),this.gc.lineWidth=this.styles.label.strokeWidth,this.gc.strokeText(C,M,E),this.gc.lineWidth=this.styles.label.fillWidth,this.gc.fillText(C,M,E)}}}}}},t.prototype.styleStringFromPackedRgba=function(t,e,n){var i=3*e;return\"rgba(\"+t[i]+\",\"+t[i+1]+\",\"+t[i+2]+\",\"+n+\")\"},t.prototype.onResize=function(t,e){var n=window.devicePixelRatio;this.canvas.width=t*n,this.canvas.height=e*n,this.canvas.style.width=t+\"px\",this.canvas.style.height=e+\"px\"},t.prototype.dispose=function(){this.removeAllLabels()},t.prototype.onPointPositionsChanged=function(t){this.worldSpacePointPositions=t,this.removeAllLabels()},t.prototype.onRender=function(t){this.labelsActive&&(this.removeAllLabels(),this.makeLabels(t))},t.prototype.setScene=function(t){},t.prototype.onPickingRender=function(t){},t}();e.ScatterPlotVisualizerCanvasLabels=c},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=function(){function t(t,e,n){this.bound=t,this.cellWidth=e,this.cellHeight=n,this.numHorizCells=Math.ceil(this.boundWidth(t)/e),this.numVertCells=Math.ceil(this.boundHeight(t)/n),this.grid=new Array(this.numHorizCells*this.numVertCells)}return t.prototype.boundWidth=function(t){return t.hiX-t.loX},t.prototype.boundHeight=function(t){return t.hiY-t.loY},t.prototype.boundsIntersect=function(t,e){return!(t.loX>e.hiX||t.loY>e.hiY||t.hiX<e.loX||t.hiY<e.loY)},t.prototype.insert=function(t,e){if(void 0===e&&(e=!1),t.hiX<this.bound.loX||t.loX>this.bound.hiX||t.hiY<this.bound.loY||t.loY>this.bound.hiY)return!1;for(var n=this.getCellX(t.loX),i=this.getCellX(t.hiX),r=this.getCellY(t.loY),o=this.getCellY(t.hiY),a=r*this.numHorizCells+n,s=a,c=r;c<=o;c++){for(var l=n;l<=i;l++){var d=this.grid[s++];if(d)for(var u=0;u<d.length;u++)if(this.boundsIntersect(t,d[u]))return!1}s+=this.numHorizCells-(i-n+1)}if(e)return!0;s=a;for(c=r;c<=o;c++){for(l=n;l<=i;l++)this.grid[s]?this.grid[s].push(t):this.grid[s]=[t],s++;s+=this.numHorizCells-(i-n+1)}return!0},t.prototype.getCellX=function(t){return Math.floor((t-this.bound.loX)/this.cellWidth)},t.prototype.getCellY=function(t){return Math.floor((t-this.bound.loY)/this.cellHeight)},t}();e.CollisionGrid=i},function(t,e,n){\"use strict\";var i=this&&this.__values||function(t){var e=\"function\"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&\"number\"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")};Object.defineProperty(e,\"__esModule\",{value:!0});var r=n(6),o=n(45),a=n(59),s=function(){function t(){this.id=\"POLYLINES\",this.sequences=[],this.polylines=[],this.polylinePositionBuffer={},this.polylineColorBuffer={},this.pointSequenceIndices=new Map}return t.prototype.getPointSequenceIndex=function(t){return this.pointSequenceIndices.get(t)},t.prototype.updateSequenceIndices=function(){for(var t=0;t<this.sequences.length;t++)for(var e=this.sequences[t],n=0;n<e.indices.length-1;n++){var i=e.indices[n];this.pointSequenceIndices.set(i,t),this.pointSequenceIndices.set(i+1,t)}},t.prototype.createPolylines=function(){var t,e;this.updateSequenceIndices();try{for(var n=i(this.polylines),o=n.next();!o.done;o=n.next()){var a=o.value;this.scene.remove(a),a.geometry.dispose()}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.polylines=[];for(var s=0;s<this.sequences.length;s++){var c=new r.BufferGeometry;c.addAttribute(\"position\",this.polylinePositionBuffer[s]),c.addAttribute(\"color\",this.polylineColorBuffer[s]);var l=new r.LineBasicMaterial({linewidth:1,opacity:1,transparent:!0,vertexColors:!0});(a=new r.LineSegments(c,l)).frustumCulled=!1,this.polylines.push(a),this.scene.add(a)}},t.prototype.dispose=function(){var t,e;try{for(var n=i(this.polylines),r=n.next();!r.done;r=n.next()){var o=r.value;this.scene.remove(o),o.geometry.dispose()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.polylines=[],this.polylinePositionBuffer={},this.polylineColorBuffer={}},t.prototype.setScene=function(t){this.scene=t},t.prototype.setSequences=function(t){this.sequences=t},t.prototype.onPointPositionsChanged=function(t){if(null==t&&this.dispose(),null!=t&&0!==this.sequences.length){for(var e=0;e<this.sequences.length;e++){var n=2*((c=this.sequences[e]).indices.length-1),i=new Float32Array(n*a.XYZ_NUM_ELEMENTS);this.polylinePositionBuffer[e]=new r.BufferAttribute(i,a.XYZ_NUM_ELEMENTS);var s=new Float32Array(n*a.RGBA_NUM_ELEMENTS);this.polylineColorBuffer[e]=new r.BufferAttribute(s,a.RGBA_NUM_ELEMENTS)}for(e=0;e<this.sequences.length;e++){for(var c=this.sequences[e],l=0,d=0;d<c.indices.length-1;d++){var u=c.indices[d],h=c.indices[d+1],p=o.vector3FromPackedArray(t,u),f=o.vector3FromPackedArray(t,h);this.polylinePositionBuffer[e].setXYZ(l,p.x,p.y,p.z),this.polylinePositionBuffer[e].setXYZ(l+1,f.x,f.y,f.z),l+=2}this.polylinePositionBuffer[e].needsUpdate=!0}this.createPolylines()}},t.prototype.onRender=function(t){for(var e=0;e<this.polylines.length;e++){var n=this.polylines[e].material;n.opacity=t.polylineOpacities[e],n.linewidth=t.polylineWidths[e],this.polylineColorBuffer[e].array=t.polylineColors[e],this.polylineColorBuffer[e].needsUpdate=!0}},t.prototype.onPickingRender=function(t){},t.prototype.onResize=function(t,e){},t}();e.ScatterPlotVisualizerPolylines=s},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.BatchRequestCache=void 0;const i=n(1);e.BatchRequestCache=class{constructor(t,e){this.requestFn=t,this.keyFn=e,this.resultCache=new Map}call(t){return i.__awaiter(this,void 0,void 0,(function*(){const e=t.map(t=>this.resultCache.get(this.keyFn(t))),n=[];for(let t=0;t<e.length;++t)void 0===e[t]&&n.push(t);if(0===n.length)return e;const i=n.map(e=>t[e]),r=yield this.requestFn(i);return null===r?null:(n.forEach((n,i)=>{const o=this.keyFn(t[n]),a=r[i];this.resultCache.set(o,a),e[n]=a}),e)}))}}},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`#scatter-gl-container {\n  height: 100%;\n  user-select: none;\n}\n\n#scatter-gl-container>canvas {\n  outline: none;\n}\n\n.toolbar-container {\n  padding: 2pt 0;\n  justify-content: space-between;\n  position: absolute\n}\n\n.flex-row {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n}\n\n.container {\n  position: relative;\n  height: 100%;\n  overflow: hidden;\n}\n\n.selected-nearest-button {\n  margin-top: 10px;\n}\n\n.selected-nearest-button:disabled {\n  pointer-events: auto;\n}\n\n#select-button-container {\n  bottom: 4px;\n  right: 4px;\n}\n`},function(t,e,n){\"use strict\";var i;Object.defineProperty(e,\"__esModule\",{value:!0}),e.GeneratedImageModule=void 0;const r=n(1),o=n(2),a=n(3),s=n(4),c=n(12),l=n(7);n(5);const d=n(8);let u=i=class extends c.LitModule{constructor(){super(...arguments),this.generatedImages={}}static get styles(){const t=a.css`\n      .field-group {\n        padding: 4px;\n      }\n    `;return[l.styles,t]}firstUpdated(){this.reactImmediately(()=>this.selectionService.primarySelectedInputData,t=>{this.updateSelection(t)})}updateSelection(t){return r.__awaiter(this,void 0,void 0,(function*(){if(this.generatedImages={},null==t)return;const e=this.appState.currentDataset,n=this.apiService.getPreds([t],this.model,e,i.supportedTypes,\"Generating images\"),r=yield this.loadLatest(\"generatedImages\",n);null!==r&&(this.generatedImages=r[0])}))}renderOutputGroup(t){return a.html`\n      <div class='field-group'>\n        <div class=\"field-title\">${t}</div>\n        <img src=${this.generatedImages[t]}>\n      </div>\n    `}render(){return a.html`\n      <div class='module-container'>\n        <div class=\"module-results-area\">\n          ${Object.keys(this.generatedImages).map(t=>this.renderOutputGroup(t))}\n        </div>\n      </div>\n    `}static shouldDisplayModule(t,e){return(0,d.doesOutputSpecContain)(t,i.supportedTypes)}};u.title=\"Generated Images\",u.duplicateForExampleComparison=!0,u.duplicateAsRow=!0,u.template=(t=\"\",e=0)=>a.html`\n      <generated-image-module model=${t}\n        selectionServiceIndex=${e}>\n      </generated-image-module>`,u.supportedTypes=[\"ImageBytes\"],r.__decorate([s.observable,r.__metadata(\"design:type\",Object)],u.prototype,\"generatedImages\",void 0),u=i=r.__decorate([(0,o.customElement)(\"generated-image-module\")],u),e.GeneratedImageModule=u},function(t,e,n){t.exports=n(138)},function(t,e,n){(function(){var t,i,r,o,a,s,c,l,d,u,h,p,f,m,g,v,y,b,_,x,w,S=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1};l=Math.floor,u=Math.max,h=Math.min,i=n(139),s=n(141),y=function(t,e){return e?2*t/e:1},v=function(t,e){var n,i,r,o,a,s;for(a=[t.length,e.length],n=o=0,s=h(i=a[0],r=a[1]);0<=s?o<s:o>s;n=0<=s?++o:--o){if(t[n]<e[n])return-1;if(t[n]>e[n])return 1}return i-r},w=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},g=function(t){var e,n;for(e=0,n=t.length;e<n;e++)if(t[e])return!0;return!1},a=function(){function t(t,e,n,i){this.isjunk=t,null==e&&(e=\"\"),null==n&&(n=\"\"),this.autojunk=null==i||i,this.a=this.b=null,this.setSeqs(e,n)}return t.name=\"SequenceMatcher\",t.prototype.setSeqs=function(t,e){return this.setSeq1(t),this.setSeq2(e)},t.prototype.setSeq1=function(t){if(t!==this.a)return this.a=t,this.matchingBlocks=this.opcodes=null},t.prototype.setSeq2=function(t){if(t!==this.b)return this.b=t,this.matchingBlocks=this.opcodes=null,this.fullbcount=null,this._chainB()},t.prototype._chainB=function(){var t,e,n,i,r,o,a,s,c,d,u,h,p,f;for(t=this.b,this.b2j=e={},i=d=0,h=t.length;d<h;i=++d)n=t[i],(w(e,n)?e[n]:e[n]=[]).push(i);if(o={},r=this.isjunk)for(u=0,p=(f=Object.keys(e)).length;u<p;u++)r(n=f[u])&&(o[n]=!0,delete e[n]);if(c={},a=t.length,this.autojunk&&a>=200)for(n in s=l(a/100)+1,e)e[n].length>s&&(c[n]=!0,delete e[n]);return this.isbjunk=function(t){return w(o,t)},this.isbpopular=function(t){return w(c,t)}},t.prototype.findLongestMatch=function(t,e,n,i){var r,o,a,s,c,l,d,u,h,p,f,m,g,v,y,b,_,x,S,M,E;for(r=(b=[this.a,this.b,this.b2j,this.isbjunk])[0],o=b[1],a=b[2],u=b[3],s=(_=[t,n,0])[0],c=_[1],l=_[2],p={},d=g=t;t<=e?g<e:g>e;d=t<=e?++g:--g){for(m={},v=0,y=(x=w(a,r[d])?a[r[d]]:[]).length;v<y;v++)if(!((h=x[v])<n)){if(h>=i)break;(f=m[h]=(p[h-1]||0)+1)>l&&(s=(S=[d-f+1,h-f+1,f])[0],c=S[1],l=S[2])}p=m}for(;s>t&&c>n&&!u(o[c-1])&&r[s-1]===o[c-1];)s=(M=[s-1,c-1,l+1])[0],c=M[1],l=M[2];for(;s+l<e&&c+l<i&&!u(o[c+l])&&r[s+l]===o[c+l];)l++;for(;s>t&&c>n&&u(o[c-1])&&r[s-1]===o[c-1];)s=(E=[s-1,c-1,l+1])[0],c=E[1],l=E[2];for(;s+l<e&&c+l<i&&u(o[c+l])&&r[s+l]===o[c+l];)l++;return[s,c,l]},t.prototype.getMatchingBlocks=function(){var t,e,n,i,r,o,a,s,c,l,d,u,h,p,f,m,g,y,b,_,x,w,S,M,E,T;if(this.matchingBlocks)return this.matchingBlocks;for(y=[[0,p=(w=[this.a.length,this.b.length])[0],0,f=w[1]]],m=[];y.length;)e=(S=y.pop())[0],t=S[1],i=S[2],n=S[3],r=(M=b=this.findLongestMatch(e,t,i,n))[0],s=M[1],(d=M[2])&&(m.push(b),e<r&&i<s&&y.push([e,r,i,s]),r+d<t&&s+d<n&&y.push([r+d,t,s+d,n]));for(m.sort(v),o=c=u=0,g=[],_=0,x=m.length;_<x;_++)a=(E=m[_])[0],l=E[1],h=E[2],o+u===a&&c+u===l?u+=h:(u&&g.push([o,c,u]),o=(T=[a,l,h])[0],c=T[1],u=T[2]);return u&&g.push([o,c,u]),g.push([p,f,0]),this.matchingBlocks=g},t.prototype.getOpcodes=function(){var t,e,n,i,r,o,a,s,c,l,d,u;if(this.opcodes)return this.opcodes;for(i=r=0,this.opcodes=e=[],s=0,c=(l=this.getMatchingBlocks()).length;s<c;s++)t=(d=l[s])[0],n=d[1],o=d[2],a=\"\",i<t&&r<n?a=\"replace\":i<t?a=\"delete\":r<n&&(a=\"insert\"),a&&e.push([a,i,t,r,n]),i=(u=[t+o,n+o])[0],r=u[1],o&&e.push([\"equal\",t,i,n,r]);return e},t.prototype.getGroupedOpcodes=function(t){var e,n,i,r,o,a,s,c,l,d,p,f,m,g,v;for(null==t&&(t=3),(e=this.getOpcodes()).length||(e=[[\"equal\",0,1,0,1]]),\"equal\"===e[0][0]&&(l=(f=e[0])[0],r=f[1],o=f[2],a=f[3],s=f[4],e[0]=[l,u(r,o-t),o,u(a,s-t),s]),\"equal\"===e[e.length-1][0]&&(l=(m=e[e.length-1])[0],r=m[1],o=m[2],a=m[3],s=m[4],e[e.length-1]=[l,r,h(o,r+t),a,h(s,a+t)]),c=t+t,i=[],n=[],d=0,p=e.length;d<p;d++)l=(g=e[d])[0],r=g[1],o=g[2],a=g[3],s=g[4],\"equal\"===l&&o-r>c&&(n.push([l,r,h(o,r+t),a,h(s,a+t)]),i.push(n),n=[],r=(v=[u(r,o-t),u(a,s-t)])[0],a=v[1]),n.push([l,r,o,a,s]);return!n.length||1===n.length&&\"equal\"===n[0][0]||i.push(n),i},t.prototype.ratio=function(){var t,e,n,i;for(t=0,e=0,n=(i=this.getMatchingBlocks()).length;e<n;e++)t+=i[e][2];return y(t,this.a.length+this.b.length)},t.prototype.quickRatio=function(){var t,e,n,i,r,o,a,s,c,l,d;if(!this.fullbcount)for(this.fullbcount=n={},o=0,s=(l=this.b).length;o<s;o++)n[e=l[o]]=(n[e]||0)+1;for(n=this.fullbcount,t={},i=0,a=0,c=(d=this.a).length;a<c;a++)e=d[a],r=w(t,e)?t[e]:n[e]||0,t[e]=r-1,r>0&&i++;return y(i,this.a.length+this.b.length)},t.prototype.realQuickRatio=function(){var t,e,n;return n=[this.a.length,this.b.length],y(h(t=n[0],e=n[1]),t+e)},t}(),d=function(t,e,n,r){var o,s,c,l,d,u,h,p,f;if(null==n&&(n=3),null==r&&(r=.6),!(n>0))throw new Error(\"n must be > 0: (\"+n+\")\");if(!(0<=r&&r<=1))throw new Error(\"cutoff must be in [0.0, 1.0]: (\"+r+\")\");for(o=[],(s=new a).setSeq2(t),l=0,u=e.length;l<u;l++)c=e[l],s.setSeq1(c),s.realQuickRatio()>=r&&s.quickRatio()>=r&&s.ratio()>=r&&o.push([s.ratio(),c]);for(f=[],d=0,h=(o=i.nlargest(o,n,v)).length;d<h;d++)(p=o[d])[0],c=p[1],f.push(c);return f},b=function(t,e){var n,i,r;for(n=(r=[0,t.length])[0],i=r[1];n<i&&t[n]===e;)n++;return n},t=function(){function t(t,e){this.linejunk=t,this.charjunk=e}return t.name=\"Differ\",t.prototype.compare=function(t,e){var n,i,r,o,s,c,l,d,u,h,p,f,m,g;for(l=[],u=0,p=(m=new a(this.linejunk,t,e).getOpcodes()).length;u<p;u++){switch(d=(g=m[u])[0],i=g[1],n=g[2],o=g[3],r=g[4],d){case\"replace\":s=this._fancyReplace(t,i,n,e,o,r);break;case\"delete\":s=this._dump(\"-\",t,i,n);break;case\"insert\":s=this._dump(\"+\",e,o,r);break;case\"equal\":s=this._dump(\" \",t,i,n);break;default:throw new Error(\"unknow tag (\"+d+\")\")}for(h=0,f=s.length;h<f;h++)c=s[h],l.push(c)}return l},t.prototype._dump=function(t,e,n,i){var r,o,a;for(a=[],r=o=n;n<=i?o<i:o>i;r=n<=i?++o:--o)a.push(t+\" \"+e[r]);return a},t.prototype._plainReplace=function(t,e,n,i,r,o){var a,c,l,d,u,h,p,f,m,g;for(s(e<n&&r<o),o-r<n-e?(a=this._dump(\"+\",i,r,o),u=this._dump(\"-\",t,e,n)):(a=this._dump(\"-\",t,e,n),u=this._dump(\"+\",i,r,o)),d=[],h=0,f=(g=[a,u]).length;h<f;h++)for(p=0,m=(c=g[h]).length;p<m;p++)l=c[p],d.push(l);return d},t.prototype._fancyReplace=function(t,e,n,i,r,o){var s,c,l,d,u,h,p,f,m,g,v,y,b,_,x,w,S,M,E,T,C,A,O,k,L,I,R,P,D,N,F,j,B,z,U,H,$,G,V,W,q,X,Y,K,Z,J,Q,tt;for(p=(H=[.74,.75])[0],_=H[1],b=new a(this.charjunk),x=($=[null,null])[0],w=$[1],A=[],M=k=r;r<=o?k<o:k>o;M=r<=o?++k:--k)for(g=i[M],b.setSeq2(g),S=L=e;e<=n?L<n:L>n;S=e<=n?++L:--L)(c=t[S])!==g?(b.setSeq1(c),b.realQuickRatio()>p&&b.quickRatio()>p&&b.ratio()>p&&(p=(X=[b.ratio(),S,M])[0],f=X[1],m=X[2])):null===x&&(x=(q=[S,M])[0],w=q[1]);if(p<_){if(null===x){for(I=0,P=(Y=this._plainReplace(t,e,n,i,r,o)).length;I<P;I++)C=Y[I],A.push(C);return A}f=(K=[x,w,1])[0],m=K[1],p=K[2]}else x=null;for(R=0,D=(Z=this._fancyHelper(t,e,f,i,r,m)).length;R<D;R++)C=Z[R],A.push(C);if(s=(J=[t[f],i[m]])[0],h=J[1],null===x){for(u=y=\"\",b.setSeqs(s,h),B=0,N=(Q=b.getOpcodes()).length;B<N;B++)switch(O=(tt=Q[B])[0],l=tt[1],d=tt[2],v=tt[3],E=(G=[d-l,tt[4]-v])[0],T=G[1],O){case\"replace\":u+=Array(E+1).join(\"^\"),y+=Array(T+1).join(\"^\");break;case\"delete\":u+=Array(E+1).join(\"-\");break;case\"insert\":y+=Array(T+1).join(\"+\");break;case\"equal\":u+=Array(E+1).join(\" \"),y+=Array(T+1).join(\" \");break;default:throw new Error(\"unknow tag (\"+O+\")\")}for(z=0,F=(V=this._qformat(s,h,u,y)).length;z<F;z++)C=V[z],A.push(C)}else A.push(\"  \"+s);for(U=0,j=(W=this._fancyHelper(t,f+1,n,i,m+1,o)).length;U<j;U++)C=W[U],A.push(C);return A},t.prototype._fancyHelper=function(t,e,n,i,r,o){var a;return a=[],e<n?a=r<o?this._fancyReplace(t,e,n,i,r,o):this._dump(\"-\",t,e,n):r<o&&(a=this._dump(\"+\",i,r,o)),a},t.prototype._qformat=function(t,e,n,i){var r,o;return o=[],r=h(b(t,\"\\t\"),b(e,\"\\t\")),r=h(r,b(n.slice(0,r),\" \")),r=h(r,b(i.slice(0,r),\" \")),n=n.slice(r).replace(/\\s+$/,\"\"),i=i.slice(r).replace(/\\s+$/,\"\"),o.push(\"- \"+t),n.length&&o.push(\"? \"+Array(r+1).join(\"\\t\")+n+\"\\n\"),o.push(\"+ \"+e),i.length&&o.push(\"? \"+Array(r+1).join(\"\\t\")+i+\"\\n\"),o},t}(),o=function(t,e){return null==e&&(e=/^\\s*#?\\s*$/),e.test(t)},r=function(t,e){return null==e&&(e=\" \\t\"),S.call(e,t)>=0},x=function(t,e){var n,i;return n=t+1,1===(i=e-t)?\"\"+n:(i||n--,n+\",\"+i)},m=function(t,e,n){var i,r,o,s,c,l,d,u,h,p,f,m,g,v,y,b,_,w,S,M,E,T,C,A,O,k,L,I,R,P,D,N,F,j,B,z,U;for(null==(c=(D=null!=n?n:{}).fromfile)&&(c=\"\"),null==(S=D.tofile)&&(S=\"\"),null==(l=D.fromfiledate)&&(l=\"\"),null==(M=D.tofiledate)&&(M=\"\"),null==D.n&&3,null==(y=D.lineterm)&&(y=\"\\n\"),v=[],b=!1,E=0,O=(N=new a(null,t,e).getGroupedOpcodes()).length;E<O;E++)for(d=N[E],b||(b=!0,s=l?\"\\t\"+l:\"\",w=M?\"\\t\"+M:\"\",v.push(\"--- \"+c+s+y),v.push(\"+++ \"+S+w+y)),m=(F=[d[0],d[d.length-1]])[1],i=x((o=F[0])[1],m[2]),r=x(o[3],m[4]),v.push(\"@@ -\"+i+\" +\"+r+\" @@\"+y),T=0,k=d.length;T<k;T++)if(_=(j=d[T])[0],u=j[1],h=j[2],p=j[3],f=j[4],\"equal\"!==_){if(\"replace\"===_||\"delete\"===_)for(A=0,I=(z=t.slice(u,h)).length;A<I;A++)g=z[A],v.push(\"-\"+g);if(\"replace\"===_||\"insert\"===_)for(P=0,R=(U=e.slice(p,f)).length;P<R;P++)g=U[P],v.push(\"+\"+g)}else for(C=0,L=(B=t.slice(u,h)).length;C<L;C++)g=B[C],v.push(\" \"+g);return v},_=function(t,e){var n,i;return n=t+1,(i=e-t)||n--,i<=1?\"\"+n:n+\",\"+(n+i-1)},c=function(t,e,n){var i,r,o,s,c,l,d,u,h,p,f,m,v,y,b,x,w,S,M,E,T,C,A,O,k,L,I,R,P,D,N,F,j,B,z,U,H,$;for(null==(c=(F=null!=n?n:{}).fromfile)&&(c=\"\"),null==(E=F.tofile)&&(E=\"\"),null==(l=F.fromfiledate)&&(l=\"\"),null==(T=F.tofiledate)&&(T=\"\"),null==F.n&&3,null==(b=F.lineterm)&&(b=\"\\n\"),x={insert:\"+ \",delete:\"- \",replace:\"! \",equal:\"  \"},w=!1,y=[],C=0,L=(j=new a(null,t,e).getGroupedOpcodes()).length;C<L;C++)if(d=j[C],!w){if(w=!0,s=l?\"\\t\"+l:\"\",M=T?\"\\t\"+T:\"\",y.push(\"*** \"+c+s+b),y.push(\"--- \"+E+M+b),o=(B=[d[0],d[d.length-1]])[0],m=B[1],y.push(\"***************\"+b),i=_(o[1],m[2]),y.push(\"*** \"+i+\" ****\"+b),g(function(){var t,e,n,i;for(i=[],t=0,e=d.length;t<e;t++)n=d[t],S=n[0],n[1],n[2],n[3],n[4],i.push(\"replace\"===S||\"delete\"===S);return i}()))for(A=0,I=d.length;A<I;A++)if(z=d[A],S=z[0],u=z[1],h=z[2],z[3],z[4],\"insert\"!==S)for(O=0,R=(U=t.slice(u,h)).length;O<R;O++)v=U[O],y.push(x[S]+v);if(r=_(o[3],m[4]),y.push(\"--- \"+r+\" ----\"+b),g(function(){var t,e,n,i;for(i=[],t=0,e=d.length;t<e;t++)n=d[t],S=n[0],n[1],n[2],n[3],n[4],i.push(\"replace\"===S||\"insert\"===S);return i}()))for(k=0,P=d.length;k<P;k++)if(H=d[k],S=H[0],H[1],H[2],p=H[3],f=H[4],\"delete\"!==S)for(N=0,D=($=e.slice(p,f)).length;N<D;N++)v=$[N],y.push(x[S]+v)}return y},p=function(e,n,i,o){return null==o&&(o=r),new t(i,o).compare(e,n)},f=function(t,e){var n,i,r,o,a,s,c;if(!(o={1:\"- \",2:\"+ \"}[e]))throw new Error(\"unknow delta choice (must be 1 or 2): \"+e);for(r=[\"  \",o],i=[],a=0,s=t.length;a<s;a++)c=(n=t[a]).slice(0,2),S.call(r,c)>=0&&i.push(n.slice(2));return i},e._arrayCmp=v,e.SequenceMatcher=a,e.getCloseMatches=d,e._countLeading=b,e.Differ=t,e.IS_LINE_JUNK=o,e.IS_CHARACTER_JUNK=r,e._formatRangeUnified=x,e.unifiedDiff=m,e._formatRangeContext=_,e.contextDiff=c,e.ndiff=p,e.restore=f}).call(this)},function(t,e,n){t.exports=n(140)},function(t,e,n){var i,r,o;(function(){var n,a,s,c,l,d,u,h,p,f,m,g,v,y,b;s=Math.floor,f=Math.min,a=function(t,e){return t<e?-1:t>e?1:0},p=function(t,e,n,i,r){var o;if(null==n&&(n=0),null==r&&(r=a),n<0)throw new Error(\"lo must be non-negative\");for(null==i&&(i=t.length);n<i;)r(e,t[o=s((n+i)/2)])<0?i=o:n=o+1;return[].splice.apply(t,[n,n-n].concat(e)),e},d=function(t,e,n){return null==n&&(n=a),t.push(e),y(t,0,t.length-1,n)},l=function(t,e){var n,i;return null==e&&(e=a),n=t.pop(),t.length?(i=t[0],t[0]=n,b(t,0,e)):i=n,i},h=function(t,e,n){var i;return null==n&&(n=a),i=t[0],t[0]=e,b(t,0,n),i},u=function(t,e,n){var i;return null==n&&(n=a),t.length&&n(t[0],e)<0&&(e=(i=[t[0],e])[0],t[0]=i[1],b(t,0,n)),e},c=function(t,e){var n,i,r,o,c,l;for(null==e&&(e=a),c=[],i=0,r=(o=function(){l=[];for(var e=0,n=s(t.length/2);0<=n?e<n:e>n;0<=n?e++:e--)l.push(e);return l}.apply(this).reverse()).length;i<r;i++)n=o[i],c.push(b(t,n,e));return c},v=function(t,e,n){var i;if(null==n&&(n=a),-1!==(i=t.indexOf(e)))return y(t,0,i,n),b(t,i,n)},m=function(t,e,n){var i,r,o,s,l;if(null==n&&(n=a),!(r=t.slice(0,e)).length)return r;for(c(r,n),o=0,s=(l=t.slice(e)).length;o<s;o++)i=l[o],u(r,i,n);return r.sort(n).reverse()},g=function(t,e,n){var i,r,o,s,d,u,h,m,g;if(null==n&&(n=a),10*e<=t.length){if(!(o=t.slice(0,e).sort(n)).length)return o;for(r=o[o.length-1],s=0,u=(h=t.slice(e)).length;s<u;s++)n(i=h[s],r)<0&&(p(o,i,0,null,n),o.pop(),r=o[o.length-1]);return o}for(c(t,n),g=[],d=0,m=f(e,t.length);0<=m?d<m:d>m;0<=m?++d:--d)g.push(l(t,n));return g},y=function(t,e,n,i){var r,o,s;for(null==i&&(i=a),r=t[n];n>e&&i(r,o=t[s=n-1>>1])<0;)t[n]=o,n=s;return t[n]=r},b=function(t,e,n){var i,r,o,s,c;for(null==n&&(n=a),r=t.length,c=e,o=t[e],i=2*e+1;i<r;)(s=i+1)<r&&!(n(t[i],t[s])<0)&&(i=s),t[e]=t[i],i=2*(e=i)+1;return t[e]=o,y(t,c,e,n)},n=function(){function t(t){this.cmp=null!=t?t:a,this.nodes=[]}return t.push=d,t.pop=l,t.replace=h,t.pushpop=u,t.heapify=c,t.updateItem=v,t.nlargest=m,t.nsmallest=g,t.prototype.push=function(t){return d(this.nodes,t,this.cmp)},t.prototype.pop=function(){return l(this.nodes,this.cmp)},t.prototype.peek=function(){return this.nodes[0]},t.prototype.contains=function(t){return-1!==this.nodes.indexOf(t)},t.prototype.replace=function(t){return h(this.nodes,t,this.cmp)},t.prototype.pushpop=function(t){return u(this.nodes,t,this.cmp)},t.prototype.heapify=function(){return c(this.nodes,this.cmp)},t.prototype.updateItem=function(t){return v(this.nodes,t,this.cmp)},t.prototype.clear=function(){return this.nodes=[]},t.prototype.empty=function(){return 0===this.nodes.length},t.prototype.size=function(){return this.nodes.length},t.prototype.clone=function(){var e;return(e=new t).nodes=this.nodes.slice(0),e},t.prototype.toArray=function(){return this.nodes.slice(0)},t.prototype.insert=t.prototype.push,t.prototype.top=t.prototype.peek,t.prototype.front=t.prototype.peek,t.prototype.has=t.prototype.contains,t.prototype.copy=t.prototype.clone,t}(),r=[],void 0===(o=\"function\"==typeof(i=function(){return n})?i.apply(e,r):i)||(t.exports=o)}).call(this)},function(t,e,n){\"use strict\";(function(e){var i=n(142);\n/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>\n * @license  MIT\n */function r(t,e){if(t===e)return 0;for(var n=t.length,i=e.length,r=0,o=Math.min(n,i);r<o;++r)if(t[r]!==e[r]){n=t[r],i=e[r];break}return n<i?-1:i<n?1:0}function o(t){return e.Buffer&&\"function\"==typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var a=n(143),s=Object.prototype.hasOwnProperty,c=Array.prototype.slice,l=\"foo\"===function(){}.name;function d(t){return Object.prototype.toString.call(t)}function u(t){return!o(t)&&(\"function\"==typeof e.ArrayBuffer&&(\"function\"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer))))}var h=t.exports=y,p=/\\s*function\\s+([^\\(\\s]*)\\s*/;function f(t){if(a.isFunction(t)){if(l)return t.name;var e=t.toString().match(p);return e&&e[1]}}function m(t,e){return\"string\"==typeof t?t.length<e?t:t.slice(0,e):t}function g(t){if(l||!a.isFunction(t))return a.inspect(t);var e=f(t);return\"[Function\"+(e?\": \"+e:\"\")+\"]\"}function v(t,e,n,i,r){throw new h.AssertionError({message:n,actual:t,expected:e,operator:i,stackStartFunction:r})}function y(t,e){t||v(t,!0,e,\"==\",h.ok)}function b(t,e,n,i){if(t===e)return!0;if(o(t)&&o(e))return 0===r(t,e);if(a.isDate(t)&&a.isDate(e))return t.getTime()===e.getTime();if(a.isRegExp(t)&&a.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&\"object\"==typeof t||null!==e&&\"object\"==typeof e){if(u(t)&&u(e)&&d(t)===d(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===r(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(o(t)!==o(e))return!1;var s=(i=i||{actual:[],expected:[]}).actual.indexOf(t);return-1!==s&&s===i.expected.indexOf(e)||(i.actual.push(t),i.expected.push(e),function(t,e,n,i){if(null==t||null==e)return!1;if(a.isPrimitive(t)||a.isPrimitive(e))return t===e;if(n&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var r=_(t),o=_(e);if(r&&!o||!r&&o)return!1;if(r)return t=c.call(t),e=c.call(e),b(t,e,n);var s,l,d=S(t),u=S(e);if(d.length!==u.length)return!1;for(d.sort(),u.sort(),l=d.length-1;l>=0;l--)if(d[l]!==u[l])return!1;for(l=d.length-1;l>=0;l--)if(s=d[l],!b(t[s],e[s],n,i))return!1;return!0}(t,e,n,i))}return n?t===e:t==e}function _(t){return\"[object Arguments]\"==Object.prototype.toString.call(t)}function x(t,e){if(!t||!e)return!1;if(\"[object RegExp]\"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(t){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function w(t,e,n,i){var r;if(\"function\"!=typeof e)throw new TypeError('\"block\" argument must be a function');\"string\"==typeof n&&(i=n,n=null),r=function(t){var e;try{t()}catch(t){e=t}return e}(e),i=(n&&n.name?\" (\"+n.name+\").\":\".\")+(i?\" \"+i:\".\"),t&&!r&&v(r,n,\"Missing expected exception\"+i);var o=\"string\"==typeof i,s=!t&&r&&!n;if((!t&&a.isError(r)&&o&&x(r,n)||s)&&v(r,n,\"Got unwanted exception\"+i),t&&r&&n&&!x(r,n)||!t&&r)throw r}h.AssertionError=function(t){this.name=\"AssertionError\",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=function(t){return m(g(t.actual),128)+\" \"+t.operator+\" \"+m(g(t.expected),128)}(this),this.generatedMessage=!0);var e=t.stackStartFunction||v;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var n=new Error;if(n.stack){var i=n.stack,r=f(e),o=i.indexOf(\"\\n\"+r);if(o>=0){var a=i.indexOf(\"\\n\",o+1);i=i.substring(a+1)}this.stack=i}}},a.inherits(h.AssertionError,Error),h.fail=v,h.ok=y,h.equal=function(t,e,n){t!=e&&v(t,e,n,\"==\",h.equal)},h.notEqual=function(t,e,n){t==e&&v(t,e,n,\"!=\",h.notEqual)},h.deepEqual=function(t,e,n){b(t,e,!1)||v(t,e,n,\"deepEqual\",h.deepEqual)},h.deepStrictEqual=function(t,e,n){b(t,e,!0)||v(t,e,n,\"deepStrictEqual\",h.deepStrictEqual)},h.notDeepEqual=function(t,e,n){b(t,e,!1)&&v(t,e,n,\"notDeepEqual\",h.notDeepEqual)},h.notDeepStrictEqual=function t(e,n,i){b(e,n,!0)&&v(e,n,i,\"notDeepStrictEqual\",t)},h.strictEqual=function(t,e,n){t!==e&&v(t,e,n,\"===\",h.strictEqual)},h.notStrictEqual=function(t,e,n){t===e&&v(t,e,n,\"!==\",h.notStrictEqual)},h.throws=function(t,e,n){w(!0,t,e,n)},h.doesNotThrow=function(t,e,n){w(!1,t,e,n)},h.ifError=function(t){if(t)throw t},h.strict=i((function t(e,n){e||v(e,!0,n,\"==\",t)}),h,{equal:h.strictEqual,deepEqual:h.deepStrictEqual,notEqual:h.notStrictEqual,notDeepEqual:h.notDeepStrictEqual}),h.strict.strict=h.strict;var S=Object.keys||function(t){var e=[];for(var n in t)s.call(t,n)&&e.push(n);return e}}).call(this,n(69))},function(t,e,n){\"use strict\";\n/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/var i=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function a(t){if(null==t)throw new TypeError(\"Object.assign cannot be called with null or undefined\");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String(\"abc\");if(t[5]=\"de\",\"5\"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e[\"_\"+String.fromCharCode(n)]=n;if(\"0123456789\"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(\"\"))return!1;var i={};return\"abcdefghijklmnopqrst\".split(\"\").forEach((function(t){i[t]=t})),\"abcdefghijklmnopqrst\"===Object.keys(Object.assign({},i)).join(\"\")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,s,c=a(t),l=1;l<arguments.length;l++){for(var d in n=Object(arguments[l]))r.call(n,d)&&(c[d]=n[d]);if(i){s=i(n);for(var u=0;u<s.length;u++)o.call(n,s[u])&&(c[s[u]]=n[s[u]])}}return c}},function(t,e,n){(function(t){var i=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),n={},i=0;i<e.length;i++)n[e[i]]=Object.getOwnPropertyDescriptor(t,e[i]);return n},r=/%[sdj%]/g;e.format=function(t){if(!v(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(s(arguments[n]));return e.join(\" \")}n=1;for(var i=arguments,o=i.length,a=String(t).replace(r,(function(t){if(\"%%\"===t)return\"%\";if(n>=o)return t;switch(t){case\"%s\":return String(i[n++]);case\"%d\":return Number(i[n++]);case\"%j\":try{return JSON.stringify(i[n++])}catch(t){return\"[Circular]\"}default:return t}})),c=i[n];n<o;c=i[++n])m(c)||!_(c)?a+=\" \"+c:a+=\" \"+s(c);return a},e.deprecate=function(n,i){if(void 0!==t&&!0===t.noDeprecation)return n;if(void 0===t)return function(){return e.deprecate(n,i).apply(this,arguments)};var r=!1;return function(){if(!r){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?console.trace(i):console.error(i),r=!0}return n.apply(this,arguments)}};var o,a={};function s(t,n){var i={seen:[],stylize:l};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),f(n)?i.showHidden=n:n&&e._extend(i,n),y(i.showHidden)&&(i.showHidden=!1),y(i.depth)&&(i.depth=2),y(i.colors)&&(i.colors=!1),y(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=c),d(i,t,i.depth)}function c(t,e){var n=s.styles[e];return n?\"\u001b[\"+s.colors[n][0]+\"m\"+t+\"\u001b[\"+s.colors[n][1]+\"m\":t}function l(t,e){return t}function d(t,n,i){if(t.customInspect&&n&&S(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var r=n.inspect(i,t);return v(r)||(r=d(t,r,i)),r}var o=function(t,e){if(y(e))return t.stylize(\"undefined\",\"undefined\");if(v(e)){var n=\"'\"+JSON.stringify(e).replace(/^\"|\"$/g,\"\").replace(/'/g,\"\\\\'\").replace(/\\\\\"/g,'\"')+\"'\";return t.stylize(n,\"string\")}if(g(e))return t.stylize(\"\"+e,\"number\");if(f(e))return t.stylize(\"\"+e,\"boolean\");if(m(e))return t.stylize(\"null\",\"null\")}(t,n);if(o)return o;var a=Object.keys(n),s=function(t){var e={};return t.forEach((function(t,n){e[t]=!0})),e}(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(n)),w(n)&&(a.indexOf(\"message\")>=0||a.indexOf(\"description\")>=0))return u(n);if(0===a.length){if(S(n)){var c=n.name?\": \"+n.name:\"\";return t.stylize(\"[Function\"+c+\"]\",\"special\")}if(b(n))return t.stylize(RegExp.prototype.toString.call(n),\"regexp\");if(x(n))return t.stylize(Date.prototype.toString.call(n),\"date\");if(w(n))return u(n)}var l,_=\"\",M=!1,E=[\"{\",\"}\"];(p(n)&&(M=!0,E=[\"[\",\"]\"]),S(n))&&(_=\" [Function\"+(n.name?\": \"+n.name:\"\")+\"]\");return b(n)&&(_=\" \"+RegExp.prototype.toString.call(n)),x(n)&&(_=\" \"+Date.prototype.toUTCString.call(n)),w(n)&&(_=\" \"+u(n)),0!==a.length||M&&0!=n.length?i<0?b(n)?t.stylize(RegExp.prototype.toString.call(n),\"regexp\"):t.stylize(\"[Object]\",\"special\"):(t.seen.push(n),l=M?function(t,e,n,i,r){for(var o=[],a=0,s=e.length;a<s;++a)A(e,String(a))?o.push(h(t,e,n,i,String(a),!0)):o.push(\"\");return r.forEach((function(r){r.match(/^\\d+$/)||o.push(h(t,e,n,i,r,!0))})),o}(t,n,i,s,a):a.map((function(e){return h(t,n,i,s,e,M)})),t.seen.pop(),function(t,e,n){if(t.reduce((function(t,e){return e.indexOf(\"\\n\")>=0&&0,t+e.replace(/\\u001b\\[\\d\\d?m/g,\"\").length+1}),0)>60)return n[0]+(\"\"===e?\"\":e+\"\\n \")+\" \"+t.join(\",\\n  \")+\" \"+n[1];return n[0]+e+\" \"+t.join(\", \")+\" \"+n[1]}(l,_,E)):E[0]+_+E[1]}function u(t){return\"[\"+Error.prototype.toString.call(t)+\"]\"}function h(t,e,n,i,r,o){var a,s,c;if((c=Object.getOwnPropertyDescriptor(e,r)||{value:e[r]}).get?s=c.set?t.stylize(\"[Getter/Setter]\",\"special\"):t.stylize(\"[Getter]\",\"special\"):c.set&&(s=t.stylize(\"[Setter]\",\"special\")),A(i,r)||(a=\"[\"+r+\"]\"),s||(t.seen.indexOf(c.value)<0?(s=m(n)?d(t,c.value,null):d(t,c.value,n-1)).indexOf(\"\\n\")>-1&&(s=o?s.split(\"\\n\").map((function(t){return\"  \"+t})).join(\"\\n\").substr(2):\"\\n\"+s.split(\"\\n\").map((function(t){return\"   \"+t})).join(\"\\n\")):s=t.stylize(\"[Circular]\",\"special\")),y(a)){if(o&&r.match(/^\\d+$/))return s;(a=JSON.stringify(\"\"+r)).match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,\"name\")):(a=a.replace(/'/g,\"\\\\'\").replace(/\\\\\"/g,'\"').replace(/(^\"|\"$)/g,\"'\"),a=t.stylize(a,\"string\"))}return a+\": \"+s}function p(t){return Array.isArray(t)}function f(t){return\"boolean\"==typeof t}function m(t){return null===t}function g(t){return\"number\"==typeof t}function v(t){return\"string\"==typeof t}function y(t){return void 0===t}function b(t){return _(t)&&\"[object RegExp]\"===M(t)}function _(t){return\"object\"==typeof t&&null!==t}function x(t){return _(t)&&\"[object Date]\"===M(t)}function w(t){return _(t)&&(\"[object Error]\"===M(t)||t instanceof Error)}function S(t){return\"function\"==typeof t}function M(t){return Object.prototype.toString.call(t)}function E(t){return t<10?\"0\"+t.toString(10):t.toString(10)}e.debuglog=function(n){if(y(o)&&(o=t.env.NODE_DEBUG||\"\"),n=n.toUpperCase(),!a[n])if(new RegExp(\"\\\\b\"+n+\"\\\\b\",\"i\").test(o)){var i=t.pid;a[n]=function(){var t=e.format.apply(e,arguments);console.error(\"%s %d: %s\",n,i,t)}}else a[n]=function(){};return a[n]},e.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:\"cyan\",number:\"yellow\",boolean:\"yellow\",undefined:\"grey\",null:\"bold\",string:\"green\",date:\"magenta\",regexp:\"red\"},e.isArray=p,e.isBoolean=f,e.isNull=m,e.isNullOrUndefined=function(t){return null==t},e.isNumber=g,e.isString=v,e.isSymbol=function(t){return\"symbol\"==typeof t},e.isUndefined=y,e.isRegExp=b,e.isObject=_,e.isDate=x,e.isError=w,e.isFunction=S,e.isPrimitive=function(t){return null===t||\"boolean\"==typeof t||\"number\"==typeof t||\"string\"==typeof t||\"symbol\"==typeof t||void 0===t},e.isBuffer=n(144);var T=[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"];function C(){var t=new Date,e=[E(t.getHours()),E(t.getMinutes()),E(t.getSeconds())].join(\":\");return[t.getDate(),T[t.getMonth()],e].join(\" \")}function A(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log(\"%s - %s\",C(),e.format.apply(e,arguments))},e.inherits=n(145),e._extend=function(t,e){if(!e||!_(e))return t;for(var n=Object.keys(e),i=n.length;i--;)t[n[i]]=e[n[i]];return t};var O=\"undefined\"!=typeof Symbol?Symbol(\"util.promisify.custom\"):void 0;function k(t,e){if(!t){var n=new Error(\"Promise was rejected with a falsy value\");n.reason=t,t=n}return e(t)}e.promisify=function(t){if(\"function\"!=typeof t)throw new TypeError('The \"original\" argument must be of type Function');if(O&&t[O]){var e;if(\"function\"!=typeof(e=t[O]))throw new TypeError('The \"util.promisify.custom\" argument must be of type Function');return Object.defineProperty(e,O,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,n,i=new Promise((function(t,i){e=t,n=i})),r=[],o=0;o<arguments.length;o++)r.push(arguments[o]);r.push((function(t,i){t?n(t):e(i)}));try{t.apply(this,r)}catch(t){n(t)}return i}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),O&&Object.defineProperty(e,O,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,i(t))},e.promisify.custom=O,e.callbackify=function(e){if(\"function\"!=typeof e)throw new TypeError('The \"original\" argument must be of type Function');function n(){for(var n=[],i=0;i<arguments.length;i++)n.push(arguments[i]);var r=n.pop();if(\"function\"!=typeof r)throw new TypeError(\"The last argument must be of type Function\");var o=this,a=function(){return r.apply(o,arguments)};e.apply(this,n).then((function(e){t.nextTick(a,null,e)}),(function(e){t.nextTick(k,e,a)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),Object.defineProperties(n,i(e)),n}}).call(this,n(68))},function(t,e){t.exports=function(t){return t&&\"object\"==typeof t&&\"function\"==typeof t.copy&&\"function\"==typeof t.fill&&\"function\"==typeof t.readUInt8}},function(t,e){\"function\"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`.module-toolbar {\n  justify-content: space-between;\n}\n\n.diff-selector > * {\n  cursor: pointer;\n}\n\n.switch-container-disabled {\n  color: rgba(60, 64, 67, 0.38);\n}\n`},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.GeneratorModule=e.GeneratedRowControls=void 0;const i=n(1);n(148),n(31);const r=n(35),o=n(2),a=n(3),s=n(4),c=n(15),l=n(12);n(40);const d=n(5),u=n(8),h=n(32),p=n(11),f=n(150),m=n(7);let g=class extends r.MobxLitElement{static get styles(){return[m.styles,f.styles,a.css`\n            :host {\n              display: flex;\n              flex-direction: row;\n              color: #1a73e8;\n            }\n            :host > * {\n              margin-right: 4px;\n            }\n            `]}render(){return a.html`\n      <mwc-icon class=\"icon-button outlined\" @click=${()=>{const t=new CustomEvent(\"add-point\");this.dispatchEvent(t)}}>\n        add_box\n      </mwc-icon>\n      <mwc-icon class=\"icon-button outlined\" @click=${()=>{const t=new CustomEvent(\"remove-point\");this.dispatchEvent(t)}}>\n        delete\n      </mwc-icon>\n    `}};g=i.__decorate([(0,o.customElement)(\"generated-row-controls\")],g),e.GeneratedRowControls=g;let v=class extends l.LitModule{constructor(){super(...arguments),this.groupService=c.app.getService(h.GroupService),this.sliceService=c.app.getService(p.SliceService),this.editedData={},this.isGenerating=!1,this.generated=[],this.appliedGenerator=null,this.sliceName=\"\"}static get styles(){return[m.styles,f.styles]}get datasetName(){return this.appState.currentDataset}get modelName(){return this.appState.currentModels[0]}get globalParams(){return{model_name:this.modelName,dataset_name:this.datasetName}}get totalNumGenerated(){return this.generated.reduce((t,e)=>t+e.length,0)}firstUpdated(){this.reactImmediately(()=>this.selectionService.primarySelectedInputData,t=>{this.selectionService.lastUser!==this&&this.resetEditedData()}),this.react(()=>this.totalNumGenerated,t=>{t<=0&&this.resetEditedData()})}updated(){super.updated();const t=this.shadowRoot.getElementById(\"header\"),e=this.shadowRoot.querySelector(\".row\");if(t)for(let n=0;n<t.children.length;n++){const i=e.children[n].offsetWidth;t.children[n].style.minWidth=i+\"px\"}}resetEditedData(){this.generated=[],this.appliedGenerator=null,this.sliceName=\"\"}handleGeneratorClick(t,e){this.isGenerating||(this.resetEditedData(),this.generate(t,this.modelName,e))}makeAutoSliceName(t,e){const n=[t];if(null!=e)for(const t of Object.keys(e))this.globalParams.hasOwnProperty(t)||n.push(`${t}=${e[t]}`);return n.join(\":\")}generate(t,e,n){return i.__awaiter(this,void 0,void 0,(function*(){this.isGenerating=!0,this.appliedGenerator=t;const i=this.selectionService.selectedInputData;try{const r=yield this.apiService.getGenerated(i,e,this.appState.currentDataset,t,n);for(const t of r)for(const e of t)Object.assign(e.meta,{added:1});this.generated=r,this.isGenerating=!1,this.sliceName=this.makeAutoSliceName(t,n)}catch(t){this.isGenerating=!1}}))}createNewDatapoints(t){return i.__awaiter(this,void 0,void 0,(function*(){const e=(0,u.flatten)(t);this.appState.commitNewDatapoints(e);const n=e.map(t=>t.id);if(0===n.length)return;\"\"!==this.sliceName&&this.sliceService.addOrAppendToSlice(this.sliceName,n);const i=new Set(e.map(t=>t.meta.parentId));if(this.selectionService.selectIds([...i,...n],this),this.selectionService.setPrimarySelection(n[0],this),this.appState.compareExamplesEnabled){const t=c.app.getServiceArray(p.SelectionService)[1];t.selectIds([...i,...n],this);const r=e[0].meta.parentId;t.setPrimarySelection(r,this)}}))}render(){return a.html`\n      <div class=\"module-container\">\n        <div class=\"module-content generator-module-content\">\n          ${this.renderGeneratorButtons()}\n          ${this.renderGenerated()}\n        </div>\n        <div class=\"module-footer\">\n          <p class=\"module-status\">${this.getStatus()}</p>\n          <p class=\"module-status\">${this.getSliceStatus()}</p>\n          ${this.renderOverallControls()}\n        </div>\n      </div>\n    `}getSliceStatus(){if(!this.sliceService.namedSlices.has(this.sliceName))return null;const t=this.sliceService.getSliceByName(this.sliceName).length,e=1===t?\"\":\"s\";return a.html`\n       Slice exists (${t} point${e});\n       will append ${this.totalNumGenerated} more.\n    `}getStatus(){if(this.isGenerating)return\"Generating...\";if(this.appliedGenerator){const t=1===this.totalNumGenerated?\"\":\"s\";return`\\n        ${this.appliedGenerator}: generated ${this.totalNumGenerated}\\n        counterfactual${t} from ${this.generated.length} inputs.\\n      `}const t=this.appState.metadata.generators;if(!Object.keys(t).length)return\"No generator components available.\";const e=this.selectionService.selectedInputData,n=()=>{this.selectionService.selectAll()};if(e.length<=0)return a.html`\n          No examples selected.\n          <span class='select-all' @click=${n}>\n            Select entire dataset?\n          </span>`;const i=1===e.length?\"\":\"s\";return`\\n      Generate counterfactuals from current selection\\n      (${e.length} datapoint${i}).\\n    `}renderInterstitial(){return a.html`\n      <div class=\"interstitial\">\n        <img src=\"static/interstitial-select.png\" />\n        <p>\n          <strong>Counterfactual Generators</strong>\n          Create new datapoints derived from the current selection.\n        </p>\n      </div>`}renderEmptyNotice(){return a.html`\n      <div class=\"interstitial\">\n        <p>No examples generated.</p>\n      </div>`}renderGenerated(){const t=this.createEntries();return this.appliedGenerator?t.length<=0?this.isGenerating?null:this.renderEmptyNotice():a.html`\n      <div class=\"results-holder\">\n        <lit-data-table class=\"table\"\n            .columnNames=${Object.keys(t[0])}\n            .data=${t}\n        ></lit-data-table>\n      </div>\n    `:this.renderInterstitial()}createEntries(){const t=[];for(let e=0;e<this.generated.length;e++){const n=this.generated[e];for(let r=0;r<n.length;r++){const o=n[r],s=()=>i.__awaiter(this,void 0,void 0,(function*(){this.generated[e].splice(r,1),yield this.createNewDatapoints([[o]])})),c=()=>{this.generated[e].splice(r,1)},l=Object.keys(o.data),d={};for(const t of l){const e=!this.appState.currentModelRequiredInputSpecKeys.includes(t);d[t]=e?this.renderEntry(o.data,t):o.data[t]}d[\"Add/Remove\"]=a.html`<generated-row-controls\n                                @add-point=${s}\n                                @remove-point=${c} />`,t.push(d)}}return t}renderOverallControls(){const t=()=>i.__awaiter(this,void 0,void 0,(function*(){yield this.createNewDatapoints(this.generated),this.resetEditedData()})),e=this.totalNumGenerated<=0;return a.html`\n      <div class=\"overall-controls\">\n        <label for=\"slice-name\">Slice name:</label>\n        <input type=\"text\" class=\"slice-name-input\" name=\"slice-name\"\n         .value=${this.sliceName} @input=${t=>{this.sliceName=t.target.value}}\n         placeholder=\"Name for generated set\">\n        <button class=\"hairline-button\" ?disabled=${e}\n           @click=${t}>\n           Add all\n        </button>\n        <button class='hairline-button'\n          @click=${()=>i.__awaiter(this,void 0,void 0,(function*(){this.appState.compareExamplesEnabled=!0,yield t()}))} ?disabled=${e}>\n          Add and compare\n        </button>\n        <button class=\"hairline-button\" ?disabled=${e}\n           @click=${this.resetEditedData}>\n           Clear\n        </button>\n      </div>`}renderGeneratorButtons(){const t=this.appState.metadata.generators,e=Object.keys(t),n=t=>{const e=t.detail.settings,n=t.detail.name,i=Object.assign({},this.globalParams,e);this.handleGeneratorClick(n,i)};return a.html`\n        <div class=\"generators-panel\">\n          ${e.map(e=>{const i=t[e].configSpec,r=JSON.parse(JSON.stringify(i)),o=t[e].description;for(const t of Object.keys(r))(0,u.isLitSubtype)(r[t],[\"FieldMatcher\",\"MultiFieldMatcher\"])&&(r[t].vocab=this.appState.getSpecKeysFromFieldMatcher(r[t],this.modelName));return a.html`\n                <lit-interpreter-controls\n                  .spec=${r}\n                  .name=${e}\n                  .description=${o||\"\"}\n                  @interpreter-click=${n}\n                  ?bordered=${!0}>\n                </lit-interpreter-controls>`})}\n        </div>\n    `}renderEntry(t,e){const n=t[e],i=this.groupService.categoricalFeatureNames.includes(e),r=n=>{t[e]=n.target.value};return i?(()=>{const t=this.groupService.categoricalFeatures[e];return{template:a.html`\n          <select class=\"dropdown\" @change=${r}>\n            ${t.map(t=>a.html`\n                <option value=\"${t}\" ?selected=${t===n}>\n                  ${t}\n                </option>`)}\n          </select>`,value:n}})():(()=>{const t=this.appState.currentDatasetSpec[e],i=(0,d.formatForDisplay)(n,t);return(0,u.isLitSubtype)(t,[\"EdgeLabels\",\"SpanLabels\"])?i:{template:a.html`<input type=\"text\" class=\"input-box\"\n            @input=${r}\n            .value=\"${i}\" />`,value:i}})()}static shouldDisplayModule(t,e){return!0}};v.title=\"Datapoint Generator\",v.numCols=10,v.template=()=>a.html`<generator-module></generator-module>`,v.duplicateForModelComparison=!1,i.__decorate([s.observable,i.__metadata(\"design:type\",Object)],v.prototype,\"editedData\",void 0),i.__decorate([s.observable,i.__metadata(\"design:type\",Object)],v.prototype,\"isGenerating\",void 0),i.__decorate([s.observable,i.__metadata(\"design:type\",Array)],v.prototype,\"generated\",void 0),i.__decorate([s.observable,i.__metadata(\"design:type\",Object)],v.prototype,\"appliedGenerator\",void 0),i.__decorate([s.observable,i.__metadata(\"design:type\",String)],v.prototype,\"sliceName\",void 0),i.__decorate([s.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],v.prototype,\"datasetName\",null),i.__decorate([s.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],v.prototype,\"modelName\",null),i.__decorate([s.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],v.prototype,\"globalParams\",null),i.__decorate([s.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],v.prototype,\"totalNumGenerated\",null),v=i.__decorate([(0,o.customElement)(\"generator-module\")],v),e.GeneratorModule=v},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.InterpreterControls=void 0;const i=n(1);n(39),n(31);const r=n(2),o=n(2),a=n(3),s=n(13),c=n(4),l=n(34),d=n(7);n(5);const u=n(8),h=n(149);let p=class extends l.ReactiveElement{constructor(){super(...arguments),this.spec={},this.name=\"\",this.description=\"\",this.bordered=!1,this.settings={},this.opened=!1}static get styles(){return[d.styles,h.styles]}render(){const t=Object.keys(this.spec).length>0||this.description.length>0,e=this.opened?\"expand_less\":\"expand_more\",n={bordered:this.bordered},i={content:!0,minimized:!this.opened};return a.html`\n      <div class=${(0,s.classMap)(n)}>\n        ${t?a.html`\n          <div class=${(0,s.classMap)({collapsible:!0,header:!0})} @click=${()=>{t&&(this.opened=!this.opened)}}>\n            <div class=\"title\">${this.name}</div>\n            <mwc-icon class=\"icon-button min-button\">\n              ${e}\n            </mwc-icon>\n          </div>`:a.html`\n          <div class=\"header\">\n            <div class=\"title\">${this.name}</div>\n          </div>`}\n        <div class=${(0,s.classMap)(i)}>\n          <div class=\"description\">${this.description}</div>\n          ${this.renderControls()}\n          <div class=\"buttons-holder\">\n            <button class=\"filled-button\" @click=${()=>{const t=new CustomEvent(\"interpreter-click\",{detail:{name:this.name,settings:this.settings}});this.dispatchEvent(t)}}>Apply</button>\n          </div>\n        </div>\n      </div>\n    `}renderControls(){const t=this.spec;return Object.keys(t).map(e=>{null==this.settings[e]&&((0,u.isLitSubtype)(t[e],\"SparseMultilabel\")&&(this.settings[e]=t[e].default),(0,u.isLitSubtype)(t[e],\"MultiFieldMatcher\")?this.settings[e]=t[e].select_all?t[e].vocab:t[e].default:(0,u.isLitSubtype)(t[e],[\"CategoryLabel\",\"FieldMatcher\"])?this.settings[e]=null!=t[e].vocab&&t[e].vocab.length>0?t[e].vocab[0]:\"\":this.settings[e]=t[e].default);const n=t[e].required;return a.html`\n          <div class=\"control-holder\">\n            <div class=\"control-name\">\n              ${(n?\"*\":\"\")+e}\n            </div>\n            ${this.renderControl(e,t[e])}\n          </div>`})}renderControl(t,e){if((0,u.isLitSubtype)(e,[\"SparseMultilabel\",\"MultiFieldMatcher\"])){const n=()=>e.vocab.map(e=>{const n=-1!==this.settings[t].indexOf(e);return a.html`\n          <lit-checkbox ?checked=${n} @change=${n=>{n.target.checked?this.settings[t].push(e):this.settings[t]=this.settings[t].filter(t=>t!==e)}}\n            label=${e} class='checkbox-control'>\n          </lit-checkbox>\n        `});return a.html`<div class='checkbox-holder'>${n()}</div>`}if((0,u.isLitSubtype)(e,[\"CategoryLabel\",\"FieldMatcher\"])){const n=n=>{const i=n.target;this.settings[t]=e.vocab[(null==i?void 0:i.selectedIndex)||0]},i=e.vocab.map((t,e)=>a.html`\n          <option value=${e}>${t}</option>\n        `),r=null!=e.vocab&&e.vocab.length>0?e.vocab[0]:\"\";return a.html`<select class=\"dropdown control\" @change=${n}\n          .value=${r} ?disabled=${e.vocab.length<2}>\n        ${i}\n      </select>`}if((0,u.isLitSubtype)(e,[\"Scalar\"])){const n=e.step,i=e.min_val,r=e.max_val,o=e=>{const n=e.target;this.settings[t]=n.value};return a.html`\n        <div class='slider-holder'>\n          <div class='slider-label slider-label-start'>${i}</div>\n          <lit-slider class=\"slider\"\n                      min=\"${i}\" max=\"${r}\" step=\"${n}\"\n                      val=\"${+this.settings[t]}\"\n                      .onInput=${o}></lit-slider>\n          <div class='slider-label'>${r}</div>\n          <div class='slider-value'>${this.settings[t]}</div>\n        </div>\n      `}if((0,u.isLitSubtype)(e,[\"Boolean\"])){const e=()=>{const e=!!this.settings[t];this.settings[t]=!e};return a.html`\n        <lit-checkbox\n         ?checked=${!!this.settings[t]}\n         @change=${e}>\n        </lit-checkbox>\n      `}if((0,u.isLitSubtype)(e,[\"Tokens\"])){const e=this.settings[t]||\"\",n=e=>{const n=e.target;this.settings[t]=n.value.split(\",\").map(t=>t.trim())};return a.html`<input class=\"control\" type=\"text\" @input=${n}\n          .value=\"${e}\" />`}{const e=this.settings[t]||\"\",n=e=>{const n=e.target;this.settings[t]=n.value};return a.html`<input class=\"control\" type=\"text\" @input=${n}\n          .value=\"${e}\" />`}}};i.__decorate([c.observable,(0,r.property)({type:Object}),i.__metadata(\"design:type\",Object)],p.prototype,\"spec\",void 0),i.__decorate([c.observable,(0,r.property)({type:String}),i.__metadata(\"design:type\",Object)],p.prototype,\"name\",void 0),i.__decorate([c.observable,(0,r.property)({type:String}),i.__metadata(\"design:type\",Object)],p.prototype,\"description\",void 0),i.__decorate([c.observable,(0,r.property)({type:Boolean}),i.__metadata(\"design:type\",Object)],p.prototype,\"bordered\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",Object)],p.prototype,\"settings\",void 0),i.__decorate([(0,r.property)({type:Boolean,reflect:!0}),i.__metadata(\"design:type\",Object)],p.prototype,\"opened\",void 0),p=i.__decorate([(0,o.customElement)(\"lit-interpreter-controls\")],p),e.InterpreterControls=p},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`.bordered {\n  border: 1px solid #e8eaed;\n}\n\n.description {\n  font-size: 8pt;\n  color: rgb(60, 64, 67);\n  padding-top: 10px;\n}\n\n.collapsible {\n  cursor: pointer;\n}\n\n.header {\n  padding: 8px;\n  width: 100%;\n  text-align: left;\n  outline: none;\n  font-family: 'Google Sans', sans;\n  font-size: 14px;\n  display: flex;\n  justify-content: space-between;\n  box-sizing: border-box;\n  align-items: center;\n}\n\n.content {\n  padding: 0 8px;\n  overflow: hidden;\n  transition: max-height 0.2s ease-out;\n  background-color: #F8F9FA;\n  box-sizing: border-box;\n}\n\n.content.minimized {\n  max-height: 0;\n  border-bottom: none;\n}\n\n.control-name {\n  color: #80868B;\n  width: 50%;\n}\n\n.control-holder {\n  padding-top: 8px;\n  display: flex;\n  align-items: center;\n}\n\n.control {\n  width: 50%;\n}\n\n.buttons-holder {\n  padding: 8px 0;\n  display: flex;\n  flex-direction: row-reverse;\n}\n\n.checkbox-holder {\n  max-width: 50%;\n  display: flex;\n  flex-wrap: wrap;\n}\n\n.checkbox-control {\n  margin-right: 12px;\n  min-width: 48px;\n}\n\n.slider-holder {\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n  padding-right: 5px;\n  width: 50%;\n}\n\n.slider {\n  min-width: 60px;\n  flex: 1;\n}\n\n.slider-label {\n  color: var(--lit-neutral-600);\n  font-size: 8pt;\n  min-width: 3em;\n}\n\n.slider-label-start {\n  text-align: end;\n  min-width: 1em;\n}\n\n.slider-value {\n  min-width: 2em;\n}\n`},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`.generator-module-content {\n  display: flex;\n  flex-direction: row;\n  overflow: hidden;\n}\n\n.generators-panel {\n  flex-grow: 0;\n  flex-shrink: 0;\n  overflow-y: auto;\n  width: 400px;\n}\n\n.results-holder {\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n  flex-shrink: 1;\n  overflow-y: auto;\n  margin-left: 4px;\n}\n\n.interstitial {\n  align-items: center;\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n  flex-shrink: 1;\n  justify-content: center;\n  overflow: hidden;\n  font-family: 'Google Sans', sans;\n}\n\n.interstitial > * {\n  flex-grow: 0;\n  flex-shrink: 0;\n  max-width: 300px;\n}\n\n.interstitial > img {\n  flex-shrink: 1;\n  max-height: 130px;\n}\n\n.interstitial p {\n  color: #5f6368;\n}\n\n.interstitial strong {\n  display: block;\n  font-size: 1.5em;\n  margin-bottom: 4px;\n}\n\n.generators-panel .label {\n  font-size: 16px;\n  font-weight: bold;\n  margin-bottom: 10px;\n}\n\n.generators-panel.visible {\n  display: block;\n}\n\n.generator-control {\n  display: flex;\n  flex-direction: row;\n}\n\n.input-label {\n  margin-right: 4px;\n  padding: 10px;\n}\n\n.input-box {\n  width: 95%;\n}\n\n.overall-controls {\n  align-items: center;\n  display: flex;\n  flex-direction: row;\n  justify-content: flex-end;\n}\n\n.slice-name-input {\n  margin-left: 4px;\n  width: 250px;\n}\n\n.select-all {\n  color: #1a73e8;\n  text-decoration: underline;\n  cursor: pointer;\n}\n`},function(t,e,n){\"use strict\";var i;Object.defineProperty(e,\"__esModule\",{value:!0}),e.LanguageModelPredictionModule=void 0;const r=n(1);n(39);const o=n(2),a=n(3),s=n(13),c=n(4),l=n(12);n(5);const d=n(8),u=n(152),h=n(7);let p=i=class extends l.LitModule{constructor(){super(...arguments),this.clickToMask=!1,this.selectedInput=null,this.tokens=[],this.originalResults=[],this.selectedTokenIndex=null,this.mlmResults=[]}static get styles(){return[h.styles,u.styles]}get modelSpec(){return this.appState.getModelSpec(this.model)}get predKey(){return(0,d.findSpecKeys)(this.modelSpec.output,\"TokenTopKPreds\")[0]}get outputTokensKey(){return this.modelSpec.output[this.predKey].align}get inputTokensKey(){return this.modelSpec.input.hasOwnProperty(this.outputTokensKey)&&(0,d.isLitSubtype)(this.modelSpec.input[this.outputTokensKey],\"Tokens\")?this.outputTokensKey:null}get maskToken(){return this.inputTokensKey?this.modelSpec.input[this.inputTokensKey].mask_token:void 0}firstUpdated(){this.reactImmediately(()=>this.selectionService.primarySelectedInputData,t=>{this.updateSelection(t)}),this.react(()=>this.selectedTokenIndex,t=>{this.updateMLMResults()}),this.react(()=>this.clickToMask,t=>{this.updateMLMResults()}),this.reactImmediately(()=>this.model,t=>{null!=this.maskToken&&(this.clickToMask=!0)})}updateSelection(t){return r.__awaiter(this,void 0,void 0,(function*(){if(this.selectedInput=null,this.tokens=[],this.originalResults=[],this.selectedTokenIndex=null,this.mlmResults=[],null==t)return;const e=this.appState.currentDataset,n=this.apiService.getPreds([t],this.model,e,[\"Tokens\",\"TokenTopKPreds\"],\"Loading tokens\"),i=yield this.loadLatest(\"modelPreds\",n);if(null===i)return;const r=i[0];if(this.tokens=r[this.outputTokensKey],this.originalResults=r[this.predKey],this.mlmResults=this.originalResults,this.selectedInput=t,null!=this.maskToken){const t=this.tokens.indexOf(this.maskToken);-1!==t&&(this.selectedTokenIndex=t)}}))}updateMLMResults(){return r.__awaiter(this,void 0,void 0,(function*(){if(null==this.selectedTokenIndex||!this.clickToMask)return void(this.mlmResults=this.originalResults);if(null==this.selectedInput||null==this.maskToken)return;const t=[...this.tokens];if(t[this.selectedTokenIndex]===this.maskToken)return void(this.mlmResults=this.originalResults);t[this.selectedTokenIndex]=this.maskToken,this.mlmResults=[];const e=[{data:Object.assign({},this.selectedInput.data,{[this.inputTokensKey]:t}),id:\"\",meta:{added:!0}}],n=this.appState.currentDataset,i=this.apiService.getPreds(e,this.model,n,[\"TokenTopKPreds\"]),r=yield this.loadLatest(\"mlmResults\",i);null!==r&&(this.mlmResults=r[0][this.predKey])}))}render(){return a.html`\n      <div class='module-container'>\n        ${this.renderControls()}\n        <div id='main-area' class='module-results-area'>\n          ${this.renderInputWords()}\n          ${this.renderOutputWords()}\n        </div>\n      </div>\n    `}renderModeInfo(){return null===this.selectedTokenIndex?null:a.html`\n      <span class='mode-info'>\n        ${this.clickToMask?\"Showing masked predictions\":\"Showing unmasked predictions\"}\n      </span>\n    `}renderControls(){return a.html`\n      <div class='module-toolbar'>\n        ${this.maskToken?a.html`\n          <lit-checkbox label=\"Click to mask?\"\n            ?checked=${this.clickToMask}\n            @change=${()=>{this.clickToMask=!this.clickToMask}}\n          ></lit-checkbox>\n          ${this.renderModeInfo()}\n        `:null}\n      </div>\n    `}renderInputWords(){return a.html`\n      <div class='input-group'>\n        <div class='field-title input-group-title'>\n          ${this.tokens.length>0?this.outputTokensKey:null}\n        </div>\n        <div class=\"input-words\">${this.tokens.map((t,e)=>{const n=(0,s.classMap)({token:!0,\"token-chip-label\":!0,selected:e===this.selectedTokenIndex,masked:e===this.selectedTokenIndex&&null!=this.maskToken&&this.clickToMask});return a.html`<div class=${n} @click=${()=>{e===this.selectedTokenIndex?this.selectedTokenIndex=null:this.selectedTokenIndex=e}}>${t}</div>`})}</div>\n      </div>\n    `}renderOutputWords(){if(null===this.selectedTokenIndex||0===this.mlmResults.length)return a.html`<div id=\"output-words\" class='sidebar'></div>`;return a.html`\n      <div id=\"output-words\" class='sidebar sidebar-shaded'>\n        ${this.mlmResults[this.selectedTokenIndex].map(t=>{const e=this.tokens[this.selectedTokenIndex],n=t[0],i=(100*t[1]).toFixed(1),r=(0,s.classMap)({\"output-token\":!0,\"token-chip-generated\":!0,selected:n===e});return a.html`\n        <div class='output-row'>\n          <div class=${r}>${n}</div>\n          <div class='token-chip-label output-percent'>${i}%</div>\n        </div>\n      `})}\n      </div>\n    `}static findTargetFields(t){return(0,d.findSpecKeys)(t,\"TokenTopKPreds\").filter(e=>{const n=t[e].align;return null!=n&&(0,d.isLitSubtype)(t[n],\"Tokens\")})}static shouldDisplayModule(t,e){for(const e of Object.values(t))if(i.findTargetFields(e.spec.output).length>0)return!0;return!1}};p.title=\"LM Predictions\",p.duplicateForExampleComparison=!0,p.duplicateAsRow=!0,p.numCols=4,p.template=(t=\"\",e=0)=>a.html`<lm-prediction-module model=${t} selectionServiceIndex=${e}></lm-prediction-module>`,r.__decorate([c.observable,r.__metadata(\"design:type\",Boolean)],p.prototype,\"clickToMask\",void 0),r.__decorate([c.observable,r.__metadata(\"design:type\",Object)],p.prototype,\"selectedInput\",void 0),r.__decorate([c.observable,r.__metadata(\"design:type\",Array)],p.prototype,\"tokens\",void 0),r.__decorate([c.observable,r.__metadata(\"design:type\",Array)],p.prototype,\"originalResults\",void 0),r.__decorate([c.observable,r.__metadata(\"design:type\",Object)],p.prototype,\"selectedTokenIndex\",void 0),r.__decorate([c.observable,r.__metadata(\"design:type\",Array)],p.prototype,\"mlmResults\",void 0),r.__decorate([c.computed,r.__metadata(\"design:type\",Object),r.__metadata(\"design:paramtypes\",[])],p.prototype,\"modelSpec\",null),r.__decorate([c.computed,r.__metadata(\"design:type\",String),r.__metadata(\"design:paramtypes\",[])],p.prototype,\"predKey\",null),r.__decorate([c.computed,r.__metadata(\"design:type\",String),r.__metadata(\"design:paramtypes\",[])],p.prototype,\"outputTokensKey\",null),r.__decorate([c.computed,r.__metadata(\"design:type\",Object),r.__metadata(\"design:paramtypes\",[])],p.prototype,\"inputTokensKey\",null),r.__decorate([c.computed,r.__metadata(\"design:type\",Object),r.__metadata(\"design:paramtypes\",[])],p.prototype,\"maskToken\",null),p=i=r.__decorate([(0,o.customElement)(\"lm-prediction-module\")],p),e.LanguageModelPredictionModule=p},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`#main-area {\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n}\n\n.module-toolbar {\n  justify-content: space-between;\n}\n\n.mode-info {\n  color: gray;\n}\n\n.input-group {\n  padding: 4px;\n}\n\n.input-group-title {\n  margin-bottom: 3px;\n}\n\n.input-words {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  align-content: flex-start;\n}\n\n.token:hover {\n  cursor: pointer;\n}\n\n.token.masked {\n  text-decoration: line-through;\n}\n\n.sidebar {\n  min-width: 15%;\n  padding: 4px;\n  overflow-y: auto; /* Scroll this before the rest of the module */\n}\n\n.sidebar-shaded {\n  background: #f8f9fa;\n  border-left: 1px solid #bdc1c6;\n  border-radius: 2px;\n}\n\n#output-table {\n  border-spacing: 0px;\n}\n\n.output-row {\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n}\n\n.output-token {\n  padding: 1px;\n  border-width: 2px;\n  margin: 2px;\n  font-family: 'Roboto Mono', monospace;\n}\n\n.output-percent {\n  margin: 2px;\n}\n\n`},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.MetricsModule=void 0;const i=n(1),r=n(2),o=n(3),a=n(4),s=n(15),c=n(12);n(40),n(5);const l=n(32),d=n(11),u=n(154),h=n(7);var p;!function(t){t.DATASET=\"dataset\",t.SELECTION=\"selection\",t.SLICE=\"slice\"}(p||(p={}));let f=class extends c.LitModule{constructor(){super(...arguments),this.sliceService=s.app.getService(d.SliceService),this.groupService=s.app.getService(l.GroupService),this.classificationService=s.app.getService(d.ClassificationService),this.selectedFacetBins={},this.metricsMap={},this.facetBySlice=!1,this.selectedFacets=[],this.pendingCalls=0}static get styles(){return[h.styles,u.styles]}firstUpdated(){this.react(()=>this.appState.currentInputData,t=>{this.metricsMap={},this.addMetrics(this.appState.currentInputData,p.DATASET),this.updateAllFacetedMetrics()}),this.reactImmediately(()=>this.selectionService.selectedInputData,()=>{Object.keys(this.metricsMap).forEach(t=>{this.metricsMap[t].source===p.SELECTION&&delete this.metricsMap[t]}),this.selectionService.lastUser!==this&&this.selectionService.selectedInputData.length>0&&(this.addMetrics(this.selectionService.selectedInputData,p.SELECTION),this.updateFacetedMetrics(this.selectionService.selectedInputData,!0))}),this.react(()=>this.classificationService.allMarginSettings,t=>{this.addMetrics(this.appState.currentInputData,p.DATASET),this.updateAllFacetedMetrics()}),this.react(()=>this.sliceService.sliceNames,t=>{this.facetBySlice=!0,this.updateSliceMetrics()}),this.addMetrics(this.appState.currentInputData,p.DATASET),this.updateAllFacetedMetrics()}addMetrics(t,e,n,r){return i.__awaiter(this,void 0,void 0,(function*(){const o=this.appState.currentModels,a=yield Promise.all(o.map(e=>i.__awaiter(this,void 0,void 0,(function*(){return this.getMetrics(t,e)}))));let s=null!=r?r:e.toString();null!=n&&(s+=\" (faceted)\"),a.forEach((i,r)=>{Object.keys(i).forEach(a=>{i[a].forEach(i=>{const c=this.getRowKey(o[r],s,i.pred_key,n);null==this.metricsMap[c]&&(this.metricsMap[c]={model:o[r],selection:s,exampleIds:t.map(t=>t.id),predKey:i.pred_key,headMetrics:{},facets:n,source:e}),this.metricsMap[c].exampleIds=t.map(t=>t.id),this.metricsMap[c].headMetrics[a]=i.metrics})})})}))}getRowKey(t,e,n,i){let r=\"\";if(null!=i)for(const t of Object.values(i))r+=t.displayVal+\"-\";return`${t}-${e}-${n}-${r}`}updateFacetedMetrics(t,e){if(this.selectedFacets.length>0){const n=this.groupService.groupExamplesByFeatures(this.selectedFacetBins,t,this.selectedFacets),i=e?p.SELECTION:p.DATASET;Object.keys(n).forEach(t=>{this.addMetrics(n[t].data,i,n[t].facets)})}}updateAllFacetedMetrics(){Object.keys(this.metricsMap).forEach(t=>{null!=this.metricsMap[t].facets&&delete this.metricsMap[t]}),this.selectedFacets.length>0&&(this.updateFacetedMetrics(this.selectionService.selectedInputData,!0),this.updateFacetedMetrics(this.appState.currentInputData,!1))}updateSliceMetrics(){Object.keys(this.metricsMap).forEach(t=>{this.metricsMap[t].source===p.SLICE&&delete this.metricsMap[t]}),this.facetBySlice&&this.sliceService.sliceNames.forEach(t=>{const e=this.sliceService.getSliceDataByName(t);e.length>0&&this.addMetrics(e,p.SLICE,void 0,t)})}getMetrics(t,e){return i.__awaiter(this,void 0,void 0,(function*(){this.pendingCalls+=1;try{const n=this.classificationService.marginSettings[e]||{},i=yield this.apiService.getInterpretations(t,e,this.appState.currentDataset,\"metrics\",n);return this.pendingCalls-=1,i}catch(t){return this.pendingCalls-=1,{}}}))}get tableData(){const t=[],e=new Set;Object.values(this.metricsMap).forEach(t=>{Object.keys(t.headMetrics).forEach(n=>{const i=t.headMetrics[n];Object.keys(i).forEach(t=>{e.add(`${n}: ${t}`)})})});const n=[...e];for(const e of Object.values(this.metricsMap)){const i=n.map(t=>{const[n,i]=t.split(\": \");if(null==e.headMetrics[n])return\"-\";const r=e.headMetrics[n][i];return null==r?\"-\":\"number\"==typeof r&&r%1!=0?r.toFixed(3):r}),r=this.selectedFacets.map(t=>e.facets&&e.facets[t]?e.facets[t].displayVal:\"-\"),o=[e.model,e.selection,...r,e.predKey,e.exampleIds.length,...i];t.push(o)}return{header:[\"Model\",\"From\",...this.selectedFacets,\"Field\",\"N\",...n],data:t}}render(){return o.html`\n      <div class=\"module-container\">\n        <div class='module-toolbar'>\n          ${this.renderFacetSelector()}\n        </div>\n        <div class='module-results-area'>\n          ${this.renderTable()}\n        </div>\n      </div>\n    `}renderTable(){return o.html`\n      <lit-data-table\n        .columnNames=${this.tableData.header}\n        .data=${this.tableData.data}\n      ></lit-data-table>\n    `}renderFacetSelector(){const t=(t,e)=>{if(t.target.checked)this.selectedFacets.push(e);else{const t=this.selectedFacets.indexOf(e);this.selectedFacets.splice(t,1)}const n=this.selectedFacets.map(t=>({featureName:t,method:this.groupService.numericalFeatureNames.includes(t)?l.FacetingMethod.EQUAL_INTERVAL:l.FacetingMethod.DISCRETE}));this.selectedFacetBins=this.groupService.numericalFeatureBins(n),this.updateAllFacetedMetrics()},e=this.sliceService.areAllSlicesEmpty();return o.html`\n      <label class=\"cb-label\">Show slices</label>\n      <lit-checkbox\n        ?checked=${this.facetBySlice}\n        @change=${t=>{this.facetBySlice=!this.facetBySlice,this.updateSliceMetrics()}}\n        ?disabled=${e}>\n      </lit-checkbox>\n      <label class=\"cb-label\">Facet by</label>\n       ${this.groupService.denseFeatureNames.map(e=>this.renderCheckbox(e,!1,n=>{t(n,e)},!1))}\n      ${this.pendingCalls>0?this.renderSpinner():null}\n    `}renderCheckbox(t,e,n,i){return o.html`\n        <div class='checkbox-holder'>\n          <lit-checkbox\n            ?checked=${e}\n            ?disabled=${i}\n            @change='${e=>{n(e,t)}}'\n            label=${t}>\n          </lit-checkbox>\n        </div>\n    `}renderSpinner(){return o.html`\n      <lit-spinner size=${24} color=\"var(--app-secondary-color)\">\n      </lit-spinner>\n    `}static shouldDisplayModule(t,e){for(const e of Object.values(t))if(-1!==e.interpreters.indexOf(\"metrics\"))return!0;return!1}};f.title=\"Metrics\",f.numCols=6,f.template=()=>o.html`<metrics-module></metrics-module>`,f.duplicateForModelComparison=!1,i.__decorate([a.observable,i.__metadata(\"design:type\",Object)],f.prototype,\"selectedFacetBins\",void 0),i.__decorate([a.observable,i.__metadata(\"design:type\",Object)],f.prototype,\"metricsMap\",void 0),i.__decorate([a.observable,i.__metadata(\"design:type\",Boolean)],f.prototype,\"facetBySlice\",void 0),i.__decorate([a.observable,i.__metadata(\"design:type\",Array)],f.prototype,\"selectedFacets\",void 0),i.__decorate([a.observable,i.__metadata(\"design:type\",Object)],f.prototype,\"pendingCalls\",void 0),i.__decorate([a.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],f.prototype,\"tableData\",null),f=i.__decorate([(0,r.customElement)(\"metrics-module\")],f),e.MetricsModule=f},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`.checkbox-holder {\n  display: flex;\n  justify-content: space-between;\n  margin-right: 4pt;\n}\n\n.cb-label {\n  margin: 4pt;\n}\n`},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.MultilabelModule=void 0;const i=n(1);n(74);const r=n(2),o=n(3),a=n(4),s=n(15),c=n(12);n(40);const l=n(5),d=n(8),u=n(11),h=n(156),p=n(7);let f=class extends c.LitModule{constructor(){super(...arguments),this.resultsInfo={},this.datapoints=[],this.groundTruthLabels=new Set,this.maxValues={}}static get styles(){return[p.styles,h.styles]}firstUpdated(){this.react(()=>this.selectionService.primarySelectedInputData,t=>{this.updateSelection()}),this.react(()=>this.appState.compareExamplesEnabled,t=>{this.updateSelection()}),this.updateSelection()}updateSelection(){return i.__awaiter(this,void 0,void 0,(function*(){if(null===this.selectionService.primarySelectedInputData)return void(this.resultsInfo={});const t=s.app.getServiceArray(u.SelectionService),e=[];for(const n of t){const t=n.primarySelectedInputData;if(null!=t&&e.push(t),!this.appState.compareExamplesEnabled)break}this.datapoints=e;const n=this.appState.currentModels,r=yield Promise.all(n.map(t=>i.__awaiter(this,void 0,void 0,(function*(){return this.apiService.getPreds(e,t,this.appState.currentDataset,[\"SparseMultilabelPreds\"])}))));if(null===r)return void(this.resultsInfo={});this.groundTruthLabels.clear();for(const t of n){const e=this.appState.currentModelSpecs[t].spec.output,n=(0,d.findSpecKeys)(e,\"SparseMultilabelPreds\");for(const t of n){const n=e[t].parent;null!=n&&this.groundTruthLabels.add(n)}}this.maxValues={};const o={};for(let t=0;t<r.length;t++)for(let e=0;e<r[t].length;e++)for(const i of Object.keys(r[t][e])){null==o[i]&&(o[i]={});const a=r[t][e][i];for(const s of a){const a=s[0],c=s[1];null==o[i][a]&&(o[i][a]={});let l=\"\"+n[t];r[t].length>1&&(l+=0===e?\" main\":\" reference\"),o[i][a][l]=c,null==this.maxValues[i]&&(this.maxValues[i]=0),c>this.maxValues[i]&&(this.maxValues[i]=c)}}this.resultsInfo=o}))}render(){const t=Object.keys(this.resultsInfo);return o.html`\n        <div class=\"top-holder\">\n          ${t.map(t=>this.renderTable(t,this.resultsInfo[t]))}\n        </div>\n    `}renderBar(t,e){return{template:o.html`\n          <score-bar score=${t} maxScore=${e}></score-bar>`,value:t}}renderTable(t,e){const n=[t+\" class\"];for(let t=0;t<this.datapoints.length;t++)for(const e of this.groundTruthLabels){let i=e;this.datapoints.length>1&&(i+=0===t?\" main\":\" reference\"),n.push(i)}const i=new Set;for(const t of Object.values(e))for(const e of Object.keys(t))i.add(e);const r=Array.from(i.values());for(let t=0;t<r.length;t++){const e=r[t];n.push(e),t>0&&n.push(e+\" \")}const a=Math.ceil(this.maxValues[t]),s=Object.keys(e).map(t=>{const n=[t];for(let e=0;e<this.datapoints.length;e++){const i=this.datapoints[e];for(const e of this.groundTruthLabels.keys())n.push((0,l.formatBoolean)(i.data[e]===t))}let i=0;for(let o=0;o<r.length;o++){const s=r[o],c=null==e[t][s]?0:e[t][s];if(n.push(this.renderBar(c,a)),0===o)i=c;else{const t=c-i;n.push(t.toFixed(3))}}return n});return o.html`\n        <div class=\"table-holder\">\n          <lit-data-table\n            .columnNames=${n}\n            .data=${s}\n          ></lit-data-table>\n        </div>`}static shouldDisplayModule(t,e){return(0,d.doesOutputSpecContain)(t,\"SparseMultilabelPreds\")}};f.title=\"Multilabel Results\",f.duplicateForModelComparison=!1,f.numCols=3,f.template=()=>o.html`<multilabel-module></multilabel-module>`,i.__decorate([a.observable,i.__metadata(\"design:type\",Object)],f.prototype,\"resultsInfo\",void 0),f=i.__decorate([(0,r.customElement)(\"multilabel-module\")],f),e.MultilabelModule=f},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`.top-holder {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n\n.table-holder {\n  flex: 1 1 0%;\n  overflow-y: auto;\n}\n`},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.PdpModule=void 0;const i=n(1);n(158),n(160);const r=n(2),o=n(3),a=n(192),s=n(4),c=n(12);n(5);const l=n(8),d=n(162),u=n(7);let h=class extends c.LitModule{constructor(){super(...arguments),this.plotVisibility=new Map,this.plotInfo=new Map,this.selectionSet=new Set}static get styles(){return[u.styles,d.styles]}firstUpdated(){this.reactImmediately(()=>this.appState.getModelSpec(this.model).input,t=>{this.resetPlots(t)}),this.react(()=>this.selectionService.selectedInputData,()=>{this.selectionSet=new Set(this.selectionService.selectedInputData.map(t=>t.id)),this.plotInfo.clear();for(const t of this.plotVisibility.keys())this.plotVisibility.set(t,!1)})}resetPlots(t){return i.__awaiter(this,void 0,void 0,(function*(){this.plotVisibility.clear(),this.plotInfo.clear();const e=(0,l.findSpecKeys)(t,[\"Scalar\",\"CategoryLabel\"]);for(const n of e)t[n].required&&this.plotVisibility.set(n,!1)}))}calculatePlotInfo(t){return i.__awaiter(this,void 0,void 0,(function*(){const e={feature:t},n=this.selectionService.selectedInputData;return yield this.apiService.getInterpretations(n,this.model,this.appState.currentDataset,\"pdp\",e)}))}renderPlot(t){if(!this.plotVisibility.get(t))return null;const e=this.appState.getModelSpec(this.model),n=(0,l.isLitSubtype)(e.input[t],\"Scalar\"),r=(t,i)=>{const r=new Array;r.push(new Map);for(const e of Object.keys(t)){const i=t[e],o=n?+e:e;if(Array.isArray(i))for(let t=0;t<i.length;t++)r.length<=t&&r.push(new Map),r[t].set(o,i[t]);else r[0].set(o,i)}const a=e.output[i].null_idx,s=e.output[i].vocab,c=(0,l.isLitSubtype)(e.output[i],\"MulticlassPreds\")?[0,1]:[];return o.html`\n          <div class=\"charts-holder\">\n            ${r.map((t,e)=>{const i=null!=s&&s.length>e?s[e]:\"\";return null==a||a!==e?o.html`\n                    <div>\n                      <div class=\"chart-label\">${i}</div>\n                      ${(t=>n?o.html`\n              <line-chart height=150 width=300\n                  .scores=${t} .yScale=${c}>\n              </line-chart>`:o.html`\n              <bar-chart height=150 width=300\n                  .scores=${t} .yScale=${c}>\n              </bar-chart>`)(t)}\n                    </div>`:null})}\n          </div>`};return o.html`${(0,a.until)((t=>{const e=new Set(this.selectionSet);return new Promise((n,r)=>i.__awaiter(this,void 0,void 0,(function*(){if(null==this.plotInfo.get(t)){const n=yield this.calculatePlotInfo(t);(0,l.setEquals)(e,this.selectionSet)&&this.plotInfo.set(t,n)}n(this.plotInfo.get(t))})))})(t).then(t=>(t=>o.html`\n          <div class='pdp-background'>\n            ${Object.keys(t).map(e=>r(t[e],e))}\n          </div>`)(t)),o.html`\n          <div class='pdp-background'>\n            <lit-spinner size=${24} color=\"var(--app-secondary-color)\">\n            </lit-spinner>\n          </div>`)}`}renderPlotHolder(t){const e=this.plotVisibility.get(t);return o.html`\n        <div class='plot-holder'>\n          <div class='collapse-bar' @click=${()=>{const e=this.plotVisibility.get(t);this.plotVisibility.set(t,!e)}}>\n            <div class=\"pdp-title\">\n              <div>${t}</div>\n            </div>\n            <mwc-icon class=\"icon-button min-button\">\n              ${e?\"expand_less\":\"expand_more\"}\n            </mwc-icon>\n          </div>\n          ${this.renderPlot(t)}\n        </div>\n      `}render(){return o.html`${Array.from(this.plotVisibility.keys()).map(t=>this.renderPlotHolder(t))}`}static shouldDisplayModule(t,e){return(0,l.doesOutputSpecContain)(t,[\"RegressionScore\",\"MulticlassPreds\"])&&(0,l.doesInputSpecContain)(t,[\"Scalar\",\"CategoryLabel\"],!0)}};h.title=\"Partial Dependence Plots\",h.duplicateForExampleComparison=!0,h.numCols=4,h.template=(t=\"\",e=0)=>o.html`<pdp-module model=${t} selectionServiceIndex=${e}></pdp-module>`,i.__decorate([s.observable,i.__metadata(\"design:type\",Object)],h.prototype,\"plotVisibility\",void 0),i.__decorate([s.observable,i.__metadata(\"design:type\",Object)],h.prototype,\"plotInfo\",void 0),h=i.__decorate([(0,r.customElement)(\"pdp-module\")],h),e.PdpModule=h},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.LineChart=void 0;const i=n(1);n(31),n(42);const r=i.__importStar(n(21)),o=n(2),a=n(2),s=n(3),c=n(4),l=n(34),d=n(159),u=n(7);let h=class extends l.ReactiveElement{constructor(){super(...arguments),this.scores=new Map,this.margin=30,this.width=0,this.height=0,this.yScale=[]}static get styles(){return[u.styles,d.styles]}firstUpdated(){this.initializeChart();this.reactImmediately(()=>this.scores,t=>{this.initializeChart()})}getXScale(){const t=Array.from(this.scores.keys());return r.scaleLinear().domain([r.min(t),r.max(t)]).range([0,this.width])}getYScale(){let t=this.yScale;if(null==t||t.length<2){const e=Array.from(this.scores.values());t=[r.min(e),r.max(e)]}return r.scaleLinear().domain(t).range([this.height,0])}initializeChart(){const t=this.shadowRoot.querySelector(\"#chart\");if(null==t)return;const e=r.select(t).attr(\"width\",this.width+2*this.margin).attr(\"height\",this.height+2*this.margin);e.selectAll(\"*\").remove(),e.append(\"g\").attr(\"id\",\"chart-group\").attr(\"transform\",`translate(${this.margin}, ${this.margin})`),this.renderChart()}renderChart(){const t=Array.from(this.scores.entries()),e=this.getXScale(),n=this.getYScale(),i=this.shadowRoot.querySelector(\"#chart-group\");if(null==i)return;const o=r.select(i);o.selectAll(\"*\").remove();const a=r.axisBottom(e),s=r.axisLeft(n).ticks(5);o.append(\"g\").attr(\"transform\",`translate(0, ${this.height})`).attr(\"class\",\"axis\").call(a),o.append(\"g\").attr(\"class\",\"axis\").call(s),o.append(\"path\").datum(t).attr(\"fill\",\"none\").attr(\"stroke\",\"var(--lit-cyea-400)\").attr(\"stroke-width\",1.5).attr(\"d\",r.line().x(t=>e(t[0])).y(t=>n(t[1])));const c=o.append(\"g\").attr(\"class\",\"focus\").style(\"display\",\"none\");c.append(\"circle\").attr(\"r\",4).attr(\"fill\",\"var(--lit-cyea-400)\").attr(\"stroke\",\"var(--lit-cyea-400)\");const l=()=>{console.log(r.mouse(this));const i=r.mouse(this)[0]-this.margin,o=e.invert(i),a=r.bisect(t.map(t=>t[0]),o);let s=t[a];if(a>0){const e=a-1;o-t[e][0]<t[a][0]-o&&(s=t[e])}c.attr(\"transform\",`translate(${e(s[0])},${n(s[1])})`);const l=`${s[0].toFixed(2)}, value: ${s[1].toFixed(2)}`,d=this.shadowRoot.querySelector(\"#tooltip\");d.innerText=l,d.style.visibility=\"visible\",d.style.left=e(s[0])+\"px\",d.style.top=n(s[1])+\"px\"};o.append(\"rect\").attr(\"class\",\"overlay\").attr(\"width\",this.width).attr(\"height\",this.height).attr(\"fill\",\"none\").attr(\"pointer-events\",\"visible\").on(\"mouseover\",()=>{c.style(\"display\",null)}).on(\"mouseout\",()=>{c.style(\"display\",\"none\");this.shadowRoot.querySelector(\"#tooltip\").style.visibility=\"hidden\"}).on(\"mousemove\",()=>{l()})}render(){return s.html`\n      <div id=\"holder\">\n          <svg id=\"chart\"></svg>\n          <div id='tooltip'>tooltip</div>\n      </div>\n    `}};i.__decorate([c.observable,(0,o.property)({type:Object}),i.__metadata(\"design:type\",Object)],h.prototype,\"scores\",void 0),i.__decorate([(0,o.property)({type:Number}),i.__metadata(\"design:type\",Object)],h.prototype,\"margin\",void 0),i.__decorate([(0,o.property)({type:Number}),i.__metadata(\"design:type\",Object)],h.prototype,\"width\",void 0),i.__decorate([(0,o.property)({type:Number}),i.__metadata(\"design:type\",Object)],h.prototype,\"height\",void 0),i.__decorate([(0,o.property)({type:Array}),i.__metadata(\"design:type\",Array)],h.prototype,\"yScale\",void 0),h=i.__decorate([(0,a.customElement)(\"line-chart\")],h),e.LineChart=h},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`#tooltip {\n  position: absolute;\n  padding: 5px;\n  margin: auto;\n  text-align: center;\n  font-size: 12px;\n  pointer-events: none;\n  visibility: hidden;\n  background: rgba(255, 255, 255, .5);\n  border-radius: 10px;\n}\n\n#holder {\n  position: relative;\n}\n`},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.BarChart=void 0;const i=n(1);n(31),n(42);const r=i.__importStar(n(21)),o=n(2),a=n(2),s=n(3),c=n(4),l=n(34),d=n(161),u=n(7);let h=class extends l.ReactiveElement{constructor(){super(...arguments),this.scores=new Map,this.margin=30,this.width=0,this.height=0,this.yScale=[]}static get styles(){return[u.styles,d.styles]}firstUpdated(){this.initializeChart();this.reactImmediately(()=>this.scores,t=>{this.initializeChart()})}getXScale(){const t=Array.from(this.scores.keys());return r.scaleBand().domain(t).range([0,this.width]).padding(.1)}getYScale(){let t=this.yScale;if(null==t||t.length<2){const e=Array.from(this.scores.values());t=[r.min(e),r.max(e)]}return r.scaleLinear().domain(t).range([this.height,0])}initializeChart(){const t=this.shadowRoot.querySelector(\"#chart\");if(null==t)return;const e=r.select(t).attr(\"width\",this.width+2*this.margin).attr(\"height\",this.height+2*this.margin);e.selectAll(\"*\").remove(),e.append(\"g\").attr(\"id\",\"chart-group\").attr(\"transform\",`translate(${this.margin}, ${this.margin})`),this.renderChart()}renderChart(){const t=Array.from(this.scores.entries()).map((t,e)=>({label:t[0],score:t[1]})),e=this.getXScale(),n=this.getYScale(),i=this.shadowRoot.querySelector(\"#chart-group\");if(null==i)return;const o=r.select(i);o.selectAll(\"*\").remove();const a=r.axisBottom(e).ticks(1),s=r.axisLeft(n).ticks(5);o.append(\"g\").attr(\"transform\",`translate(0, ${this.height})`).attr(\"class\",\"axis\").call(a).selectAll(\"text\").style(\"text-anchor\",\"end\").attr(\"transform\",\"rotate(-45)\").each((function(){const t=r.select(this);let e=t.node().getComputedTextLength(),n=t.text();for(;e>30&&n.length>0;)n=n.slice(0,-1),t.text(n+\"...\"),e=t.node().getComputedTextLength()})),o.append(\"g\").attr(\"class\",\"axis\").call(s),o.selectAll(\"rect\").data(t).enter().append(\"rect\").attr(\"width\",e.bandwidth()).style(\"fill\",\"var(--lit-cyea-400)\").attr(\"height\",t=>this.height-n(t.score)).attr(\"x\",t=>{const n=e(t.label);return null==n?0:n}).attr(\"y\",t=>n(t.score)).on(\"mouseover\",(t,e,n)=>{const i=n[e],r=`${t.label}, value: ${t.score.toFixed(2)}`;this.displayTooltip(r,i)}).on(\"mouseout\",(t,e,n)=>{this.hideTooltip()})}displayTooltip(t,e){const n=this.shadowRoot.querySelector(\"#tooltip\");n.innerText=t,n.style.visibility=\"visible\";const i=e.getBoundingClientRect();n.style.left=(i.left+i.right)/2+\"px\",n.style.top=i.top+\"px\"}hideTooltip(){this.shadowRoot.querySelector(\"#tooltip\").style.visibility=\"hidden\"}render(){return s.html`\n      <div id=\"holder\">\n          <svg id=\"chart\"></svg>\n          <div id='tooltip'>tooltip</div>\n      </div>\n    `}};i.__decorate([c.observable,(0,o.property)({type:Object}),i.__metadata(\"design:type\",Object)],h.prototype,\"scores\",void 0),i.__decorate([(0,o.property)({type:Number}),i.__metadata(\"design:type\",Object)],h.prototype,\"margin\",void 0),i.__decorate([(0,o.property)({type:Number}),i.__metadata(\"design:type\",Object)],h.prototype,\"width\",void 0),i.__decorate([(0,o.property)({type:Number}),i.__metadata(\"design:type\",Object)],h.prototype,\"height\",void 0),i.__decorate([(0,o.property)({type:Array}),i.__metadata(\"design:type\",Array)],h.prototype,\"yScale\",void 0),h=i.__decorate([(0,a.customElement)(\"bar-chart\")],h),e.BarChart=h},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`#tooltip {\n  position: fixed;\n  padding: 5px;\n  margin: auto;\n  text-align: center;\n  transform: translate(-50%, -22px);\n  font-size: 12px;\n  pointer-events: none;\n  visibility: hidden;\n  background: rgba(255, 255, 255, .5);\n  border-radius: 10px;\n}\n`},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`.collapse-bar {\n  width: 100%;\n  height: 30px;\n  cursor: pointer;\n  padding: 2px 8px;\n  width: 100%;\n  border: 1px solid rgb(232, 234, 237);\n  outline: none;\n  display: flex;\n  justify-content: space-between;\n  box-sizing: border-box;\n}\n\n.pdp-title {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  flex: 1;\n}\n\n.pdp-background {\n  background: rgb(248, 249, 250);\n  border: 1px solid rgb(232, 234, 237);\n  padding: 5px;\n}\n\n.charts-holder {\n  display: flex;\n  flex-wrap: wrap;\n}\n\n.chart-label {\n  width: 100%;\n  text-align: center;\n}\n`},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.RegressionModule=void 0;const i=n(1),r=n(2),o=n(3),a=n(4),s=n(15),c=n(12);n(40),n(5);const l=n(8),d=n(11),u=n(164),h=n(7);let p=class extends c.LitModule{constructor(){super(...arguments),this.regressionService=s.app.getService(d.RegressionService),this.result=null}static get styles(){return[h.styles,u.styles]}firstUpdated(){this.reactImmediately(()=>this.selectionService.primarySelectedInputData,t=>{this.updateSelection(t)})}updateSelection(t){return i.__awaiter(this,void 0,void 0,(function*(){if(null==t)return void(this.result=null);const e=this.appState.currentDataset,n=this.regressionService.getRegressionPreds([t],this.model,e),i=yield this.loadLatest(\"regressionPreds\",n);if(null===i||0===i.length)return void(this.result=null);const r=Object.keys(i[0]);for(const e of r){const n=(yield this.regressionService.getResults([t.id],this.model,e))[0];i[0][this.regressionService.getErrorKey(e)]=n.error}this.result=i[0]}))}render(){if(null==this.result)return null;const t=this.result,e=this.selectionService.primarySelectedInputData,n=this.appState.getModelSpec(this.model),i=(0,l.findSpecKeys)(n.output,\"RegressionScore\"),r=[];let a=!1;for(const o of i){const i=null==t[o]?\"\":t[o].toFixed(4),s=n.output[o].parent||\"\",c=null==e.data[s]?\"\":e.data[s].toFixed(4);let l=\"\";if(s&&c){const e=t[this.regressionService.getErrorKey(o)];null!=e&&(a=!0,l=e.toFixed(4))}r.push({Field:o,\"Ground truth\":c,Score:i,Error:l})}const s=a?[\"Field\",\"Ground truth\",\"Score\",\"Error\"]:[\"Field\",\"Score\"];return o.html`\n      <lit-data-table\n        .columnNames=${s}\n        .data=${r}\n      ></lit-data-table>`}static shouldDisplayModule(t,e){return(0,l.doesOutputSpecContain)(t,\"RegressionScore\")}};p.title=\"Regression Results\",p.duplicateForExampleComparison=!0,p.numCols=3,p.template=(t=\"\",e=0)=>o.html`<regression-module model=${t} selectionServiceIndex=${e}></regression-module>`,i.__decorate([a.observable,i.__metadata(\"design:type\",Object)],p.prototype,\"result\",void 0),p=i.__decorate([(0,r.customElement)(\"regression-module\")],p),e.RegressionModule=p},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`td {\n  padding-right: 4px;\n  text-align: left;\n}\n\nth {\n  text-align: left;\n}\n`},function(t,e,n){\"use strict\";var i;Object.defineProperty(e,\"__esModule\",{value:!0}),e.SalienceMapModule=void 0;const r=n(1);n(39),n(42);const o=n(2),a=n(3),s=n(13),c=n(17),l=n(4),d=n(15),u=n(12),h=n(52),p=n(5),f=n(8),m=n(56),g=n(11),v=n(75),y=n(7);let b=i=class extends u.LitModule{constructor(){super(...arguments),this.focusService=d.app.getService(m.FocusService),this.state={}}static get styles(){return[y.styles,v.styles]}shouldRunInterpreter(t){return this.state[t].autorun}firstUpdated(){const t=this.appState.metadata.interpreters,e=this.appState.metadata.models[this.model].interpreters,n={};for(const r of e){const e=(0,f.findSpecKeys)(t[r].metaSpec,i.salienceTypes);if(0===e.length)continue;const o=t[r].metaSpec[e[0]];n[r]={autorun:!!o.autorun,isLoading:!1,salience:{},cmap:o.signed?new h.SignedSalienceCmap(4):new h.UnsignedSalienceCmap(4)}}this.state=n,this.reactImmediately(()=>this.focusService.focusData,t=>{this.handleFocus(this.focusService.focusData)});for(const t of Object.keys(this.state)){const e=()=>this.selectionService.primarySelectedInputData;this.react(e,e=>{this.shouldRunInterpreter(t)?this.runInterpreter(t):this.state[t].salience={}});const n=()=>this.state[t].autorun;this.react(n,e=>{this.shouldRunInterpreter(t)&&this.runInterpreter(t)}),this.shouldRunInterpreter(t)&&this.runInterpreter(t)}}runInterpreter(t){return r.__awaiter(this,void 0,void 0,(function*(){const e=this.selectionService.primarySelectedInputData;if(null==e)return void(this.state[t].salience={});this.state[t].isLoading=!0;const n=this.apiService.getInterpretations([e],this.model,this.appState.currentDataset,t,this.state[t].config,\"Running \"+t),i=yield this.loadLatest(\"interpretations-\"+t,n);this.state[t].isLoading=!1,null!==i&&(this.state[t].salience=i[0])}))}handleFocus(t){this.shadowRoot.querySelectorAll(\".tokens-group\").forEach(e=>{const n=e.querySelector(\".salience-tooltip\");if(null==t||null==t.fieldName)n.style.visibility=\"hidden\";else if(t.datapointId===this.selectionService.primarySelectedInputData.id){e.querySelectorAll(`.salient-token[data-gradKey=\"${t.fieldName}\"]`).forEach((i,r)=>{const o=i;if(r!==t.subField)return;n.innerText=o.dataset.tooltip,n.style.visibility=\"visible\";const a=o.getBoundingClientRect(),s=e.getBoundingClientRect(),c=(a.left+a.right)/2-s.left,l=a.bottom-s.top;n.style.left=c+\"px\",n.style.top=l+\"px\"})}})}updated(){super.updated(),this.shadowRoot.querySelectorAll(\".tokens-group\").forEach(t=>{const e=t.querySelectorAll(\".salient-token\"),n=this;e.forEach((t,e)=>{t.onmouseover=function(){n.focusService.setFocusedField(n.selectionService.primarySelectedInputData.id,\"input\",this.dataset.gradkey,e)},t.onmouseout=function(){n.focusService.clearFocus()}})})}renderToken(t,e,n,i){const r=(0,c.styleMap)({color:n.textCmap(e),\"background-color\":n.bgCmap(e)});return null!=i?a.html`\n        <div class=\"salient-token\" style=${r}\n          data-tooltip=${e.toPrecision(3)} data-gradkey=${i}>\n          ${t}\n        </div>`:a.html`\n        <div class=\"salient-token\" style=${r}\n          data-tooltip=${e.toPrecision(3)}>\n          ${t}\n        </div>`}renderImage(t,e){const n=t[e];return a.html`<img src='${n}'></img>`}renderTokens(t,e,n){const i=t[e].tokens,r=t[e].salience,o=i.map((t,i)=>this.renderToken(t,r[i],n,e));return a.html`\n      <div class=\"tokens-group\">\n        <div class=\"tokens-group-title\">\n          ${e}\n        </div>\n        <div class=\"tokens-holder\">\n          ${o}\n        </div>\n        <div class=\"salience-tooltip\">\n        </div>\n      </div>\n    `}renderFeatureSalience(t,e,n){const i=t[e].salience,r=Object.keys(i).sort((t,e)=>i[e]-i[t]).map(t=>{const r=`${t}: ${this.selectionService.primarySelectedInputData.data[t]}`;return this.renderToken(r,i[t],n,e)});return a.html`\n      <div class=\"tokens-group\">\n        <div class=\"tokens-group-title\">\n          ${e}\n        </div>\n        <div class=\"tokens-holder\">\n          ${r}\n        </div>\n        <div class=\"salience-tooltip\">\n        </div>\n      </div>\n    `}renderGroup(t,e,n){const i=this.appState.getModelSpec(this.model);return(0,f.isLitSubtype)(i.output[e],\"ImageGradients\")?(t=t,this.renderImage(t,e)):(0,f.isLitSubtype)(i.output[e],\"FeatureSalience\")?(t=t,this.renderFeatureSalience(t,e,n)):(t=t,this.renderTokens(t,e,n))}renderSpinner(){return a.html`\n      <div class=\"spinner-container\">\n        <lit-spinner size=${24} color=\"var(--app-secondary-color)\">\n        </lit-spinner>\n      </div>\n    `}renderControls(){return Object.keys(this.state).map(t=>a.html`\n        <lit-checkbox label=${t}\n         ?checked=${this.state[t].autorun}\n         @change=${()=>{this.state[t].autorun=!this.state[t].autorun}}>\n        </lit-checkbox>\n      `)}renderTable(){const t=t=>{const e=t.detail.name;this.state[e].config=t.detail.settings,this.runInterpreter(e)},e=e=>{const n=this.appState.metadata.interpreters[e].configSpec,i=JSON.parse(JSON.stringify(n));for(const t of Object.keys(i))(0,f.isLitSubtype)(i[t],[\"FieldMatcher\",\"MultiFieldMatcher\"])&&(i[t].vocab=this.appState.getSpecKeysFromFieldMatcher(i[t],this.model));return a.html`\n          <lit-interpreter-controls\n            .spec=${i}\n            .name=${e}\n            @interpreter-click=${t}>\n          </lit-interpreter-controls>`};return a.html`\n      <table>\n        ${Object.keys(this.state).map(t=>{if(!this.state[t].autorun)return null;const n=this.state[t].salience,i=this.appState.metadata.interpreters[t].description||t;return a.html`\n            <tr class='method-row'>\n              <th class='group-label' title=${i}>\n                ${e(t)}\n              </th>\n              <td class=${(0,s.classMap)({\"group-container\":!0,loading:this.state[t].isLoading})}>\n                ${Object.keys(n).map(e=>this.renderGroup(n,e,this.state[t].cmap))}\n                ${this.state[t].isLoading?this.renderSpinner():null}\n              </td>\n            </tr>\n          `})}\n      </table>\n    `}render(){return a.html`\n      <div class='module-container'>\n        <div class='module-toolbar'>\n          ${this.renderControls()}\n        </div>\n        <div class='module-results-area ${p.SCROLL_SYNC_CSS_CLASS}'>\n          ${this.renderTable()}\n        </div>\n      </div>\n    `}static shouldDisplayModule(t,e){const n=d.app.getService(g.AppState);for(const e of Object.values(t))for(let t=0;t<e.interpreters.length;t++){const r=e.interpreters[t];if(null==n.metadata)return!1;const o=n.metadata.interpreters[r];if(0!==(0,f.findSpecKeys)(o.metaSpec,i.salienceTypes).length)return!0}return!1}};b.title=\"Salience Maps\",b.numCols=6,b.duplicateForExampleComparison=!0,b.template=(t=\"\",e=0)=>a.html`<salience-map-module model=${t} selectionServiceIndex=${e}></salience-map-module>`,b.salienceTypes=[\"TokenSalience\",\"ImageSalience\",\"FeatureSalience\"],r.__decorate([l.observable,r.__metadata(\"design:type\",Object)],b.prototype,\"state\",void 0),b=i=r.__decorate([(0,o.customElement)(\"salience-map-module\")],b),e.SalienceMapModule=b},function(t,e,n){\"use strict\";var i;Object.defineProperty(e,\"__esModule\",{value:!0}),e.ScalarModule=e.MAX_DEFAULT_PLOTS=void 0;const r=n(1),o=r.__importStar(n(21)),a=n(2),s=n(3),c=n(4),l=n(167),d=n(15),u=n(12),h=n(5),p=n(8);n(56);const f=n(11),m=n(176),g=n(7);e.MAX_DEFAULT_PLOTS=2;let v=i=class extends u.LitModule{constructor(){super(...arguments),this.colorService=d.app.getService(f.ColorService),this.classificationService=d.app.getService(f.ClassificationService),this.groupService=d.app.getService(f.GroupService),this.regressionService=d.app.getService(f.RegressionService),this.focusService=d.app.getService(f.FocusService),this.inputIDToIndex=new Map,this.numPlotsRendered=0,this.brushObjects=[],this.isPlotHidden=new Map,this.preds=[],this.plotWidth=i.maxPlotWidth,this.plotHeight=i.minPlotHeight,this.plotTranslation=`translate(${i.plotLeftMargin},${i.plotTopMargin})`}static get styles(){return[g.styles,m.styles]}get inputKeys(){return this.groupService.numericalFeatureNames}get scalarKeys(){const t=this.appState.currentModelSpecs[this.model].spec.output;return(0,p.findSpecKeys)(t,\"Scalar\")}get classificationKeys(){const t=this.appState.currentModelSpecs[this.model].spec.output;return(0,p.findSpecKeys)(t,\"MulticlassPreds\")}firstUpdated(){const t=this.appState.getModelSpec(this.model);this.classificationKeys.forEach(e=>{const n=t.output[e];null!=n.null_idx&&null!=n.vocab&&this.classificationService.setMargin(this.model,e,0)}),this.makePlot();this.reactImmediately(()=>this.appState.currentInputData,t=>{null!=t&&this.updatePredictions(t)});this.reactImmediately(()=>this.selectionService.selectedInputData,t=>{null!=t&&(this.clearBrushes(),this.updateGeneralSelection(t))});this.reactImmediately(()=>this.selectionService.primarySelectedInputData,t=>{this.updatePrimarySelection(t)});this.reactImmediately(()=>this.classificationService.allMarginSettings,t=>{this.updateThreshold(),this.updateColors()});this.reactImmediately(()=>this.colorService.selectedColorOption,t=>{this.updateColors()}),this.react(()=>this.focusService.focusData,t=>{this.updateHoveredPoint(t)});const e=this.shadowRoot.getElementById(\"container\");this.resizeObserver=new ResizeObserver(()=>{this.resize()}),this.resizeObserver.observe(e)}resize(){this.makePlot(),this.updatePlotData()}clearBrushes(){for(const t of this.brushObjects)t.selection.call(t.brush.move,null)}updateColors(){const t=this.shadowRoot.querySelectorAll(\".scatterplot\");for(const e of Array.from(t)){const t=e;this.updateAllScatterplotColors(t)}}updateGeneralSelection(t){this.updateCallouts(t,\"#overlay\",\"selected-point\",!0)}updatePrimarySelection(t){const e=[];null!==t&&e.push(t),this.updateCallouts(e,\"#primaryOverlay\",\"primary-selected-point\",!0)}updateHoveredPoint(t){let e=[];null!==t&&(e=this.appState.getExamplesById([t.datapointId])),this.updateCallouts(e,\"#hoverOverlay\",\"hovered-point\",!1)}updateCallouts(t,e,n,i){const r=this.shadowRoot.querySelectorAll(\".scatterplot\");for(const a of Array.from(r)){const r=a,s=o.select(r).select(\"#dataPoints\").selectAll(\"circle\"),c=t.map(t=>this.inputIDToIndex.get(t.id)),l=[];s.each((t,e,n)=>{if(c.includes(e)){const t=o.select(n[e]).attr(\"cx\"),i=o.select(n[e]).attr(\"cy\"),r=o.select(n[e]).style(\"fill\"),a=o.select(n[e]).attr(\"data-id\");l.push([t,i,r,a])}});const d=o.select(r).select(e);d.selectAll(\"circle\").remove();const u=d.selectAll(\"circle\").data(l).enter().append(\"circle\");u.attr(\"cx\",t=>+t[0]).attr(\"cy\",t=>+t[1]).classed(n,!0).style(\"fill\",t=>t[2]),i?u.on(\"mouseenter\",(t,e,n)=>{this.focusService.setFocusedDatapoint(t[3])}):u.on(\"click\",(t,e,n)=>{this.selectionService.setPrimarySelection(t[3])})}}updatePredictions(t){return r.__awaiter(this,void 0,void 0,(function*(){if(null==t)return;const e=this.appState.currentDataset,n=Promise.all([this.classificationService.getClassificationPreds(t,this.model,e),this.regressionService.getRegressionPreds(t,this.model,e),this.apiService.getPreds(t,this.model,e,[\"Scalar\"])]),i=yield this.loadLatest(\"predictionScores\",n);if(null===i)return;const r=i[0],o=i[1],a=i[2];if(null==r&&null==o&&null==a)return;const s=[];for(let e=0;e<r.length;e++){const n=t[e].id,i=Object.assign({},r[e],a[e],o[e],{id:n});for(const n of this.inputKeys)i[n]=t[e].data[n];s.push(i)}if(null!=o&&o.length){const e=t.map(t=>t.id),n=Object.keys(o[0]);for(let t=0;t<n.length;t++){const i=yield this.regressionService.getResults(e,this.model,n[t]);for(let e=0;e<s.length;e++)s[e][this.regressionService.getErrorKey(n[t])]=i[e].error}}this.preds=s,this.updatePlotData()}))}getXScale(t){var e;let n=[0,1];const r=null===(e=this.appState.currentModelSpecs[this.model])||void 0===e?void 0:e.spec.output;if(null!=r&&(0,p.isLitSubtype)(r[t],\"Scalar\")){const e=this.preds.map(e=>e[t]);n=[Math.min(...e),Math.max(...e)],n[0]===n[1]&&(n[0]=n[0]-.1,n[1]=n[1]+.1)}else-1!==this.inputKeys.indexOf(t)&&(n=this.groupService.numericalFeatureRanges[t]);return o.scaleLinear().domain(n).range([0,this.plotWidth-1.5*i.plotLeftMargin])}getYScale(t){var e;let n=[0,1];const r=null===(e=this.appState.currentModelSpecs[this.model])||void 0===e?void 0:e.spec.output;if(null!=r&&(0,p.isLitSubtype)(r[t],\"Scalar\")){const e=this.regressionService.ranges[`${this.model}:${t}`];null==e||isNaN(e.error[0])||isNaN(e.error[1])||(n=e.error)}return o.scaleLinear().domain(n).range([this.plotHeight-i.plotBottomMargin-i.plotTopMargin,i.plotTopMargin])}getValue(t,e,n,i){if((0,p.isLitSubtype)(e.output[n],\"MulticlassPreds\")){const r=e.output[n].vocab.indexOf(i);return t[n][r]}return t[n]}updateThreshold(){const t=this.classificationService.marginSettings[this.model]||{},e=this.shadowRoot.querySelectorAll(\".scatterplot\");for(const n of Array.from(e)){const e=n,i=n.dataset.key;if(null==i||-1!==this.inputKeys.indexOf(i))return;const r=this.appState.getModelSpec(this.model),a=r.output[i].vocab;if((0,p.isLitSubtype)(r.output[i],\"Scalar\")||2!==a.length)continue;if(null==t[i]||null==t[i][\"\"])continue;const s=(0,p.getThresholdFromMargin)(t[i][\"\"].margin),c=o.select(e).select(\"#threshold\");c.selectAll(\"line\").remove();const l=this.getXScale(i)(s),[d,u]=this.getYScale(i).range();c.append(\"line\").attr(\"x1\",l).attr(\"y1\",d).attr(\"x2\",l).attr(\"y2\",u).style(\"stroke\",\"black\")}}updateAllScatterplotColors(t){this.updateScatterplotColors(t,\"#dataPoints\"),this.updateScatterplotColors(t,\"#overlay\"),this.updateScatterplotColors(t,\"#primaryOverlay\")}updateScatterplotColors(t,e){o.select(t).select(e).selectAll(\"circle\").style(\"fill\",(t,e,n)=>{const i=Array.isArray(t)?t[t.length-1]:o.select(n[e]).attr(\"data-id\"),r=this.appState.getCurrentInputDataById(i);return this.colorService.getDatapointColor(r)})}makePlot(){const t=this.shadowRoot.getElementById(\"container\");if(!t.offsetHeight||!t.offsetWidth)return;const e=Array.from(this.shadowRoot.querySelectorAll(\".scatterplot\"));if(e.length){this.plotWidth=t.offsetWidth-1.5*i.plotLeftMargin,this.plotHeight=100;for(const t of Array.from(e)){if(null==t.dataset.key)continue;const e=t;o.select(e).attr(\"width\",this.plotWidth).attr(\"height\",this.plotHeight).selectAll(\"*\").remove(),o.select(e).append(\"g\").attr(\"id\",\"threshold\").attr(\"transform\",this.plotTranslation),this.updateThreshold(),o.select(e).append(\"g\").attr(\"id\",\"dataPoints\").attr(\"transform\",this.plotTranslation),o.select(e).append(\"g\").attr(\"id\",\"overlay\").attr(\"transform\",this.plotTranslation),o.select(e).append(\"g\").attr(\"id\",\"primaryOverlay\").attr(\"transform\",this.plotTranslation),o.select(e).append(\"g\").attr(\"id\",\"hoverOverlay\").attr(\"transform\",this.plotTranslation),this.updateAllScatterplotColors(e)}}}updatePlotData(){const t=this.shadowRoot.querySelectorAll(\".scatterplot\");for(const e of Array.from(t)){const t=e.dataset.key,n=e.dataset.label;if(null==t||null==n)return;const r=this.appState.getModelSpec(this.model),a=(0,p.isLitSubtype)(r.output[t],\"Scalar\"),s=this.regressionService.ranges[`${this.model}:${t}`],c=null!=s&&!isNaN(s.error[0])&&!isNaN(s.error[1]),d=e,u=o.select(d);o.select(d).select(\"#xAxis\").remove(),o.select(d).select(\"#yAxis\").remove(),o.select(d).select(\"#brushGroup\").remove();const h=this.getXScale(t),f=this.getYScale(t),m=this.plotHeight-i.plotBottomMargin,g=`translate(${i.plotLeftMargin},${m})`;o.select(d).append(\"g\").attr(\"id\",\"xAxis\").attr(\"transform\",g).call(o.axisBottom(h));const v=o.axisLeft(f);let y=0;if(a&&c&&(y=5),v.ticks(y),o.select(d).append(\"g\").attr(\"id\",\"yAxis\").attr(\"transform\",this.plotTranslation).call(v),a&&c){const t=i.plotTopMargin+this.plotHeight/2+i.yLabelOffsetY;o.select(d).append(\"text\").attr(\"transform\",`translate(0,${t}) rotate(270)`).style(\"text-anchor\",\"middle\").text(\"error\")}if(a&&c){const e=this.regressionService.ranges[`${this.model}:${t}`].error;if(e[0]<0&&e[1]>0){const t=(this.plotHeight-i.plotBottomMargin)/2+i.plotTopMargin;o.select(d).append(\"line\").attr(\"x1\",i.plotLeftMargin).attr(\"y1\",t).attr(\"x2\",h.range()[1]+i.plotLeftMargin).attr(\"y2\",t).style(\"stroke\",i.zeroLineColor)}}const b=a&&c?o.brush():o.brushX();b.extent([[0,i.plotTopMargin],[this.plotWidth-i.plotLeftMargin,this.plotHeight-i.plotBottomMargin]]).on(\"start end\",()=>{o.event.sourceEvent&&this.selectBrushedPoints(d)});const _=u.append(\"g\").attr(\"id\",\"brushGroup\").attr(\"transform\",`translate(${i.plotLeftMargin},0)`).on(\"mouseenter\",()=>{this.focusService.clearFocus()}).call(b);this.brushObjects.push({brush:b,selection:_});const x=o.select(d).select(\"#dataPoints\");x.selectAll(\"circle\").remove(),x.raise(),o.select(d).select(\"#overlay\").raise(),o.select(d).select(\"#primaryOverlay\").raise(),o.select(d).select(\"#hoverOverlay\").raise();const w=x.selectAll(\"circle\").data(this.preds).enter().append(\"circle\"),S=l(\"lit\");w.attr(\"cx\",e=>h(this.getValue(e,r,t,n))).attr(\"cy\",e=>(0,p.isLitSubtype)(r.output[t],\"Scalar\")&&c?f(e[this.regressionService.getErrorKey(t)]):f(S())).style(\"fill\",t=>{const e=this.appState.getCurrentInputDataById(t.id);return this.colorService.getDatapointColor(e)}).classed(\"point\",!0).on(\"mouseenter\",t=>{this.focusService.setFocusedDatapoint(t.id)}).each((t,e,n)=>{this.inputIDToIndex.set(t.id,e),o.select(n[e]).attr(\"data-id\",t.id)})}this.updateGeneralSelection(this.selectionService.selectedInputData),this.updatePrimarySelection(this.selectionService.primarySelectedInputData)}selectBrushedPoints(t){const e=o.event.selection;if(null!=e&&e.length>0){const n=[],i=\"number\"!=typeof e[0],r=i?[e[0][0],e[1][0]]:e,a=i?[e[0][1],e[1][1]]:null;o.select(t).select(\"#dataPoints\").selectAll(\"circle\").each((t,e,s)=>{const c=+o.select(s[e]).attr(\"cx\");if(c<r[0]||c>r[1])return;if(i&&null!=a){const t=+o.select(s[e]).attr(\"cy\");if(t<a[0]||t>a[1])return}const l=o.select(s[e]).attr(\"data-id\");n.push(l)}),this.selectionService.selectIds(n)}}render(){return this.numPlotsRendered=0,s.html`\n      <div id='container'>\n        ${this.scalarKeys.map(t=>this.renderPlot(t,\"\"))}\n        ${this.classificationKeys.map(t=>this.renderClassificationGroup(t))}\n        ${this.inputKeys.map(t=>this.renderPlot(t,\"\"))}\n      </div>\n    `}renderClassificationGroup(t){const e=this.appState.getModelSpec(this.model),n=e.output[t].vocab,i=e.output[t].null_idx;return 2===n.length&&null!=i?s.html`${this.renderPlot(t,n[1-i])}`:s.html`\n        ${null!=n&&null!=i?this.renderMarginSlider(t):null}\n        ${n.map(e=>this.renderPlot(t,e))}`}renderPlot(t,n){const i=this.numPlotsRendered>e.MAX_DEFAULT_PLOTS-1;this.numPlotsRendered++;const r=n?`${t}:${n}`:t;let o=\"\";if(null!=this.selectionService.primarySelectedId){const e=this.appState.getIndexById(this.selectionService.primarySelectedId);if(null!=e&&e<this.preds.length&&null!=this.preds[e]){const i=this.appState.getModelSpec(this.model);o=\"Value: \"+(0,h.formatForDisplay)(this.getValue(this.preds[e],i,t,n))}}const a=null==this.isPlotHidden.get(r)?i:this.isPlotHidden.get(r);return s.html`\n        <div class='plot-holder'>\n          <div class='collapse-bar' @click=${()=>{const t=null==this.isPlotHidden.get(r)?i:this.isPlotHidden.get(r);this.isPlotHidden.set(r,!t)}}>\n            <div class=\"axis-title\">\n              <div>${r}</div>\n              <div class=\"selected-value\">${o}</div>\n            </div>\n            <mwc-icon class=\"icon-button min-button\">\n              ${a?\"expand_more\":\"expand_less\"}\n            </mwc-icon>\n          </div>\n          ${a?null:s.html`\n            <div class='scatterplot-background'>\n              ${s.svg`<svg class='scatterplot' data-key='${t}'\n                  data-label='${n}'>\n                </svg>`}\n            </div>`}\n        </div>\n      `}renderMarginSlider(t){const e=this.classificationService.getMargin(this.model,t);return s.html`<threshold-slider .margin=${e} label=${t}\n                  ?isThreshold=${!1} ?showControls=${!0}\n                  @threshold-changed=${e=>{this.classificationService.setMargin(this.model,t,e.detail.margin)}}>\n                </threshold-slider>`}static shouldDisplayModule(t,e){return(0,p.doesOutputSpecContain)(t,[\"Scalar\",\"MulticlassPreds\"])}};v.title=\"Scalars\",v.numCols=4,v.template=(t=\"\")=>s.html`\n      <scalar-module model=${t}>\n      </scalar-module>`,v.maxPlotWidth=900,v.minPlotHeight=100,v.maxPlotHeight=220,v.plotTopMargin=6,v.plotBottomMargin=20,v.plotLeftMargin=32,v.xLabelOffsetY=30,v.yLabelOffsetY=-25,v.zeroLineColor=\"#cccccc\",r.__decorate([c.observable,r.__metadata(\"design:type\",Object)],v.prototype,\"isPlotHidden\",void 0),r.__decorate([c.observable,r.__metadata(\"design:type\",Array)],v.prototype,\"preds\",void 0),r.__decorate([c.observable,r.__metadata(\"design:type\",Object)],v.prototype,\"plotWidth\",void 0),r.__decorate([c.observable,r.__metadata(\"design:type\",Object)],v.prototype,\"plotHeight\",void 0),r.__decorate([c.computed,r.__metadata(\"design:type\",Object),r.__metadata(\"design:paramtypes\",[])],v.prototype,\"inputKeys\",null),r.__decorate([c.computed,r.__metadata(\"design:type\",Object),r.__metadata(\"design:paramtypes\",[])],v.prototype,\"scalarKeys\",null),r.__decorate([c.computed,r.__metadata(\"design:type\",Object),r.__metadata(\"design:paramtypes\",[])],v.prototype,\"classificationKeys\",null),v=i=r.__decorate([(0,a.customElement)(\"scalar-module\")],v),e.ScalarModule=v},function(t,e,n){var i=n(168),r=n(169),o=n(170),a=n(171),s=n(172),c=n(173),l=n(174);l.alea=i,l.xor128=r,l.xorwow=o,l.xorshift7=a,l.xor4096=s,l.tychei=c,t.exports=l},function(t,e,n){(function(t){var i;!function(t,r,o){function a(t){var e,n=this,i=(e=4022871197,function(t){t=String(t);for(var n=0;n<t.length;n++){var i=.02519603282416938*(e+=t.charCodeAt(n));i-=e=i>>>0,e=(i*=e)>>>0,e+=4294967296*(i-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=i(\" \"),n.s1=i(\" \"),n.s2=i(\" \"),n.s0-=i(t),n.s0<0&&(n.s0+=1),n.s1-=i(t),n.s1<0&&(n.s1+=1),n.s2-=i(t),n.s2<0&&(n.s2+=1),i=null}function s(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function c(t,e){var n=new a(t),i=e&&e.state,r=n.next;return r.int32=function(){return 4294967296*n.next()|0},r.double=function(){return r()+11102230246251565e-32*(2097152*r()|0)},r.quick=r,i&&(\"object\"==typeof i&&s(i,n),r.state=function(){return s(n,{})}),r}r&&r.exports?r.exports=c:n(30)&&n(47)?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.alea=c}(0,t,n(30))}).call(this,n(46)(t))},function(t,e,n){(function(t){var i;!function(t,r,o){function a(t){var e=this,n=\"\";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var i=0;i<n.length+64;i++)e.x^=0|n.charCodeAt(i),e.next()}function s(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function c(t,e){var n=new a(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&(\"object\"==typeof i&&s(i,n),r.state=function(){return s(n,{})}),r}r&&r.exports?r.exports=c:n(30)&&n(47)?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.xor128=c}(0,t,n(30))}).call(this,n(46)(t))},function(t,e,n){(function(t){var i;!function(t,r,o){function a(t){var e=this,n=\"\";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var i=0;i<n.length+64;i++)e.x^=0|n.charCodeAt(i),i==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function s(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function c(t,e){var n=new a(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&(\"object\"==typeof i&&s(i,n),r.state=function(){return s(n,{})}),r}r&&r.exports?r.exports=c:n(30)&&n(47)?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.xorwow=c}(0,t,n(30))}).call(this,n(46)(t))},function(t,e,n){(function(t){var i;!function(t,r,o){function a(t){var e=this;e.next=function(){var t,n,i=e.x,r=e.i;return t=i[r],n=(t^=t>>>7)^t<<24,n^=(t=i[r+1&7])^t>>>10,n^=(t=i[r+3&7])^t>>>3,n^=(t=i[r+4&7])^t<<7,t=i[r+7&7],n^=(t^=t<<13)^t<<9,i[r]=n,e.i=r+1&7,n},function(t,e){var n,i=[];if(e===(0|e))i[0]=e;else for(e=\"\"+e,n=0;n<e.length;++n)i[7&n]=i[7&n]<<15^e.charCodeAt(n)+i[n+1&7]<<13;for(;i.length<8;)i.push(0);for(n=0;n<8&&0===i[n];++n);for(8==n?i[7]=-1:i[n],t.x=i,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function s(t,e){return e.x=t.x.slice(),e.i=t.i,e}function c(t,e){null==t&&(t=+new Date);var n=new a(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&(i.x&&s(i,n),r.state=function(){return s(n,{})}),r}r&&r.exports?r.exports=c:n(30)&&n(47)?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.xorshift7=c}(0,t,n(30))}).call(this,n(46)(t))},function(t,e,n){(function(t){var i;!function(t,r,o){function a(t){var e=this;e.next=function(){var t,n,i=e.w,r=e.X,o=e.i;return e.w=i=i+1640531527|0,n=r[o+34&127],t=r[o=o+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=r[o]=n^t,e.i=o,n+(i^i>>>16)|0},function(t,e){var n,i,r,o,a,s=[],c=128;for(e===(0|e)?(i=e,e=null):(e+=\"\\0\",i=0,c=Math.max(c,e.length)),r=0,o=-32;o<c;++o)e&&(i^=e.charCodeAt((o+32)%e.length)),0===o&&(a=i),i^=i<<10,i^=i>>>15,i^=i<<4,i^=i>>>13,o>=0&&(a=a+1640531527|0,r=0==(n=s[127&o]^=i+a)?r+1:0);for(r>=128&&(s[127&(e&&e.length||0)]=-1),r=127,o=512;o>0;--o)i=s[r+34&127],n=s[r=r+1&127],i^=i<<13,n^=n<<17,i^=i>>>15,n^=n>>>12,s[r]=i^n;t.w=a,t.X=s,t.i=r}(e,t)}function s(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function c(t,e){null==t&&(t=+new Date);var n=new a(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&(i.X&&s(i,n),r.state=function(){return s(n,{})}),r}r&&r.exports?r.exports=c:n(30)&&n(47)?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.xor4096=c}(0,t,n(30))}).call(this,n(46)(t))},function(t,e,n){(function(t){var i;!function(t,r,o){function a(t){var e=this,n=\"\";e.next=function(){var t=e.b,n=e.c,i=e.d,r=e.a;return t=t<<25^t>>>7^n,n=n-i|0,i=i<<24^i>>>8^r,r=r-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-i|0,e.d=i<<16^n>>>16^r,e.a=r-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var i=0;i<n.length+20;i++)e.b^=0|n.charCodeAt(i),e.next()}function s(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function c(t,e){var n=new a(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&(\"object\"==typeof i&&s(i,n),r.state=function(){return s(n,{})}),r}r&&r.exports?r.exports=c:n(30)&&n(47)?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.tychei=c}(0,t,n(30))}).call(this,n(46)(t))},function(t,e,n){var i;!function(r,o,a){var s,c=a.pow(256,6),l=a.pow(2,52),d=2*l;function u(t,e,n){var i=[],u=f(function t(e,n){var i,r=[],o=typeof e;if(n&&\"object\"==o)for(i in e)try{r.push(t(e[i],n-1))}catch(t){}return r.length?r:\"string\"==o?e:e+\"\\0\"}((e=1==e?{entropy:!0}:e||{}).entropy?[t,m(o)]:null==t?function(){try{var t;return s&&(t=s.randomBytes)?t=t(256):(t=new Uint8Array(256),(r.crypto||r.msCrypto).getRandomValues(t)),m(t)}catch(t){var e=r.navigator,n=e&&e.plugins;return[+new Date,r,n,r.screen,m(o)]}}():t,3),i),g=new h(i),v=function(){for(var t=g.g(6),e=c,n=0;t<l;)t=256*(t+n),e*=256,n=g.g(1);for(;t>=d;)t/=2,e/=2,n>>>=1;return(t+n)/e};return v.int32=function(){return 0|g.g(4)},v.quick=function(){return g.g(4)/4294967296},v.double=v,f(m(g.S),o),(e.pass||n||function(t,e,n,i){return i&&(i.S&&p(i,g),t.state=function(){return p(g,{})}),n?(a.random=t,e):t})(v,u,\"global\"in e?e.global:this==a,e.state)}function h(t){var e,n=t.length,i=this,r=0,o=i.i=i.j=0,a=i.S=[];for(n||(t=[n++]);r<256;)a[r]=r++;for(r=0;r<256;r++)a[r]=a[o=255&o+t[r%n]+(e=a[r])],a[o]=e;(i.g=function(t){for(var e,n=0,r=i.i,o=i.j,a=i.S;t--;)e=a[r=255&r+1],n=256*n+a[255&(a[r]=a[o=255&o+e])+(a[o]=e)];return i.i=r,i.j=o,n})(256)}function p(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function f(t,e){for(var n,i=t+\"\",r=0;r<i.length;)e[255&r]=255&(n^=19*e[255&r])+i.charCodeAt(r++);return m(e)}function m(t){return String.fromCharCode.apply(0,t)}if(f(a.random(),o),t.exports){t.exports=u;try{s=n(175)}catch(t){}}else void 0===(i=function(){return u}.call(e,n,e,t))||(t.exports=i)}(\"undefined\"!=typeof self?self:this,[],Math)},function(t,e){},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`.label {\n  margin-bottom: 4px;\n}\n\n.primary-selected-point {\n  r: 6px;\n  opacity: 1.0;\n  stroke-width: 1px;\n  stroke: #000;\n}\n\n.hovered-point {\n  r: 6px;\n  opacity: 1.0;\n  /* !important required to override explicit element.fill attr set by D3 */\n  fill: var(--lit-mage-300) !important;\n  stroke-width: 2px;\n  stroke: var(--lit-mage-300);\n  cursor: pointer;\n}\n\n.selected-point {\n  r: 5px;\n  fill-opacity: 0.8;\n  stroke-width: 2px;\n  stroke: #fff;\n}\n\n.point {\n  r: 4px;\n  opacity: .25;\n}\n\n.plot-holder {\n  border-top: 1px solid rgb(232, 234, 237);\n  border-bottom: 1px solid rgb(232, 234, 237);\n}\n\n.collapse-bar {\n  width: 100%;\n  height: 30px;\n  cursor: pointer;\n  padding: 2px 8px;\n  width: 100%;\n  outline: none;\n  display: flex;\n  justify-content: space-between;\n  box-sizing: border-box;\n}\n\n.scatterplot-background {\n  padding-bottom: 15px;\n  padding-top: 5px;\n}\n\n.axis-title {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  flex: 1;\n}\n\n.selected-value {\n  padding-right: 8px;\n}\n\n/**\n * d3.brush() sets up some questionable CSS styles, like pointer-events: all,\n * which will cause this module to respond to clicks in surprising ways even\n * when it is hidden. So, override this to 'visible' keep this from happening.\n */\ng#brushGroup {\n  pointer-events: visible !important;\n}\n\n#brushGroup .overlay {\n  pointer-events: visible !important;\n}\n`},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.SequenceSalienceModule=void 0;const i=n(1);n(178);const r=n(3),o=n(2),a=n(13),s=n(17),c=n(4),l=n(12),d=n(7);n(5);const u=n(8),h=n(52),p=n(77),f=n(180);var m;!function(t){t.NORMALIZE=\"normalize\",t.MAX_LOCAL=\"max_local\",t.MAX_GLOBAL=\"max_global\"}(m||(m={}));let g=class extends l.LitModule{constructor(){super(...arguments),this.currentSalience={},this.selectedSalienceField=void 0,this.focusState=void 0,this.cmapGamma=2,this.cmapScalingMode=m.NORMALIZE,this.denseView=!1,this.showValues=!1}static get styles(){return[d.styles,f.styles]}get salienceSpecInfo(){var t,e;return null!==(e=null===(t=this.appState.metadata.interpreters.sequence_salience)||void 0===t?void 0:t.metaSpec)&&void 0!==e?e:{}}get cmap(){var t;return null!=this.selectedSalienceField&&(null===(t=this.salienceSpecInfo[this.selectedSalienceField])||void 0===t?void 0:t.signed)?new h.SignedSalienceCmap(this.cmapGamma):new h.UnsignedSalienceCmap(this.cmapGamma)}get allReferenceTexts(){if(!this.currentData)return[];const t=[],e=this.appState.currentDatasetSpec,n=this.appState.getModelSpec(this.model).output,i=new Set;for(const t of(0,u.findSpecKeys)(n,p.GENERATION_TYPES)){const r=n[t].parent;r&&e[r]&&i.add(r)}for(const e of i){const n=this.currentData.data[e];if(n instanceof Array)for(const e of n)t.push(e[0]);else t.push(n)}return t}get allOutputTexts(){if(!this.currentPreds||!this.currentData)return[];const t=[],e=this.appState.getModelSpec(this.model).output;for(const n of(0,u.findSpecKeys)(e,p.GENERATION_TYPES)){const e=this.currentPreds[n];if(e instanceof Array)for(const n of e)t.push(n[0]);else t.push(e)}return t}get salienceTargetStrings(){return[...this.allReferenceTexts,...this.allOutputTexts]}firstUpdated(){void 0===this.selectedSalienceField&&(this.selectedSalienceField=Object.keys(this.salienceSpecInfo)[0]);this.reactImmediately(()=>this.selectionService.primarySelectedInputData,t=>i.__awaiter(this,void 0,void 0,(function*(){this.focusState=void 0,yield this.updateToSelection(t),this.salienceTarget=this.salienceTargetStrings[0]}))),this.reactImmediately(()=>this.salienceTarget,t=>{this.updateSalience(this.currentData,t)})}updateToSelection(t){return i.__awaiter(this,void 0,void 0,(function*(){if(null==t)return this.currentData=void 0,void(this.currentPreds=void 0);this.currentData=t,this.currentPreds=void 0;const e=this.apiService.getPreds([t],this.model,this.appState.currentDataset,p.GENERATION_TYPES,\"Generating text\"),n=yield this.loadLatest(\"preds\",e);if(null===n)return;const i=this.appState.getModelSpec(this.model).output,r=n[0],o={};for(const t of Object.keys(r))(0,u.isLitSubtype)(i[t],\"GeneratedText\")&&(o[t]=[[r[t],null]]),(0,u.isLitSubtype)(i[t],\"GeneratedTextCandidates\")&&(o[t]=r[t]);this.currentData=t,this.currentPreds=o}))}updateSalience(t,e){return i.__awaiter(this,void 0,void 0,(function*(){if(null==t||null==e)return void(this.currentSalience={});this.currentSalience={};const n={target_text:[e]},i=this.apiService.getInterpretations([t],this.model,this.appState.currentDataset,\"sequence_salience\",n,\"Computing sequence salience\"),r=yield this.loadLatest(\"salience\",i);if(null===r)return;const o=r[0],a={};for(const t of Object.keys(o))a[t]={sourceTokens:o[t].tokens_in,targetTokens:o[t].tokens_out,salience:o[t].salience};this.currentSalience=a}))}renderField(t){var e,n;const i=this.currentSalience[t],o=null!==(n=null===(e=this.focusState)||void 0===e?void 0:e.idx)&&void 0!==n?n:-1,c=this.cmap,l=o>-1?i.salience[o]:[...i.salience[0]].fill(0);let d=1;if(this.cmapScalingMode===m.NORMALIZE)d=(0,u.sumArray)(l.map(Math.abs));else if(this.cmapScalingMode===m.MAX_LOCAL)d=Math.max(...l.map(Math.abs));else if(this.cmapScalingMode===m.MAX_GLOBAL){const t=i.salience.map(t=>Math.max(...t.map(Math.abs)));d=Math.max(...t)}const h=d>0?l.map(t=>t/d):l,p=t=>{var e;(null===(e=this.focusState)||void 0===e?void 0:e.sticky)||(this.focusState={idx:t,sticky:!1})},f=()=>{var t;(null===(t=this.focusState)||void 0===t?void 0:t.sticky)||(this.focusState=void 0)},g=(t,e)=>{var n,i;e.stopPropagation(),(null===(n=this.focusState)||void 0===n?void 0:n.idx)===t&&(null===(i=this.focusState)||void 0===i?void 0:i.sticky)?this.focusState=void 0:this.focusState={idx:t,sticky:!0}},v=(0,a.classMap)({\"token-holder\":!0,\"token-holder-dense\":this.denseView}),y=t=>1-c.lightness(t)>.05,b=t=>t.toFixed(3);return r.html`\n      <div class='field-group'>\n        <table class='field-table'>\n          <tr>\n            <th><div class='subfield-title'>Source</div></th>\n            <td><div class=${v}>\n                ${i.sourceTokens.map((t,e)=>{const n=h[e],i=(0,s.styleMap)({color:c.textCmap(n),\"background-color\":c.bgCmap(n)}),o=(0,a.classMap)({\"salient-token\":!0,\"salient-token-with-number\":this.showValues});return r.html`\n        <div class=${o} style=${i}\n         data-displayval=${b(n)} ?data-shownumber=${y(n)}>\n          ${t}\n        </div>\n      `})}\n            </div></td>\n          </tr>\n          <tr>\n            <th><div class='subfield-title'>Target</div></th>\n             <td><div class=${v}>\n                ${i.targetTokens.map((t,e)=>{var n;const l=h[e+i.sourceTokens.length],d=(0,s.styleMap)({color:c.textCmap(l),\"background-color\":c.bgCmap(l)}),u=(0,a.classMap)({\"salient-token\":!0,\"salient-token-with-number\":this.showValues,\"target-token\":!0,\"token-focused\":e===o,\"token-pinned\":e===o&&!0===(null===(n=this.focusState)||void 0===n?void 0:n.sticky)});return r.html`\n        <div class=${u} style=${d}\n         data-displayval=${b(l)} ?data-shownumber=${y(l)}\n         @mouseover=${()=>{p(e)}}\n         @mouseout=${f}\n         @click=${t=>{g(e,t)}}>\n          ${t}\n        </div>\n      `})}\n            </div></td>\n          </tr>\n        </table>\n      </div>\n    `}renderContent(){return this.currentData?void 0===this.selectedSalienceField?null:this.currentSalience[this.selectedSalienceField]?this.renderField(this.selectedSalienceField):null:null}renderHeaderControls(){return r.html`\n      <div class=\"controls-group controls-group-variable\" title=\"Target string for salience.\">\n        <label class=\"dropdown-label\">Target:</label>\n        <select class=\"dropdown\" @change=${t=>{this.salienceTarget=t.target.value}}>\n          ${this.salienceTargetStrings.map(t=>r.html`<option value=${t} ?selected=${t===this.salienceTarget}>\n                   ${t}\n                 </option>`)}\n        </select>\n      </div>\n      <div class=\"controls-group\">\n        <div title=\"Type of salience map to use.\">\n          <label class=\"dropdown-label\">Method:</label>\n          <select class=\"dropdown\" @change=${t=>{this.selectedSalienceField=t.target.value}}>\n            ${Object.keys(this.salienceSpecInfo).map(t=>r.html`<option value=${t} ?selected=${t===this.selectedSalienceField}>\n                     ${t}\n                   </option>`)}\n          </select>\n        </div>\n        <div title=\"Method to scale raw values for display.\">\n          <label class=\"dropdown-label\">Scaling:</label>\n          <select class=\"dropdown\" @change=${t=>{this.cmapScalingMode=t.target.value}}>\n            ${Object.values(m).map(t=>r.html`<option value=${t} ?selected=${t===this.cmapScalingMode}>\n                     ${t}\n                   </option>`)}\n          </select>\n        </div>\n      </div>\n    `}renderColorBlocks(){const t=this.cmap,e=t instanceof h.SignedSalienceCmap,n=e?[-1,-.7,-.3,0,.3,.7,1]:[0,.2,.4,.6,.8,1],i=(0,a.classMap)({\"cmap-block\":!0,\"cmap-block-wide\":e}),o=n.map(e=>{const n=(0,s.styleMap)({color:t.textCmap(e),\"background-color\":t.bgCmap(e)});return r.html`\n        <div class=${i} style=${n}>\n          ${e.toFixed(1)}\n        </div>`});return r.html`<div class='cmap-blocks-holder'>${o}</div>`}renderFooterControls(){return r.html`\n      <div class=\"controls-group\">\n        <div class='switch-container' @click=${()=>{this.denseView=!this.denseView}}>\n          <div>Dense view</div>\n          <mwc-switch .checked=${this.denseView}></mwc-switch>\n        </div>\n        <div class='vertical-separator'></div>\n        <div class='switch-container' @click=${()=>{this.showValues=!this.showValues}}>\n          <div>Show values</div>\n          <mwc-switch .checked=${this.showValues}></mwc-switch>\n        </div>\n      </div>\n      <div class=\"controls-group\">\n        <label>Colormap:</label>\n        ${this.renderColorBlocks()}\n        <label for=\"gamma-slider\">Gamma:</label>\n        <lit-slider min=\"0.25\" max=\"6\" step=\"0.25\" val=\"${this.cmapGamma}\"\n                    .onInput=${t=>{this.cmapGamma=+t.target.value}}></lit-slider>\n        <div class=\"gamma-value\">${this.cmapGamma.toFixed(2)}</div>\n      </div>`}render(){return r.html`\n      <div class=\"module-container\">\n        <div class=\"module-toolbar\">\n          ${this.renderHeaderControls()}\n        </div>\n        <div class=\"module-results-area\"\n         @click=${()=>{var t;(null===(t=this.focusState)||void 0===t?void 0:t.sticky)&&(this.focusState=void 0)}}>\n          ${this.renderContent()}\n        </div>\n        <div class=\"module-footer\">\n          ${this.renderFooterControls()}\n        </div>\n      </div>\n    `}static shouldDisplayModule(t,e){for(const e of Object.values(t))if(-1!==e.interpreters.indexOf(\"sequence_salience\"))return!0;return!1}};g.title=\"Sequence Salience\",g.duplicateForExampleComparison=!0,g.duplicateForModelComparison=!0,g.numCols=4,g.template=(t=\"\",e=0)=>r.html`\n      <sequence-salience-module model=${t}\n       selectionServiceIndex=${e}>\n      </sequence-salience-module>`,i.__decorate([c.observable,i.__metadata(\"design:type\",Object)],g.prototype,\"currentData\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",Object)],g.prototype,\"currentPreds\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",String)],g.prototype,\"salienceTarget\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",Object)],g.prototype,\"currentSalience\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",String)],g.prototype,\"selectedSalienceField\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",Object)],g.prototype,\"focusState\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",Number)],g.prototype,\"cmapGamma\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",String)],g.prototype,\"cmapScalingMode\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",Boolean)],g.prototype,\"denseView\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",Boolean)],g.prototype,\"showValues\",void 0),i.__decorate([c.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],g.prototype,\"salienceSpecInfo\",null),i.__decorate([c.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],g.prototype,\"cmap\",null),i.__decorate([c.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],g.prototype,\"allReferenceTexts\",null),i.__decorate([c.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],g.prototype,\"allOutputTexts\",null),i.__decorate([c.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],g.prototype,\"salienceTargetStrings\",null),g=i.__decorate([(0,o.customElement)(\"sequence-salience-module\")],g),e.SequenceSalienceModule=g},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.Slider=void 0;const i=n(1),r=n(2),o=n(2),a=n(3),s=n(17),c=n(179),l=n(7);let d=class extends a.LitElement{constructor(){super(...arguments),this.min=0,this.max=1,this.step=.1,this.val=.5,this.onChange=()=>{},this.onInput=t=>{const e=t.target;this.val=+e.value}}static get styles(){return[l.styles,c.styles]}render(){const t={\"background-size\":100*((this.val-this.min)/(this.max-this.min))+\"% 100%\"};return a.html`<input type=\"range\" class=\"slider\" style=${(0,s.styleMap)(t)}\n                  min=\"${this.min}\" max=\"${this.max}\" step=\"${this.step}\"\n                  .value=\"${this.val.toString()}\"\n                  @input=${this.onInput}\n                  @change=${this.onChange}>`}};i.__decorate([(0,r.property)({type:Number}),i.__metadata(\"design:type\",Object)],d.prototype,\"min\",void 0),i.__decorate([(0,r.property)({type:Number}),i.__metadata(\"design:type\",Object)],d.prototype,\"max\",void 0),i.__decorate([(0,r.property)({type:Number}),i.__metadata(\"design:type\",Object)],d.prototype,\"step\",void 0),i.__decorate([(0,r.property)({type:Number}),i.__metadata(\"design:type\",Object)],d.prototype,\"val\",void 0),i.__decorate([(0,r.property)({attribute:!1}),i.__metadata(\"design:type\",Object)],d.prototype,\"onChange\",void 0),i.__decorate([(0,r.property)({attribute:!1}),i.__metadata(\"design:type\",Object)],d.prototype,\"onInput\",void 0),d=i.__decorate([(0,o.customElement)(\"lit-slider\")],d),e.Slider=d},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`/** Slider styles for Chrome */\ninput[type='range'].slider {\n  -webkit-appearance: none;\n  max-width: calc(100% - 4px);\n  background: var(--lit-neutral-400);\n  border-radius: 4px;\n  background-image: linear-gradient(var(--lit-cyea-400), var(--lit-cyea-400));\n  background-repeat: no-repeat;\n}\n\ninput[type='range'].slider::-webkit-slider-runnable-track {\n  -webkit-appearance: none;\n  height: 10px;\n  color: var(--lit-cyea-400);\n}\n\ninput[type='range'].slider::-webkit-slider-thumb {\n  -webkit-appearance: none;\n  width: 16px;\n  height: 16px;\n  margin-top: -3px;\n  border-radius: 50%;\n  cursor: grab;\n  background: var(--lit-cyea-600);\n  box-shadow: 0 0 2px 0 var(--lit-neutral-900);\n}\n\n/** Slider styles for FF*/\ninput[type=\"range\"].slider::-moz-range-progress {\n  background-color: var(--lit-cyea-400);\n}\n\ninput[type=\"range\"].slider::-moz-range-thumb {\n  background-color: var(--lit-cyea-600);\n}\n\ninput[type=\"range\"].slider::-moz-range-track {\n  background-color: var(--lit-neutral-400);\n}\n\n/** Slider styles for IE */\ninput[type=\"range\"].slider::-ms-fill-lower {\n  background-color: var(--lit-cyea-400);\n}\n\ninput[type=\"range\"].slider::-ms-fill-upper {\n  background-color: var(--lit-neutral-400);\n}\n\ninput[type=\"range\"].slider::-ms-thumb {\n  background-color: var(--lit-cyea-600);\n}\n`},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`table.field-table {\n  width: 100%;\n  min-width: 100%;\n  border-spacing: 8px;\n}\n\ntable.field-table th {\n  vertical-align: top;\n  text-align: start;\n}\n\n.subfield-title {\n  padding-top: 6px; /* align title with first row of content */\n}\n\n.token-holder {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  align-content: flex-start;\n}\n\n.salience-value {\n  font-size: 10px;\n}\n\n.salient-token {\n  /* color and background set individually vis styleMap */\n  font-family: 'Roboto';\n  border-radius: 2px;\n  border: 1px solid transparent; /* for spacing */\n  width: fit-content;\n  position: relative;\n  text-align: center;\n}\n\n.token-holder > .salient-token {\n  padding: 2px 4px; /* wider horizontally */\n  margin: 3px;\n}\n\n.token-holder-dense > .salient-token {\n  padding: 2px 0; /* no spacing, so words flow */\n  margin: 0;\n}\n\n/**\n * Styles for token chips when showValues is enabled.\n * For visual consistency and to avoid jumping, these apply to all tokens\n * regardless of whether the number is actually visible (see below).\n */\n.token-holder > .salient-token-with-number {\n  /* These should override the regular and dense settings above. */\n  margin-top: 12px;\n  padding-top: 0;\n  padding-bottom: 0;\n}\n\n.salient-token-with-number {\n  min-width: 30px;  /* enough space for number label */\n}\n\n/* Style for the actual value display, above the token text.\n * If we want to do anything fancier we should probably make a separate element,\n * but for now :before will do. (Note that :after is used below for a pin icon.)\n */\n.salient-token-with-number:before {\n  font-size: 10px;\n  color: black !important;\n  position: absolute;\n  margin: auto;\n  left: 0;\n  right: 0;\n  bottom: 100%;\n  text-align: center;\n  content: attr(data-displayval);\n  visibility: hidden;\n}\n\n/* Always show numbers with data-shownumber set explicitly. */\n.salient-token-with-number[data-shownumber]:before {\n  visibility: visible;\n}\n\n/**\n * Always show numbers on token hover, such as when a different token is pinned.\n * This could be done in the template code in TypeScript, but doing this in CSS\n * lets us use :hover directly and avoid manually tracking another ephemeral\n * focus state.\n */\n.salient-token-with-number:hover:before {\n  visibility: visible;\n}\n\n.target-token {\n  cursor: pointer;\n}\n\n.token-focused {\n  font-weight: 600;\n  text-decoration: underline;\n}\n\n.token-pinned {\n  border: 1px solid #dadce0;\n}\n\n.token-pinned:after {\n  position: absolute;\n  font-family: 'Material Icons';\n  content: 'push_pin';\n  /* upper right corner of token */\n  right: -6px;\n  bottom: 60%;\n  z-index: 1; /* draw over adjacent tokens in dense mode */\n}\n\n/**\n * Module controls\n */\n.module-toolbar {\n  border-bottom: 1px solid #dadce0;\n  box-sizing: border-box;\n  justify-content: space-between;\n}\n\n.module-footer {\n  justify-content: space-between;\n}\n\n.controls-group {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  margin: 0 4px;\n}\n\n.controls-group > * {\n  margin: 0 2px;\n}\n\n/* Allow dropdown area to grow, but not to cause line wrapping. */\n.controls-group-variable {\n  flex: 1;\n  overflow-x: clip;\n  margin-right: 8px;\n}\n\n.controls-group-variable .dropdown {\n  max-width: 100%;\n}\n\n.vertical-separator {\n  background: #dadce0;\n  width: 2px;\n  height: 1.2rem;\n  padding: 0;\n  margin: 0 8px;\n}\n\n.cmap-blocks-holder {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  margin: 0 4px;\n}\n\n.cmap-block {\n  width: 28px;\n  height: 20px;\n  border: 1px solid gray;\n  border-radius: 3px;\n  text-align: center;\n  vertical-align: middle;\n  margin: 0 2px;\n}\n\n.cmap-block-wide {\n  width: 32px;\n}\n\n.gamma-value {\n  min-width: 32px;\n}\n`},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.SliceModule=void 0;const i=n(1),r=n(2),o=n(3),a=n(13),s=n(4),c=n(15),l=n(12);n(5);const d=n(8),u=n(32),h=n(11),p=n(53),f=n(7),m=n(182);let g=class extends l.LitModule{constructor(){super(...arguments),this.sliceService=c.app.getService(h.SliceService),this.groupService=c.app.getService(u.GroupService),this.sliceByBins={},this.sliceByFeatures=[],this.sliceName=null}static get styles(){return[f.styles,m.styles]}get createButtonEnabled(){return 0===this.selectionService.selectedIds.length&&this.anyCheckboxChecked||null!==this.sliceName&&\"\"!==this.sliceName&&this.selectionService.selectedIds.length>0}get anyCheckboxChecked(){return this.sliceByFeatures.length>0}lastCreatedSlice(){const t=this.sliceService.sliceNames;return t[t.length-1]}handleClickCreate(){if(this.anyCheckboxChecked)this.makeSlicesFromAllLabelCombos(),this.selectSlice(this.lastCreatedSlice());else{const t=this.selectionService.selectedIds,e=this.sliceName;null!=e&&this.sliceService.addNamedSlice(e,t),this.selectSlice(e)}this.sliceName=null,this.sliceByFeatures=[]}makeSlicesFromAllLabelCombos(){const t=this.selectionService.selectedOrAllInputData,e=this.groupService.groupExamplesByFeatures(this.sliceByBins,t,this.sliceByFeatures),n=null==this.sliceName?\"\":this.sliceName+\" \";Object.keys(e).forEach(t=>{const i=`${n}${t}`,r=e[t].data.map(t=>t.id);this.sliceService.addNamedSlice(i,r)})}selectSlice(t){this.sliceService.selectNamedSlice(t,this)}renderCreate(){const t=()=>{this.handleClickCreate()};return o.html`\n      <div class=\"row-container\">\n        <input type=\"text\" id=\"input-box\" .value=${this.sliceName}\n          placeholder=\"Enter name\" @input=${t=>{this.sliceName=t.target.value}}\n          @keyup=${e=>{(e=>{(0,d.handleEnterKey)(e,t)})(e)}}/>\n        <button class='hairline-button'\n          ?disabled=\"${!this.createButtonEnabled}\"\n          @click=${t}>${this.sliceByFeatures.length>0?\"Create slices\":\"Create slice\"}\n        </button>\n      </div>\n    `}renderSliceRow(t){var e,n;const i=this.sliceService.selectedSliceName,r=(0,a.classMap)({\"selector-item\":!0,selected:t===i}),s=null!==(n=null===(e=this.sliceService.getSliceByName(t))||void 0===e?void 0:e.length)&&void 0!==n?n:0,c=this.selectionService.selectedIds.filter(e=>!this.sliceService.isInSlice(t,e)).length>0,l=(0,a.classMap)({\"icon-button\":!0,disabled:!c}),d=(0,a.classMap)({\"icon-button\":!0,\"mdi-outlined\":!0,disabled:s<=0});return o.html`\n      <div class=${r} @click=${()=>{const e=i===t?null:t;this.selectSlice(e)}}>\n        <span class='slice-name'>${t}</span>\n        <span class=\"number-label\">\n          ${s} ${1===s?\"datapoint\":\"datapoints\"}\n          <mwc-icon class=${l} @click=${e=>{e.stopPropagation(),this.sliceService.addIdsToSlice(t,this.selectionService.selectedIds)}}\n           title=\"Add selected to this slice\">\n           add_circle_outline\n          </mwc-icon>\n          ${t===p.STARRED_SLICE_NAME?o.html`<mwc-icon class=${d} @click=${e=>{var n;e.stopPropagation();const i=null!==(n=this.sliceService.getSliceByName(t))&&void 0!==n?n:[];this.sliceService.removeIdsFromSlice(t,i)}}\n                  title=\"Reset this slice\">\n                   clear\n                 </mwc-icon>`:o.html`<mwc-icon class='icon-button' @click=${e=>{e.stopPropagation(),this.sliceService.deleteNamedSlice(t)}}\n                  title=\"Delete this slice\">\n                   delete_outline\n                 </mwc-icon>`}\n        </span>\n      </div>`}renderSliceSelector(){return o.html`\n      <div id=\"select-container\">\n        <label>Select slice</label>\n        <div id=\"slice-selector\">\n          ${this.sliceService.sliceNames.map(t=>this.renderSliceRow(t))}\n        </div>\n      </div>\n    `}renderFilters(){const t=(t,e)=>{if(t.target.checked)this.sliceByFeatures.push(e);else{const t=this.sliceByFeatures.indexOf(e);this.sliceByFeatures.splice(t,1)}const n=this.sliceByFeatures.map(t=>({featureName:t,method:this.groupService.numericalFeatureNames.includes(t)?u.FacetingMethod.EQUAL_INTERVAL:u.FacetingMethod.DISCRETE}));this.sliceByBins=this.groupService.numericalFeatureBins(n)},e=e=>o.html`\n        <div>\n          <div class='checkbox-holder'>\n            <lit-checkbox\n              ?checked=${this.sliceByFeatures.includes(e)}\n              @change='${n=>{t(n,e)}}'\n              label=${e}>\n            </lit-checkbox>\n          </div>\n        </div>\n      `;return o.html`${this.groupService.denseFeatureNames.map(t=>e(t))}`}renderNumSlices(){return this.anyCheckboxChecked?o.html`\n        <div class=\"dropdown-label\">\n          (${this.groupService.numIntersectionsLabel(this.sliceByBins,this.sliceByFeatures)} slices)\n        </div>\n      `:\"\"}render(){return o.html`\n      <div class='module-container'>\n        ${this.renderCreate()}\n        <div class=\"row-container\" >\n          <label>Slice by feature</label>\n          ${this.renderFilters()}\n          ${this.renderNumSlices()}\n        </div>\n        ${this.renderSliceSelector()}\n      </div>\n    `}static shouldDisplayModule(t,e){return!0}};g.title=\"Slice Editor\",g.numCols=2,g.collapseByDefault=!0,g.duplicateForModelComparison=!1,g.template=()=>o.html`<lit-slice-module></lit-slice-module>`,i.__decorate([s.observable,i.__metadata(\"design:type\",Array)],g.prototype,\"sliceByFeatures\",void 0),i.__decorate([s.observable,i.__metadata(\"design:type\",Object)],g.prototype,\"sliceName\",void 0),i.__decorate([s.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],g.prototype,\"createButtonEnabled\",null),i.__decorate([s.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],g.prototype,\"anyCheckboxChecked\",null),g=i.__decorate([(0,r.customElement)(\"lit-slice-module\")],g),e.SliceModule=g},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`:host {\n  --slice-selector-right-col-width: 140px;\n}\n\n.module-container {\n  padding: 6px;\n}\n\n.row-container {\n  display: flex;\n  flex-wrap: wrap;\n  flex-direction: row;\n  align-items: center;\n\n  margin-bottom: 10px;\n}\n\n#select-container {\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  width: 100%;\n}\n\n#slice-selector {\n  border: 1px solid rgb(218, 220, 224);\n  flex: 1;\n  min-height: 250px;\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n\n.selector-item {\n  padding: 8px;\n}\n\n.selector-item:hover {\n  background: #f8f9fa;\n}\n\n.selector-item > * {\n  vertical-align: middle;\n}\n\n.selected {\n  background: rgb(197, 228, 232);\n}\n\n.selected:hover {\n  background: rgb(197, 228, 232);\n}\n\n.toolbar > * {\n  margin: 4pt;\n}\n\n.checkbox-holder{\n  display: flex;\n  justify-content: space-between;\n}\n\n.checkbox-title{\n  font-size: 12px;\n}\n\n#input-box {\n  flex: 1;\n}\n\n.checkbox-holder {\n  margin: 0 7px;\n}\n\n.slice-name {\n  max-width: calc(100% - var(--slice-selector-right-col-width));\n  display: inline-block;\n  overflow: auto;\n}\n\n.number-label {\n  float: right;\n  color: #5f6368;\n  max-width: var(--slice-selector-right-col-width);\n}\n\n.selector-item .icon-button {\n  font-size: 18px;\n  vertical-align: middle;\n  margin-left: 3px;\n  margin-bottom: 5px;\n}\n\n.selector-item .icon-button.disabled {\n  pointer-events: none;\n  cursor: auto;\n  opacity: .2;\n}\n\n.hidden {\n  visibility: hidden;\n}\n`},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.TCAVModule=void 0;const i=n(1);n(42),n(184),n(60);const r=n(2),o=n(3);n(3);const a=n(13),s=n(17),c=n(4),l=n(15),d=n(12);n(40),n(5);const u=n(8),h=n(11),p=n(53),f=n(7),m=n(185),g=[\"Positive Slice\",\"Negative Slice\",\"Run\",\"Embedding\",\"Class\",\"CAV Score\",\"Score Bar\"];let v=class extends d.LitModule{constructor(){super(...arguments),this.sliceService=l.app.getService(h.SliceService),this.selectedSlices=new Set,this.selectedLayers=new Set,this.selectedClasses=new Set,this.negativeSlices=new Set,this.isLoading=!1,this.isSliceHidden=!1,this.isClassHidden=!0,this.isEmbeddingHidden=!0,this.resultsTableData=[],this.cavCounter=0}static get styles(){return[f.styles,m.styles]}get modelSpec(){return this.appState.getModelSpec(this.model)}get gradKeys(){return(0,u.findSpecKeys)(this.modelSpec.output,\"Gradients\")}get TCAVSliceNames(){return this.sliceService.sliceNames.filter(t=>t!==p.STARRED_SLICE_NAME)}get slicePairs(){const t=Array.from(this.selectedSlices.values()),e=Array.from(this.negativeSlices.values());if(0===t.length)return[];if(0===e.length)return t.map(t=>[t,null]);const n=[];for(const i of t)for(const t of e)n.push([i,t]);return n}get predClasses(){const t=(0,u.findSpecKeys)(this.modelSpec.output,\"MulticlassPreds\");return this.modelSpec.output[t[0]].vocab}get nullIndex(){const t=(0,u.findSpecKeys)(this.modelSpec.output,\"MulticlassPreds\");return this.modelSpec.output[t[0]].null_idx}firstUpdated(){if(0===this.selectedLayers.size&&this.gradKeys.length>0&&this.selectedLayers.add(this.gradKeys[0]),0===this.selectedClasses.size&&this.predClasses.length>1){const t=0===this.nullIndex?1:0;this.selectedClasses.add(this.predClasses[t])}}renderSpinner(){return o.html`\n      <div class=\"spinner-container\">\n        <lit-spinner size=${24} color=\"var(--app-secondary-color)\">\n        </lit-spinner>\n      </div>\n    `}renderCollapseBar(t,e,n,i,r,a,c=\"\",l=null){const d=i.map(t=>{const e=[o.html`<lit-checkbox ?checked=${a.has(t)}\n                @change='${e=>{((t,e)=>{t.target.checked?a.add(e):a.delete(e)})(e,t)}}'>\n            </lit-checkbox>`,t];if(null!=l){const n=(t,e)=>{t.target.checked?l.add(e):l.delete(e)};e.push(o.html`<lit-checkbox id='compare-switch'\n                  ?checked=${l.has(t)}\n                  @change='${e=>{n(e,t)}}'>\n                </lit-checkbox>`)}return e}),u=[\"selected\",r];return null!=l&&u.push(c),o.html`\n      <div class='collapse-bar' @click=${e}>\n        <div class=\"axis-title\">\n          <div>${t}</div>\n        </div>\n        <mwc-icon class=\"icon-button min-button\">\n          ${n?\"expand_more\":\"expand_less\"}\n        </mwc-icon>\n      </div>\n      <div class='collapse-content'\n        style=${(0,s.styleMap)({display:\"\"+(n?\"none\":\"block\")})}>\n        ${0===d.length?o.html`<div class='require-text label-2'>\n                  This module requires at least one ${r.toLowerCase()}.\n               </div>`:o.html`<lit-data-table .verticalAlignMiddle=${!0}\n                               .columnNames=${u}\n                               .data=${d}></lit-data-table>`}\n      </div>\n    `}render(){const t=()=>{for(const t of this.selectedSlices){const e=this.sliceService.getSliceByName(t);if(null==e)return!0;const n=this.appState.currentInputData.length-e.length;if(e.length>=3&&n>=3)return!1}return!0},e=this.selectedClasses.size*this.selectedSlices.size*this.selectedLayers.size;return o.html`\n      <div class=\"module-container\">\n        <div class=\"module-content\">\n          <div class=\"left-container\">\n            <div class=\"controls-holder\">\n              ${this.renderCollapseBar(\"Select Slices\",()=>{this.isSliceHidden=!this.isSliceHidden},this.isSliceHidden,this.TCAVSliceNames,\"Positive slice\",this.selectedSlices,\"Negative slice\",this.negativeSlices)}\n              ${this.renderCollapseBar(\"Explainable Classes\",()=>{this.isClassHidden=!this.isClassHidden},this.isClassHidden,this.predClasses,\"Class\",this.selectedClasses)}\n              ${this.renderCollapseBar(\"Embeddings\",()=>{this.isEmbeddingHidden=!this.isEmbeddingHidden},this.isEmbeddingHidden,this.gradKeys,\"Embedding\",this.selectedLayers)}\n            </div>\n            <div class=\"controls-actions\">\n              <div id='examples-selected-label'\n                class=\"label-2\">${e} CAV Results</div>\n              <div class=\"controls-buttons\">\n                <button id='clear-button' class=\"hairline-button\"\n                  @click=${()=>{this.selectedClasses.clear(),this.selectedLayers.clear(),this.selectedSlices.clear(),this.negativeSlices.clear()}}\n                  ?disabled=${0===this.selectedClasses.size&&0===this.selectedLayers.size&&0===this.selectedSlices.size&&0===this.negativeSlices.size}>Clear</button>\n                <button id='submit'\n                  class=\"hairline-button\" title=${t()?\"select a slice with 3 or more examples\":\"\"}\n                  @click=${()=>this.runTCAV()} ?disabled=${t()}>Run TCAV</button>\n              </div>\n            </div>\n          </div>\n          <div id='vis-container' class=${(0,a.classMap)({loading:this.isLoading})}>\n            ${this.isLoading?this.renderSpinner():\"\"}\n            <lit-data-table .columnNames=${g}\n                            .data=${[...this.resultsTableData]}\n                            .verticalAlignMiddle=${!0}></lit-data-table>\n          </div>\n        </div>\n        <div class=\"module-footer\">\n          <button class=\"hairline-button\" @click=${()=>{this.resultsTableData=[],this.cavCounter=0,this.requestUpdate()}}\n             ?disabled=${0===this.resultsTableData.length}>Clear</button>\n        </div>\n      </div>\n    `}runSingleTCAV(t,e,n){return i.__awaiter(this,void 0,void 0,(function*(){const i=this.appState.currentInputData.length-t.concept_set_ids.length;if(t.concept_set_ids.length<3||i<3)return;const r=yield this.apiService.getInterpretations(this.appState.currentInputData,this.model,this.appState.currentDataset,\"tcav\",t,\"Running tcav\");return null!==r?{positiveSlice:e,negativeSlice:n,config:t,score:r[0].result.score,p_val:r[0].p_val,random_mean:r[0].random_mean}:void 0}))}runTCAV(){return i.__awaiter(this,void 0,void 0,(function*(){this.isLoading=!0;const t=[];for(const e of this.slicePairs)for(const n of this.selectedClasses.values())for(const i of this.selectedLayers.values()){const r=e[0],o=e[1],a={concept_set_ids:this.sliceService.getSliceByName(r),class_to_explain:n,grad_layer:i,dataset_name:this.appState.currentDataset};if(null!=o){const t=this.sliceService.getSliceByName(o);a.negative_set_ids=t}t.push(this.runSingleTCAV(a,r,null!=o?o:\"-\"))}const e=yield this.loadLatest(\"getResults\",Promise.all(t));if(null!=e){for(const t of e){if(null==t)continue;if(null==t.config||null==t.score)continue;let e=o.html`<tcav-score-bar\n             score=${t.score}\n             meanVal=${t.random_mean}\n             clampVal=${1}>\n           </tcav-score-bar>`,n=t.score.toFixed(3);null!=t.p_val&&t.p_val>.05&&(n=\"-\",e=\"this run was not statistically significant (p > 0.05)\"),null==t.p_val&&(e=\"Did not run t-testing (requires at least 6 positive and 6 negative samples)\"),this.resultsTableData.push({\"Positive Slice\":t.positiveSlice,\"Negative Slice\":t.negativeSlice,Run:this.cavCounter,Embedding:t.config.grad_layer,Class:t.config.class_to_explain,\"CAV Score\":n,\"Score Bar\":e})}this.cavCounter++,this.isLoading=!1,this.requestUpdate()}}))}static shouldDisplayModule(t,e){const n=(0,u.doesOutputSpecContain)(t,\"Embeddings\"),i=(0,u.doesOutputSpecContain)(t,\"Gradients\"),r=(0,u.doesOutputSpecContain)(t,\"MulticlassPreds\");if(!i||!n||!r)return!1;for(const e of Object.values(t))if(-1!==e.interpreters.indexOf(\"tcav\"))return!0;return!1}};v.title=\"TCAV Explorer\",v.numCols=12,v.duplicateForModelComparison=!0,v.template=(t=\"\")=>o.html`\n      <tcav-module model=${t}>\n      </tcav-module>`,i.__decorate([c.observable,i.__metadata(\"design:type\",Object)],v.prototype,\"selectedSlices\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",Object)],v.prototype,\"selectedLayers\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",Object)],v.prototype,\"selectedClasses\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",Object)],v.prototype,\"negativeSlices\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",Boolean)],v.prototype,\"isLoading\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",Boolean)],v.prototype,\"isSliceHidden\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",Boolean)],v.prototype,\"isClassHidden\",void 0),i.__decorate([c.observable,i.__metadata(\"design:type\",Boolean)],v.prototype,\"isEmbeddingHidden\",void 0),i.__decorate([c.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],v.prototype,\"modelSpec\",null),i.__decorate([c.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],v.prototype,\"gradKeys\",null),i.__decorate([c.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],v.prototype,\"TCAVSliceNames\",null),i.__decorate([c.computed,i.__metadata(\"design:type\",Array),i.__metadata(\"design:paramtypes\",[])],v.prototype,\"slicePairs\",null),i.__decorate([c.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],v.prototype,\"predClasses\",null),i.__decorate([c.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],v.prototype,\"nullIndex\",null),v=i.__decorate([(0,r.customElement)(\"tcav-module\")],v),e.TCAVModule=v},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.TcavScoreBar=void 0;const i=n(1),r=n(2),o=n(2),a=n(3),s=n(17);let c=class extends a.LitElement{constructor(){super(...arguments),this.score=0,this.meanVal=0,this.clampVal=0}static get styles(){return a.css`\n        .cell {\n          position: relative;\n          display: flex;\n          min-width: 100px;\n          min-height: 20px;\n          background-color: var(--lit-neutral-200);\n        }\n\n        .separator {\n          width: 2px;\n          background-color: black;\n          min-height: 20px;\n          position: absolute;\n        }\n\n        .pos-bar {\n          min-height: 20px;\n          position: absolute;\n          background-color: var(--lit-cyea-300);\n        }\n    `}render(){const{score:t,clampVal:e,meanVal:n}=this,i=Math.min(Math.max(t,0),e)/e,r=Math.min(Math.max(n,0),e)/e,o={width:100*Math.abs(i-r)+\"%\",left:i>r?100*r+\"%\":100*i+\"%\"},c={left:100*r+\"%\"};return a.html`<td><div class='cell'>\n        <div class='pos-bar' style='${(0,s.styleMap)(o)}'></div>\n        <div class='separator' style='${(0,s.styleMap)(c)}'></div>\n      </div></td>`}};i.__decorate([(0,r.property)({type:Number}),i.__metadata(\"design:type\",Object)],c.prototype,\"score\",void 0),i.__decorate([(0,r.property)({type:Number}),i.__metadata(\"design:type\",Object)],c.prototype,\"meanVal\",void 0),i.__decorate([(0,r.property)({type:Number}),i.__metadata(\"design:type\",Object)],c.prototype,\"clampVal\",void 0),c=i.__decorate([(0,o.customElement)(\"tcav-score-bar\")],c),e.TcavScoreBar=c},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"styles\",(function(){return i}));const i=n(0).b`.module-content {\n  display: flex;\n  flex-direction: row;\n}\n\n.module-footer {\n  justify-content: flex-end;\n}\n\n.field-name {\n  font-weight: bold;\n}\n\n.tcav-dropdown {\n  max-width: unset;\n}\n\n#vis-container {\n  margin-left: 4px;\n  height: 100%;\n  width: 100%;\n}\n\n#warning-text {\n  margin-left: 5px;\n  font-size: 11px;\n}\n\n.loading {\n  opacity: .3;\n}\n\n.spinner-container {\n  position: absolute;\n  top: 150px;\n  left: 80px;\n}\n\n.collapse-bar {\n  align-items: center;\n  background: rgb(248, 249, 250);\n  width: 100%;\n  height: 36px;\n  cursor: pointer;\n  padding: 2px 8px;\n  width: 100%;\n  border: 1px solid rgb(232, 234, 237);\n  outline: none;\n  display: flex;\n  justify-content: space-between;\n  box-sizing: border-box;\n}\n\n.collapse-content {\n  flex: 1 1 0%\n}\n\n.left-container {\n  border-right: 1px solid #e8eaed;\n  width: 500px;\n}\n\n.controls-buttons {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n}\n\n.controls-actions {\n  align-items: center;\n  border-bottom: 1px solid #e8eaed;\n  border-top: 1px solid #e8eaed;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n}\n\n.controls-actions > * {\n  margin: 4px;\n}\n\n.output-controls {\n  border: 1px solid #e8eaed;\n  display: flex;\n  height: 32px;\n}\n\n.require-text {\n  margin: 4px 8px 16px 4px;\n}\n\n.label-2 {\n  color: #80868b;\n  font-family: Roboto;\n  font-size: 12px;\n  font-style: normal;\n  font-weight: normal;\n}\n`},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.ThresholderModule=void 0;const i=n(1);n(187);const r=n(2),o=n(3),a=n(17),s=n(4),c=n(15),l=n(12);n(40);const d=n(5),u=n(8),h=n(11),p=n(32),f=n(7);let m=class extends l.LitModule{constructor(){super(...arguments),this.costRatio=1,this.selectedFacetBins={},this.selectedFacets=[],this.calculatedMargins={},this.classificationService=c.app.getService(h.ClassificationService),this.groupService=c.app.getService(h.GroupService)}static get styles(){return[f.styles,o.css`\n        .cost-ratio-input {\n          width: 50px;\n        }\n\n        .module-toolbar {\n          margin-bottom: 4px;\n        }\n    `]}firstUpdated(){this.reactImmediately(()=>this.groupedExamples,t=>{this.updateMarginCategories(t)})}updateMarginCategories(t){this.calculatedMargins={};for(const e of this.binaryClassificationKeys){this.classificationService.setMarginGroups(this.model,e,t);const n={};for(const e of Object.keys(t))n[e]={};this.calculatedMargins[e]=n}}get binaryClassificationKeys(){const t=this.appState.currentModelSpecs[this.model].spec.output;return(0,u.findSpecKeys)(t,\"MulticlassPreds\").filter(e=>(0,u.isBinaryClassification)(t[e]))}calculateThresholds(){return i.__awaiter(this,void 0,void 0,(function*(){const t={cost_ratio:this.costRatio,facets:this.groupedExamples},e=yield this.apiService.getInterpretations(this.appState.currentInputData,this.model,this.appState.currentDataset,\"thresholder\",t);for(const t of e){const e=this.calculatedMargins[t.pred_key];for(const n of Object.keys(t.thresholds)){const i={};for(const e of Object.keys(t.thresholds[n]))i[e]=(0,u.getMarginFromThreshold)(t.thresholds[n][e]);e[n]=i}this.calculatedMargins[t.pred_key]=e}}))}get groupedExamples(){return this.groupService.groupExamplesByFeatures(this.selectedFacetBins,this.appState.currentInputData,this.selectedFacets)}renderTable(t){const e={background:\"transparent\",\"border-radius\":\"4px\",border:\"1px solid rgb(189, 193, 198)\",color:\"rgb(26, 115, 232)\"},n=[\"Facet\"],i=this.calculatedMargins[t];if(null==i)return null;let r=!0;const s=[];for(const c of Object.keys(i)){const l=[\"\"===c?\"All\":c];for(const s of Object.keys(i[c])){if(r){const r=()=>{for(const e of Object.keys(i))this.classificationService.setMargin(this.model,t,i[e][s],this.groupedExamples[e])};n.push({name:s,html:o.html`\n              <div>${s}</div>\n              <button style=${(0,a.styleMap)(e)} @click=${r}>\n                Apply\n              </button>`,rightAlign:!0})}l.push((0,u.getThresholdFromMargin)(i[c][s]).toFixed(2))}const d=this.classificationService.getMargin(this.model,t,this.groupedExamples[c]),h=e=>{this.classificationService.setMargin(this.model,t,e.detail.margin,this.groupedExamples[c])};l.push(o.html`<threshold-slider .margin=${d} label=${c}\n                    ?isThreshold=${!0} @threshold-changed=${h}>\n                  </threshold-slider>`),r=!1,s.push(l)}return n.push(t+\" threshold\"),o.html`\n        <lit-data-table\n          .columnNames=${n}\n          .data=${s}\n        ></lit-data-table>\n    `}renderCheckbox(t,e,n,i){return o.html`\n        <div class='checkbox-holder'>\n          <lit-checkbox\n            ?checked=${e}\n            ?disabled=${i}\n            @change='${e=>{n(e,t)}}'\n            label=${t}>\n          </lit-checkbox>\n        </div>\n    `}renderControls(){const t=(t,e)=>{if(t.target.checked)this.selectedFacets.push(e);else{const t=this.selectedFacets.indexOf(e);this.selectedFacets.splice(t,1)}const n=this.selectedFacets.map(t=>({featureName:t,method:this.groupService.numericalFeatureNames.includes(t)?p.FacetingMethod.EQUAL_INTERVAL:p.FacetingMethod.DISCRETE}));this.selectedFacetBins=this.groupService.numericalFeatureBins(n)};return o.html`\n        <label class=\"cb-label\">Facet by</label>\n       ${this.groupService.denseFeatureNames.map(e=>this.renderCheckbox(e,!1,n=>{t(n,e)},!1))}\n        <div title=${\"The cost of false positives relative to false negatives. Used to find optimal classifier thresholds\"}>Cost ratio (FP/FN):</div>\n        <input type=number step=\"0.1\" min=0 max=20\n           .value=${this.costRatio.toString()} class=\"cost-ratio-input\"\n            @input=${t=>{this.costRatio=+t.target.value}}>\n        <button class='hairline-button' title=${\"Calculate optimal threholds for each facet using the cost ratio and a number of different techniques\"}\n           @click=${this.calculateThresholds}>\n          Get optimal thresholds\n        </button>`}render(){const t=this.binaryClassificationKeys.map(t=>this.renderTable(t));return o.html`\n        <div class='module-container'>\n          <div class='module-toolbar'>\n            ${this.renderControls()}\n          </div>\n          <div class='module-results-area ${d.SCROLL_SYNC_CSS_CLASS}'>\n            ${t}\n          </div>\n        </div>\n        `}static shouldDisplayModule(t,e){return(0,u.doesOutputSpecContain)(t,[\"MulticlassPreds\"],u.isBinaryClassification)}};m.title=\"Binary Classifier Thresholds\",m.numCols=3,m.template=(t=\"\",e=0)=>o.html`<thresholder-module model=${t} selectionServiceIndex=${e}></thresholder-module>`,i.__decorate([s.observable,i.__metadata(\"design:type\",Array)],m.prototype,\"selectedFacets\",void 0),i.__decorate([s.observable,i.__metadata(\"design:type\",Object)],m.prototype,\"calculatedMargins\",void 0),i.__decorate([s.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],m.prototype,\"binaryClassificationKeys\",null),i.__decorate([s.computed,i.__metadata(\"design:type\",Object),i.__metadata(\"design:paramtypes\",[])],m.prototype,\"groupedExamples\",null),m=i.__decorate([(0,r.customElement)(\"thresholder-module\")],m),e.ThresholderModule=m},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.ThresholdSlider=void 0;const i=n(1),r=n(2),o=n(2),a=n(3),s=n(13),c=n(7),l=n(8);let d=class extends a.LitElement{constructor(){super(...arguments),this.margin=0,this.label=\"\",this.isThreshold=!0,this.showControls=!1}static get styles(){return[c.styles,a.css`\n        .slider-row {\n          display: flex;\n          flex-wrap: wrap;\n          align-items: start;\n          justify-content: center;\n        }\n\n        .text-with-controls {\n          padding-top: 9px;\n        }\n\n        .text-no-controls {\n          padding-top: 2px;\n        }\n\n        .slider-val {\n          color: var(--lit-neutral-600);\n          margin-top: -3px; /*Accounts for custom thumb offset in lit-slider*/\n          margin-left: 2px;\n          width: 30px;\n        }\n\n        .hairline-button.reset-button {\n          margin: 5px;\n          padding: 5px 10px;\n        }\n    `]}renderThresholdSlider(t,e){return this.renderSlider(t,e,0,1,.01,t=>{const n=+t.target.value,i=(0,l.getMarginFromThreshold)(n),r=new CustomEvent(\"threshold-changed\",{detail:{label:e,margin:i}});this.dispatchEvent(r)},t=>{const e=(0,l.getThresholdFromMargin)(+t);return Math.round(100*e)/100},\"threshold\")}renderMarginSlider(t,e){return this.renderSlider(t,e,-5,5,.05,t=>{const n=t.target.value,i=new CustomEvent(\"threshold-changed\",{detail:{label:e,margin:n}});this.dispatchEvent(i)},t=>t,\"margin\")}renderSlider(t,e,n,i,r,o,c,l){const d=c(t),u=0===t,h={\"text-with-controls\":this.showControls,\"text-no-controls\":!this.showControls},p={\"text-with-controls\":this.showControls,\"text-no-controls\":!this.showControls,\"slider-val\":!0};return a.html`\n        <div class=\"slider-row\">\n          ${(()=>this.showControls?a.html`\n          <div class=${(0,s.classMap)(h)}>${e} ${l}:</div>`:null)()}\n          <lit-slider min=\"${n}\" max=\"${i}\" step=\"${r}\" val=\"${d}\"\n                      .onChange=${o}></lit-slider>\n          <div class=${(0,s.classMap)(p)}>${d}</div>\n          ${this.showControls?a.html`<button class='hairline-button reset-button' @click=${()=>{const t=new CustomEvent(\"threshold-changed\",{detail:{label:e,margin:0}});this.dispatchEvent(t)}}\n                   ?disabled=\"${u}\">Reset</button>`:null}\n        </div>`}render(){return a.html`${this.isThreshold?this.renderThresholdSlider(this.margin,this.label):this.renderMarginSlider(this.margin,this.label)}`}};i.__decorate([(0,r.property)({type:Number}),i.__metadata(\"design:type\",Object)],d.prototype,\"margin\",void 0),i.__decorate([(0,r.property)({type:String}),i.__metadata(\"design:type\",Object)],d.prototype,\"label\",void 0),i.__decorate([(0,r.property)({type:Boolean}),i.__metadata(\"design:type\",Object)],d.prototype,\"isThreshold\",void 0),i.__decorate([(0,r.property)({type:Boolean}),i.__metadata(\"design:type\",Object)],d.prototype,\"showControls\",void 0),d=i.__decorate([(0,o.customElement)(\"threshold-slider\")],d),e.ThresholdSlider=d},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"TextField\",(function(){return z}));var i=n(1),r=n(0),o=n(18),a=n(16),s={NOTCH_ELEMENT_SELECTOR:\".mdc-notched-outline__notch\"},c={NOTCH_ELEMENT_PADDING:8},l={NO_LABEL:\"mdc-notched-outline--no-label\",OUTLINE_NOTCHED:\"mdc-notched-outline--notched\",OUTLINE_UPGRADED:\"mdc-notched-outline--upgraded\"},d=function(t){function e(n){return t.call(this,Object(i.__assign)(Object(i.__assign)({},e.defaultAdapter),n))||this}return Object(i.__extends)(e,t),Object.defineProperty(e,\"strings\",{get:function(){return s},enumerable:!0,configurable:!0}),Object.defineProperty(e,\"cssClasses\",{get:function(){return l},enumerable:!0,configurable:!0}),Object.defineProperty(e,\"numbers\",{get:function(){return c},enumerable:!0,configurable:!0}),Object.defineProperty(e,\"defaultAdapter\",{get:function(){return{addClass:function(){},removeClass:function(){},setNotchWidthProperty:function(){},removeNotchWidthProperty:function(){}}},enumerable:!0,configurable:!0}),e.prototype.notch=function(t){var n=e.cssClasses.OUTLINE_NOTCHED;t>0&&(t+=c.NOTCH_ELEMENT_PADDING),this.adapter_.setNotchWidthProperty(t),this.adapter_.addClass(n)},e.prototype.closeNotch=function(){var t=e.cssClasses.OUTLINE_NOTCHED;this.adapter_.removeClass(t),this.adapter_.removeNotchWidthProperty()},e}(a.a);\n/**\n@license\nCopyright 2019 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\nclass u extends o.a{constructor(){super(...arguments),this.mdcFoundationClass=d,this.width=0,this.open=!1,this.lastOpen=this.open}createAdapter(){return{addClass:t=>this.mdcRoot.classList.add(t),removeClass:t=>this.mdcRoot.classList.remove(t),setNotchWidthProperty:t=>this.notchElement.style.setProperty(\"width\",t+\"px\"),removeNotchWidthProperty:()=>this.notchElement.style.removeProperty(\"width\")}}openOrClose(t,e){this.mdcFoundation&&(t&&void 0!==e?this.mdcFoundation.notch(e):this.mdcFoundation.closeNotch())}render(){return this.openOrClose(this.open,this.width),r.e`\n      <span class=\"mdc-notched-outline\">\n        <span class=\"mdc-notched-outline__leading\"></span>\n        <span class=\"mdc-notched-outline__notch\">\n          <slot></slot>\n        </span>\n        <span class=\"mdc-notched-outline__trailing\"></span>\n      </span>`}}Object(i.__decorate)([Object(r.h)(\".mdc-notched-outline\")],u.prototype,\"mdcRoot\",void 0),Object(i.__decorate)([Object(r.g)({type:Number})],u.prototype,\"width\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean,reflect:!0})],u.prototype,\"open\",void 0),Object(i.__decorate)([Object(r.h)(\".mdc-notched-outline__notch\")],u.prototype,\"notchElement\",void 0);\n/**\n@license\nCopyright 2018 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\nconst h=r.b`.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline,.mdc-notched-outline[dir=rtl]{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;border-top:1px solid;border-bottom:1px solid;pointer-events:none}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}[dir=rtl] .mdc-notched-outline__leading,.mdc-notched-outline__leading[dir=rtl]{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid;flex-grow:1}[dir=rtl] .mdc-notched-outline__trailing,.mdc-notched-outline__trailing[dir=rtl]{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{flex:0 0 auto;width:auto;max-width:calc(100% - 12px * 2)}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(100% / .75)}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch,.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl]{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{padding:0}:host{display:block;position:absolute;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] :host,:host[dir=rtl]{text-align:right}::slotted(.mdc-floating-label){display:inline-block;position:relative;top:17px;bottom:auto;max-width:100%}::slotted(.mdc-floating-label--float-above){text-overflow:clip}.mdc-notched-outline--upgraded ::slotted(.mdc-floating-label--float-above){max-width:calc(100% / .75)}.mdc-notched-outline__leading{width:12px;width:var(--mdc-notched-outline-leading-width, 12px);border-radius:4px 0 0 4px;border-radius:var(--mdc-notched-outline-leading-border-radius, 4px 0 0 4px)}.mdc-notched-outline__trailing{border-radius:0 4px 4px 0;border-radius:var(--mdc-notched-outline-trailing-border-radius, 0 4px 4px 0)}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{border-color:var(--mdc-notched-outline-border-color, var(--mdc-theme-primary, #6200ee));border-width:1px;border-width:var(--mdc-notched-outline-stroke-width, 1px)}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0;padding-top:var(--mdc-notched-outline-notch-offset, 0)}`;\n/**\n@license\nCopyright 2019 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/let p=class extends u{};p.styles=h,p=Object(i.__decorate)([Object(r.c)(\"mwc-notched-outline\")],p);var f=n(24),m={LABEL_FLOAT_ABOVE:\"mdc-floating-label--float-above\",LABEL_SHAKE:\"mdc-floating-label--shake\",ROOT:\"mdc-floating-label\"},g=function(t){function e(n){var r=t.call(this,Object(i.__assign)(Object(i.__assign)({},e.defaultAdapter),n))||this;return r.shakeAnimationEndHandler_=function(){return r.handleShakeAnimationEnd_()},r}return Object(i.__extends)(e,t),Object.defineProperty(e,\"cssClasses\",{get:function(){return m},enumerable:!0,configurable:!0}),Object.defineProperty(e,\"defaultAdapter\",{get:function(){return{addClass:function(){},removeClass:function(){},getWidth:function(){return 0},registerInteractionHandler:function(){},deregisterInteractionHandler:function(){}}},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.adapter_.registerInteractionHandler(\"animationend\",this.shakeAnimationEndHandler_)},e.prototype.destroy=function(){this.adapter_.deregisterInteractionHandler(\"animationend\",this.shakeAnimationEndHandler_)},e.prototype.getWidth=function(){return this.adapter_.getWidth()},e.prototype.shake=function(t){var n=e.cssClasses.LABEL_SHAKE;t?this.adapter_.addClass(n):this.adapter_.removeClass(n)},e.prototype.float=function(t){var n=e.cssClasses,i=n.LABEL_FLOAT_ABOVE,r=n.LABEL_SHAKE;t?this.adapter_.addClass(i):(this.adapter_.removeClass(i),this.adapter_.removeClass(r))},e.prototype.handleShakeAnimationEnd_=function(){var t=e.cssClasses.LABEL_SHAKE;this.adapter_.removeClass(t)},e}(a.a),v=n(9);\n/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */const y=new WeakMap,b=Object(v.f)(t=>e=>{const n=y.get(e);if(n){if(n.label!==t){const t=e.committer.element,n=new Event(\"labelchange\");t.dispatchEvent(n)}}else{const n=e.committer.element;n.classList.add(\"mdc-floating-label\");const i=(t=>({addClass:e=>t.classList.add(e),removeClass:e=>t.classList.remove(e),getWidth:()=>t.scrollWidth,registerInteractionHandler:(e,n)=>{t.addEventListener(e,n)},deregisterInteractionHandler:(e,n)=>{t.removeEventListener(e,n)}}))(n),r=new g(i);r.init(),e.setValue(r),y.set(e,{label:t,foundation:r})}});\n/**\n * @license\n * Copyright 2018 Google Inc.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nvar _={LINE_RIPPLE_ACTIVE:\"mdc-line-ripple--active\",LINE_RIPPLE_DEACTIVATING:\"mdc-line-ripple--deactivating\"},x=function(t){function e(n){var r=t.call(this,Object(i.__assign)(Object(i.__assign)({},e.defaultAdapter),n))||this;return r.transitionEndHandler_=function(t){return r.handleTransitionEnd(t)},r}return Object(i.__extends)(e,t),Object.defineProperty(e,\"cssClasses\",{get:function(){return _},enumerable:!0,configurable:!0}),Object.defineProperty(e,\"defaultAdapter\",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},setStyle:function(){},registerEventHandler:function(){},deregisterEventHandler:function(){}}},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.adapter_.registerEventHandler(\"transitionend\",this.transitionEndHandler_)},e.prototype.destroy=function(){this.adapter_.deregisterEventHandler(\"transitionend\",this.transitionEndHandler_)},e.prototype.activate=function(){this.adapter_.removeClass(_.LINE_RIPPLE_DEACTIVATING),this.adapter_.addClass(_.LINE_RIPPLE_ACTIVE)},e.prototype.setRippleCenter=function(t){this.adapter_.setStyle(\"transform-origin\",t+\"px center\")},e.prototype.deactivate=function(){this.adapter_.addClass(_.LINE_RIPPLE_DEACTIVATING)},e.prototype.handleTransitionEnd=function(t){var e=this.adapter_.hasClass(_.LINE_RIPPLE_DEACTIVATING);\"opacity\"===t.propertyName&&e&&(this.adapter_.removeClass(_.LINE_RIPPLE_ACTIVE),this.adapter_.removeClass(_.LINE_RIPPLE_DEACTIVATING))},e}(a.a);\n/**\n * @license\n * Copyright 2018 Google Inc.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */const w=new WeakMap,S=Object(v.f)(()=>t=>{if(!w.get(t)){const e=t.committer.element;e.classList.add(\"mdc-line-ripple\");const n=(t=>({addClass:e=>t.classList.add(e),removeClass:e=>t.classList.remove(e),hasClass:e=>t.classList.contains(e),setStyle:(e,n)=>t.style.setProperty(e,n),registerEventHandler:(e,n)=>{t.addEventListener(e,n)},deregisterEventHandler:(e,n)=>{t.removeEventListener(e,n)}}))(e),i=new x(n);i.init(),t.setValue(i),w.set(t,i)}});\n/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nvar M={ARIA_CONTROLS:\"aria-controls\",INPUT_SELECTOR:\".mdc-text-field__input\",LABEL_SELECTOR:\".mdc-floating-label\",LEADING_ICON_SELECTOR:\".mdc-text-field__icon--leading\",LINE_RIPPLE_SELECTOR:\".mdc-line-ripple\",OUTLINE_SELECTOR:\".mdc-notched-outline\",PREFIX_SELECTOR:\".mdc-text-field__affix--prefix\",SUFFIX_SELECTOR:\".mdc-text-field__affix--suffix\",TRAILING_ICON_SELECTOR:\".mdc-text-field__icon--trailing\"},E={DISABLED:\"mdc-text-field--disabled\",FOCUSED:\"mdc-text-field--focused\",FULLWIDTH:\"mdc-text-field--fullwidth\",HELPER_LINE:\"mdc-text-field-helper-line\",INVALID:\"mdc-text-field--invalid\",LABEL_FLOATING:\"mdc-text-field--label-floating\",NO_LABEL:\"mdc-text-field--no-label\",OUTLINED:\"mdc-text-field--outlined\",ROOT:\"mdc-text-field\",TEXTAREA:\"mdc-text-field--textarea\",WITH_LEADING_ICON:\"mdc-text-field--with-leading-icon\",WITH_TRAILING_ICON:\"mdc-text-field--with-trailing-icon\"},T={LABEL_SCALE:.75},C=[\"pattern\",\"min\",\"max\",\"required\",\"step\",\"minlength\",\"maxlength\"],A=[\"color\",\"date\",\"datetime-local\",\"month\",\"range\",\"time\",\"week\"],O=[\"mousedown\",\"touchstart\"],k=[\"click\",\"keydown\"],L=function(t){function e(n,r){void 0===r&&(r={});var o=t.call(this,Object(i.__assign)(Object(i.__assign)({},e.defaultAdapter),n))||this;return o.isFocused_=!1,o.receivedUserInput_=!1,o.isValid_=!0,o.useNativeValidation_=!0,o.helperText_=r.helperText,o.characterCounter_=r.characterCounter,o.leadingIcon_=r.leadingIcon,o.trailingIcon_=r.trailingIcon,o.inputFocusHandler_=function(){return o.activateFocus()},o.inputBlurHandler_=function(){return o.deactivateFocus()},o.inputInputHandler_=function(){return o.handleInput()},o.setPointerXOffset_=function(t){return o.setTransformOrigin(t)},o.textFieldInteractionHandler_=function(){return o.handleTextFieldInteraction()},o.validationAttributeChangeHandler_=function(t){return o.handleValidationAttributeChange(t)},o}return Object(i.__extends)(e,t),Object.defineProperty(e,\"cssClasses\",{get:function(){return E},enumerable:!0,configurable:!0}),Object.defineProperty(e,\"strings\",{get:function(){return M},enumerable:!0,configurable:!0}),Object.defineProperty(e,\"numbers\",{get:function(){return T},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"shouldAlwaysFloat_\",{get:function(){var t=this.getNativeInput_().type;return A.indexOf(t)>=0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"shouldFloat\",{get:function(){return this.shouldAlwaysFloat_||this.isFocused_||!!this.getValue()||this.isBadInput_()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"shouldShake\",{get:function(){return!this.isFocused_&&!this.isValid()&&!!this.getValue()},enumerable:!0,configurable:!0}),Object.defineProperty(e,\"defaultAdapter\",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!0},registerTextFieldInteractionHandler:function(){},deregisterTextFieldInteractionHandler:function(){},registerInputInteractionHandler:function(){},deregisterInputInteractionHandler:function(){},registerValidationAttributeChangeHandler:function(){return new MutationObserver((function(){}))},deregisterValidationAttributeChangeHandler:function(){},getNativeInput:function(){return null},isFocused:function(){return!1},activateLineRipple:function(){},deactivateLineRipple:function(){},setLineRippleTransformOrigin:function(){},shakeLabel:function(){},floatLabel:function(){},hasLabel:function(){return!1},getLabelWidth:function(){return 0},hasOutline:function(){return!1},notchOutline:function(){},closeOutline:function(){}}},enumerable:!0,configurable:!0}),e.prototype.init=function(){var t=this;this.adapter_.isFocused()?this.inputFocusHandler_():this.adapter_.hasLabel()&&this.shouldFloat&&(this.notchOutline(!0),this.adapter_.floatLabel(!0),this.styleFloating_(!0)),this.adapter_.registerInputInteractionHandler(\"focus\",this.inputFocusHandler_),this.adapter_.registerInputInteractionHandler(\"blur\",this.inputBlurHandler_),this.adapter_.registerInputInteractionHandler(\"input\",this.inputInputHandler_),O.forEach((function(e){t.adapter_.registerInputInteractionHandler(e,t.setPointerXOffset_)})),k.forEach((function(e){t.adapter_.registerTextFieldInteractionHandler(e,t.textFieldInteractionHandler_)})),this.validationObserver_=this.adapter_.registerValidationAttributeChangeHandler(this.validationAttributeChangeHandler_),this.setCharacterCounter_(this.getValue().length)},e.prototype.destroy=function(){var t=this;this.adapter_.deregisterInputInteractionHandler(\"focus\",this.inputFocusHandler_),this.adapter_.deregisterInputInteractionHandler(\"blur\",this.inputBlurHandler_),this.adapter_.deregisterInputInteractionHandler(\"input\",this.inputInputHandler_),O.forEach((function(e){t.adapter_.deregisterInputInteractionHandler(e,t.setPointerXOffset_)})),k.forEach((function(e){t.adapter_.deregisterTextFieldInteractionHandler(e,t.textFieldInteractionHandler_)})),this.adapter_.deregisterValidationAttributeChangeHandler(this.validationObserver_)},e.prototype.handleTextFieldInteraction=function(){var t=this.adapter_.getNativeInput();t&&t.disabled||(this.receivedUserInput_=!0)},e.prototype.handleValidationAttributeChange=function(t){var e=this;t.some((function(t){return C.indexOf(t)>-1&&(e.styleValidity_(!0),!0)})),t.indexOf(\"maxlength\")>-1&&this.setCharacterCounter_(this.getValue().length)},e.prototype.notchOutline=function(t){if(this.adapter_.hasOutline())if(t){var e=this.adapter_.getLabelWidth()*T.LABEL_SCALE;this.adapter_.notchOutline(e)}else this.adapter_.closeOutline()},e.prototype.activateFocus=function(){this.isFocused_=!0,this.styleFocused_(this.isFocused_),this.adapter_.activateLineRipple(),this.adapter_.hasLabel()&&(this.notchOutline(this.shouldFloat),this.adapter_.floatLabel(this.shouldFloat),this.styleFloating_(this.shouldFloat),this.adapter_.shakeLabel(this.shouldShake)),this.helperText_&&this.helperText_.showToScreenReader()},e.prototype.setTransformOrigin=function(t){var e=t.touches,n=e?e[0]:t,i=n.target.getBoundingClientRect(),r=n.clientX-i.left;this.adapter_.setLineRippleTransformOrigin(r)},e.prototype.handleInput=function(){this.autoCompleteFocus(),this.setCharacterCounter_(this.getValue().length)},e.prototype.autoCompleteFocus=function(){this.receivedUserInput_||this.activateFocus()},e.prototype.deactivateFocus=function(){this.isFocused_=!1,this.adapter_.deactivateLineRipple();var t=this.isValid();this.styleValidity_(t),this.styleFocused_(this.isFocused_),this.adapter_.hasLabel()&&(this.notchOutline(this.shouldFloat),this.adapter_.floatLabel(this.shouldFloat),this.styleFloating_(this.shouldFloat),this.adapter_.shakeLabel(this.shouldShake)),this.shouldFloat||(this.receivedUserInput_=!1)},e.prototype.getValue=function(){return this.getNativeInput_().value},e.prototype.setValue=function(t){this.getValue()!==t&&(this.getNativeInput_().value=t),this.setCharacterCounter_(t.length);var e=this.isValid();this.styleValidity_(e),this.adapter_.hasLabel()&&(this.notchOutline(this.shouldFloat),this.adapter_.floatLabel(this.shouldFloat),this.styleFloating_(this.shouldFloat),this.adapter_.shakeLabel(this.shouldShake))},e.prototype.isValid=function(){return this.useNativeValidation_?this.isNativeInputValid_():this.isValid_},e.prototype.setValid=function(t){this.isValid_=t,this.styleValidity_(t);var e=!t&&!this.isFocused_&&!!this.getValue();this.adapter_.hasLabel()&&this.adapter_.shakeLabel(e)},e.prototype.setUseNativeValidation=function(t){this.useNativeValidation_=t},e.prototype.isDisabled=function(){return this.getNativeInput_().disabled},e.prototype.setDisabled=function(t){this.getNativeInput_().disabled=t,this.styleDisabled_(t)},e.prototype.setHelperTextContent=function(t){this.helperText_&&this.helperText_.setContent(t)},e.prototype.setLeadingIconAriaLabel=function(t){this.leadingIcon_&&this.leadingIcon_.setAriaLabel(t)},e.prototype.setLeadingIconContent=function(t){this.leadingIcon_&&this.leadingIcon_.setContent(t)},e.prototype.setTrailingIconAriaLabel=function(t){this.trailingIcon_&&this.trailingIcon_.setAriaLabel(t)},e.prototype.setTrailingIconContent=function(t){this.trailingIcon_&&this.trailingIcon_.setContent(t)},e.prototype.setCharacterCounter_=function(t){if(this.characterCounter_){var e=this.getNativeInput_().maxLength;if(-1===e)throw new Error(\"MDCTextFieldFoundation: Expected maxlength html property on text input or textarea.\");this.characterCounter_.setCounterValue(t,e)}},e.prototype.isBadInput_=function(){return this.getNativeInput_().validity.badInput||!1},e.prototype.isNativeInputValid_=function(){return this.getNativeInput_().validity.valid},e.prototype.styleValidity_=function(t){var n=e.cssClasses.INVALID;t?this.adapter_.removeClass(n):this.adapter_.addClass(n),this.helperText_&&this.helperText_.setValidity(t)},e.prototype.styleFocused_=function(t){var n=e.cssClasses.FOCUSED;t?this.adapter_.addClass(n):this.adapter_.removeClass(n)},e.prototype.styleDisabled_=function(t){var n=e.cssClasses,i=n.DISABLED,r=n.INVALID;t?(this.adapter_.addClass(i),this.adapter_.removeClass(r)):this.adapter_.removeClass(i),this.leadingIcon_&&this.leadingIcon_.setDisabled(t),this.trailingIcon_&&this.trailingIcon_.setDisabled(t)},e.prototype.styleFloating_=function(t){var n=e.cssClasses.LABEL_FLOATING;t?this.adapter_.addClass(n):this.adapter_.removeClass(n)},e.prototype.getNativeInput_=function(){return(this.adapter_?this.adapter_.getNativeInput():null)||{disabled:!1,maxLength:-1,type:\"input\",validity:{badInput:!1,valid:!0},value:\"\"}},e}(a.a),I=n(29),R=n(27);\n/**\n * @license\n * Copyright (c) 2020 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nconst P=Object(v.f)(t=>e=>{let n;if(e instanceof v.c||e instanceof v.d)throw new Error(\"The `live` directive is not allowed on text or event bindings\");if(e instanceof v.b)D(e.strings),n=e.element.hasAttribute(e.name),e.value=n;else{const{element:i,name:r,strings:o}=e.committer;if(D(o),e instanceof v.e){if(n=i[r],n===t)return}else e instanceof v.a&&(n=i.getAttribute(r));if(n===String(t))return}e.setValue(t)}),D=t=>{if(2!==t.length||\"\"!==t[0]||\"\"!==t[1])throw new Error(\"`live` bindings can only contain a single expression\")},N=[\"touchstart\",\"touchmove\",\"scroll\",\"mousewheel\"],F=(t={})=>{const e={};for(const n in t)e[n]=t[n];return Object.assign({badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valid:!0,valueMissing:!1},e)};class j extends f.a{constructor(){super(...arguments),this.mdcFoundationClass=L,this.value=\"\",this.type=\"text\",this.placeholder=\"\",this.label=\"\",this.icon=\"\",this.iconTrailing=\"\",this.disabled=!1,this.required=!1,this.minLength=-1,this.maxLength=-1,this.outlined=!1,this.fullWidth=!1,this.helper=\"\",this.validateOnInitialRender=!1,this.validationMessage=\"\",this.autoValidate=!1,this.pattern=\"\",this.min=\"\",this.max=\"\",this.step=null,this.size=null,this.helperPersistent=!1,this.charCounter=!1,this.endAligned=!1,this.prefix=\"\",this.suffix=\"\",this.readOnly=!1,this.outlineOpen=!1,this.outlineWidth=0,this.isUiValid=!0,this._validity=F(),this._outlineUpdateComplete=null,this.validityTransform=null}get validity(){return this._checkValidity(this.value),this._validity}get willValidate(){return this.formElement.willValidate}get selectionStart(){return this.formElement.selectionStart}get selectionEnd(){return this.formElement.selectionEnd}get shouldRenderHelperText(){return!!this.helper||!!this.validationMessage||this.charCounterVisible}get charCounterVisible(){return this.charCounter&&-1!==this.maxLength}focus(){const t=new CustomEvent(\"focus\");this.formElement.dispatchEvent(t),this.formElement.focus()}blur(){const t=new CustomEvent(\"blur\");this.formElement.dispatchEvent(t),this.formElement.blur()}select(){this.formElement.select()}setSelectionRange(t,e,n){this.formElement.setSelectionRange(t,e,n)}render(){const t={\"mdc-text-field--disabled\":this.disabled,\"mdc-text-field--no-label\":!this.label,\"mdc-text-field--filled\":!this.outlined,\"mdc-text-field--outlined\":this.outlined,\"mdc-text-field--fullwidth\":this.fullWidth,\"mdc-text-field--with-leading-icon\":this.icon,\"mdc-text-field--with-trailing-icon\":this.iconTrailing,\"mdc-text-field--end-aligned\":this.endAligned},e=this.outlined?\"\":r.e`<div class=\"mdc-text-field__ripple\"></div>`;return r.e`\n      <label class=\"mdc-text-field ${Object(I.a)(t)}\">\n        ${e}\n        ${this.icon?this.renderIcon(this.icon):\"\"}\n        ${this.prefix?this.renderAffix(this.prefix):\"\"}\n        ${this.renderInput()}\n        ${this.suffix?this.renderAffix(this.suffix,!0):\"\"}\n        ${this.iconTrailing?this.renderIcon(this.iconTrailing,!0):\"\"}\n        ${this.outlined?this.renderOutlined():this.renderLabelText()}\n      </label>\n      ${this.renderHelperText(this.renderCharCounter())}\n    `}updated(t){t.has(\"value\")&&void 0!==t.get(\"value\")&&this.mdcFoundation.setValue(this.value)}renderInput(){const t=-1===this.minLength?void 0:this.minLength,e=-1===this.maxLength?void 0:this.maxLength;return r.e`\n      <input\n          aria-labelledby=\"label\"\n          class=\"mdc-text-field__input\"\n          type=\"${this.type}\"\n          .value=\"${P(this.value)}\"\n          ?disabled=\"${this.disabled}\"\n          placeholder=\"${this.placeholder}\"\n          ?required=\"${this.required}\"\n          ?readonly=\"${this.readOnly}\"\n          minlength=\"${Object(R.a)(t)}\"\n          maxlength=\"${Object(R.a)(e)}\"\n          pattern=\"${Object(R.a)(this.pattern?this.pattern:void 0)}\"\n          min=\"${Object(R.a)(\"\"===this.min?void 0:this.min)}\"\n          max=\"${Object(R.a)(\"\"===this.max?void 0:this.max)}\"\n          step=\"${Object(R.a)(null===this.step?void 0:this.step)}\"\n          size=\"${Object(R.a)(null===this.size?void 0:this.size)}\"\n          inputmode=\"${Object(R.a)(this.inputMode)}\"\n          @input=\"${this.handleInputChange}\"\n          @blur=\"${this.onInputBlur}\">`}renderAffix(t,e=!1){const n={\"mdc-text-field__affix--prefix\":!e,\"mdc-text-field__affix--suffix\":e};return r.e`<span class=\"mdc-text-field__affix ${Object(I.a)(n)}\">\n        ${t}</span>`}renderIcon(t,e=!1){const n={\"mdc-text-field__icon--leading\":!e,\"mdc-text-field__icon--trailing\":e};return r.e`<i class=\"material-icons mdc-text-field__icon ${Object(I.a)(n)}\">${t}</i>`}renderOutlined(){let t=\"\";return this.label&&(t=r.e`\n        <span\n            .floatingLabelFoundation=${b(this.label)}\n            @labelchange=${this.onLabelChange}\n            id=\"label\">\n          ${this.label}\n        </span>\n      `),r.e`\n      <mwc-notched-outline\n          .width=${this.outlineWidth}\n          .open=${this.outlineOpen}\n          class=\"mdc-notched-outline\">\n        ${t}\n      </mwc-notched-outline>`}renderLabelText(){let t=\"\";return this.label&&!this.fullWidth&&(t=r.e`\n      <span\n          .floatingLabelFoundation=${b(this.label)}\n          id=\"label\">\n        ${this.label}\n      </span>`),r.e`\n      ${t}\n      <span .lineRippleFoundation=${S()}></span>\n    `}renderHelperText(t){if(!this.shouldRenderHelperText)return;const e=this.validationMessage&&!this.isUiValid,n={\"mdc-text-field-helper-text--persistent\":this.helperPersistent,\"mdc-text-field-helper-text--validation-msg\":e};return r.e`\n      <div class=\"mdc-text-field-helper-line\">\n        <div class=\"mdc-text-field-helper-text ${Object(I.a)(n)}\">${e?this.validationMessage:this.helper}</div>\n        ${t}\n      </div>\n    `}renderCharCounter(){if(!this.charCounterVisible)return;const t=Math.min(this.value.length,this.maxLength);return r.e`<span class=\"mdc-text-field-character-counter\">${t} / ${this.maxLength}</span>`}onInputBlur(){this.reportValidity()}checkValidity(){const t=this._checkValidity(this.value);if(!t){const t=new Event(\"invalid\",{bubbles:!1,cancelable:!0});this.dispatchEvent(t)}return t}reportValidity(){const t=this.checkValidity();return this.mdcFoundation.setValid(t),this.isUiValid=t,t}_checkValidity(t){const e=this.formElement.validity;let n=F(e);if(this.validityTransform){const e=this.validityTransform(t,n);n=Object.assign(Object.assign({},n),e),this.mdcFoundation.setUseNativeValidation(!1)}else this.mdcFoundation.setUseNativeValidation(!0);return this._validity=n,this._validity.valid}setCustomValidity(t){this.validationMessage=t,this.formElement.setCustomValidity(t)}handleInputChange(){this.value=this.formElement.value,this.autoValidate&&this.reportValidity()}createFoundation(){void 0!==this.mdcFoundation&&this.mdcFoundation.destroy(),this.mdcFoundation=new this.mdcFoundationClass(this.createAdapter()),this.mdcFoundation.init()}createAdapter(){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},this.getRootAdapterMethods()),this.getInputAdapterMethods()),this.getLabelAdapterMethods()),this.getLineRippleAdapterMethods()),this.getOutlineAdapterMethods())}getRootAdapterMethods(){return Object.assign({registerTextFieldInteractionHandler:(t,e)=>this.addEventListener(t,e),deregisterTextFieldInteractionHandler:(t,e)=>this.removeEventListener(t,e),registerValidationAttributeChangeHandler:t=>{const e=new MutationObserver(e=>{t((t=>t.map(t=>t.attributeName).filter(t=>t))(e))});return e.observe(this.formElement,{attributes:!0}),e},deregisterValidationAttributeChangeHandler:t=>t.disconnect()},Object(f.b)(this.mdcRoot))}getInputAdapterMethods(){return{getNativeInput:()=>this.formElement,isFocused:()=>!!this.shadowRoot&&this.shadowRoot.activeElement===this.formElement,registerInputInteractionHandler:(t,e)=>this.formElement.addEventListener(t,e,{passive:t in N}),deregisterInputInteractionHandler:(t,e)=>this.formElement.removeEventListener(t,e)}}getLabelAdapterMethods(){return{floatLabel:t=>this.labelElement&&this.labelElement.floatingLabelFoundation.float(t),getLabelWidth:()=>this.labelElement?this.labelElement.floatingLabelFoundation.getWidth():0,hasLabel:()=>Boolean(this.labelElement),shakeLabel:t=>this.labelElement&&this.labelElement.floatingLabelFoundation.shake(t)}}getLineRippleAdapterMethods(){return{activateLineRipple:()=>{this.lineRippleElement&&this.lineRippleElement.lineRippleFoundation.activate()},deactivateLineRipple:()=>{this.lineRippleElement&&this.lineRippleElement.lineRippleFoundation.deactivate()},setLineRippleTransformOrigin:t=>{this.lineRippleElement&&this.lineRippleElement.lineRippleFoundation.setRippleCenter(t)}}}async _getUpdateComplete(){await super._getUpdateComplete(),await this._outlineUpdateComplete}async firstUpdated(){const t=this.outlineElement;t&&(this._outlineUpdateComplete=t.updateComplete,await this._outlineUpdateComplete),super.firstUpdated(),this.validateOnInitialRender&&this.reportValidity()}getOutlineAdapterMethods(){return{closeOutline:()=>this.outlineElement&&(this.outlineOpen=!1),hasOutline:()=>Boolean(this.outlineElement),notchOutline:t=>{this.outlineElement&&!this.outlineOpen&&(this.outlineWidth=t,this.outlineOpen=!0)}}}async onLabelChange(){this.label&&await this.layout()}async layout(){if(await this.updateComplete,this.labelElement&&this.outlineElement){const t=this.labelElement.floatingLabelFoundation.getWidth();this.outlineOpen&&(this.outlineWidth=t)}}}Object(i.__decorate)([Object(r.h)(\".mdc-text-field\")],j.prototype,\"mdcRoot\",void 0),Object(i.__decorate)([Object(r.h)(\"input\")],j.prototype,\"formElement\",void 0),Object(i.__decorate)([Object(r.h)(\".mdc-floating-label\")],j.prototype,\"labelElement\",void 0),Object(i.__decorate)([Object(r.h)(\".mdc-line-ripple\")],j.prototype,\"lineRippleElement\",void 0),Object(i.__decorate)([Object(r.h)(\"mwc-notched-outline\")],j.prototype,\"outlineElement\",void 0),Object(i.__decorate)([Object(r.h)(\".mdc-notched-outline__notch\")],j.prototype,\"notchElement\",void 0),Object(i.__decorate)([Object(r.g)({type:String})],j.prototype,\"value\",void 0),Object(i.__decorate)([Object(r.g)({type:String})],j.prototype,\"type\",void 0),Object(i.__decorate)([Object(r.g)({type:String})],j.prototype,\"placeholder\",void 0),Object(i.__decorate)([Object(r.g)({type:String})],j.prototype,\"label\",void 0),Object(i.__decorate)([Object(r.g)({type:String})],j.prototype,\"icon\",void 0),Object(i.__decorate)([Object(r.g)({type:String})],j.prototype,\"iconTrailing\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean,reflect:!0})],j.prototype,\"disabled\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],j.prototype,\"required\",void 0),Object(i.__decorate)([Object(r.g)({type:Number})],j.prototype,\"minLength\",void 0),Object(i.__decorate)([Object(r.g)({type:Number})],j.prototype,\"maxLength\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean,reflect:!0})],j.prototype,\"outlined\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean,reflect:!0})],j.prototype,\"fullWidth\",void 0),Object(i.__decorate)([Object(r.g)({type:String})],j.prototype,\"helper\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],j.prototype,\"validateOnInitialRender\",void 0),Object(i.__decorate)([Object(r.g)({type:String})],j.prototype,\"validationMessage\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],j.prototype,\"autoValidate\",void 0),Object(i.__decorate)([Object(r.g)({type:String})],j.prototype,\"pattern\",void 0),Object(i.__decorate)([Object(r.g)({type:Number})],j.prototype,\"min\",void 0),Object(i.__decorate)([Object(r.g)({type:Number})],j.prototype,\"max\",void 0),Object(i.__decorate)([Object(r.g)({type:Number})],j.prototype,\"step\",void 0),Object(i.__decorate)([Object(r.g)({type:Number})],j.prototype,\"size\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],j.prototype,\"helperPersistent\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],j.prototype,\"charCounter\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],j.prototype,\"endAligned\",void 0),Object(i.__decorate)([Object(r.g)({type:String})],j.prototype,\"prefix\",void 0),Object(i.__decorate)([Object(r.g)({type:String})],j.prototype,\"suffix\",void 0),Object(i.__decorate)([Object(r.g)({type:String})],j.prototype,\"inputMode\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],j.prototype,\"readOnly\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],j.prototype,\"outlineOpen\",void 0),Object(i.__decorate)([Object(r.g)({type:Number})],j.prototype,\"outlineWidth\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],j.prototype,\"isUiValid\",void 0),Object(i.__decorate)([Object(r.d)({passive:!0})],j.prototype,\"handleInputChange\",null);\n/**\n@license\nCopyright 2018 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\nconst B=r.b`.mdc-floating-label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-subtitle1-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:1rem;font-size:var(--mdc-typography-subtitle1-font-size, 1rem);font-weight:400;font-weight:var(--mdc-typography-subtitle1-font-weight, 400);letter-spacing:.009375em;letter-spacing:var(--mdc-typography-subtitle1-letter-spacing, 0.009375em);text-decoration:inherit;text-decoration:var(--mdc-typography-subtitle1-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-subtitle1-text-transform, inherit);position:absolute;left:0;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform;transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}[dir=rtl] .mdc-floating-label,.mdc-floating-label[dir=rtl]{right:0;left:auto;transform-origin:right top;text-align:right}.mdc-floating-label--float-above{cursor:auto}.mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-standard 250ms 1}@keyframes mdc-floating-label-shake-float-above-standard{0%{transform:translateX(calc(0 - 0%)) translateY(-106%) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(-106%) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(-106%) scale(0.75)}100%{transform:translateX(calc(0 - 0%)) translateY(-106%) scale(0.75)}}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:\"\"}.mdc-line-ripple::before{border-bottom-width:1px;z-index:1}.mdc-line-ripple::after{transform:scaleX(0);border-bottom-width:2px;opacity:0;z-index:2}.mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline,.mdc-notched-outline[dir=rtl]{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;border-top:1px solid;border-bottom:1px solid;pointer-events:none}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}[dir=rtl] .mdc-notched-outline__leading,.mdc-notched-outline__leading[dir=rtl]{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid;flex-grow:1}[dir=rtl] .mdc-notched-outline__trailing,.mdc-notched-outline__trailing[dir=rtl]{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{flex:0 0 auto;width:auto;max-width:calc(100% - 12px * 2)}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(100% / .75)}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch,.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl]{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{padding:0}.mdc-text-field-helper-text{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-caption-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:.75rem;font-size:var(--mdc-typography-caption-font-size, 0.75rem);line-height:1.25rem;line-height:var(--mdc-typography-caption-line-height, 1.25rem);font-weight:400;font-weight:var(--mdc-typography-caption-font-weight, 400);letter-spacing:.0333333333em;letter-spacing:var(--mdc-typography-caption-letter-spacing, 0.0333333333em);text-decoration:inherit;text-decoration:var(--mdc-typography-caption-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-caption-text-transform, inherit);display:block;margin-top:0;line-height:normal;margin:0;opacity:0;will-change:opacity;transition:opacity 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-text-field-helper-text::before{display:inline-block;width:0;height:16px;content:\"\";vertical-align:0}.mdc-text-field-helper-text--persistent{transition:none;opacity:1;will-change:initial}.mdc-text-field-character-counter{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-caption-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:.75rem;font-size:var(--mdc-typography-caption-font-size, 0.75rem);line-height:1.25rem;line-height:var(--mdc-typography-caption-line-height, 1.25rem);font-weight:400;font-weight:var(--mdc-typography-caption-font-weight, 400);letter-spacing:.0333333333em;letter-spacing:var(--mdc-typography-caption-letter-spacing, 0.0333333333em);text-decoration:inherit;text-decoration:var(--mdc-typography-caption-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-caption-text-transform, inherit);display:block;margin-top:0;line-height:normal;margin-left:auto;margin-right:0;padding-left:16px;padding-right:0;white-space:nowrap}.mdc-text-field-character-counter::before{display:inline-block;width:0;height:16px;content:\"\";vertical-align:0}[dir=rtl] .mdc-text-field-character-counter,.mdc-text-field-character-counter[dir=rtl]{margin-left:0;margin-right:auto}[dir=rtl] .mdc-text-field-character-counter,.mdc-text-field-character-counter[dir=rtl]{padding-left:0;padding-right:16px}.mdc-text-field__icon{align-self:center;cursor:pointer}.mdc-text-field__icon:not([tabindex]),.mdc-text-field__icon[tabindex=\"-1\"]{cursor:default;pointer-events:none}.mdc-text-field__icon--leading{margin-left:16px;margin-right:8px}[dir=rtl] .mdc-text-field__icon--leading,.mdc-text-field__icon--leading[dir=rtl]{margin-left:8px;margin-right:16px}.mdc-text-field__icon--trailing{margin-left:12px;margin-right:12px}[dir=rtl] .mdc-text-field__icon--trailing,.mdc-text-field__icon--trailing[dir=rtl]{margin-left:12px;margin-right:12px}@keyframes mdc-ripple-fg-radius-in{from{animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transform:translate(var(--mdc-ripple-fg-translate-start, 0)) scale(1)}to{transform:translate(var(--mdc-ripple-fg-translate-end, 0)) scale(var(--mdc-ripple-fg-scale, 1))}}@keyframes mdc-ripple-fg-opacity-in{from{animation-timing-function:linear;opacity:0}to{opacity:var(--mdc-ripple-fg-opacity, 0)}}@keyframes mdc-ripple-fg-opacity-out{from{animation-timing-function:linear;opacity:var(--mdc-ripple-fg-opacity, 0)}to{opacity:0}}.mdc-text-field--filled{--mdc-ripple-fg-size: 0;--mdc-ripple-left: 0;--mdc-ripple-top: 0;--mdc-ripple-fg-scale: 1;--mdc-ripple-fg-translate-end: 0;--mdc-ripple-fg-translate-start: 0;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mdc-text-field--filled .mdc-text-field__ripple::before,.mdc-text-field--filled .mdc-text-field__ripple::after{position:absolute;border-radius:50%;opacity:0;pointer-events:none;content:\"\"}.mdc-text-field--filled .mdc-text-field__ripple::before{transition:opacity 15ms linear,background-color 15ms linear;z-index:1}.mdc-text-field--filled.mdc-ripple-upgraded .mdc-text-field__ripple::before{transform:scale(var(--mdc-ripple-fg-scale, 1))}.mdc-text-field--filled.mdc-ripple-upgraded .mdc-text-field__ripple::after{top:0;left:0;transform:scale(0);transform-origin:center center}.mdc-text-field--filled.mdc-ripple-upgraded--unbounded .mdc-text-field__ripple::after{top:var(--mdc-ripple-top, 0);left:var(--mdc-ripple-left, 0)}.mdc-text-field--filled.mdc-ripple-upgraded--foreground-activation .mdc-text-field__ripple::after{animation:mdc-ripple-fg-radius-in 225ms forwards,mdc-ripple-fg-opacity-in 75ms forwards}.mdc-text-field--filled.mdc-ripple-upgraded--foreground-deactivation .mdc-text-field__ripple::after{animation:mdc-ripple-fg-opacity-out 150ms;transform:translate(var(--mdc-ripple-fg-translate-end, 0)) scale(var(--mdc-ripple-fg-scale, 1))}.mdc-text-field--filled .mdc-text-field__ripple::before,.mdc-text-field--filled .mdc-text-field__ripple::after{top:calc(50% - 100%);left:calc(50% - 100%);width:200%;height:200%}.mdc-text-field--filled.mdc-ripple-upgraded .mdc-text-field__ripple::after{width:var(--mdc-ripple-fg-size, 100%);height:var(--mdc-ripple-fg-size, 100%)}.mdc-text-field__ripple{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none}.mdc-text-field{border-radius:4px 4px 0 0;padding:0 16px;display:inline-flex;align-items:baseline;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-floating-label{color:rgba(0,0,0,.6)}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__input{color:rgba(0,0,0,.87)}@media all{.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:rgba(0,0,0,.54)}}@media all{.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:rgba(0,0,0,.54)}}.mdc-text-field .mdc-text-field__input{caret-color:#6200ee;caret-color:var(--mdc-theme-primary, #6200ee)}.mdc-text-field:not(.mdc-text-field--disabled)+.mdc-text-field-helper-line .mdc-text-field-helper-text{color:rgba(0,0,0,.6)}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field-character-counter,.mdc-text-field:not(.mdc-text-field--disabled)+.mdc-text-field-helper-line .mdc-text-field-character-counter{color:rgba(0,0,0,.6)}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__icon--leading{color:rgba(0,0,0,.54)}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__icon--trailing{color:rgba(0,0,0,.54)}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__affix--prefix{color:rgba(0,0,0,.6)}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__affix--suffix{color:rgba(0,0,0,.6)}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-text-field.mdc-text-field--with-leading-icon{padding-left:0;padding-right:16px}[dir=rtl] .mdc-text-field.mdc-text-field--with-leading-icon,.mdc-text-field.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:16px;padding-right:0}.mdc-text-field.mdc-text-field--with-trailing-icon{padding-left:16px;padding-right:0}[dir=rtl] .mdc-text-field.mdc-text-field--with-trailing-icon,.mdc-text-field.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0;padding-right:16px}.mdc-text-field.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}[dir=rtl] .mdc-text-field.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon,.mdc-text-field.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0;padding-right:0}.mdc-text-field__input{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-subtitle1-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:1rem;font-size:var(--mdc-typography-subtitle1-font-size, 1rem);font-weight:400;font-weight:var(--mdc-typography-subtitle1-font-weight, 400);letter-spacing:.009375em;letter-spacing:var(--mdc-typography-subtitle1-letter-spacing, 0.009375em);text-decoration:inherit;text-decoration:var(--mdc-typography-subtitle1-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-subtitle1-text-transform, inherit);height:28px;transition:opacity 150ms cubic-bezier(0.4, 0, 0.2, 1);width:100%;min-width:0;border:none;border-radius:0;background:none;appearance:none;padding:0}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}.mdc-text-field__input:-webkit-autofill{z-index:auto !important}@media all{.mdc-text-field__input::placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1);opacity:0}}@media all{.mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1);opacity:0}}@media all{.mdc-text-field--fullwidth .mdc-text-field__input::placeholder,.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}}@media all{.mdc-text-field--fullwidth .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}}.mdc-text-field__affix{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-subtitle1-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:1rem;font-size:var(--mdc-typography-subtitle1-font-size, 1rem);font-weight:400;font-weight:var(--mdc-typography-subtitle1-font-weight, 400);letter-spacing:.009375em;letter-spacing:var(--mdc-typography-subtitle1-letter-spacing, 0.009375em);text-decoration:inherit;text-decoration:var(--mdc-typography-subtitle1-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-subtitle1-text-transform, inherit);height:28px;transition:opacity 150ms cubic-bezier(0.4, 0, 0.2, 1);opacity:0;white-space:nowrap}.mdc-text-field--label-floating .mdc-text-field__affix,.mdc-text-field--no-label .mdc-text-field__affix{opacity:1}.mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field__affix--prefix,.mdc-text-field__affix--prefix[dir=rtl]{padding-left:2px;padding-right:0}.mdc-text-field--end-aligned .mdc-text-field__affix--prefix{padding-left:0;padding-right:12px}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--end-aligned .mdc-text-field__affix--prefix[dir=rtl]{padding-left:12px;padding-right:0}.mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field__affix--suffix,.mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:12px}.mdc-text-field--end-aligned .mdc-text-field__affix--suffix{padding-left:2px;padding-right:0}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--end-aligned .mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:2px}.mdc-text-field__input:-webkit-autofill+.mdc-floating-label{transform:translateY(-50%) scale(0.75);cursor:auto}.mdc-text-field--filled{height:56px}.mdc-text-field--filled .mdc-text-field__ripple::before,.mdc-text-field--filled .mdc-text-field__ripple::after{background-color:rgba(0,0,0,.87)}.mdc-text-field--filled:hover .mdc-text-field__ripple::before{opacity:.04}.mdc-text-field--filled.mdc-ripple-upgraded--background-focused .mdc-text-field__ripple::before,.mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms;opacity:.12}.mdc-text-field--filled::before{display:inline-block;width:0;height:40px;content:\"\";vertical-align:0}.mdc-text-field--filled:not(.mdc-text-field--disabled){background-color:#f5f5f5}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:rgba(0,0,0,.42)}.mdc-text-field--filled:not(.mdc-text-field--disabled):hover .mdc-line-ripple::before{border-bottom-color:rgba(0,0,0,.87)}.mdc-text-field--filled .mdc-line-ripple::after{border-bottom-color:#6200ee;border-bottom-color:var(--mdc-theme-primary, #6200ee)}.mdc-text-field--filled .mdc-floating-label{left:16px;right:initial}[dir=rtl] .mdc-text-field--filled .mdc-floating-label,.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:16px}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled.mdc-text-field--no-label::before{display:none}.mdc-text-field--outlined{height:56px;overflow:visible}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1)}.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined{0%{transform:translateX(calc(0 - 0%)) translateY(-34.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(-34.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(-34.75px) scale(0.75)}100%{transform:translateX(calc(0 - 0%)) translateY(-34.75px) scale(0.75)}}.mdc-text-field--outlined .mdc-text-field__input{height:100%}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:rgba(0,0,0,.38)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:rgba(0,0,0,.87)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:#6200ee;border-color:var(--mdc-theme-primary, #6200ee)}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-radius:4px 0 0 4px}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-radius:0 4px 4px 0}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-radius:0 4px 4px 0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-radius:4px 0 0 4px}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--outlined .mdc-text-field__ripple::before,.mdc-text-field--outlined .mdc-text-field__ripple::after{content:none}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:initial}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:4px}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:transparent}.mdc-text-field--textarea{flex-direction:column;width:auto;height:auto;padding:0;transition:none}.mdc-text-field--textarea .mdc-floating-label{top:18px}.mdc-text-field--textarea .mdc-floating-label:not(.mdc-floating-label--float-above){transform:none}.mdc-text-field--textarea .mdc-text-field__input{flex-grow:1;height:auto;min-height:1.5rem;overflow-x:hidden;overflow-y:auto;box-sizing:border-box;margin-left:0;margin-right:1px;padding:0 16px;line-height:1.5rem}[dir=rtl] .mdc-text-field--textarea .mdc-text-field__input,.mdc-text-field--textarea .mdc-text-field__input[dir=rtl]{margin-left:1px;margin-right:0}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-27.25px) scale(1)}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-24.75px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-outlined{0%{transform:translateX(calc(0 - 0%)) translateY(-24.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(-24.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(-24.75px) scale(0.75)}100%{transform:translateX(calc(0 - 0%)) translateY(-24.75px) scale(0.75)}}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field__input{margin-bottom:2px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter{padding:0 16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::after{display:inline-block;width:0;height:16px;content:\"\";vertical-align:-16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::before{display:none}.mdc-text-field--fullwidth{padding:0;width:100%}.mdc-text-field--fullwidth:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:rgba(0,0,0,.42)}.mdc-text-field--fullwidth.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:rgba(0,0,0,.42)}.mdc-text-field--fullwidth:not(.mdc-text-field--textarea){display:flex}.mdc-text-field--fullwidth:not(.mdc-text-field--textarea) .mdc-text-field__input{height:100%}.mdc-text-field--fullwidth:not(.mdc-text-field--textarea) .mdc-floating-label{display:none}.mdc-text-field--fullwidth:not(.mdc-text-field--textarea)::before{display:none}.mdc-text-field--fullwidth:not(.mdc-text-field--textarea) .mdc-text-field__ripple::before,.mdc-text-field--fullwidth:not(.mdc-text-field--textarea) .mdc-text-field__ripple::after{content:none}.mdc-text-field--fullwidth:not(.mdc-text-field--textarea):not(.mdc-text-field--disabled){background-color:transparent}.mdc-text-field--fullwidth.mdc-text-field--textarea .mdc-text-field__input{resize:vertical}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 48px);left:48px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:48px}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 64px / 0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label{left:36px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:36px}.mdc-text-field--with-leading-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) translateX(-32px) scale(1)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-37.25px) translateX(32px) scale(1)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) translateX(-32px) scale(0.75)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl],[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-34.75px) translateX(32px) scale(0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon{0%{transform:translateX(calc(0 - 32px)) translateY(-34.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 32px)) translateY(-34.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 32px)) translateY(-34.75px) scale(0.75)}100%{transform:translateX(calc(0 - 32px)) translateY(-34.75px) scale(0.75)}}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake,.mdc-text-field--with-leading-icon.mdc-text-field--outlined[dir=rtl] .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon-rtl{0%{transform:translateX(calc(0 - -32px)) translateY(-34.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - -32px)) translateY(-34.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - -32px)) translateY(-34.75px) scale(0.75)}100%{transform:translateX(calc(0 - -32px)) translateY(-34.75px) scale(0.75)}}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 64px)}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 64px / 0.75)}.mdc-text-field--with-trailing-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 96px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 96px / 0.75)}.mdc-text-field__input:required~.mdc-floating-label::after,.mdc-text-field__input:required~.mdc-notched-outline .mdc-floating-label::after{margin-left:1px;content:\"*\"}.mdc-text-field-helper-line{display:flex;justify-content:space-between;box-sizing:border-box}.mdc-text-field+.mdc-text-field-helper-line{padding-right:16px;padding-left:16px}.mdc-form-field>.mdc-text-field+label{align-self:flex-start}.mdc-text-field--focused:not(.mdc-text-field--disabled) .mdc-floating-label{color:rgba(98,0,238,.87)}.mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--focused .mdc-notched-outline__trailing{border-width:2px}.mdc-text-field--focused+.mdc-text-field-helper-line .mdc-text-field-helper-text:not(.mdc-text-field-helper-text--validation-msg){opacity:1}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-text-field--focused.mdc-text-field--outlined.mdc-text-field--textarea .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--invalid:not(.mdc-text-field--disabled):hover .mdc-line-ripple::before{border-bottom-color:#b00020;border-bottom-color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:#b00020;border-bottom-color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label{color:#b00020;color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-helper-text--validation-msg{color:#b00020;color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid .mdc-text-field__input{caret-color:#b00020;caret-color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__icon--trailing{color:#b00020;color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:#b00020;border-bottom-color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:#b00020;border-color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:#b00020;border-color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:#b00020;border-color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-helper-text--validation-msg{opacity:1}.mdc-text-field--disabled{pointer-events:none}.mdc-text-field--disabled .mdc-text-field__input{color:rgba(0,0,0,.38)}@media all{.mdc-text-field--disabled .mdc-text-field__input::placeholder{color:rgba(0,0,0,.38)}}@media all{.mdc-text-field--disabled .mdc-text-field__input:-ms-input-placeholder{color:rgba(0,0,0,.38)}}.mdc-text-field--disabled .mdc-floating-label{color:rgba(0,0,0,.38)}.mdc-text-field--disabled+.mdc-text-field-helper-line .mdc-text-field-helper-text{color:rgba(0,0,0,.38)}.mdc-text-field--disabled .mdc-text-field-character-counter,.mdc-text-field--disabled+.mdc-text-field-helper-line .mdc-text-field-character-counter{color:rgba(0,0,0,.38)}.mdc-text-field--disabled .mdc-text-field__icon--leading{color:rgba(0,0,0,.3)}.mdc-text-field--disabled .mdc-text-field__icon--trailing{color:rgba(0,0,0,.3)}.mdc-text-field--disabled .mdc-text-field__affix--prefix{color:rgba(0,0,0,.38)}.mdc-text-field--disabled .mdc-text-field__affix--suffix{color:rgba(0,0,0,.38)}.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:rgba(0,0,0,.06)}.mdc-text-field--disabled .mdc-notched-outline__leading,.mdc-text-field--disabled .mdc-notched-outline__notch,.mdc-text-field--disabled .mdc-notched-outline__trailing{border-color:rgba(0,0,0,.06)}@media screen and (-ms-high-contrast: active){.mdc-text-field--disabled .mdc-text-field__input::placeholder{color:GrayText}}@media screen and (-ms-high-contrast: active){.mdc-text-field--disabled .mdc-text-field__input:-ms-input-placeholder{color:GrayText}}@media screen and (-ms-high-contrast: active){.mdc-text-field--disabled .mdc-floating-label{color:GrayText}}@media screen and (-ms-high-contrast: active){.mdc-text-field--disabled+.mdc-text-field-helper-line .mdc-text-field-helper-text{color:GrayText}}@media screen and (-ms-high-contrast: active){.mdc-text-field--disabled .mdc-text-field-character-counter,.mdc-text-field--disabled+.mdc-text-field-helper-line .mdc-text-field-character-counter{color:GrayText}}@media screen and (-ms-high-contrast: active){.mdc-text-field--disabled .mdc-text-field__icon--leading{color:GrayText}}@media screen and (-ms-high-contrast: active){.mdc-text-field--disabled .mdc-text-field__icon--trailing{color:GrayText}}@media screen and (-ms-high-contrast: active){.mdc-text-field--disabled .mdc-text-field__affix--prefix{color:GrayText}}@media screen and (-ms-high-contrast: active){.mdc-text-field--disabled .mdc-text-field__affix--suffix{color:GrayText}}@media screen and (-ms-high-contrast: active){.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:GrayText}}@media screen and (-ms-high-contrast: active){.mdc-text-field--disabled .mdc-notched-outline__leading,.mdc-text-field--disabled .mdc-notched-outline__notch,.mdc-text-field--disabled .mdc-notched-outline__trailing{border-color:GrayText}}.mdc-text-field--disabled .mdc-floating-label{cursor:default}.mdc-text-field--disabled.mdc-text-field--filled{background-color:#fafafa}.mdc-text-field--end-aligned .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--end-aligned .mdc-text-field__input[dir=rtl]{text-align:left}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix{direction:ltr}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--leading,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--leading{order:1}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{order:2}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input{order:3}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{order:4}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--trailing,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--trailing{order:5}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--prefix{padding-right:12px}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--suffix{padding-left:2px}.material-icons{font-family:var(--mdc-icon-font, \"Material Icons\");font-weight:normal;font-style:normal;font-size:var(--mdc-icon-size, 24px);line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;font-feature-settings:\"liga\"}:host{display:inline-flex;flex-direction:column;outline:none}:host([fullwidth]){display:flex}.mdc-text-field{width:100%;border-radius:4px 4px 0 0;border-radius:var(--mdc-text-field-filled-border-radius, 4px 4px 0 0)}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:rgba(0,0,0,.42);border-bottom-color:var(--mdc-text-field-idle-line-color, rgba(0, 0, 0, 0.42))}.mdc-text-field:not(.mdc-text-field--disabled):hover .mdc-line-ripple::before{border-bottom-color:rgba(0,0,0,.87);border-bottom-color:var(--mdc-text-field-hover-line-color, rgba(0, 0, 0, 0.87))}.mdc-text-field.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:rgba(0,0,0,.06);border-bottom-color:var(--mdc-text-field-disabled-line-color, rgba(0, 0, 0, 0.06))}.mdc-text-field.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:#b00020;border-bottom-color:var(--mdc-theme-error, #b00020)}mwc-notched-outline{--mdc-notched-outline-border-color: var(--mdc-text-field-outlined-idle-border-color, rgba(0, 0, 0, 0.38))}:host(:not([disabled]):hover) :not(.mdc-text-field--invalid):not(.mdc-text-field--focused) mwc-notched-outline{--mdc-notched-outline-border-color: var(--mdc-text-field-outlined-hover-border-color, rgba(0, 0, 0, 0.87))}:host(:not([disabled])) .mdc-text-field:not(.mdc-text-field--outlined){background-color:var(--mdc-text-field-fill-color, whitesmoke)}:host(:not([disabled])) .mdc-text-field.mdc-text-field--invalid mwc-notched-outline{--mdc-notched-outline-border-color: var(--mdc-text-field-error-color, var(--mdc-theme-error, #b00020))}:host(:not([disabled])) .mdc-text-field.mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-character-counter,:host(:not([disabled])) .mdc-text-field.mdc-text-field--invalid .mdc-text-field__icon{color:var(--mdc-text-field-error-color, var(--mdc-theme-error, #b00020))}:host(:not([disabled])) .mdc-text-field:not(.mdc-text-field--invalid):not(.mdc-text-field--focused) .mdc-floating-label,:host(:not([disabled])) .mdc-text-field:not(.mdc-text-field--invalid):not(.mdc-text-field--focused) .mdc-floating-label::after{color:var(--mdc-text-field-label-ink-color, rgba(0, 0, 0, 0.6))}:host(:not([disabled])) .mdc-text-field.mdc-text-field--focused mwc-notched-outline{--mdc-notched-outline-stroke-width: 2px}:host(:not([disabled])) .mdc-text-field.mdc-text-field--focused:not(.mdc-text-field--invalid) mwc-notched-outline{--mdc-notched-outline-border-color: var(--mdc-text-field-focused-label-color, var(--mdc-theme-primary, rgba(98, 0, 238, 0.87)))}:host(:not([disabled])) .mdc-text-field.mdc-text-field--focused:not(.mdc-text-field--invalid) .mdc-floating-label{color:#6200ee;color:var(--mdc-theme-primary, #6200ee)}:host(:not([disabled])) .mdc-text-field.mdc-text-field--focused:not(.mdc-text-field--invalid) .mdc-text-field__input:required~.mdc-floating-label::after,:host(:not([disabled])) .mdc-text-field.mdc-text-field--focused:not(.mdc-text-field--invalid) .mdc-text-field__input:required~.mdc-notched-outline .mdc-floating-label::after{color:#6200ee;color:var(--mdc-theme-primary, #6200ee)}:host(:not([disabled])) .mdc-text-field .mdc-text-field__input{color:var(--mdc-text-field-ink-color, rgba(0, 0, 0, 0.87))}:host(:not([disabled])) .mdc-text-field .mdc-text-field__input::placeholder{color:var(--mdc-text-field-label-ink-color, rgba(0, 0, 0, 0.6))}:host(:not([disabled])) .mdc-text-field-helper-line .mdc-text-field-helper-text:not(.mdc-text-field-helper-text--validation-msg),:host(:not([disabled])) .mdc-text-field-helper-line:not(.mdc-text-field--invalid) .mdc-text-field-character-counter{color:var(--mdc-text-field-label-ink-color, rgba(0, 0, 0, 0.6))}:host([disabled]) .mdc-text-field:not(.mdc-text-field--outlined){background-color:var(--mdc-text-field-disabled-fill-color, #fafafa)}:host([disabled]) .mdc-text-field.mdc-text-field--outlined mwc-notched-outline{--mdc-notched-outline-border-color: var(--mdc-text-field-outlined-disabled-border-color, rgba(0, 0, 0, 0.06))}:host([disabled]) .mdc-text-field:not(.mdc-text-field--invalid):not(.mdc-text-field--focused) .mdc-floating-label,:host([disabled]) .mdc-text-field:not(.mdc-text-field--invalid):not(.mdc-text-field--focused) .mdc-floating-label::after{color:var(--mdc-text-field-disabled-ink-color, rgba(0, 0, 0, 0.38))}:host([disabled]) .mdc-text-field .mdc-text-field__input,:host([disabled]) .mdc-text-field .mdc-text-field__input::placeholder{color:var(--mdc-text-field-disabled-ink-color, rgba(0, 0, 0, 0.38))}:host([disabled]) .mdc-text-field-helper-line .mdc-text-field-helper-text,:host([disabled]) .mdc-text-field-helper-line .mdc-text-field-character-counter{color:var(--mdc-text-field-disabled-ink-color, rgba(0, 0, 0, 0.38))}`;\n/**\n@license\nCopyright 2019 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/let z=class extends j{};z.styles=B,z=Object(i.__decorate)([Object(r.c)(\"mwc-textfield\")],z)},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"DefaultFocusState\",(function(){return F})),n.d(e,\"createSetFromIndex\",(function(){return v})),n.d(e,\"isEventMulti\",(function(){return g})),n.d(e,\"isIndexSet\",(function(){return m})),n.d(e,\"Menu\",(function(){return G}));var i=n(1),r=n(0),o=n(18),a=n(10),s=n(28),c=n(27),l=n(16),d=\"mdc-list-item\",u=\"mdc-list-item--disabled\",h={ACTION_EVENT:\"MDCList:action\",ARIA_CHECKED:\"aria-checked\",ARIA_CHECKED_CHECKBOX_SELECTOR:'[role=\"checkbox\"][aria-checked=\"true\"]',ARIA_CHECKED_RADIO_SELECTOR:'[role=\"radio\"][aria-checked=\"true\"]',ARIA_CURRENT:\"aria-current\",ARIA_DISABLED:\"aria-disabled\",ARIA_ORIENTATION:\"aria-orientation\",ARIA_ORIENTATION_HORIZONTAL:\"horizontal\",ARIA_ROLE_CHECKBOX_SELECTOR:'[role=\"checkbox\"]',ARIA_SELECTED:\"aria-selected\",CHECKBOX_RADIO_SELECTOR:'input[type=\"checkbox\"], input[type=\"radio\"]',CHECKBOX_SELECTOR:'input[type=\"checkbox\"]',CHILD_ELEMENTS_TO_TOGGLE_TABINDEX:\"\\n    .\"+d+\" button:not(:disabled),\\n    .\"+d+\" a\\n  \",FOCUSABLE_CHILD_ELEMENTS:\"\\n    .\"+d+\" button:not(:disabled),\\n    .\"+d+\" a,\\n    .\"+d+' input[type=\"radio\"]:not(:disabled),\\n    .'+d+' input[type=\"checkbox\"]:not(:disabled)\\n  ',RADIO_SELECTOR:'input[type=\"radio\"]'},p={UNSET_INDEX:-1};\n/**\n @license\n Copyright 2020 Google Inc. All Rights Reserved.\n\n Licensed under the Apache License, Version 2.0 (the \"License\");\n you may not use this file except in compliance with the License.\n You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\n Unless required by applicable law or agreed to in writing, software\n distributed under the License is distributed on an \"AS IS\" BASIS,\n WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n See the License for the specific language governing permissions and\n limitations under the License.\n */\nconst f=[\"input\",\"button\",\"textarea\",\"select\"];function m(t){return t instanceof Set}function g(t){return m(t.detail.index)}const v=t=>{const e=t===p.UNSET_INDEX?new Set:t;return m(e)?new Set(e):new Set([e])};class y extends l.a{constructor(t){super(Object.assign(Object.assign({},y.defaultAdapter),t)),this.isMulti_=!1,this.wrapFocus_=!1,this.isVertical_=!0,this.selectedIndex_=p.UNSET_INDEX,this.focusedItemIndex_=p.UNSET_INDEX,this.useActivatedClass_=!1,this.ariaCurrentAttrValue_=null}static get strings(){return h}static get numbers(){return p}static get defaultAdapter(){return{focusItemAtIndex:()=>{},getFocusedElementIndex:()=>0,getListItemCount:()=>0,isFocusInsideList:()=>!1,isRootFocused:()=>!1,notifyAction:()=>{},notifySelected:()=>{},getSelectedStateForElementIndex:()=>!1,setDisabledStateForElementIndex:()=>{},getDisabledStateForElementIndex:()=>!1,setSelectedStateForElementIndex:()=>{},setActivatedStateForElementIndex:()=>{},setTabIndexForElementIndex:()=>{},setAttributeForElementIndex:()=>{},getAttributeForElementIndex:()=>null}}setWrapFocus(t){this.wrapFocus_=t}setMulti(t){this.isMulti_=t;const e=this.selectedIndex_;if(t){if(!m(e)){const t=e===p.UNSET_INDEX;this.selectedIndex_=t?new Set:new Set([e])}}else if(m(e))if(e.size){const t=Array.from(e).sort();this.selectedIndex_=t[0]}else this.selectedIndex_=p.UNSET_INDEX}setVerticalOrientation(t){this.isVertical_=t}setUseActivatedClass(t){this.useActivatedClass_=t}getSelectedIndex(){return this.selectedIndex_}setSelectedIndex(t){this.isIndexValid_(t)&&(this.isMulti_?this.setMultiSelectionAtIndex_(v(t)):this.setSingleSelectionAtIndex_(t))}handleFocusIn(t,e){e>=0&&this.adapter_.setTabIndexForElementIndex(e,0)}handleFocusOut(t,e){e>=0&&this.adapter_.setTabIndexForElementIndex(e,-1),setTimeout(()=>{this.adapter_.isFocusInsideList()||this.setTabindexToFirstSelectedItem_()},0)}handleKeydown(t,e,n){const i=\"ArrowLeft\"===t.key||37===t.keyCode,r=\"ArrowUp\"===t.key||38===t.keyCode,o=\"ArrowRight\"===t.key||39===t.keyCode,a=\"ArrowDown\"===t.key||40===t.keyCode,s=\"Home\"===t.key||36===t.keyCode,c=\"End\"===t.key||35===t.keyCode,l=\"Enter\"===t.key||13===t.keyCode,d=\"Space\"===t.key||32===t.keyCode;if(this.adapter_.isRootFocused())return void(r||c?(t.preventDefault(),this.focusLastElement()):(a||s)&&(t.preventDefault(),this.focusFirstElement()));let u,h=this.adapter_.getFocusedElementIndex();if(!(-1===h&&(h=n,h<0))){if(this.isVertical_&&a||!this.isVertical_&&o)this.preventDefaultEvent_(t),u=this.focusNextElement(h);else if(this.isVertical_&&r||!this.isVertical_&&i)this.preventDefaultEvent_(t),u=this.focusPrevElement(h);else if(s)this.preventDefaultEvent_(t),u=this.focusFirstElement();else if(c)this.preventDefaultEvent_(t),u=this.focusLastElement();else if((l||d)&&e){const e=t.target;if(e&&\"A\"===e.tagName&&l)return;this.preventDefaultEvent_(t),this.setSelectedIndexOnAction_(h,!0)}this.focusedItemIndex_=h,void 0!==u&&(this.setTabindexAtIndex_(u),this.focusedItemIndex_=u)}}handleSingleSelection(t,e,n){t!==p.UNSET_INDEX&&(this.setSelectedIndexOnAction_(t,e,n),this.setTabindexAtIndex_(t),this.focusedItemIndex_=t)}focusNextElement(t){let e=t+1;if(e>=this.adapter_.getListItemCount()){if(!this.wrapFocus_)return t;e=0}return this.adapter_.focusItemAtIndex(e),e}focusPrevElement(t){let e=t-1;if(e<0){if(!this.wrapFocus_)return t;e=this.adapter_.getListItemCount()-1}return this.adapter_.focusItemAtIndex(e),e}focusFirstElement(){return this.adapter_.focusItemAtIndex(0),0}focusLastElement(){const t=this.adapter_.getListItemCount()-1;return this.adapter_.focusItemAtIndex(t),t}setEnabled(t,e){this.isIndexValid_(t)&&this.adapter_.setDisabledStateForElementIndex(t,!e)}preventDefaultEvent_(t){const e=(\"\"+t.target.tagName).toLowerCase();-1===f.indexOf(e)&&t.preventDefault()}setSingleSelectionAtIndex_(t,e=!0){this.selectedIndex_!==t&&(this.selectedIndex_!==p.UNSET_INDEX&&(this.adapter_.setSelectedStateForElementIndex(this.selectedIndex_,!1),this.useActivatedClass_&&this.adapter_.setActivatedStateForElementIndex(this.selectedIndex_,!1)),e&&this.adapter_.setSelectedStateForElementIndex(t,!0),this.useActivatedClass_&&this.adapter_.setActivatedStateForElementIndex(t,!0),this.setAriaForSingleSelectionAtIndex_(t),this.selectedIndex_=t,this.adapter_.notifySelected(t))}setMultiSelectionAtIndex_(t,e=!0){const n=((t,e)=>{const n=Array.from(t),i=Array.from(e),r={added:[],removed:[]},o=n.sort(),a=i.sort();let s=0,c=0;for(;s<o.length||c<a.length;){const t=o[s],e=a[c];t!==e?void 0!==t&&(void 0===e||t<e)?(r.removed.push(t),s++):void 0!==e&&(void 0===t||e<t)&&(r.added.push(e),c++):(s++,c++)}return r})(v(this.selectedIndex_),t);if(n.removed.length||n.added.length){for(const t of n.removed)e&&this.adapter_.setSelectedStateForElementIndex(t,!1),this.useActivatedClass_&&this.adapter_.setActivatedStateForElementIndex(t,!1);for(const t of n.added)e&&this.adapter_.setSelectedStateForElementIndex(t,!0),this.useActivatedClass_&&this.adapter_.setActivatedStateForElementIndex(t,!0);this.selectedIndex_=t,this.adapter_.notifySelected(t,n)}}setAriaForSingleSelectionAtIndex_(t){this.selectedIndex_===p.UNSET_INDEX&&(this.ariaCurrentAttrValue_=this.adapter_.getAttributeForElementIndex(t,h.ARIA_CURRENT));const e=null!==this.ariaCurrentAttrValue_,n=e?h.ARIA_CURRENT:h.ARIA_SELECTED;this.selectedIndex_!==p.UNSET_INDEX&&this.adapter_.setAttributeForElementIndex(this.selectedIndex_,n,\"false\");const i=e?this.ariaCurrentAttrValue_:\"true\";this.adapter_.setAttributeForElementIndex(t,n,i)}setTabindexAtIndex_(t){this.focusedItemIndex_===p.UNSET_INDEX&&0!==t?this.adapter_.setTabIndexForElementIndex(0,-1):this.focusedItemIndex_>=0&&this.focusedItemIndex_!==t&&this.adapter_.setTabIndexForElementIndex(this.focusedItemIndex_,-1),this.adapter_.setTabIndexForElementIndex(t,0)}setTabindexToFirstSelectedItem_(){let t=0;\"number\"==typeof this.selectedIndex_&&this.selectedIndex_!==p.UNSET_INDEX?t=this.selectedIndex_:m(this.selectedIndex_)&&this.selectedIndex_.size>0&&(t=Math.min(...this.selectedIndex_)),this.setTabindexAtIndex_(t)}isIndexValid_(t){if(t instanceof Set){if(!this.isMulti_)throw new Error(\"MDCListFoundation: Array of index is only supported for checkbox based list\");if(0===t.size)return!0;{let e=!1;for(const n of t)if(e=this.isIndexInRange_(n),e)break;return e}}if(\"number\"==typeof t){if(this.isMulti_)throw new Error(\"MDCListFoundation: Expected array of index for checkbox based list but got number: \"+t);return t===p.UNSET_INDEX||this.isIndexInRange_(t)}return!1}isIndexInRange_(t){const e=this.adapter_.getListItemCount();return t>=0&&t<e}setSelectedIndexOnAction_(t,e,n){if(this.adapter_.getDisabledStateForElementIndex(t))return;let i=t;if(this.isMulti_&&(i=new Set([t])),this.isIndexValid_(i)){if(this.isMulti_)this.toggleMultiAtIndex(t,n,e);else if(e||n)this.setSingleSelectionAtIndex_(t,e);else{this.selectedIndex_===t&&this.setSingleSelectionAtIndex_(p.UNSET_INDEX)}e&&this.adapter_.notifyAction(t)}}toggleMultiAtIndex(t,e,n=!0){let i=!1;i=void 0===e?!this.adapter_.getSelectedStateForElementIndex(t):e;const r=v(this.selectedIndex_);i?r.add(t):r.delete(t),this.setMultiSelectionAtIndex_(r,n)}}var b=y;\n/**\n@license\nCopyright 2020 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/const _=t=>t.hasAttribute(\"mwc-list-item\");class x extends o.a{constructor(){super(...arguments),this.mdcAdapter=null,this.mdcFoundationClass=b,this.activatable=!1,this.multi=!1,this.wrapFocus=!1,this.itemRoles=null,this.innerRole=null,this.innerAriaLabel=null,this.rootTabbable=!1,this.previousTabindex=null,this.noninteractive=!1,this.items_=[]}get assignedElements(){const t=this.slotElement;return t?t.assignedNodes({flatten:!0}).filter(s.e):[]}get items(){return this.items_}updateItems(){const t=this.assignedElements,e=[];for(const n of t)_(n)&&e.push(n),n.hasAttribute(\"divider\")&&!n.hasAttribute(\"role\")&&n.setAttribute(\"role\",\"separator\");this.items_=e;const n=new Set;if(this.items_.forEach((t,e)=>{this.itemRoles?t.setAttribute(\"role\",this.itemRoles):t.removeAttribute(\"role\"),t.selected&&n.add(e)}),this.multi)this.select(n);else{const t=n.size?n.entries().next().value[1]:-1;this.select(t)}}get selected(){const t=this.index;if(!m(t))return-1===t?null:this.items[t];const e=[];for(const n of t)e.push(this.items[n]);return e}get index(){return this.mdcFoundation?this.mdcFoundation.getSelectedIndex():-1}render(){const t=null===this.innerRole?void 0:this.innerRole,e=null===this.innerAriaLabel?void 0:this.innerAriaLabel,n=this.rootTabbable?\"0\":\"-1\";return r.e`\n      <!-- @ts-ignore -->\n      <ul\n          tabindex=${n}\n          role=\"${Object(c.a)(t)}\"\n          aria-label=\"${Object(c.a)(e)}\"\n          class=\"mdc-list\"\n          @keydown=${this.onKeydown}\n          @focusin=${this.onFocusIn}\n          @focusout=${this.onFocusOut}\n          @request-selected=${this.onRequestSelected}\n          @list-item-rendered=${this.onListItemConnected}>\n        <slot></slot>\n      </ul>\n    `}firstUpdated(){super.firstUpdated(),this.items.length||(this.mdcFoundation.setMulti(this.multi),this.layout())}onFocusIn(t){if(this.mdcFoundation&&this.mdcRoot){const e=this.getIndexOfTarget(t);this.mdcFoundation.handleFocusIn(t,e)}}onFocusOut(t){if(this.mdcFoundation&&this.mdcRoot){const e=this.getIndexOfTarget(t);this.mdcFoundation.handleFocusOut(t,e)}}onKeydown(t){if(this.mdcFoundation&&this.mdcRoot){const e=this.getIndexOfTarget(t),n=t.target,i=_(n);this.mdcFoundation.handleKeydown(t,i,e)}}onRequestSelected(t){if(this.mdcFoundation){const e=this.getIndexOfTarget(t);if(-1===e)return;if(this.items[e].disabled)return;const n=t.detail.selected,i=t.detail.source;this.mdcFoundation.handleSingleSelection(e,\"interaction\"===i,n),t.stopPropagation()}}getIndexOfTarget(t){const e=this.items,n=t.composedPath();for(const t of n){let n=-1;if(Object(s.e)(t)&&_(t)&&(n=e.indexOf(t)),-1!==n)return n}return-1}createAdapter(){return this.mdcAdapter={getListItemCount:()=>this.mdcRoot?this.items.length:0,getFocusedElementIndex:()=>{if(!this.mdcRoot)return-1;if(!this.items.length)return-1;const t=Object(s.b)();if(!t.length)return-1;for(let e=t.length-1;e>=0;e--){const n=t[e];if(_(n))return this.items.indexOf(n)}return-1},getAttributeForElementIndex:(t,e)=>{if(!this.mdcRoot)return\"\";const n=this.items[t];return n?n.getAttribute(e):\"\"},setAttributeForElementIndex:(t,e,n)=>{if(!this.mdcRoot)return;const i=this.items[t];i&&i.setAttribute(e,n)},focusItemAtIndex:t=>{const e=this.items[t];e&&e.focus()},setTabIndexForElementIndex:(t,e)=>{const n=this.items[t];n&&(n.tabindex=e)},notifyAction:t=>{const e={bubbles:!0,composed:!0};e.detail={index:t};const n=new CustomEvent(\"action\",e);this.dispatchEvent(n)},notifySelected:(t,e)=>{const n={bubbles:!0,composed:!0};n.detail={index:t,diff:e};const i=new CustomEvent(\"selected\",n);this.dispatchEvent(i)},isFocusInsideList:()=>Object(s.c)(this),isRootFocused:()=>{const t=this.mdcRoot;return t.getRootNode().activeElement===t},setDisabledStateForElementIndex:(t,e)=>{const n=this.items[t];n&&(n.disabled=e)},getDisabledStateForElementIndex:t=>{const e=this.items[t];return!!e&&e.disabled},setSelectedStateForElementIndex:(t,e)=>{const n=this.items[t];n&&(n.selected=e)},getSelectedStateForElementIndex:t=>{const e=this.items[t];return!!e&&e.selected},setActivatedStateForElementIndex:(t,e)=>{const n=this.items[t];n&&(n.activated=e)}},this.mdcAdapter}selectUi(t,e=!1){const n=this.items[t];n&&(n.selected=!0,n.activated=e)}deselectUi(t){const e=this.items[t];e&&(e.selected=!1,e.activated=!1)}select(t){this.mdcFoundation&&this.mdcFoundation.setSelectedIndex(t)}toggle(t,e){this.multi&&this.mdcFoundation.toggleMultiAtIndex(t,e)}onListItemConnected(t){const e=t.target;this.layout(-1===this.items.indexOf(e))}layout(t=!0){t&&this.updateItems();const e=this.items[0];for(const t of this.items)t.tabindex=-1;e&&(this.noninteractive?this.previousTabindex||(this.previousTabindex=e):e.tabindex=0)}focus(){const t=this.mdcRoot;t&&t.focus()}blur(){const t=this.mdcRoot;t&&t.blur()}}Object(i.__decorate)([Object(r.h)(\".mdc-list\")],x.prototype,\"mdcRoot\",void 0),Object(i.__decorate)([Object(r.h)(\"slot\")],x.prototype,\"slotElement\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean}),Object(a.a)((function(t){this.mdcFoundation&&this.mdcFoundation.setUseActivatedClass(t)}))],x.prototype,\"activatable\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean}),Object(a.a)((function(t,e){this.mdcFoundation&&this.mdcFoundation.setMulti(t),void 0!==e&&this.layout()}))],x.prototype,\"multi\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean}),Object(a.a)((function(t){this.mdcFoundation&&this.mdcFoundation.setWrapFocus(t)}))],x.prototype,\"wrapFocus\",void 0),Object(i.__decorate)([Object(r.g)({type:String}),Object(a.a)((function(t,e){void 0!==e&&this.updateItems()}))],x.prototype,\"itemRoles\",void 0),Object(i.__decorate)([Object(r.g)({type:String})],x.prototype,\"innerRole\",void 0),Object(i.__decorate)([Object(r.g)({type:String})],x.prototype,\"innerAriaLabel\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],x.prototype,\"rootTabbable\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean,reflect:!0}),Object(a.a)((function(t){const e=this.slotElement;if(t&&e){const t=Object(s.d)(e,'[tabindex=\"0\"]');this.previousTabindex=t,t&&t.setAttribute(\"tabindex\",\"-1\")}else!t&&this.previousTabindex&&(this.previousTabindex.setAttribute(\"tabindex\",\"0\"),this.previousTabindex=null)}))],x.prototype,\"noninteractive\",void 0);\n/**\n@license\nCopyright 2018 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\nconst w=r.b`@keyframes mdc-ripple-fg-radius-in{from{animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transform:translate(var(--mdc-ripple-fg-translate-start, 0)) scale(1)}to{transform:translate(var(--mdc-ripple-fg-translate-end, 0)) scale(var(--mdc-ripple-fg-scale, 1))}}@keyframes mdc-ripple-fg-opacity-in{from{animation-timing-function:linear;opacity:0}to{opacity:var(--mdc-ripple-fg-opacity, 0)}}@keyframes mdc-ripple-fg-opacity-out{from{animation-timing-function:linear;opacity:var(--mdc-ripple-fg-opacity, 0)}to{opacity:0}}:host{display:block}.mdc-list{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-subtitle1-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:1rem;font-size:var(--mdc-typography-subtitle1-font-size, 1rem);line-height:1.75rem;line-height:var(--mdc-typography-subtitle1-line-height, 1.75rem);font-weight:400;font-weight:var(--mdc-typography-subtitle1-font-weight, 400);letter-spacing:.009375em;letter-spacing:var(--mdc-typography-subtitle1-letter-spacing, 0.009375em);text-decoration:inherit;text-decoration:var(--mdc-typography-subtitle1-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-subtitle1-text-transform, inherit);line-height:1.5rem;margin:0;padding:8px 0;list-style-type:none;color:rgba(0,0,0,.87);color:var(--mdc-theme-text-primary-on-background, rgba(0, 0, 0, 0.87));padding:var(--mdc-list-vertical-padding, 8px) 0}.mdc-list:focus{outline:none}.mdc-list-item{height:48px}.mdc-list--dense{padding-top:4px;padding-bottom:4px;font-size:.812rem}.mdc-list ::slotted([divider]){height:0;margin:0;border:none;border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgba(0,0,0,.12)}.mdc-list ::slotted([divider][padded]){margin:0 var(--mdc-list-side-padding, 16px)}.mdc-list ::slotted([divider][inset]){margin-left:var(--mdc-list-inset-margin, 72px);margin-right:0;width:calc(100% - var(--mdc-list-inset-margin, 72px))}.mdc-list-group[dir=rtl] .mdc-list ::slotted([divider][inset]),[dir=rtl] .mdc-list-group .mdc-list ::slotted([divider][inset]){margin-left:0;margin-right:var(--mdc-list-inset-margin, 72px)}.mdc-list ::slotted([divider][inset][padded]){width:calc(100% - var(--mdc-list-inset-margin, 72px) - var(--mdc-list-side-padding, 16px))}.mdc-list--dense ::slotted([mwc-list-item]){height:40px}.mdc-list--dense ::slotted([mwc-list]){--mdc-list-item-graphic-size: 20px}.mdc-list--two-line.mdc-list--dense ::slotted([mwc-list-item]),.mdc-list--avatar-list.mdc-list--dense ::slotted([mwc-list-item]){height:60px}.mdc-list--avatar-list.mdc-list--dense ::slotted([mwc-list]){--mdc-list-item-graphic-size: 36px}:host([noninteractive]){pointer-events:none;cursor:default}.mdc-list--dense ::slotted(.mdc-list-item__primary-text){display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list--dense ::slotted(.mdc-list-item__primary-text)::before{display:inline-block;width:0;height:24px;content:\"\";vertical-align:0}.mdc-list--dense ::slotted(.mdc-list-item__primary-text)::after{display:inline-block;width:0;height:20px;content:\"\";vertical-align:-20px}`;\n/**\n@license\nCopyright 2020 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/let S=class extends x{};S.styles=w,S=Object(i.__decorate)([Object(r.c)(\"mwc-list\")],S);\n/**\n * @license\n * Copyright 2018 Google Inc.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nvar M,E,T={ANCHOR:\"mdc-menu-surface--anchor\",ANIMATING_CLOSED:\"mdc-menu-surface--animating-closed\",ANIMATING_OPEN:\"mdc-menu-surface--animating-open\",FIXED:\"mdc-menu-surface--fixed\",IS_OPEN_BELOW:\"mdc-menu-surface--is-open-below\",OPEN:\"mdc-menu-surface--open\",ROOT:\"mdc-menu-surface\"},C={CLOSED_EVENT:\"MDCMenuSurface:closed\",OPENED_EVENT:\"MDCMenuSurface:opened\",FOCUSABLE_ELEMENTS:[\"button:not(:disabled)\",'[href]:not([aria-disabled=\"true\"])',\"input:not(:disabled)\",\"select:not(:disabled)\",\"textarea:not(:disabled)\",'[tabindex]:not([tabindex=\"-1\"]):not([aria-disabled=\"true\"])'].join(\", \")},A={TRANSITION_OPEN_DURATION:120,TRANSITION_CLOSE_DURATION:75,MARGIN_TO_EDGE:32,ANCHOR_TO_MENU_SURFACE_WIDTH_RATIO:.67};!function(t){t[t.BOTTOM=1]=\"BOTTOM\",t[t.CENTER=2]=\"CENTER\",t[t.RIGHT=4]=\"RIGHT\",t[t.FLIP_RTL=8]=\"FLIP_RTL\"}(M||(M={})),function(t){t[t.TOP_LEFT=0]=\"TOP_LEFT\",t[t.TOP_RIGHT=4]=\"TOP_RIGHT\",t[t.BOTTOM_LEFT=1]=\"BOTTOM_LEFT\",t[t.BOTTOM_RIGHT=5]=\"BOTTOM_RIGHT\",t[t.TOP_START=8]=\"TOP_START\",t[t.TOP_END=12]=\"TOP_END\",t[t.BOTTOM_START=9]=\"BOTTOM_START\",t[t.BOTTOM_END=13]=\"BOTTOM_END\"}(E||(E={}));\n/**\n * @license\n * Copyright 2018 Google Inc.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nvar O,k=function(t){function e(n){var r=t.call(this,Object(i.__assign)(Object(i.__assign)({},e.defaultAdapter),n))||this;return r.isOpen_=!1,r.isQuickOpen_=!1,r.isHoistedElement_=!1,r.isFixedPosition_=!1,r.openAnimationEndTimerId_=0,r.closeAnimationEndTimerId_=0,r.animationRequestId_=0,r.anchorCorner_=E.TOP_START,r.originCorner_=E.TOP_START,r.anchorMargin_={top:0,right:0,bottom:0,left:0},r.position_={x:0,y:0},r}return Object(i.__extends)(e,t),Object.defineProperty(e,\"cssClasses\",{get:function(){return T},enumerable:!0,configurable:!0}),Object.defineProperty(e,\"strings\",{get:function(){return C},enumerable:!0,configurable:!0}),Object.defineProperty(e,\"numbers\",{get:function(){return A},enumerable:!0,configurable:!0}),Object.defineProperty(e,\"Corner\",{get:function(){return E},enumerable:!0,configurable:!0}),Object.defineProperty(e,\"defaultAdapter\",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},hasAnchor:function(){return!1},isElementInContainer:function(){return!1},isFocused:function(){return!1},isRtl:function(){return!1},getInnerDimensions:function(){return{height:0,width:0}},getAnchorDimensions:function(){return null},getWindowDimensions:function(){return{height:0,width:0}},getBodyDimensions:function(){return{height:0,width:0}},getWindowScroll:function(){return{x:0,y:0}},setPosition:function(){},setMaxHeight:function(){},setTransformOrigin:function(){},saveFocus:function(){},restoreFocus:function(){},notifyClose:function(){},notifyOpen:function(){}}},enumerable:!0,configurable:!0}),e.prototype.init=function(){var t=e.cssClasses,n=t.ROOT,i=t.OPEN;if(!this.adapter_.hasClass(n))throw new Error(n+\" class required in root element.\");this.adapter_.hasClass(i)&&(this.isOpen_=!0)},e.prototype.destroy=function(){clearTimeout(this.openAnimationEndTimerId_),clearTimeout(this.closeAnimationEndTimerId_),cancelAnimationFrame(this.animationRequestId_)},e.prototype.setAnchorCorner=function(t){this.anchorCorner_=t},e.prototype.flipCornerHorizontally=function(){this.originCorner_=this.originCorner_^M.RIGHT},e.prototype.setAnchorMargin=function(t){this.anchorMargin_.top=t.top||0,this.anchorMargin_.right=t.right||0,this.anchorMargin_.bottom=t.bottom||0,this.anchorMargin_.left=t.left||0},e.prototype.setIsHoisted=function(t){this.isHoistedElement_=t},e.prototype.setFixedPosition=function(t){this.isFixedPosition_=t},e.prototype.setAbsolutePosition=function(t,e){this.position_.x=this.isFinite_(t)?t:0,this.position_.y=this.isFinite_(e)?e:0},e.prototype.setQuickOpen=function(t){this.isQuickOpen_=t},e.prototype.isOpen=function(){return this.isOpen_},e.prototype.open=function(){var t=this;this.isOpen_||(this.adapter_.saveFocus(),this.isQuickOpen_?(this.isOpen_=!0,this.adapter_.addClass(e.cssClasses.OPEN),this.dimensions_=this.adapter_.getInnerDimensions(),this.autoPosition_(),this.adapter_.notifyOpen()):(this.adapter_.addClass(e.cssClasses.ANIMATING_OPEN),this.animationRequestId_=requestAnimationFrame((function(){t.adapter_.addClass(e.cssClasses.OPEN),t.dimensions_=t.adapter_.getInnerDimensions(),t.autoPosition_(),t.openAnimationEndTimerId_=setTimeout((function(){t.openAnimationEndTimerId_=0,t.adapter_.removeClass(e.cssClasses.ANIMATING_OPEN),t.adapter_.notifyOpen()}),A.TRANSITION_OPEN_DURATION)})),this.isOpen_=!0))},e.prototype.close=function(t){var n=this;void 0===t&&(t=!1),this.isOpen_&&(this.isQuickOpen_?(this.isOpen_=!1,t||this.maybeRestoreFocus_(),this.adapter_.removeClass(e.cssClasses.OPEN),this.adapter_.removeClass(e.cssClasses.IS_OPEN_BELOW),this.adapter_.notifyClose()):(this.adapter_.addClass(e.cssClasses.ANIMATING_CLOSED),requestAnimationFrame((function(){n.adapter_.removeClass(e.cssClasses.OPEN),n.adapter_.removeClass(e.cssClasses.IS_OPEN_BELOW),n.closeAnimationEndTimerId_=setTimeout((function(){n.closeAnimationEndTimerId_=0,n.adapter_.removeClass(e.cssClasses.ANIMATING_CLOSED),n.adapter_.notifyClose()}),A.TRANSITION_CLOSE_DURATION)})),this.isOpen_=!1,t||this.maybeRestoreFocus_()))},e.prototype.handleBodyClick=function(t){var e=t.target;this.adapter_.isElementInContainer(e)||this.close()},e.prototype.handleKeydown=function(t){var e=t.keyCode;(\"Escape\"===t.key||27===e)&&this.close()},e.prototype.autoPosition_=function(){var t;this.measurements_=this.getAutoLayoutMeasurements_();var n=this.getOriginCorner_(),i=this.getMenuSurfaceMaxHeight_(n),r=this.hasBit_(n,M.BOTTOM)?\"bottom\":\"top\",o=this.hasBit_(n,M.RIGHT)?\"right\":\"left\",a=this.getHorizontalOriginOffset_(n),s=this.getVerticalOriginOffset_(n),c=this.measurements_,l=c.anchorSize,d=c.surfaceSize,u=((t={})[o]=a,t[r]=s,t);l.width/d.width>A.ANCHOR_TO_MENU_SURFACE_WIDTH_RATIO&&(o=\"center\"),(this.isHoistedElement_||this.isFixedPosition_)&&this.adjustPositionForHoistedElement_(u),this.adapter_.setTransformOrigin(o+\" \"+r),this.adapter_.setPosition(u),this.adapter_.setMaxHeight(i?i+\"px\":\"\"),this.hasBit_(n,M.BOTTOM)||this.adapter_.addClass(e.cssClasses.IS_OPEN_BELOW)},e.prototype.getAutoLayoutMeasurements_=function(){var t=this.adapter_.getAnchorDimensions(),e=this.adapter_.getBodyDimensions(),n=this.adapter_.getWindowDimensions(),i=this.adapter_.getWindowScroll();return t||(t={top:this.position_.y,right:this.position_.x,bottom:this.position_.y,left:this.position_.x,width:0,height:0}),{anchorSize:t,bodySize:e,surfaceSize:this.dimensions_,viewportDistance:{top:t.top,right:n.width-t.right,bottom:n.height-t.bottom,left:t.left},viewportSize:n,windowScroll:i}},e.prototype.getOriginCorner_=function(){var t,n,i=this.originCorner_,r=this.measurements_,o=r.viewportDistance,a=r.anchorSize,s=r.surfaceSize,c=e.numbers.MARGIN_TO_EDGE;this.hasBit_(this.anchorCorner_,M.BOTTOM)?(t=o.top-c+a.height+this.anchorMargin_.bottom,n=o.bottom-c-this.anchorMargin_.bottom):(t=o.top-c+this.anchorMargin_.top,n=o.bottom-c+a.height-this.anchorMargin_.top),!(n-s.height>0)&&t>=n&&(i=this.setBit_(i,M.BOTTOM));var l,d,u=this.adapter_.isRtl(),h=this.hasBit_(this.anchorCorner_,M.FLIP_RTL),p=this.hasBit_(this.anchorCorner_,M.RIGHT),f=!1;(f=u&&h?!p:p)?(l=o.left+a.width+this.anchorMargin_.right,d=o.right-this.anchorMargin_.right):(l=o.left+this.anchorMargin_.left,d=o.right+a.width-this.anchorMargin_.left);var m=l-s.width>0,g=d-s.width>0,v=this.hasBit_(i,M.FLIP_RTL)&&this.hasBit_(i,M.RIGHT);return g&&v&&u||!m&&v?i=this.unsetBit_(i,M.RIGHT):(m&&f&&u||m&&!f&&p||!g&&l>=d)&&(i=this.setBit_(i,M.RIGHT)),i},e.prototype.getMenuSurfaceMaxHeight_=function(t){var n=this.measurements_.viewportDistance,i=0,r=this.hasBit_(t,M.BOTTOM),o=this.hasBit_(this.anchorCorner_,M.BOTTOM),a=e.numbers.MARGIN_TO_EDGE;return r?(i=n.top+this.anchorMargin_.top-a,o||(i+=this.measurements_.anchorSize.height)):(i=n.bottom-this.anchorMargin_.bottom+this.measurements_.anchorSize.height-a,o&&(i-=this.measurements_.anchorSize.height)),i},e.prototype.getHorizontalOriginOffset_=function(t){var e=this.measurements_.anchorSize,n=this.hasBit_(t,M.RIGHT),i=this.hasBit_(this.anchorCorner_,M.RIGHT);if(n){var r=i?e.width-this.anchorMargin_.left:this.anchorMargin_.right;return this.isHoistedElement_||this.isFixedPosition_?r-(this.measurements_.viewportSize.width-this.measurements_.bodySize.width):r}return i?e.width-this.anchorMargin_.right:this.anchorMargin_.left},e.prototype.getVerticalOriginOffset_=function(t){var e=this.measurements_.anchorSize,n=this.hasBit_(t,M.BOTTOM),i=this.hasBit_(this.anchorCorner_,M.BOTTOM);return n?i?e.height-this.anchorMargin_.top:-this.anchorMargin_.bottom:i?e.height+this.anchorMargin_.bottom:this.anchorMargin_.top},e.prototype.adjustPositionForHoistedElement_=function(t){var e,n,r=this.measurements_,o=r.windowScroll,a=r.viewportDistance,s=Object.keys(t);try{for(var c=Object(i.__values)(s),l=c.next();!l.done;l=c.next()){var d=l.value,u=t[d]||0;u+=a[d],this.isFixedPosition_||(\"top\"===d?u+=o.y:\"bottom\"===d?u-=o.y:\"left\"===d?u+=o.x:u-=o.x),t[d]=u}}catch(t){e={error:t}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}},e.prototype.maybeRestoreFocus_=function(){var t=this.adapter_.isFocused(),e=document.activeElement&&this.adapter_.isElementInContainer(document.activeElement);(t||e)&&this.adapter_.restoreFocus()},e.prototype.hasBit_=function(t,e){return Boolean(t&e)},e.prototype.setBit_=function(t,e){return t|e},e.prototype.unsetBit_=function(t,e){return t^e},e.prototype.isFinite_=function(t){return\"number\"==typeof t&&isFinite(t)},e}(l.a),L=k;var I=n(29);const R={TOP_LEFT:E.TOP_LEFT,TOP_RIGHT:E.TOP_RIGHT,BOTTOM_LEFT:E.BOTTOM_LEFT,BOTTOM_RIGHT:E.BOTTOM_RIGHT,TOP_START:E.TOP_START,TOP_END:E.TOP_END,BOTTOM_START:E.BOTTOM_START,BOTTOM_END:E.BOTTOM_END};class P extends o.a{constructor(){super(...arguments),this.mdcFoundationClass=L,this.absolute=!1,this.fullwidth=!1,this.fixed=!1,this.x=null,this.y=null,this.quick=!1,this.open=!1,this.corner=\"TOP_START\",this.anchor=null,this.previouslyFocused=null,this.previousAnchor=null,this.onBodyClickBound=()=>{}}render(){const t={\"mdc-menu-surface--fixed\":this.fixed,\"mdc-menu-surface--fullwidth\":this.fullwidth};return r.e`\n      <div\n          class=\"mdc-menu-surface ${Object(I.a)(t)}\"\n          @keydown=${this.onKeydown}\n          @opened=${this.registerBodyClick}\n          @closed=${this.deregisterBodyClick}>\n        <slot></slot>\n      </div>`}createAdapter(){return Object.assign(Object.assign({},Object(o.b)(this.mdcRoot)),{hasAnchor:()=>!!this.anchor,notifyClose:()=>{const t=new CustomEvent(\"closed\",{bubbles:!0,composed:!0});this.open=!1,this.mdcRoot.dispatchEvent(t)},notifyOpen:()=>{const t=new CustomEvent(\"opened\",{bubbles:!0,composed:!0});this.open=!0,this.mdcRoot.dispatchEvent(t)},isElementInContainer:()=>!1,isRtl:()=>!!this.mdcRoot&&\"rtl\"===getComputedStyle(this.mdcRoot).direction,setTransformOrigin:t=>{const e=this.mdcRoot;if(!e)return;const n=function(t,e){if(void 0===e&&(e=!1),void 0===O||e){var n=t.document.createElement(\"div\");O=\"transform\"in n.style?\"transform\":\"webkitTransform\"}return O}(window)+\"-origin\";e.style.setProperty(n,t)},isFocused:()=>Object(s.c)(this),saveFocus:()=>{const t=Object(s.b)(),e=t.length;e||(this.previouslyFocused=null),this.previouslyFocused=t[e-1]},restoreFocus:()=>{this.previouslyFocused&&\"focus\"in this.previouslyFocused&&this.previouslyFocused.focus()},getInnerDimensions:()=>{const t=this.mdcRoot;return t?{width:t.offsetWidth,height:t.offsetHeight}:{width:0,height:0}},getAnchorDimensions:()=>{const t=this.anchor;return t?t.getBoundingClientRect():null},getBodyDimensions:()=>({width:document.body.clientWidth,height:document.body.clientHeight}),getWindowDimensions:()=>({width:window.innerWidth,height:window.innerHeight}),getWindowScroll:()=>({x:window.pageXOffset,y:window.pageYOffset}),setPosition:t=>{const e=this.mdcRoot;e&&(e.style.left=\"left\"in t?t.left+\"px\":\"\",e.style.right=\"right\"in t?t.right+\"px\":\"\",e.style.top=\"top\"in t?t.top+\"px\":\"\",e.style.bottom=\"bottom\"in t?t.bottom+\"px\":\"\")},setMaxHeight:t=>{const e=this.mdcRoot;e&&(e.style.maxHeight=t)}})}onKeydown(t){this.mdcFoundation&&this.mdcFoundation.handleKeydown(t)}onBodyClick(t){-1===t.composedPath().indexOf(this)&&this.close()}registerBodyClick(){this.onBodyClickBound=this.onBodyClick.bind(this),document.body.addEventListener(\"click\",this.onBodyClickBound,{passive:!0,capture:!0})}deregisterBodyClick(){document.body.removeEventListener(\"click\",this.onBodyClickBound)}close(){this.open=!1}show(){this.open=!0}}Object(i.__decorate)([Object(r.h)(\".mdc-menu-surface\")],P.prototype,\"mdcRoot\",void 0),Object(i.__decorate)([Object(r.h)(\"slot\")],P.prototype,\"slotElement\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean}),Object(a.a)((function(t){this.mdcFoundation&&!this.fixed&&this.mdcFoundation.setIsHoisted(t)}))],P.prototype,\"absolute\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],P.prototype,\"fullwidth\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean}),Object(a.a)((function(t){this.mdcFoundation&&!this.absolute&&this.mdcFoundation.setIsHoisted(t)}))],P.prototype,\"fixed\",void 0),Object(i.__decorate)([Object(r.g)({type:Number}),Object(a.a)((function(t){this.mdcFoundation&&null!==this.y&&null!==t&&(this.mdcFoundation.setAbsolutePosition(t,this.y),this.mdcFoundation.setAnchorMargin({left:t,top:this.y,right:-t,bottom:this.y}))}))],P.prototype,\"x\",void 0),Object(i.__decorate)([Object(r.g)({type:Number}),Object(a.a)((function(t){this.mdcFoundation&&null!==this.x&&null!==t&&(this.mdcFoundation.setAbsolutePosition(this.x,t),this.mdcFoundation.setAnchorMargin({left:this.x,top:t,right:-this.x,bottom:t}))}))],P.prototype,\"y\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean}),Object(a.a)((function(t){this.mdcFoundation&&this.mdcFoundation.setQuickOpen(t)}))],P.prototype,\"quick\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean,reflect:!0}),Object(a.a)((function(t,e){this.mdcFoundation&&(t?this.mdcFoundation.open():void 0!==e&&this.mdcFoundation.close())}))],P.prototype,\"open\",void 0),Object(i.__decorate)([Object(r.g)({type:String}),Object(a.a)((function(t){this.mdcFoundation&&(t?this.mdcFoundation.setAnchorCorner(R[t]):this.mdcFoundation.setAnchorCorner(E.TOP_START))}))],P.prototype,\"corner\",void 0);\n/**\n@license\nCopyright 2018 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\nconst D=r.b`.mdc-menu-surface{display:none;position:absolute;box-sizing:border-box;max-width:calc(100vw - 32px);max-height:calc(100vh - 32px);margin:0;padding:0;transform:scale(1);transform-origin:top left;opacity:0;overflow:auto;will-change:transform,opacity;z-index:8;transition:opacity .03s linear,transform .12s cubic-bezier(0, 0, 0.2, 1);box-shadow:0px 5px 5px -3px rgba(0, 0, 0, 0.2),0px 8px 10px 1px rgba(0, 0, 0, 0.14),0px 3px 14px 2px rgba(0,0,0,.12);background-color:#fff;background-color:var(--mdc-theme-surface, #fff);color:#000;color:var(--mdc-theme-on-surface, #000);border-radius:4px;transform-origin-left:top left;transform-origin-right:top right}.mdc-menu-surface:focus{outline:none}.mdc-menu-surface--open{display:inline-block;transform:scale(1);opacity:1}.mdc-menu-surface--animating-open{display:inline-block;transform:scale(0.8);opacity:0}.mdc-menu-surface--animating-closed{display:inline-block;opacity:0;transition:opacity .075s linear}[dir=rtl] .mdc-menu-surface,.mdc-menu-surface[dir=rtl]{transform-origin-left:top right;transform-origin-right:top left}.mdc-menu-surface--anchor{position:relative;overflow:visible}.mdc-menu-surface--fixed{position:fixed}.mdc-menu-surface--fullwidth{width:100%}:host(:not([open])){display:none}.mdc-menu-surface{border-radius:var(--mdc-shape-medium, 4px);z-index:var(--mdc-menu-z-index, 8)}`;\n/**\n@license\nCopyright 2020 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/let N=class extends P{};N.styles=D,N=Object(i.__decorate)([Object(r.c)(\"mwc-menu-surface\")],N);\n/**\n * @license\n * Copyright 2018 Google Inc.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nvar F,j={MENU_SELECTED_LIST_ITEM:\"mdc-menu-item--selected\",MENU_SELECTION_GROUP:\"mdc-menu__selection-group\",ROOT:\"mdc-menu\"},B={ARIA_CHECKED_ATTR:\"aria-checked\",ARIA_DISABLED_ATTR:\"aria-disabled\",CHECKBOX_SELECTOR:'input[type=\"checkbox\"]',LIST_SELECTOR:\".mdc-list\",SELECTED_EVENT:\"MDCMenu:selected\"},z={FOCUS_ROOT_INDEX:-1};!function(t){t[t.NONE=0]=\"NONE\",t[t.LIST_ROOT=1]=\"LIST_ROOT\",t[t.FIRST_ITEM=2]=\"FIRST_ITEM\",t[t.LAST_ITEM=3]=\"LAST_ITEM\"}(F||(F={}));\n/**\n * @license\n * Copyright 2018 Google Inc.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nvar U=function(t){function e(n){var r=t.call(this,Object(i.__assign)(Object(i.__assign)({},e.defaultAdapter),n))||this;return r.closeAnimationEndTimerId_=0,r.defaultFocusState_=F.LIST_ROOT,r}return Object(i.__extends)(e,t),Object.defineProperty(e,\"cssClasses\",{get:function(){return j},enumerable:!0,configurable:!0}),Object.defineProperty(e,\"strings\",{get:function(){return B},enumerable:!0,configurable:!0}),Object.defineProperty(e,\"numbers\",{get:function(){return z},enumerable:!0,configurable:!0}),Object.defineProperty(e,\"defaultAdapter\",{get:function(){return{addClassToElementAtIndex:function(){},removeClassFromElementAtIndex:function(){},addAttributeToElementAtIndex:function(){},removeAttributeFromElementAtIndex:function(){},elementContainsClass:function(){return!1},closeSurface:function(){},getElementIndex:function(){return-1},notifySelected:function(){},getMenuItemCount:function(){return 0},focusItemAtIndex:function(){},focusListRoot:function(){},getSelectedSiblingOfItemAtIndex:function(){return-1},isSelectableItemAtIndex:function(){return!1}}},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.closeAnimationEndTimerId_&&clearTimeout(this.closeAnimationEndTimerId_),this.adapter_.closeSurface()},e.prototype.handleKeydown=function(t){var e=t.key,n=t.keyCode;(\"Tab\"===e||9===n)&&this.adapter_.closeSurface(!0)},e.prototype.handleItemAction=function(t){var e=this,n=this.adapter_.getElementIndex(t);n<0||(this.adapter_.notifySelected({index:n}),this.adapter_.closeSurface(),this.closeAnimationEndTimerId_=setTimeout((function(){var n=e.adapter_.getElementIndex(t);e.adapter_.isSelectableItemAtIndex(n)&&e.setSelectedIndex(n)}),k.numbers.TRANSITION_CLOSE_DURATION))},e.prototype.handleMenuSurfaceOpened=function(){switch(this.defaultFocusState_){case F.FIRST_ITEM:this.adapter_.focusItemAtIndex(0);break;case F.LAST_ITEM:this.adapter_.focusItemAtIndex(this.adapter_.getMenuItemCount()-1);break;case F.NONE:break;default:this.adapter_.focusListRoot()}},e.prototype.setDefaultFocusState=function(t){this.defaultFocusState_=t},e.prototype.setSelectedIndex=function(t){if(this.validatedIndex_(t),!this.adapter_.isSelectableItemAtIndex(t))throw new Error(\"MDCMenuFoundation: No selection group at specified index.\");var e=this.adapter_.getSelectedSiblingOfItemAtIndex(t);e>=0&&(this.adapter_.removeAttributeFromElementAtIndex(e,B.ARIA_CHECKED_ATTR),this.adapter_.removeClassFromElementAtIndex(e,j.MENU_SELECTED_LIST_ITEM)),this.adapter_.addClassToElementAtIndex(t,j.MENU_SELECTED_LIST_ITEM),this.adapter_.addAttributeToElementAtIndex(t,B.ARIA_CHECKED_ATTR,\"true\")},e.prototype.setEnabled=function(t,e){this.validatedIndex_(t),e?(this.adapter_.removeClassFromElementAtIndex(t,u),this.adapter_.addAttributeToElementAtIndex(t,B.ARIA_DISABLED_ATTR,\"false\")):(this.adapter_.addClassToElementAtIndex(t,u),this.adapter_.addAttributeToElementAtIndex(t,B.ARIA_DISABLED_ATTR,\"true\"))},e.prototype.validatedIndex_=function(t){var e=this.adapter_.getMenuItemCount();if(!(t>=0&&t<e))throw new Error(\"MDCMenuFoundation: No list item at specified index.\")},e}(l.a);\n/**\n@license\nCopyright 2020 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\nclass H extends o.a{constructor(){super(...arguments),this.mdcFoundationClass=U,this.listElement_=null,this.anchor=null,this.open=!1,this.quick=!1,this.wrapFocus=!1,this.innerRole=\"menu\",this.corner=\"TOP_START\",this.x=null,this.y=null,this.absolute=!1,this.multi=!1,this.activatable=!1,this.fixed=!1,this.forceGroupSelection=!1,this.fullwidth=!1,this.defaultFocus=\"LIST_ROOT\",this._listUpdateComplete=null}get listElement(){return this.listElement_||(this.listElement_=this.renderRoot.querySelector(\"mwc-list\")),this.listElement_}get items(){const t=this.listElement;return t?t.items:[]}get index(){const t=this.listElement;return t?t.index:-1}get selected(){const t=this.listElement;return t?t.selected:null}render(){const t=\"menu\"===this.innerRole?\"menuitem\":\"option\";return r.e`\n      <mwc-menu-surface\n          ?hidden=${!this.open}\n          .anchor=${this.anchor}\n          .open=${this.open}\n          .quick=${this.quick}\n          .corner=${this.corner}\n          .x=${this.x}\n          .y=${this.y}\n          .absolute=${this.absolute}\n          .fixed=${this.fixed}\n          .fullwidth=${this.fullwidth}\n          class=\"mdc-menu mdc-menu-surface\"\n          @closed=${this.onClosed}\n          @opened=${this.onOpened}\n          @keydown=${this.onKeydown}>\n        <mwc-list\n          rootTabbable\n          .innerRole=${this.innerRole}\n          .multi=${this.multi}\n          class=\"mdc-list\"\n          .itemRoles=${t}\n          .wrapFocus=${this.wrapFocus}\n          .activatable=${this.activatable}\n          @action=${this.onAction}>\n        <slot></slot>\n      </mwc-list>\n    </mwc-menu-surface>`}createAdapter(){return{addClassToElementAtIndex:(t,e)=>{const n=this.listElement;if(!n)return;const i=n.items[t];i&&(\"mdc-menu-item--selected\"===e?this.forceGroupSelection&&!i.selected&&n.toggle(t,!0):i.classList.add(e))},removeClassFromElementAtIndex:(t,e)=>{const n=this.listElement;if(!n)return;const i=n.items[t];i&&(\"mdc-menu-item--selected\"===e?i.selected&&n.toggle(t,!1):i.classList.remove(e))},addAttributeToElementAtIndex:(t,e,n)=>{const i=this.listElement;if(!i)return;const r=i.items[t];r&&r.setAttribute(e,n)},removeAttributeFromElementAtIndex:(t,e)=>{const n=this.listElement;if(!n)return;const i=n.items[t];i&&i.removeAttribute(e)},elementContainsClass:(t,e)=>t.classList.contains(e),closeSurface:()=>{this.open=!1},getElementIndex:t=>{const e=this.listElement;return e?e.items.indexOf(t):-1},notifySelected:()=>{},getMenuItemCount:()=>{const t=this.listElement;return t?t.items.length:0},focusItemAtIndex:t=>{const e=this.listElement;if(!e)return;const n=e.items[t];n&&n.focus()},focusListRoot:()=>{this.listElement&&this.listElement.focus()},getSelectedSiblingOfItemAtIndex:t=>{const e=this.listElement;if(!e)return-1;const n=e.items[t];if(!n||!n.group)return-1;for(let i=0;i<e.items.length;i++){if(i===t)continue;const r=e.items[i];if(r.selected&&r.group===n.group)return i}return-1},isSelectableItemAtIndex:t=>{const e=this.listElement;if(!e)return!1;const n=e.items[t];return!!n&&n.hasAttribute(\"group\")}}}onKeydown(t){this.mdcFoundation&&this.mdcFoundation.handleKeydown(t)}onAction(t){const e=this.listElement;if(this.mdcFoundation&&e){const n=t.detail.index,i=e.items[n];i&&this.mdcFoundation.handleItemAction(i)}}onOpened(){this.open=!0,this.mdcFoundation&&this.mdcFoundation.handleMenuSurfaceOpened()}onClosed(){this.open=!1}async _getUpdateComplete(){await this._listUpdateComplete,await super._getUpdateComplete()}async firstUpdated(){super.firstUpdated();const t=this.listElement;t&&(this._listUpdateComplete=t.updateComplete,await this._listUpdateComplete)}select(t){const e=this.listElement;e&&e.select(t)}close(){this.open=!1}show(){this.open=!0}layout(t=!0){const e=this.listElement;e&&e.layout(t)}}Object(i.__decorate)([Object(r.h)(\".mdc-menu\")],H.prototype,\"mdcRoot\",void 0),Object(i.__decorate)([Object(r.h)(\"slot\")],H.prototype,\"slotElement\",void 0),Object(i.__decorate)([Object(r.g)({type:Object})],H.prototype,\"anchor\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean,reflect:!0})],H.prototype,\"open\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],H.prototype,\"quick\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],H.prototype,\"wrapFocus\",void 0),Object(i.__decorate)([Object(r.g)({type:String})],H.prototype,\"innerRole\",void 0),Object(i.__decorate)([Object(r.g)({type:String})],H.prototype,\"corner\",void 0),Object(i.__decorate)([Object(r.g)({type:Number})],H.prototype,\"x\",void 0),Object(i.__decorate)([Object(r.g)({type:Number})],H.prototype,\"y\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],H.prototype,\"absolute\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],H.prototype,\"multi\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],H.prototype,\"activatable\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],H.prototype,\"fixed\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],H.prototype,\"forceGroupSelection\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],H.prototype,\"fullwidth\",void 0),Object(i.__decorate)([Object(r.g)({type:String}),Object(a.a)((function(t){this.mdcFoundation&&this.mdcFoundation.setDefaultFocusState(F[t])}))],H.prototype,\"defaultFocus\",void 0);\n/**\n@license\nCopyright 2018 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\nconst $=r.b`mwc-list ::slotted([mwc-list-item]:not([twoline])){height:var(--mdc-menu-item-height, 48px)}mwc-list{max-width:var(--mdc-menu-max-width, auto);min-width:var(--mdc-menu-min-width, auto)}`;\n/**\n@license\nCopyright 2020 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/let G=class extends H{};G.styles=$,G=Object(i.__decorate)([Object(r.c)(\"mwc-menu\")],G)},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"Formfield\",(function(){return g}));var i=n(1),r=n(0),o=n(16),a={ROOT:\"mdc-form-field\"},s={LABEL_SELECTOR:\".mdc-form-field > label\"},c=function(t){function e(n){var r=t.call(this,Object(i.__assign)(Object(i.__assign)({},e.defaultAdapter),n))||this;return r.clickHandler_=function(){return r.handleClick_()},r}return Object(i.__extends)(e,t),Object.defineProperty(e,\"cssClasses\",{get:function(){return a},enumerable:!0,configurable:!0}),Object.defineProperty(e,\"strings\",{get:function(){return s},enumerable:!0,configurable:!0}),Object.defineProperty(e,\"defaultAdapter\",{get:function(){return{activateInputRipple:function(){},deactivateInputRipple:function(){},deregisterInteractionHandler:function(){},registerInteractionHandler:function(){}}},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.adapter_.registerInteractionHandler(\"click\",this.clickHandler_)},e.prototype.destroy=function(){this.adapter_.deregisterInteractionHandler(\"click\",this.clickHandler_)},e.prototype.handleClick_=function(){var t=this;this.adapter_.activateInputRipple(),requestAnimationFrame((function(){return t.adapter_.deactivateInputRipple()}))},e}(o.a),l=n(18),d=n(24),u=n(10),h=n(28),p=n(29);\n/**\n * @license\n * Copyright 2018 Google Inc. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nclass f extends l.a{constructor(){super(...arguments),this.alignEnd=!1,this.spaceBetween=!1,this.nowrap=!1,this.label=\"\",this.mdcFoundationClass=c}createAdapter(){return{registerInteractionHandler:(t,e)=>{this.labelEl.addEventListener(t,e)},deregisterInteractionHandler:(t,e)=>{this.labelEl.removeEventListener(t,e)},activateInputRipple:async()=>{const t=this.input;if(t instanceof d.a){const e=await t.ripple;e&&e.startPress()}},deactivateInputRipple:async()=>{const t=this.input;if(t instanceof d.a){const e=await t.ripple;e&&e.endPress()}}}}get input(){return Object(h.d)(this.slotEl,\"*\")}render(){const t={\"mdc-form-field--align-end\":this.alignEnd,\"mdc-form-field--space-between\":this.spaceBetween,\"mdc-form-field--nowrap\":this.nowrap};return r.e`\n      <div class=\"mdc-form-field ${Object(p.a)(t)}\">\n        <slot></slot>\n        <label class=\"mdc-label\"\n               @click=\"${this._labelClick}\">${this.label}</label>\n      </div>`}_labelClick(){const t=this.input;t&&(t.focus(),t.click())}}Object(i.__decorate)([Object(r.g)({type:Boolean})],f.prototype,\"alignEnd\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],f.prototype,\"spaceBetween\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],f.prototype,\"nowrap\",void 0),Object(i.__decorate)([Object(r.g)({type:String}),Object(u.a)((async function(t){const e=this.input;e&&(\"input\"===e.localName?e.setAttribute(\"aria-label\",t):e instanceof d.a&&(await e.updateComplete,e.setAriaLabel(t)))}))],f.prototype,\"label\",void 0),Object(i.__decorate)([Object(r.h)(\".mdc-form-field\")],f.prototype,\"mdcRoot\",void 0),Object(i.__decorate)([Object(r.h)(\"slot\")],f.prototype,\"slotEl\",void 0),Object(i.__decorate)([Object(r.h)(\"label\")],f.prototype,\"labelEl\",void 0);\n/**\n@license\nCopyright 2018 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\nconst m=r.b`.mdc-form-field{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-body2-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:.875rem;font-size:var(--mdc-typography-body2-font-size, 0.875rem);line-height:1.25rem;line-height:var(--mdc-typography-body2-line-height, 1.25rem);font-weight:400;font-weight:var(--mdc-typography-body2-font-weight, 400);letter-spacing:.0178571429em;letter-spacing:var(--mdc-typography-body2-letter-spacing, 0.0178571429em);text-decoration:inherit;text-decoration:var(--mdc-typography-body2-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-body2-text-transform, inherit);color:rgba(0,0,0,.87);color:var(--mdc-theme-text-primary-on-background, rgba(0, 0, 0, 0.87));display:inline-flex;align-items:center;vertical-align:middle}.mdc-form-field>label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0;order:0}[dir=rtl] .mdc-form-field>label,.mdc-form-field>label[dir=rtl]{margin-left:auto;margin-right:0}[dir=rtl] .mdc-form-field>label,.mdc-form-field>label[dir=rtl]{padding-left:0;padding-right:4px}.mdc-form-field--nowrap>label{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mdc-form-field--align-end>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px;order:-1}[dir=rtl] .mdc-form-field--align-end>label,.mdc-form-field--align-end>label[dir=rtl]{margin-left:0;margin-right:auto}[dir=rtl] .mdc-form-field--align-end>label,.mdc-form-field--align-end>label[dir=rtl]{padding-left:4px;padding-right:0}.mdc-form-field--space-between{justify-content:space-between}.mdc-form-field--space-between>label{margin:0}[dir=rtl] .mdc-form-field--space-between>label,.mdc-form-field--space-between>label[dir=rtl]{margin:0}:host{display:inline-flex}.mdc-form-field{width:100%}::slotted(*){-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-body2-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:.875rem;font-size:var(--mdc-typography-body2-font-size, 0.875rem);line-height:1.25rem;line-height:var(--mdc-typography-body2-line-height, 1.25rem);font-weight:400;font-weight:var(--mdc-typography-body2-font-weight, 400);letter-spacing:.0178571429em;letter-spacing:var(--mdc-typography-body2-letter-spacing, 0.0178571429em);text-decoration:inherit;text-decoration:var(--mdc-typography-body2-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-body2-text-transform, inherit);color:rgba(0,0,0,.87);color:var(--mdc-theme-text-primary-on-background, rgba(0, 0, 0, 0.87))}::slotted(mwc-switch){margin-right:10px}[dir=rtl] ::slotted(mwc-switch),::slotted(mwc-switch)[dir=rtl]{margin-left:10px}`;\n/**\n@license\nCopyright 2018 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/let g=class extends f{};g.styles=m,g=Object(i.__decorate)([Object(r.c)(\"mwc-formfield\")],g)},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"Radio\",(function(){return v}));var i=n(1),r=n(0),o=n(24),a=n(10),s=n(49),c=n(16),l={NATIVE_CONTROL_SELECTOR:\".mdc-radio__native-control\"},d={DISABLED:\"mdc-radio--disabled\",ROOT:\"mdc-radio\"},u=function(t){function e(n){return t.call(this,Object(i.__assign)(Object(i.__assign)({},e.defaultAdapter),n))||this}return Object(i.__extends)(e,t),Object.defineProperty(e,\"cssClasses\",{get:function(){return d},enumerable:!0,configurable:!0}),Object.defineProperty(e,\"strings\",{get:function(){return l},enumerable:!0,configurable:!0}),Object.defineProperty(e,\"defaultAdapter\",{get:function(){return{addClass:function(){},removeClass:function(){},setNativeControlDisabled:function(){}}},enumerable:!0,configurable:!0}),e.prototype.setDisabled=function(t){var n=e.cssClasses.DISABLED;this.adapter_.setNativeControlDisabled(t),t?this.adapter_.addClass(n):this.adapter_.removeClass(n)},e}(c.a);\n/**\n@license\nCopyright 2018 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\nclass h extends o.a{constructor(){super(...arguments),this._checked=!1,this.global=!1,this.disabled=!1,this.value=\"\",this.name=\"\",this.mdcFoundationClass=u}get checked(){return this._checked}set checked(t){const e=this._checked;!!t!=!!e&&(this._checked=t,this.formElement&&(this.formElement.checked=t),void 0!==this._selectionController&&this._selectionController.update(this),this.requestUpdate(\"checked\",e),this.dispatchEvent(new Event(\"checked\",{bubbles:!0,composed:!0})))}_handleUpdatedValue(t){this.formElement.value=t}connectedCallback(){super.connectedCallback(),this._selectionController=m.getController(this),this._selectionController.register(this),this._selectionController.update(this)}disconnectedCallback(){this._selectionController.unregister(this),this._selectionController=void 0}focusNative(){this.formElement.focus()}get ripple(){return this.rippleElement.ripple}createAdapter(){return Object.assign(Object.assign({},Object(o.b)(this.mdcRoot)),{setNativeControlDisabled:t=>{this.formElement.disabled=t}})}_changeHandler(){this.checked=this.formElement.checked}_focusHandler(){void 0!==this._selectionController&&this._selectionController.focus(this)}_clickHandler(){this.formElement.focus()}render(){return r.e`\n      <div class=\"mdc-radio\" .ripple=${Object(s.a)()}>\n        <input\n          class=\"mdc-radio__native-control\"\n          type=\"radio\"\n          name=\"${this.name}\"\n          .checked=\"${this.checked}\"\n          .value=\"${this.value}\"\n          @change=\"${this._changeHandler}\"\n          @focus=\"${this._focusHandler}\"\n          @click=\"${this._clickHandler}\">\n        <div class=\"mdc-radio__background\">\n          <div class=\"mdc-radio__outer-circle\"></div>\n          <div class=\"mdc-radio__inner-circle\"></div>\n        </div>\n        <div class=\"mdc-radio__ripple\"></div>\n      </div>`}firstUpdated(){super.firstUpdated(),this.formElement.checked=this.checked,void 0!==this._selectionController&&this._selectionController.update(this)}}Object(i.__decorate)([Object(r.h)(\".mdc-radio\")],h.prototype,\"mdcRoot\",void 0),Object(i.__decorate)([Object(r.h)(\"input\")],h.prototype,\"formElement\",void 0),Object(i.__decorate)([Object(r.h)(\".mdc-radio__ripple\")],h.prototype,\"rippleElement\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],h.prototype,\"global\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean,reflect:!0})],h.prototype,\"checked\",null),Object(i.__decorate)([Object(r.g)({type:Boolean}),Object(a.a)((function(t){this.mdcFoundation.setDisabled(t)}))],h.prototype,\"disabled\",void 0),Object(i.__decorate)([Object(r.g)({type:String}),Object(a.a)((function(t){this._handleUpdatedValue(t)}))],h.prototype,\"value\",void 0),Object(i.__decorate)([Object(r.g)({type:String})],h.prototype,\"name\",void 0);const p=Symbol(\"selection controller\");class f{constructor(){this.selected=null,this.ordered=null,this.set=new Set}}class m{constructor(t){this.sets={},this.focusedSet=null,this.mouseIsDown=!1,this.updating=!1,t.addEventListener(\"keydown\",t=>this.keyDownHandler(t)),t.addEventListener(\"mousedown\",()=>this.mousedownHandler()),t.addEventListener(\"mouseup\",()=>this.mouseupHandler())}static getController(t){const e=!(\"global\"in t)||\"global\"in t&&t.global?document:t.getRootNode();let n=e[p];return void 0===n&&(n=new m(e),e[p]=n),n}keyDownHandler(t){if(!(t.target instanceof h))return;const e=t.target;this.has(e)&&(\"ArrowRight\"==t.key||\"ArrowDown\"==t.key?this.next(e):\"ArrowLeft\"!=t.key&&\"ArrowUp\"!=t.key||this.previous(e))}mousedownHandler(){this.mouseIsDown=!0}mouseupHandler(){this.mouseIsDown=!1}has(t){return this.getSet(t.name).set.has(t)}previous(t){const e=this.getOrdered(t),n=e.indexOf(t);this.select(e[n-1]||e[e.length-1])}next(t){const e=this.getOrdered(t),n=e.indexOf(t);this.select(e[n+1]||e[0])}select(t){t.click()}focus(t){if(this.mouseIsDown)return;const e=this.getSet(t.name),n=this.focusedSet;this.focusedSet=e,n!=e&&e.selected&&e.selected!=t&&e.selected.focusNative()}getOrdered(t){const e=this.getSet(t.name);return e.ordered||(e.ordered=Array.from(e.set),e.ordered.sort((t,e)=>t.compareDocumentPosition(e)==Node.DOCUMENT_POSITION_PRECEDING?1:0)),e.ordered}getSet(t){return this.sets[t]||(this.sets[t]=new f),this.sets[t]}register(t){const e=this.getSet(t.name);e.set.add(t),e.ordered=null}unregister(t){const e=this.getSet(t.name);e.set.delete(t),e.ordered=null,e.selected==t&&(e.selected=null)}update(t){if(!this.updating){if(this.updating=!0,t.checked){const e=this.getSet(t.name);for(const n of e.set)n.checked=n==t;e.selected=t}this.updating=!1}}}\n/**\n@license\nCopyright 2018 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/const g=r.b`.mdc-touch-target-wrapper{display:inline}.mdc-radio{padding:10px;display:inline-block;position:relative;flex:0 0 auto;box-sizing:content-box;width:20px;height:20px;cursor:pointer;will-change:opacity,transform,border-color,color}.mdc-radio .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:rgba(0,0,0,.54)}.mdc-radio .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:#018786;border-color:var(--mdc-theme-secondary, #018786)}.mdc-radio .mdc-radio__native-control:enabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:#018786;border-color:var(--mdc-theme-secondary, #018786)}.mdc-radio [aria-disabled=true] .mdc-radio__native-control:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle,.mdc-radio .mdc-radio__native-control:disabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:rgba(0,0,0,.38)}.mdc-radio [aria-disabled=true] .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mdc-radio .mdc-radio__native-control:disabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:rgba(0,0,0,.38)}.mdc-radio [aria-disabled=true] .mdc-radio__native-control+.mdc-radio__background .mdc-radio__inner-circle,.mdc-radio .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:rgba(0,0,0,.38)}.mdc-radio .mdc-radio__background::before{background-color:#018786;background-color:var(--mdc-theme-secondary, #018786)}.mdc-radio .mdc-radio__background::before{top:-10px;left:-10px;width:40px;height:40px}.mdc-radio .mdc-radio__native-control{top:0px;right:0px;left:0px;width:40px;height:40px}.mdc-radio__background{display:inline-block;position:relative;box-sizing:border-box;width:20px;height:20px}.mdc-radio__background::before{position:absolute;transform:scale(0, 0);border-radius:50%;opacity:0;pointer-events:none;content:\"\";transition:opacity 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-radio__outer-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;border-width:2px;border-style:solid;border-radius:50%;transition:border-color 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-radio__inner-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;transform:scale(0, 0);border-width:10px;border-style:solid;border-radius:50%;transition:transform 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1),border-color 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-radio__native-control{position:absolute;margin:0;padding:0;opacity:0;cursor:inherit;z-index:1}.mdc-radio--touch{margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}.mdc-radio--touch .mdc-radio__native-control{top:-4px;right:-4px;left:-4px;width:48px;height:48px}.mdc-radio__native-control:checked+.mdc-radio__background,.mdc-radio__native-control:disabled+.mdc-radio__background{transition:opacity 120ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__outer-circle{transition:border-color 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__inner-circle,.mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle{transition:transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1),border-color 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio--disabled{cursor:default;pointer-events:none}.mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__inner-circle{transform:scale(0.5);transition:transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1),border-color 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio__native-control:disabled+.mdc-radio__background,[aria-disabled=true] .mdc-radio__native-control+.mdc-radio__background{cursor:default}.mdc-radio__native-control:focus+.mdc-radio__background::before{transform:scale(1);opacity:.12;transition:opacity 120ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}@keyframes mdc-ripple-fg-radius-in{from{animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transform:translate(var(--mdc-ripple-fg-translate-start, 0)) scale(1)}to{transform:translate(var(--mdc-ripple-fg-translate-end, 0)) scale(var(--mdc-ripple-fg-scale, 1))}}@keyframes mdc-ripple-fg-opacity-in{from{animation-timing-function:linear;opacity:0}to{opacity:var(--mdc-ripple-fg-opacity, 0)}}@keyframes mdc-ripple-fg-opacity-out{from{animation-timing-function:linear;opacity:var(--mdc-ripple-fg-opacity, 0)}to{opacity:0}}.mdc-radio{--mdc-ripple-fg-size: 0;--mdc-ripple-left: 0;--mdc-ripple-top: 0;--mdc-ripple-fg-scale: 1;--mdc-ripple-fg-translate-end: 0;--mdc-ripple-fg-translate-start: 0;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mdc-radio .mdc-radio__ripple::before,.mdc-radio .mdc-radio__ripple::after{position:absolute;border-radius:50%;opacity:0;pointer-events:none;content:\"\"}.mdc-radio .mdc-radio__ripple::before{transition:opacity 15ms linear,background-color 15ms linear;z-index:1}.mdc-radio.mdc-ripple-upgraded .mdc-radio__ripple::before{transform:scale(var(--mdc-ripple-fg-scale, 1))}.mdc-radio.mdc-ripple-upgraded .mdc-radio__ripple::after{top:0;left:0;transform:scale(0);transform-origin:center center}.mdc-radio.mdc-ripple-upgraded--unbounded .mdc-radio__ripple::after{top:var(--mdc-ripple-top, 0);left:var(--mdc-ripple-left, 0)}.mdc-radio.mdc-ripple-upgraded--foreground-activation .mdc-radio__ripple::after{animation:mdc-ripple-fg-radius-in 225ms forwards,mdc-ripple-fg-opacity-in 75ms forwards}.mdc-radio.mdc-ripple-upgraded--foreground-deactivation .mdc-radio__ripple::after{animation:mdc-ripple-fg-opacity-out 150ms;transform:translate(var(--mdc-ripple-fg-translate-end, 0)) scale(var(--mdc-ripple-fg-scale, 1))}.mdc-radio .mdc-radio__ripple::before,.mdc-radio .mdc-radio__ripple::after{top:calc(50% - 50%);left:calc(50% - 50%);width:100%;height:100%}.mdc-radio.mdc-ripple-upgraded .mdc-radio__ripple::before,.mdc-radio.mdc-ripple-upgraded .mdc-radio__ripple::after{top:var(--mdc-ripple-top, calc(50% - 50%));left:var(--mdc-ripple-left, calc(50% - 50%));width:var(--mdc-ripple-fg-size, 100%);height:var(--mdc-ripple-fg-size, 100%)}.mdc-radio.mdc-ripple-upgraded .mdc-radio__ripple::after{width:var(--mdc-ripple-fg-size, 100%);height:var(--mdc-ripple-fg-size, 100%)}.mdc-radio .mdc-radio__ripple::before,.mdc-radio .mdc-radio__ripple::after{background-color:#018786;background-color:var(--mdc-theme-secondary, #018786)}.mdc-radio:hover .mdc-radio__ripple::before{opacity:.04}.mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__ripple::before,.mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__ripple::before{transition-duration:75ms;opacity:.12}.mdc-radio:not(.mdc-ripple-upgraded) .mdc-radio__ripple::after{transition:opacity 150ms linear}.mdc-radio:not(.mdc-ripple-upgraded):active .mdc-radio__ripple::after{transition-duration:75ms;opacity:.12}.mdc-radio.mdc-ripple-upgraded{--mdc-ripple-fg-opacity: 0.12}.mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__background::before{content:none}.mdc-radio__ripple{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none}:host{display:inline-block;outline:none}.mdc-radio{vertical-align:bottom}.mdc-radio .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unchecked-color, rgba(0, 0, 0, 0.54))}.mdc-radio [aria-disabled=true] .mdc-radio__native-control:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle,.mdc-radio .mdc-radio__native-control:disabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-color, rgba(0, 0, 0, 0.38))}.mdc-radio [aria-disabled=true] .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mdc-radio .mdc-radio__native-control:disabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-color, rgba(0, 0, 0, 0.38))}.mdc-radio [aria-disabled=true] .mdc-radio__native-control+.mdc-radio__background .mdc-radio__inner-circle,.mdc-radio .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-disabled-color, rgba(0, 0, 0, 0.38))}`;\n/**\n@license\nCopyright 2018 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/let v=class extends h{};v.styles=g,v=Object(i.__decorate)([Object(r.c)(\"mwc-radio\")],v)},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"UntilDirective\",(function(){return g})),n.d(e,\"until\",(function(){return v}));var i=n(22),r=n(23),o=n(48);\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst a=(t,e)=>{var n,i;const r=t._$AN;if(void 0===r)return!1;for(const t of r)null===(i=(n=t)._$AO)||void 0===i||i.call(n,e,!1),a(t,e);return!0},s=t=>{let e,n;do{if(void 0===(e=t._$AM))break;n=e._$AN,n.delete(t),t=e}while(0===(null==n?void 0:n.size))},c=t=>{for(let e;e=t._$AM;t=e){let n=e._$AN;if(void 0===n)e._$AN=n=new Set;else if(n.has(t))break;n.add(t),u(e)}};function l(t){void 0!==this._$AN?(s(this),this._$AM=t,c(this)):this._$AM=t}function d(t,e=!1,n=0){const i=this._$AH,r=this._$AN;if(void 0!==r&&0!==r.size)if(e)if(Array.isArray(i))for(let t=n;t<i.length;t++)a(i[t],!1),s(i[t]);else null!=i&&(a(i,!1),s(i));else a(this,t)}const u=t=>{var e,n,i,o;t.type==r.b.CHILD&&(null!==(e=(i=t)._$AP)&&void 0!==e||(i._$AP=d),null!==(n=(o=t)._$AQ)&&void 0!==n||(o._$AQ=l))};class h extends r.a{constructor(){super(...arguments),this._$AN=void 0}_$AT(t,e,n){super._$AT(t,e,n),c(this),this.isConnected=t._$AU}_$AO(t,e=!0){var n,i;t!==this.isConnected&&(this.isConnected=t,t?null===(n=this.reconnected)||void 0===n||n.call(this):null===(i=this.disconnected)||void 0===i||i.call(this)),e&&(a(this,t),s(this))}setValue(t){if(Object(o.h)(this._$Ct))this._$Ct._$AI(t,this);else{const e=[...this._$Ct._$AH];e[this._$Ci]=t,this._$Ct._$AI(e,this,0)}}disconnected(){}reconnected(){}}\n/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */class p{constructor(t){this.Y=t}disconnect(){this.Y=void 0}reconnect(t){this.Y=t}deref(){return this.Y}}class f{constructor(){this.Z=void 0,this.q=void 0}get(){return this.Z}pause(){var t;null!==(t=this.Z)&&void 0!==t||(this.Z=new Promise(t=>this.q=t))}resume(){var t;null===(t=this.q)||void 0===t||t.call(this),this.Z=this.q=void 0}}\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const m=t=>!Object(o.g)(t)&&\"function\"==typeof t.then;class g extends h{constructor(){super(...arguments),this._$Cwt=1073741823,this._$Cyt=[],this._$CK=new p(this),this._$CX=new f}render(...t){var e;return null!==(e=t.find(t=>!m(t)))&&void 0!==e?e:i.c}update(t,e){const n=this._$Cyt;let r=n.length;this._$Cyt=e;const o=this._$CK,a=this._$CX;this.isConnected||this.disconnected();for(let t=0;t<e.length&&!(t>this._$Cwt);t++){const i=e[t];if(!m(i))return this._$Cwt=t,i;t<r&&i===n[t]||(this._$Cwt=1073741823,r=0,Promise.resolve(i).then(async t=>{for(;a.get();)await a.get();const e=o.deref();if(void 0!==e){const n=e._$Cyt.indexOf(i);n>-1&&n<e._$Cwt&&(e._$Cwt=n,e.setValue(t))}}))}return i.c}disconnected(){this._$CK.disconnect(),this._$CX.pause()}reconnected(){this._$CK.reconnect(this),this._$CX.resume()}}const v=Object(r.c)(g)},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"Checkbox\",(function(){return u}));var i=n(1),r=n(0),o=(n(81),n(24)),a=n(63),s=n(29),c=n(27);\n/**\n@license\nCopyright 2019 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\nclass l extends o.a{constructor(){super(...arguments),this.checked=!1,this.indeterminate=!1,this.disabled=!1,this.value=\"\",this.animationClass=\"\",this.shouldRenderRipple=!1,this.mdcFoundationClass=void 0,this.mdcFoundation=void 0,this.rippleElement=null,this.rippleHandlers=new a.a(()=>(this.shouldRenderRipple=!0,this.ripple.then(t=>this.rippleElement=t),this.ripple))}createAdapter(){return{}}update(t){const e=t.get(\"indeterminate\"),n=t.get(\"checked\");if(void 0!==e||void 0!==n){const t=this.calculateAnimationStateName(!!n,!!e),i=this.calculateAnimationStateName(this.checked,this.indeterminate);this.animationClass=`${t}-${i}`}super.update(t)}calculateAnimationStateName(t,e){return e?\"indeterminate\":t?\"checked\":\"unchecked\"}renderRipple(){const t=this.indeterminate||this.checked;return r.e`${this.shouldRenderRipple?r.e`<mwc-ripple .accent=\"${t}\" .disabled=\"${this.disabled}\" .unbounded=\"${!0}\"></mwc-ripple>`:\"\"}`}render(){const t=this.indeterminate||this.checked,e={\"mdc-checkbox--disabled\":this.disabled,\"mdc-checkbox--selected\":t,\"mdc-checkbox--anim-checked-indeterminate\":\"checked-indeterminate\"==this.animationClass,\"mdc-checkbox--anim-checked-unchecked\":\"checked-unchecked\"==this.animationClass,\"mdc-checkbox--anim-indeterminate-checked\":\"indeterminate-checked\"==this.animationClass,\"mdc-checkbox--anim-indeterminate-unchecked\":\"indeterminate-unchecked\"==this.animationClass,\"mdc-checkbox--anim-unchecked-checked\":\"unchecked-checked\"==this.animationClass,\"mdc-checkbox--anim-unchecked-indeterminate\":\"unchecked-indeterminate\"==this.animationClass},n=this.indeterminate?\"mixed\":void 0;return r.e`\n      <div class=\"mdc-checkbox mdc-checkbox--upgraded ${Object(s.a)(e)}\">\n        <input type=\"checkbox\"\n              class=\"mdc-checkbox__native-control\"\n              aria-checked=\"${Object(c.a)(n)}\"\n              data-indeterminate=\"${this.indeterminate?\"true\":\"false\"}\"\n              ?disabled=\"${this.disabled}\"\n              .indeterminate=\"${this.indeterminate}\"\n              .checked=\"${this.checked}\"\n              .value=\"${this.value}\"\n              @change=\"${this._changeHandler}\"\n              @focus=\"${this._handleFocus}\"\n              @blur=\"${this._handleBlur}\"\n              @mousedown=\"${this._activateRipple}\"\n              @mouseup=\"${this._deactivateRipple}\"\n              @mouseenter=\"${this._handleMouseEnter}\"\n              @mouseleave=\"${this._handleMouseLeave}\"\n              @touchstart=\"${this._activateRipple}\"\n              @touchend=\"${this._deactivateRipple}\"\n              @touchcancel=\"${this._deactivateRipple}\">\n        <div class=\"mdc-checkbox__background\">\n          <svg class=\"mdc-checkbox__checkmark\"\n              viewBox=\"0 0 24 24\">\n            <path class=\"mdc-checkbox__checkmark-path\"\n                  fill=\"none\"\n                  d=\"M1.73,12.91 8.1,19.28 22.79,4.59\"></path>\n          </svg>\n          <div class=\"mdc-checkbox__mixedmark\"></div>\n        </div>\n        ${this.renderRipple()}\n      </div>`}_handleFocus(){this.rippleHandlers.startFocus()}_handleBlur(){this.rippleHandlers.endFocus()}_activateRipple(){this.rippleHandlers.startPress()}_deactivateRipple(){this.rippleHandlers.endPress()}_handleMouseEnter(){this.rippleHandlers.startHover()}_handleMouseLeave(){this.rippleHandlers.endHover()}_changeHandler(){this.checked=this.formElement.checked,this.indeterminate=this.formElement.indeterminate}get isRippleActive(){var t;return(null===(t=this.rippleElement)||void 0===t?void 0:t.isActive)||!1}}Object(i.__decorate)([Object(r.h)(\".mdc-checkbox\")],l.prototype,\"mdcRoot\",void 0),Object(i.__decorate)([Object(r.h)(\"input\")],l.prototype,\"formElement\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean,reflect:!0})],l.prototype,\"checked\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],l.prototype,\"indeterminate\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean,reflect:!0})],l.prototype,\"disabled\",void 0),Object(i.__decorate)([Object(r.g)({type:String})],l.prototype,\"value\",void 0),Object(i.__decorate)([Object(r.f)()],l.prototype,\"animationClass\",void 0),Object(i.__decorate)([Object(r.f)()],l.prototype,\"shouldRenderRipple\",void 0),Object(i.__decorate)([Object(r.i)(\"mwc-ripple\")],l.prototype,\"ripple\",void 0);\n/**\n@license\nCopyright 2018 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\nconst d=r.b`.mdc-touch-target-wrapper{display:inline}@keyframes mdc-checkbox-unchecked-checked-checkmark-path{0%,50%{stroke-dashoffset:29.7833385}50%{animation-timing-function:cubic-bezier(0, 0, 0.2, 1)}100%{stroke-dashoffset:0}}@keyframes mdc-checkbox-unchecked-indeterminate-mixedmark{0%,68.2%{transform:scaleX(0)}68.2%{animation-timing-function:cubic-bezier(0, 0, 0, 1)}100%{transform:scaleX(1)}}@keyframes mdc-checkbox-checked-unchecked-checkmark-path{from{animation-timing-function:cubic-bezier(0.4, 0, 1, 1);opacity:1;stroke-dashoffset:0}to{opacity:0;stroke-dashoffset:-29.7833385}}@keyframes mdc-checkbox-checked-indeterminate-checkmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(45deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-checked-checkmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(45deg);opacity:0}to{transform:rotate(360deg);opacity:1}}@keyframes mdc-checkbox-checked-indeterminate-mixedmark{from{animation-timing-function:mdc-animation-deceleration-curve-timing-function;transform:rotate(-45deg);opacity:0}to{transform:rotate(0deg);opacity:1}}@keyframes mdc-checkbox-indeterminate-checked-mixedmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(315deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-unchecked-mixedmark{0%{animation-timing-function:linear;transform:scaleX(1);opacity:1}32.8%,100%{transform:scaleX(0);opacity:0}}.mdc-checkbox{display:inline-block;position:relative;flex:0 0 18px;box-sizing:content-box;width:18px;height:18px;line-height:0;white-space:nowrap;cursor:pointer;vertical-align:bottom;padding:11px}.mdc-checkbox .mdc-checkbox__native-control:checked~.mdc-checkbox__background::before,.mdc-checkbox .mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background::before,.mdc-checkbox .mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background::before{background-color:#018786;background-color:var(--mdc-theme-secondary, #018786)}.mdc-checkbox.mdc-checkbox--selected .mdc-checkbox__ripple::before,.mdc-checkbox.mdc-checkbox--selected .mdc-checkbox__ripple::after{background-color:#018786;background-color:var(--mdc-theme-secondary, #018786)}.mdc-checkbox.mdc-checkbox--selected:hover .mdc-checkbox__ripple::before{opacity:.04}.mdc-checkbox.mdc-checkbox--selected.mdc-ripple-upgraded--background-focused .mdc-checkbox__ripple::before,.mdc-checkbox.mdc-checkbox--selected:not(.mdc-ripple-upgraded):focus .mdc-checkbox__ripple::before{transition-duration:75ms;opacity:.12}.mdc-checkbox.mdc-checkbox--selected:not(.mdc-ripple-upgraded) .mdc-checkbox__ripple::after{transition:opacity 150ms linear}.mdc-checkbox.mdc-checkbox--selected:not(.mdc-ripple-upgraded):active .mdc-checkbox__ripple::after{transition-duration:75ms;opacity:.12}.mdc-checkbox.mdc-checkbox--selected.mdc-ripple-upgraded{--mdc-ripple-fg-opacity: 0.12}.mdc-checkbox.mdc-ripple-upgraded--background-focused.mdc-checkbox--selected .mdc-checkbox__ripple::before,.mdc-checkbox.mdc-ripple-upgraded--background-focused.mdc-checkbox--selected .mdc-checkbox__ripple::after{background-color:#018786;background-color:var(--mdc-theme-secondary, #018786)}.mdc-checkbox .mdc-checkbox__background{top:11px;left:11px}.mdc-checkbox .mdc-checkbox__background::before{top:-13px;left:-13px;width:40px;height:40px}.mdc-checkbox .mdc-checkbox__native-control{top:0px;right:0px;left:0px;width:40px;height:40px}.mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:rgba(0,0,0,.54);background-color:transparent}.mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:#018786;border-color:var(--mdc-theme-secondary, #018786);background-color:#018786;background-color:var(--mdc-theme-secondary, #018786)}@keyframes mdc-checkbox-fade-in-background-8A000000secondary00000000secondary{0%{border-color:rgba(0,0,0,.54);background-color:transparent}50%{border-color:#018786;border-color:var(--mdc-theme-secondary, #018786);background-color:#018786;background-color:var(--mdc-theme-secondary, #018786)}}@keyframes mdc-checkbox-fade-out-background-8A000000secondary00000000secondary{0%,80%{border-color:#018786;border-color:var(--mdc-theme-secondary, #018786);background-color:#018786;background-color:var(--mdc-theme-secondary, #018786)}100%{border-color:rgba(0,0,0,.54);background-color:transparent}}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-8A000000secondary00000000secondary}.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-8A000000secondary00000000secondary}.mdc-checkbox__native-control[disabled]:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:rgba(0,0,0,.38);background-color:transparent}.mdc-checkbox__native-control[disabled]:checked~.mdc-checkbox__background,.mdc-checkbox__native-control[disabled]:indeterminate~.mdc-checkbox__background,.mdc-checkbox__native-control[data-indeterminate=true][disabled]~.mdc-checkbox__background{border-color:transparent;background-color:rgba(0,0,0,.38)}.mdc-checkbox__native-control:enabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:#fff}.mdc-checkbox__native-control:enabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:#fff}.mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:#fff}.mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:#fff}@media screen and (-ms-high-contrast: active){.mdc-checkbox__native-control[disabled]:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:GrayText;background-color:transparent}.mdc-checkbox__native-control[disabled]:checked~.mdc-checkbox__background,.mdc-checkbox__native-control[disabled]:indeterminate~.mdc-checkbox__background,.mdc-checkbox__native-control[data-indeterminate=true][disabled]~.mdc-checkbox__background{border-color:GrayText;background-color:transparent}.mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:GrayText}.mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:GrayText}.mdc-checkbox__mixedmark{margin:0 1px}}.mdc-checkbox--disabled{cursor:default;pointer-events:none}.mdc-checkbox__background{display:inline-flex;position:absolute;align-items:center;justify-content:center;box-sizing:border-box;width:18px;height:18px;border:2px solid currentColor;border-radius:2px;background-color:transparent;pointer-events:none;will-change:background-color,border-color;transition:background-color 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),border-color 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__background .mdc-checkbox__background::before{background-color:#000;background-color:var(--mdc-theme-on-surface, #000)}.mdc-checkbox__checkmark{position:absolute;top:0;right:0;bottom:0;left:0;width:100%;opacity:0;transition:opacity 180ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox--upgraded .mdc-checkbox__checkmark{opacity:1}.mdc-checkbox__checkmark-path{transition:stroke-dashoffset 180ms 0ms cubic-bezier(0.4, 0, 0.6, 1);stroke:currentColor;stroke-width:3.12px;stroke-dashoffset:29.7833385;stroke-dasharray:29.7833385}.mdc-checkbox__mixedmark{width:100%;height:0;transform:scaleX(0) rotate(0deg);border-width:1px;border-style:solid;opacity:0;transition:opacity 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox--upgraded .mdc-checkbox__background,.mdc-checkbox--upgraded .mdc-checkbox__checkmark,.mdc-checkbox--upgraded .mdc-checkbox__checkmark-path,.mdc-checkbox--upgraded .mdc-checkbox__mixedmark{transition:none !important}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__background,.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__background,.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__background,.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__background{animation-duration:180ms;animation-timing-function:linear}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-unchecked-checked-checkmark-path 180ms linear 0s;transition:none}.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-unchecked-indeterminate-mixedmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-checked-unchecked-checkmark-path 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__checkmark{animation:mdc-checkbox-checked-indeterminate-checkmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-checked-indeterminate-mixedmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__checkmark{animation:mdc-checkbox-indeterminate-checked-checkmark 500ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-checked-mixedmark 500ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-unchecked-mixedmark 300ms linear 0s;transition:none}.mdc-checkbox__native-control:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background{transition:border-color 90ms 0ms cubic-bezier(0, 0, 0.2, 1),background-color 90ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__checkmark-path{stroke-dashoffset:0}.mdc-checkbox__background::before{position:absolute;transform:scale(0, 0);border-radius:50%;opacity:0;pointer-events:none;content:\"\";will-change:opacity,transform;transition:opacity 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__native-control:focus~.mdc-checkbox__background::before{transform:scale(1);opacity:.12;transition:opacity 80ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 80ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-checkbox__native-control{position:absolute;margin:0;padding:0;opacity:0;cursor:inherit}.mdc-checkbox__native-control:disabled{cursor:default;pointer-events:none}.mdc-checkbox--touch{margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}.mdc-checkbox--touch .mdc-checkbox__native-control{top:-4px;right:-4px;left:-4px;width:48px;height:48px}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark{transition:opacity 180ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 180ms 0ms cubic-bezier(0, 0, 0.2, 1);opacity:1}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(-45deg)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__checkmark{transform:rotate(45deg);opacity:0;transition:opacity 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__mixedmark,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(0deg);opacity:1}:host{outline:none;display:inline-block}.mdc-checkbox .mdc-checkbox__native-control:focus~.mdc-checkbox__background::before{background-color:rgba(0,0,0,.54);background-color:var(--mdc-checkbox-unchecked-color, rgba(0, 0, 0, 0.54))}.mdc-checkbox .mdc-checkbox__background::before{content:none}.mdc-checkbox__native-control[disabled]:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-disabled-color, rgba(0, 0, 0, 0.38));background-color:transparent}.mdc-checkbox__native-control[disabled]:checked~.mdc-checkbox__background,.mdc-checkbox__native-control[disabled]:indeterminate~.mdc-checkbox__background,.mdc-checkbox__native-control[data-indeterminate=true][disabled]~.mdc-checkbox__background{border-color:transparent;background-color:var(--mdc-checkbox-disabled-color, rgba(0, 0, 0, 0.38))}.mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unchecked-color, rgba(0, 0, 0, 0.54));background-color:transparent}.mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:#018786;border-color:var(--mdc-theme-secondary, #018786);background-color:#018786;background-color:var(--mdc-theme-secondary, #018786)}@keyframes mdc-checkbox-fade-in-background---mdc-checkbox-unchecked-colorsecondary00000000secondary{0%{border-color:var(--mdc-checkbox-unchecked-color, rgba(0, 0, 0, 0.54));background-color:transparent}50%{border-color:#018786;border-color:var(--mdc-theme-secondary, #018786);background-color:#018786;background-color:var(--mdc-theme-secondary, #018786)}}@keyframes mdc-checkbox-fade-out-background---mdc-checkbox-unchecked-colorsecondary00000000secondary{0%,80%{border-color:#018786;border-color:var(--mdc-theme-secondary, #018786);background-color:#018786;background-color:var(--mdc-theme-secondary, #018786)}100%{border-color:var(--mdc-checkbox-unchecked-color, rgba(0, 0, 0, 0.54));background-color:transparent}}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background---mdc-checkbox-unchecked-colorsecondary00000000secondary}.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background---mdc-checkbox-unchecked-colorsecondary00000000secondary}.mdc-checkbox__native-control:enabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:var(--mdc-checkbox-mark-color, #fff)}.mdc-checkbox__native-control:enabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:var(--mdc-checkbox-mark-color, #fff)}.mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:var(--mdc-checkbox-mark-color, #fff)}.mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:var(--mdc-checkbox-mark-color, #fff)}`;\n/**\n@license\nCopyright 2018 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/let u=class extends l{};u.styles=d,u=Object(i.__decorate)([Object(r.c)(\"mwc-checkbox\")],u)},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"ListItem\",(function(){return l}));var i=n(1),r=n(0),o=(n(81),n(10)),a=n(63);\n/**\n @license\n Copyright 2020 Google Inc. All Rights Reserved.\n\n Licensed under the Apache License, Version 2.0 (the \"License\");\n you may not use this file except in compliance with the License.\n You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\n Unless required by applicable law or agreed to in writing, software\n distributed under the License is distributed on an \"AS IS\" BASIS,\n WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n See the License for the specific language governing permissions and\n limitations under the License.\n */\nclass s extends r.a{constructor(){super(...arguments),this.value=\"\",this.group=null,this.tabindex=-1,this.disabled=!1,this.twoline=!1,this.activated=!1,this.graphic=null,this.hasMeta=!1,this.noninteractive=!1,this.selected=!1,this.shouldRenderRipple=!1,this.boundOnClick=this.onClick.bind(this),this._firstChanged=!0,this._skipPropRequest=!1,this.rippleHandlers=new a.a(()=>(this.shouldRenderRipple=!0,this.ripple)),this.listeners=[{target:this,eventNames:[\"click\"],cb:()=>{this.onClick()}},{target:this,eventNames:[\"mouseenter\"],cb:this.rippleHandlers.startHover},{target:this,eventNames:[\"mouseleave\"],cb:this.rippleHandlers.endHover},{target:this,eventNames:[\"focus\"],cb:this.rippleHandlers.startFocus},{target:this,eventNames:[\"blur\"],cb:this.rippleHandlers.endFocus},{target:this,eventNames:[\"mousedown\",\"touchstart\"],cb:this.rippleHandlers.startPress},{target:this,eventNames:[\"mouseup\",\"touchend\"],cb:this.rippleHandlers.endPress}]}get text(){const t=this.textContent;return t?t.trim():\"\"}render(){const t=this.renderText(),e=this.graphic?this.renderGraphic():r.e``,n=this.hasMeta?this.renderMeta():r.e``;return r.e`\n      ${this.renderRipple()}\n      ${e}\n      ${t}\n      ${n}`}renderRipple(){return this.shouldRenderRipple?r.e`\n      <mwc-ripple\n        .activated=${this.activated}>\n      </mwc-ripple>`:this.activated?r.e`<div class=\"fake-activated-ripple\"></div>`:r.e``}renderGraphic(){return r.e`\n      <span class=\"mdc-list-item__graphic material-icons\">\n        <slot name=\"graphic\"></slot>\n      </span>`}renderMeta(){return r.e`\n      <span class=\"mdc-list-item__meta material-icons\">\n        <slot name=\"meta\"></slot>\n      </span>`}renderText(){const t=this.twoline?this.renderTwoline():this.renderSingleLine();return r.e`\n      <span class=\"mdc-list-item__text\">\n        ${t}\n      </span>`}renderSingleLine(){return r.e`<slot></slot>`}renderTwoline(){return r.e`\n      <span class=\"mdc-list-item__primary-text\">\n        <slot></slot>\n      </span>\n      <span class=\"mdc-list-item__secondary-text\">\n        <slot name=\"secondary\"></slot>\n      </span>\n    `}onClick(){this.fireRequestSelected(!this.selected,\"interaction\")}fireRequestSelected(t,e){if(this.noninteractive)return;const n=new CustomEvent(\"request-selected\",{bubbles:!0,composed:!0,detail:{source:e,selected:t}});this.dispatchEvent(n)}connectedCallback(){super.connectedCallback(),this.noninteractive||this.setAttribute(\"mwc-list-item\",\"\");for(const t of this.listeners)for(const e of t.eventNames)t.target.addEventListener(e,t.cb,{passive:!0})}disconnectedCallback(){super.disconnectedCallback();for(const t of this.listeners)for(const e of t.eventNames)t.target.removeEventListener(e,t.cb)}firstUpdated(){this.dispatchEvent(new Event(\"list-item-rendered\",{bubbles:!0,composed:!0}))}}Object(i.__decorate)([Object(r.h)(\"slot\")],s.prototype,\"slotElement\",void 0),Object(i.__decorate)([Object(r.i)(\"mwc-ripple\")],s.prototype,\"ripple\",void 0),Object(i.__decorate)([Object(r.g)({type:String})],s.prototype,\"value\",void 0),Object(i.__decorate)([Object(r.g)({type:String,reflect:!0})],s.prototype,\"group\",void 0),Object(i.__decorate)([Object(r.g)({type:Number,reflect:!0})],s.prototype,\"tabindex\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean,reflect:!0}),Object(o.a)((function(t){t?this.setAttribute(\"aria-disabled\",\"true\"):this.setAttribute(\"aria-disabled\",\"false\")}))],s.prototype,\"disabled\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean,reflect:!0})],s.prototype,\"twoline\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean,reflect:!0})],s.prototype,\"activated\",void 0),Object(i.__decorate)([Object(r.g)({type:String,reflect:!0})],s.prototype,\"graphic\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean})],s.prototype,\"hasMeta\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean,reflect:!0}),Object(o.a)((function(t){t?(this.removeAttribute(\"aria-checked\"),this.removeAttribute(\"mwc-list-item\"),this.selected=!1,this.activated=!1,this.tabIndex=-1):this.setAttribute(\"mwc-list-item\",\"\")}))],s.prototype,\"noninteractive\",void 0),Object(i.__decorate)([Object(r.g)({type:Boolean,reflect:!0}),Object(o.a)((function(t){t?this.setAttribute(\"aria-selected\",\"true\"):this.setAttribute(\"aria-selected\",\"false\"),this._firstChanged?this._firstChanged=!1:this._skipPropRequest||this.fireRequestSelected(t,\"property\")}))],s.prototype,\"selected\",void 0),Object(i.__decorate)([Object(r.f)()],s.prototype,\"shouldRenderRipple\",void 0);\n/**\n@license\nCopyright 2018 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\nconst c=r.b`:host{cursor:pointer;user-select:none;height:48px;display:flex;position:relative;align-items:center;justify-content:flex-start;padding:0 16px;overflow:hidden;padding-left:var(--mdc-list-side-padding, 16px);padding-right:var(--mdc-list-side-padding, 16px);outline:none;height:48px;color:rgba(0,0,0,.87);color:var(--mdc-theme-text-primary-on-background, rgba(0, 0, 0, 0.87))}:host:focus{outline:none}:host([activated]){color:#6200ee;color:var(--mdc-theme-primary, #6200ee);--mdc-ripple-color: var(--mdc-theme-primary, #6200ee)}:host([activated]) .mdc-list-item__graphic{color:#6200ee;color:var(--mdc-theme-primary, #6200ee)}:host([activated]) .fake-activated-ripple::before{position:absolute;display:block;top:0;bottom:0;left:0;right:0;width:100%;height:100%;pointer-events:none;z-index:1;content:\"\";opacity:.12;opacity:var(--mdc-ripple-activated-opacity, 0.12);background-color:var(--mdc-theme-primary, #6200ee)}.mdc-list-item__graphic{flex-shrink:0;align-items:center;justify-content:center;fill:currentColor;display:inline-flex}.mdc-list-item__graphic ::slotted(*){flex-shrink:0;align-items:center;justify-content:center;fill:currentColor;width:100%;height:100%;text-align:center}.mdc-list-item__meta{width:var(--mdc-list-item-meta-size, 24px);height:var(--mdc-list-item-meta-size, 24px);margin-left:auto;margin-right:0;color:rgba(0,0,0,.38);color:var(--mdc-theme-text-hint-on-background, rgba(0, 0, 0, 0.38))}.mdc-list-item__meta ::slotted(*){line-height:var(--mdc-list-item-meta-size, 24px)}.mdc-list-item__meta ::slotted(.material-icons),.mdc-list-item__meta ::slotted(mwc-icon){line-height:var(--mdc-list-item-meta-size, 24px) !important}.mdc-list-item__meta ::slotted(:not(.material-icons):not(mwc-icon)){-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-caption-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:.75rem;font-size:var(--mdc-typography-caption-font-size, 0.75rem);line-height:1.25rem;line-height:var(--mdc-typography-caption-line-height, 1.25rem);font-weight:400;font-weight:var(--mdc-typography-caption-font-weight, 400);letter-spacing:.0333333333em;letter-spacing:var(--mdc-typography-caption-letter-spacing, 0.0333333333em);text-decoration:inherit;text-decoration:var(--mdc-typography-caption-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-caption-text-transform, inherit)}:host[dir=rtl] .mdc-list-item__meta,[dir=rtl] :host .mdc-list-item__meta{margin-left:0;margin-right:auto}.mdc-list-item__meta ::slotted(*){width:100%;height:100%}.mdc-list-item__text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.mdc-list-item__text ::slotted([for]),.mdc-list-item__text[for]{pointer-events:none}.mdc-list-item__primary-text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block;margin-top:0;line-height:normal;margin-bottom:-20px;display:block}.mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:\"\";vertical-align:0}.mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:\"\";vertical-align:-20px}.mdc-list-item__secondary-text{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-body2-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:.875rem;font-size:var(--mdc-typography-body2-font-size, 0.875rem);line-height:1.25rem;line-height:var(--mdc-typography-body2-line-height, 1.25rem);font-weight:400;font-weight:var(--mdc-typography-body2-font-weight, 400);letter-spacing:.0178571429em;letter-spacing:var(--mdc-typography-body2-letter-spacing, 0.0178571429em);text-decoration:inherit;text-decoration:var(--mdc-typography-body2-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-body2-text-transform, inherit);text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block;margin-top:0;line-height:normal;display:block}.mdc-list-item__secondary-text::before{display:inline-block;width:0;height:20px;content:\"\";vertical-align:0}.mdc-list--dense .mdc-list-item__secondary-text{font-size:inherit}* ::slotted(a),a{color:inherit;text-decoration:none}:host([twoline]){height:72px}:host([twoline]) .mdc-list-item__text{align-self:flex-start}:host([disabled]),:host([noninteractive]){cursor:default;pointer-events:none}:host([disabled]) .mdc-list-item__text ::slotted(*){opacity:.38}:host([disabled]) .mdc-list-item__text ::slotted(*),:host([disabled]) .mdc-list-item__primary-text ::slotted(*),:host([disabled]) .mdc-list-item__secondary-text ::slotted(*){color:#000;color:var(--mdc-theme-on-surface, #000)}.mdc-list-item__secondary-text ::slotted(*){color:rgba(0,0,0,.54);color:var(--mdc-theme-text-secondary-on-background, rgba(0, 0, 0, 0.54))}.mdc-list-item__graphic ::slotted(*){background-color:transparent;color:rgba(0,0,0,.38);color:var(--mdc-theme-text-icon-on-background, rgba(0, 0, 0, 0.38))}.mdc-list-group__subheader ::slotted(*){color:rgba(0,0,0,.87);color:var(--mdc-theme-text-primary-on-background, rgba(0, 0, 0, 0.87))}:host([graphic=avatar]) .mdc-list-item__graphic{width:var(--mdc-list-item-graphic-size, 40px);height:var(--mdc-list-item-graphic-size, 40px)}:host([graphic=avatar]) .mdc-list-item__graphic ::slotted(*){line-height:var(--mdc-list-item-graphic-size, 40px)}:host([graphic=avatar]) .mdc-list-item__graphic ::slotted(.material-icons),:host([graphic=avatar]) .mdc-list-item__graphic ::slotted(mwc-icon){line-height:var(--mdc-list-item-graphic-size, 40px) !important}:host([graphic=avatar]) .mdc-list-item__graphic ::slotted(*){border-radius:50%}:host([graphic=avatar],[graphic=medium],[graphic=large],[graphic=control]) .mdc-list-item__graphic{margin-left:0;margin-right:var(--mdc-list-item-graphic-margin, 16px)}:host[dir=rtl] :host([graphic=avatar],[graphic=medium],[graphic=large],[graphic=control]) .mdc-list-item__graphic,[dir=rtl] :host :host([graphic=avatar],[graphic=medium],[graphic=large],[graphic=control]) .mdc-list-item__graphic{margin-left:var(--mdc-list-item-graphic-margin, 16px);margin-right:0}:host([graphic=icon]) .mdc-list-item__graphic{width:var(--mdc-list-item-graphic-size, 24px);height:var(--mdc-list-item-graphic-size, 24px);margin-left:0;margin-right:var(--mdc-list-item-graphic-margin, 32px)}:host([graphic=icon]) .mdc-list-item__graphic ::slotted(*){line-height:var(--mdc-list-item-graphic-size, 24px)}:host([graphic=icon]) .mdc-list-item__graphic ::slotted(.material-icons),:host([graphic=icon]) .mdc-list-item__graphic ::slotted(mwc-icon){line-height:var(--mdc-list-item-graphic-size, 24px) !important}:host[dir=rtl] :host([graphic=icon]) .mdc-list-item__graphic,[dir=rtl] :host :host([graphic=icon]) .mdc-list-item__graphic{margin-left:var(--mdc-list-item-graphic-margin, 32px);margin-right:0}:host([graphic=avatar]:not([twoLine])),:host([graphic=icon]:not([twoLine])){height:56px}:host([graphic=medium]:not([twoLine])),:host([graphic=large]:not([twoLine])){height:72px}:host([graphic=medium]) .mdc-list-item__graphic,:host([graphic=large]) .mdc-list-item__graphic{width:var(--mdc-list-item-graphic-size, 56px);height:var(--mdc-list-item-graphic-size, 56px)}:host([graphic=medium]) .mdc-list-item__graphic ::slotted(*),:host([graphic=large]) .mdc-list-item__graphic ::slotted(*){line-height:var(--mdc-list-item-graphic-size, 56px)}:host([graphic=medium]) .mdc-list-item__graphic ::slotted(.material-icons),:host([graphic=medium]) .mdc-list-item__graphic ::slotted(mwc-icon),:host([graphic=large]) .mdc-list-item__graphic ::slotted(.material-icons),:host([graphic=large]) .mdc-list-item__graphic ::slotted(mwc-icon){line-height:var(--mdc-list-item-graphic-size, 56px) !important}:host([graphic=large]){padding-left:0px}`;\n/**\n@license\nCopyright 2020 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/let l=class extends s{};l.styles=c,l=Object(i.__decorate)([Object(r.c)(\"mwc-list-item\")],l)}]);","extractedComments":[]}